<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Error Message: setterm: $TERM is not defined</title>
    <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763</link>
    <description>For the new Whonix experimental templates from the Qubes repo:

In Dom0, when running &quot;qvm-&quot; commands [1] specifically upon Whonix VMs, such as &quot;qvm-start&quot;, &quot;qvm-run&quot;, etc, it outputs 2 lines of the following error, like this...

&lt;blockquote&gt;setterm: $TERM is not defined.
setterm: $TERM is not defined.&lt;/blockquote&gt;

For example, if I run the following in the Dom0 terminal:

[code]
qvm-run --pass-io whonix-workstation &#39;date&#39;
[/code]

it outputs:

&lt;blockquote&gt;setterm: $TERM is not defined.
setterm: $TERM is not defined.
Sat Dec 25 12:00:00 UTC 2014&lt;/blockquote&gt;

This error does not happen with other Fedora-based (non-Whonix) VMs in Qubes.

This error does not happen within the Whonix VM terminals themselves, just Dom0, when running &quot;qvm-&quot; commands upon the Whonix VMs.

I&#39;m writing a toolkit for Qubes + Whonix and this error gets in the way of cleanly parsing and processing the output of commands issued to the Whonix VMs.

Checked $TERM variable inside the Whonix VM terminals, I echo $TERM:

[code]
echo $TERM
[/code]

it outputs:

&lt;blockquote&gt;xterm&lt;/blockquote&gt;


[1] https://qubes-os.org/wiki/DomZeroTools


Cross posted this to the qubes-users mailing list: https://groups.google.com/d/topic/qubes-users/ToWHLRXBy5c</description>
    <language>en</language>
    <lastBuildDate>Tue, 06 Jan 2015 12:53:38 +0000</lastBuildDate>
    <category>Qubes-Whonix</category>
    <atom:link href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Yes.</p>
<p>“parsing” = have the <a href="https://en.wikipedia.org/wiki/Virtual_console" data-bbcode="true">virtual console</a></p>
<pre><code class="lang-auto"></code></pre>
<p>which does</p>
<pre><code class="lang-auto">if [ -d /etc/profile.d ]; then
  for i in /etc/profile.d/*.sh; do
    if [ -r $i ]; then
      . $i
    fi
  done
  unset i
fi</code></pre>
<p>Usually only a virtual console is doing this once after the user has (auto) logged in. (For example into tty0.)</p>
<p>“always parsing” = would be the case if virtual console did the above for each and every command that is entered.</p>
<p>Having qvm-run parse /etc/profile once for each VM might be fine. But it should be somehow cached. Doing this every time, for each and every command is what I mean by “always parsing” and this could be a performance issue.</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/28">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/28</link>
        <pubDate>Tue, 06 Jan 2015 12:53:38 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-28</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[nrgaway]]></dc:creator>
        <description><![CDATA[
            <p>[quote=“Patrick, post:26, topic:763”][quote author=WhonixQubes link=topic=839.msg6328#msg6328 date=1420478957]<br>
It makes me wonder if executing Whonix’s full “/etc/profile.d” directory each time is causing the launching of apps to be slow.<br>
[/quote]<br>
Could be. That’s what I meant by Qubes specific issue. I don’t think always parsing it is a good implementation. But what do I know.  <img src="//forums.whonix.org/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"> Could be, that it’s not that simple to implement this any better in Qubes.[/quote]</p>
<p>I don’t think I understand what you mean by ‘always parsing’ or maybe what it’s in reference to.</p>
<p>From what I understand every file related to the shell (.sh for bash, .csh for csh) in the /etc/profile.d directory is sourced by every newly created shell.  This would be the case for every distribution of Linux no matter the flavour, would it not?</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/27">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/27</link>
        <pubDate>Mon, 05 Jan 2015 22:43:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-27</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="25" data-topic="763">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/w/c5a1d2/40.png" class="avatar"> WhonixQubes:</div>
<blockquote>
<p>It makes me wonder if executing Whonix’s full “/etc/profile.d” directory each time is causing the launching of apps to be slow.</p>
</blockquote>
</aside>
<p>Could be. That’s what I meant by Qubes specific issue. I don’t think always parsing it is a good implementation. But what do I know.  <img src="//forums.whonix.org/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"> Could be, that it’s not that simple to implement this any better in Qubes.</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/26">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/26</link>
        <pubDate>Mon, 05 Jan 2015 20:26:44 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-26</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <p>I have <em>subjectively</em> noticed that launching apps can feel slow. Especially remembering when launching apps via “qvm-run” command in Dom0.</p>
<p>It makes me wonder if executing Whonix’s full “/etc/profile.d” directory each time is causing the launching of apps to be slow.</p>
<p>Haven’t done explicit A/B tests yet to compare app launching speeds.</p>
<p>Contents of /etc/profile.d that supposedly gets executed every time:</p>
<pre><code class="lang-auto">ls /etc/profile.d

15_open_link_confirmation.sh
20_controlportfilt.sh
20_default_browser.sh
20_power_savings_disable_in_vms.sh
20_torbrowser.sh
20_whonix.sh
30_desktop.sh
30_setup.sh
40_msgdispatcher.sh
bash_completion.sh
qt_x11_no_mitshm.sh
qubes-gui.csh
qubes-gui.sh
qubes-session.sh</code></pre>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/25">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/25</link>
        <pubDate>Mon, 05 Jan 2015 17:29:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-25</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[nrgaway]]></dc:creator>
        <description><![CDATA[
            <p>[quote=“Patrick, post:22, topic:763”]The problem is that 20_power_savings_disable_in_vms.sh is executed when running qvm-run.</p>
<p>Or more generally said:<br>
The problem is that /etc/profile.d is executed when running qvm-run. (Must be persistent.)</p>
<p>If you use some other VM and add /etc/profile.d/30_test.sh, make it executable and add.</p>
<pre><code class="lang-auto">#!/bin/bash
echo "$0: debug test"</code></pre>
<p>It would have the same effect.</p>
<p>So “setterm: $TERM is not defined.” / power-savings-disable-in-vms is just a symptom. Not the issue.</p>
<p>Parsing whole /etc/profile.d/ for each run of qvm-run seems strange to me. Could be a Qubes specific issue.[/quote]</p>
<p>qvm-run is a command line utility that connects to the AppVM to run some command as superuser which will also echo its output back.  profile.d is parsed for any shell connecting as it would for any distribution I would think.  qvm-run is used instead of networking for inter-vm communications which means to be more secure and allows transferring of data (based on policies) between vm’s with no network access.</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/24">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/24</link>
        <pubDate>Sat, 03 Jan 2015 20:22:35 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-24</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[nrgaway]]></dc:creator>
        <description><![CDATA[
            <p>[quote=“Patrick, post:14, topic:763”]Added this:<br>
</p><aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/power-savings-disable-in-vms/commit/94dbabd43c54305822d7f045a7eb456db9d683d5" target="_blank" rel="nofollow noopener">github.com/Whonix/power-savings-disable-in-vms</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/power-savings-disable-in-vms/commit/94dbabd43c54305822d7f045a7eb456db9d683d5" target="_blank" rel="nofollow noopener">qubes specific fix</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2015-01-01" data-time="15:56:08" data-timezone="UTC">03:56PM - 01 Jan 15 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
          <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 17 additions and 4 deletions">
        <a href="https://github.com/Whonix/power-savings-disable-in-vms/commit/94dbabd43c54305822d7f045a7eb456db9d683d5" target="_blank" rel="nofollow noopener">
          <span class="added">+17</span>
          <span class="removed">-4</span>
        </a>
      </div>
    </div>

  </div>
</div>




  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<p></p>
<p>Are you sure there will be a /usr/lib/qubes folder?</p>
<p>The whonix-qubes package does not contain one. See <a href="https://github.com/nrgaway/whonix-qubes/tree/master/usr/lib.%5B/quote" rel="nofollow noopener">https://github.com/nrgaway/whonix-qubes/tree/master/usr/lib.[/quote</a>]</p>
<p>Yes, there will always be a /var/run/qubes. It is created before the network is brought up in /usr/lib/qubes/init/qubes-sysinit.sh.</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/23">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/23</link>
        <pubDate>Sat, 03 Jan 2015 20:13:31 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-23</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>The problem is that 20_power_savings_disable_in_vms.sh is executed when running qvm-run.</p>
<p>Or more generally said:<br>
The problem is that /etc/profile.d is executed when running qvm-run. (Must be persistent.)</p>
<p>If you use some other VM and add /etc/profile.d/30_test.sh, make it executable and add.</p>
<pre><code class="lang-auto">#!/bin/bash
echo "$0: debug test"</code></pre>
<p>It would have the same effect.</p>
<p>So “setterm: $TERM is not defined.” / power-savings-disable-in-vms is just a symptom. Not the issue.</p>
<p>Parsing whole /etc/profile.d/ for each run of qvm-run seems strange to me. Could be a Qubes specific issue.</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/22">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/22</link>
        <pubDate>Sat, 03 Jan 2015 19:53:48 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-22</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="20" data-topic="763">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Looks like a Qubes bug to me. Or just a strange way to implement this.</p>
</blockquote>
</aside>
<p>I’m unsure how the qrexec module and qvm-* commands are implemented.</p>
<p>Don’t get these errors in Qubes Dom0 Terminal with other Qubes VMs.</p>
<p>I can literally out comment each of the problem commands in “20_power_savings_disable_in_vms.sh” and individual instances of the errors disappear, while the VM is live without reboot.</p>
<p>For example:</p>
<p>In Qubes Dom0 Terminal:</p>
<pre><code class="lang-auto">qvm-run --pass-io whonix-workstation 'date'

setterm: $TERM is not defined.
setterm: $TERM is not defined.
Sat Dec 25 12:00:00 UTC 2014</code></pre>
<p>Then, if in the whonix-workstation VM, I comment out:</p>
<pre><code class="lang-auto">#setterm -blank 0
true "$0: exit code: $?"
setterm -powerdown 0
true "$0: exit code: $?"</code></pre>
<p>and run again in Qubes Dom0 Terminal:</p>
<pre><code class="lang-auto">qvm-run --pass-io whonix-workstation 'date'

setterm: $TERM is not defined.
Sat Dec 25 12:00:00 UTC 2014</code></pre>
<p>Then, if in the whonix-workstation VM, I comment out:</p>
<pre><code class="lang-auto">#setterm -blank 0
true "$0: exit code: $?"
#setterm -powerdown 0
true "$0: exit code: $?"</code></pre>
<p>and run again in Qubes Dom0 Terminal:</p>
<pre><code class="lang-auto">qvm-run --pass-io whonix-workstation 'date'

Sat Dec 25 12:00:00 UTC 2014</code></pre>
<p>Each instance of the Qubes Dom0 Terminal error is dynamically removed on live VMs by commenting out each “setterm” command in the Whonix VM.</p>
<p>But, anyway, our “2&gt;/dev/null” patch takes care of the error output as well, without disabling the Whonix “setterm” commands.</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/21">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/21</link>
        <pubDate>Sat, 03 Jan 2015 19:10:51 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-21</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Looks like a Qubes bug to me. Or just a strange way to implement this.</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/20">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/20</link>
        <pubDate>Sat, 03 Jan 2015 18:35:36 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-20</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="18" data-topic="763">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>You were getting this “setterm: $TERM is not defined.” for executing each and every command?</p>
</blockquote>
</aside>
<p>Not in the Whonix VMs themselves.<br>
Yes in Qubes Dom0 Terminal using qvm-* commands.</p>
<p><a href="https://qubes-os.org/wiki/DomZeroTools" class="onebox" target="_blank" rel="nofollow noopener">https://qubes-os.org/wiki/DomZeroTools</a></p>
<p>[quote=“Patrick, post:18, topic:763”]To make sure, consider adding some debug output to /etc/profile.d/20_power_savings_disable_in_vms.sh such as</p>
<pre><code class="lang-auto"></code></pre>
<p>after</p>
<pre><code class="lang-auto"></code></pre>
<p>This echos the following in Qubes Dom0 Terminal along with the additional output of the qvm-* commands:</p>
<blockquote>-su: debug</blockquote>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/19">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/19</link>
        <pubDate>Sat, 03 Jan 2015 17:49:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-19</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>You were getting this “setterm: $TERM is not defined.” for executing each and every command?</p>
<p><a href="https://github.com/Whonix/power-savings-disable-in-vms/blob/master/etc/profile.d/20_power_savings_disable_in_vms.sh">https://github.com/Whonix/power-savings-disable-in-vms/blob/master/etc/profile.d/20_power_savings_disable_in_vms.sh</a> should only be executed after login to a <a href="https://en.wikipedia.org/wiki/Virtual_console" data-bbcode="true">virtual console</a>.</p>
<p>If it happens for each and every command in a terminal emulator (ex: Konsole) (?), then it would mean that script is executed every time you type a command. That would be a Qubes specific bug, that would cause a lot unnecessary system load that should be fixed.</p>
<p>To make sure, consider adding some debug output to /etc/profile.d/20_power_savings_disable_in_vms.sh such as</p>
<pre><code class="lang-auto"></code></pre>
<p>after</p>
<pre><code class="lang-auto"></code></pre>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/18">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/18</link>
        <pubDate>Sat, 03 Jan 2015 11:01:41 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-18</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <p>Just tested and confirmed as working in Qubes.</p>
<p>Working as in it now successfully allows commands to execute without error: “setterm: $TERM is not defined.”</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/17">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/17</link>
        <pubDate>Sat, 03 Jan 2015 00:55:52 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-17</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Sounds good. So <a href="https://github.com/Whonix/power-savings-disable-in-vms/commit/94dbabd43c54305822d7f045a7eb456db9d683d5">https://github.com/Whonix/power-savings-disable-in-vms/commit/94dbabd43c54305822d7f045a7eb456db9d683d5</a> should do.</p>
<p>Can you test please?</p>
<p>You just need this updated file:<br>
</p><aside class="onebox githubblob">
  <header class="source">
      <a href="https://github.com/Whonix/power-savings-disable-in-vms/blob/master/etc/profile.d/20_power_savings_disable_in_vms.sh" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="https://github.com/Whonix/power-savings-disable-in-vms/blob/master/etc/profile.d/20_power_savings_disable_in_vms.sh" target="_blank" rel="nofollow noopener">Whonix/power-savings-disable-in-vms/blob/master/etc/profile.d/20_power_savings_disable_in_vms.sh</a></h4>
<pre><code class="lang-sh">#!/bin/bash

## Copyright (C) 2012 - 2018 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions.

output_cmd="true"
#output_cmd="echo"

script_name="power-savings-disable-in-vms"

true "$script_name: Using 'return' in combination with 'exit' so this script can be both, being 'source'd as well as executed."

if ! shopt -q login_shell ; then
   $output_cmd "$script_name: Not running in a login shell, not doing anything."
   return
   exit 0
fi

if ! test -x /usr/sbin/virt-what &gt;/dev/null ; then
   $output_cmd "$script_name: /usr/sbin/virt-what not executable found. Stop."
</code></pre>

  This file has been truncated. <a href="https://github.com/Whonix/power-savings-disable-in-vms/blob/master/etc/profile.d/20_power_savings_disable_in_vms.sh" target="_blank" rel="nofollow noopener">show original</a>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<p></p>
<p>Get it either way. Copy/paste manually or install the upgraded package.</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/16">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/16</link>
        <pubDate>Fri, 02 Jan 2015 16:33:58 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-16</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <p>[quote=“Patrick, post:14, topic:763”]Added this:<br>
</p><aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/power-savings-disable-in-vms/commit/94dbabd43c54305822d7f045a7eb456db9d683d5" target="_blank" rel="nofollow noopener">github.com/Whonix/power-savings-disable-in-vms</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/power-savings-disable-in-vms/commit/94dbabd43c54305822d7f045a7eb456db9d683d5" target="_blank" rel="nofollow noopener">qubes specific fix</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2015-01-01" data-time="15:56:08" data-timezone="UTC">03:56PM - 01 Jan 15 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
          <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 17 additions and 4 deletions">
        <a href="https://github.com/Whonix/power-savings-disable-in-vms/commit/94dbabd43c54305822d7f045a7eb456db9d683d5" target="_blank" rel="nofollow noopener">
          <span class="added">+17</span>
          <span class="removed">-4</span>
        </a>
      </div>
    </div>

  </div>
</div>




  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<p></p>
<p>Are you sure there will be a /usr/lib/qubes folder?</p>
<p>The whonix-qubes package does not contain one. See <a href="https://github.com/nrgaway/whonix-qubes/tree/master/usr/lib.%5B/quote" rel="nofollow noopener">https://github.com/nrgaway/whonix-qubes/tree/master/usr/lib.[/quote</a>]</p>
<p>The “/usr/lib/qubes” directory is a part of Qubes, so it is expected to NOT be in the “whonix-qubes” package made by nrgaway.</p>
<p>I just confirmed that “/usr/lib/qubes” it is present in the Qubes Fedora and Whonix templates, as well as all ProxyVMs and AppVMs that are created from these templates, including Whonix-Gateway ProxyVMs and Whonix-Workstation AppVMs.</p>
<p>It does seem to be always present from what I can tell by looking in various Qubes VMs.</p>
<p>It contains several Qubes system files:</p>
<pre><code class="lang-auto">ls /usr/lib/qubes

close-window
dispvm-prerun.sh
init
iptables-updates-proxy
network-manager-prepare-conf-dir
prepare-suspend
qfile-agent
qfile-unpacker
qopen-in-vm
qrexec-agent
qrexec_client_vm
qrexec-client-vm
qrun-in-vm
qubes-fix-nm-conf.sh
qubes-rpc-multiplexer
qubes-setup-dnat-to-ns
qubes-trigger-sync-appmenus.sh
qvm-copy-to-vm.gnome
qvm-copy-to-vm.kde
qvm-move-to-vm.gnome
qvm-move-to-vm.kde
setup-ip
show-hide-nm-applet.sh
sync-ntp-clock
tar2qfile
vm-file-editor
vusb-ctl.py
wrap-in-html-if-url.sh</code></pre>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/15</link>
        <pubDate>Thu, 01 Jan 2015 22:37:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-15</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Added this:<br>
</p><aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/power-savings-disable-in-vms/commit/94dbabd43c54305822d7f045a7eb456db9d683d5" target="_blank">github.com/Whonix/power-savings-disable-in-vms</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/power-savings-disable-in-vms/commit/94dbabd43c54305822d7f045a7eb456db9d683d5" target="_blank">qubes specific fix</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2015-01-01" data-time="15:56:08" data-timezone="UTC">03:56PM - 01 Jan 15 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 17 additions and 4 deletions">
        <a href="https://github.com/Whonix/power-savings-disable-in-vms/commit/94dbabd43c54305822d7f045a7eb456db9d683d5" target="_blank">
          <span class="added">+17</span>
          <span class="removed">-4</span>
        </a>
      </div>
    </div>

  </div>
</div>




  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<p></p>
<p>Are you sure there will be a /usr/lib/qubes folder?</p>
<p>The whonix-qubes package does not contain one. See <a href="https://github.com/nrgaway/whonix-qubes/tree/master/usr/lib">https://github.com/nrgaway/whonix-qubes/tree/master/usr/lib</a>.</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/14</link>
        <pubDate>Thu, 01 Jan 2015 15:58:25 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-14</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Looks good.</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/13</link>
        <pubDate>Mon, 29 Dec 2014 10:46:33 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-13</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <p>[quote=“Patrick, post:11, topic:763”]Redirecting stderr to /dev/null is fine. Not sure if that should be conditional only done on Qubes, but not for others. I guess the former is better.</p>
<p>I don’t think /var/run/anything is a good conditional for this due to the nature how /var/run is created. There is some qubes specific folder in /usr/ already anyhow as far I remember.</p>
<p>The code without “!” is slightly faster to grasp, for me, because it avoid a negation.[/quote]</p>
<p>If wanting to universally apply “2&gt;/dev/null” to all platforms, then that’s good.</p>
<pre><code class="lang-auto">setterm -blank 0 2&gt;/dev/null
true "$0: exit code: $?"
setterm -powerdown 0 2&gt;/dev/null
true "$0: exit code: $?"</code></pre>
<p>[hr]</p>
<p>If wanting to apply “2&gt;/dev/null” to Qubes only…</p>
<p>Maybe instead it would work to substitute in the following directory as the Qubes platform conditional check?</p>
<pre><code class="lang-auto">/usr/lib/qubes</code></pre>
<pre><code class="lang-auto">if [ -d "/usr/lib/qubes" ]; then
   setterm -blank 0 2&gt;/dev/null
   true "$0: exit code: $?"
   setterm -powerdown 0 2&gt;/dev/null
   true "$0: exit code: $?"
else
   setterm -blank 0
   true "$0: exit code: $?"
   setterm -powerdown 0
   true "$0: exit code: $?"
fi</code></pre>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/12</link>
        <pubDate>Mon, 29 Dec 2014 10:23:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-12</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Redirecting stderr to /dev/null is fine. Not sure if that should be conditional only done on Qubes, but not for others. I guess the former is better.</p>
<p>I don’t think /var/run/anything is a good conditional for this due to the nature how /var/run is created. There is some qubes specific folder in /usr/ already anyhow as far I remember.</p>
<p>The code without “!” is slightly faster to grasp, for me, because it avoid a negation.</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/11</link>
        <pubDate>Mon, 29 Dec 2014 10:03:13 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-11</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <p>[quote=“nrgaway, post:9, topic:763”]Anyway, I suggest redirect any errors when when using the setterm command as follows:script to look like this:</p>
<p><code>
setterm -blank 0 2&gt;/dev/null
true "$0: exit code: $?"
setterm -powerdown 2&gt;/dev/null
true "$0: exit code: $?"
</code>[/quote]</p>
<p>Confirmed as working in Qubes.</p>
<p>It simply suppresses the STDERR of these commands.</p>
<p>Should work universally.</p>
<p>But if wanting to implement specific to Qubes, here would be some simple conditional code:</p>
<p>Version <span class="hashtag">#1:</span> Give Whonix Standard code 1st position; and Whonix Qubes code 2nd position:</p>
<pre><code class="lang-auto">if [ ! -d "/var/run/qubes" ]; then
   setterm -blank 0
   true "$0: exit code: $?"
   setterm -powerdown 0
   true "$0: exit code: $?"
else
   setterm -blank 0 2&gt;/dev/null
   true "$0: exit code: $?"
   setterm -powerdown 0 2&gt;/dev/null
   true "$0: exit code: $?"
fi</code></pre>
<p>Version <span class="hashtag">#2:</span> Give Whonix Qubes code 1st position; and Whonix Standard code 2nd position:</p>
<pre><code class="lang-auto">if [ -d "/var/run/qubes" ]; then
   setterm -blank 0 2&gt;/dev/null
   true "$0: exit code: $?"
   setterm -powerdown 0 2&gt;/dev/null
   true "$0: exit code: $?"
else
   setterm -blank 0
   true "$0: exit code: $?"
   setterm -powerdown 0
   true "$0: exit code: $?"
fi</code></pre>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/10</link>
        <pubDate>Mon, 29 Dec 2014 06:24:13 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-10</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[nrgaway]]></dc:creator>
        <description><![CDATA[
            <p>[quote=“Patrick, post:5, topic:763”]Maybe it’s just a symptom. Not the cause.</p>
<p>On a wheezy system using KDE, Konsole.</p>
<pre><code class="lang-auto">echo $TERM
xterm</code></pre>
<p>On a wheezy system, using console tty0.</p>
<pre><code class="lang-auto">echo $TERM
linux</code></pre>
<p>I guess the $TERM variable is not set when using Qubes? That would be a Qubes specific bug worth fixing.</p>
<p>Dumbing it down further, getting the whole power-savings-disable-in-vms package out of the equation…</p>
<p>What happens if you run the following in a Qubes plain Debian template? Try in KDE, Konsole as well as in a real login console such as tty0.</p>
<pre><code class="lang-auto">xset s off
xset -dpms
setterm -blank 0
setterm -powerdown 0</code></pre>
<p>I guess you’re getting the $TERM not defined error?[/quote]</p>
<p>$TERM is set on Qubes.  In a terminal shell using Whonix Gateway AppVM:</p>
<pre><code class="lang-auto">echo $TERM
xterm</code></pre>
<p>As for running the following:</p>
<pre><code class="lang-auto">xset s off
xset -dpms
setterm -blank 0
setterm -powerdown 0</code></pre>
<p>The last statement (setterm -powerdown 0) spits out a few bytes of garbage text, some type of escape sequence (<em>[9;0]</em>[14;0]).<br>
Qubes uses its own video (and input) drivers and does not rely on X-Windows due to security concerns (Any user can obtain access to any users x-window sessions keystrokes and such <a href="http://theinvisiblethings.blogspot.ca/2011/04/linux-security-circus-on-gui-isolation.html" data-bbcode="true" rel="nofollow noopener">http://theinvisiblethings.blogspot.ca/2011/04/linux-security-circus-on-gui-isolation.html</a>)</p>
<p>Anyway, I suggest redirect any errors when when using the setterm command as follows:script to look like this:</p>
<pre><code class="lang-auto">setterm -blank 0 2&gt;/dev/null
true "$0: exit code: $?"
setterm -powerdown 2&gt;/dev/null
true "$0: exit code: $?"</code></pre>
<p>The above code block works in Qubes and I imagine it would work as expected in other Vms as well.  Maybe you can test that out?</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/9</link>
        <pubDate>Sun, 28 Dec 2014 15:28:41 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-9</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="6" data-topic="763">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/n/f17d59/40.png" class="avatar"> nrgaway:</div>
<blockquote>
<p>If ‘/var/run/qubes’ exists, you are using a Qubes VM of some sort (template, proxy, etc).  So that would be good to use to determine if running on Qubes.</p>
</blockquote>
</aside>
<p>Great. Thanks!</p>
<p>Will plan on checking for this directory specifically for Whonix Qubes conditionals:</p>
<pre><code class="lang-auto">/var/run/qubes</code></pre>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/8</link>
        <pubDate>Sun, 28 Dec 2014 15:20:12 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-8</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <p>No $TERM errors within the Whonix VMs themselves.</p>
<p>The $TERM variable seems to be set inside the Whonix VMs.</p>
<p>Dom0 has no problem with other (non-Whonix) VMs in Qubes.</p>
<p>Dom0 has no problem with Whonix VMs <em>after deleting</em> the “power-savings-disable-in-vms” package.</p>
<p>However, the Whonix “power-savings-disable-in-vms” package seems to “disrupt” Qubes Dom0 from knowing the $TERM variable of Whonix VMs.</p>
<p>Only get the $TERM error when working with Whonix VMs from Dom0 (qvm-run --pass-io, etc), when the “power-savings-disable-in-vms” package is enabled.</p>
<p>Qubes Test Results:</p>
<p>[hr]</p>
<p>In Whonix AppVM KDE Konsole:</p>
<pre><code class="lang-auto">echo $TERM
xterm</code></pre>
<p>[hr]</p>
<p>In Dom0 KDE Konsole to Whonix AppVM:</p>
<pre><code class="lang-auto">qvm-run --pass-io whonix-workstation "echo $TERM"
setterm: $TERM is not defined.
setterm: $TERM is not defined.
xterm-256color</code></pre>
<p>[hr]</p>
<p>In Whonix HVM TTY:</p>
<pre><code class="lang-auto">echo $TERM
linux</code></pre>
<p>[hr]</p>
<p>In Whonix HVM TTY:</p>
<pre><code class="lang-auto">echo $TERM
linux

xset s off
xset:  unable to open display ""

xset -dpms
xset:  unable to open display ""

setterm -blank 0

setterm -powerdown 0

echo $TERM
linux</code></pre>
<p>[hr]</p>
<p>In Debian 8 AppVM GNOME Terminal:</p>
<pre><code class="lang-auto">echo $TERM
xterm</code></pre>
<p>[hr]</p>
<p>In Debian 8 AppVM GNOME Terminal:</p>
<pre><code class="lang-auto">echo $TERM
xterm

xset s off

xset -dpms

setterm -blank 0
setterm: terminal xterm does not support --blank

setterm -powerdown 0
 [14;0]

echo $TERM
xterm</code></pre>
<p>[hr]</p>
<p>In Dom0 KDE Konsole to Debian 8 GNOME Terminal:</p>
<pre><code class="lang-auto">echo $TERM
xterm-256color</code></pre>
<p>[hr]</p>
<p>In Debian 7 HVM GNOME Terminal:</p>
<pre><code class="lang-auto">echo $TERM
xterm</code></pre>
<p>[hr]</p>
<p>In Debian 7 HVM GNOME Terminal:</p>
<pre><code class="lang-auto">echo $TERM
xterm

xset s off

xset -dpms

setterm -blank 0

setterm -powerdown 0
 [14;0]

echo $TERM
xterm</code></pre>
<p>[hr]</p>
<p>In Debian 7 HVM TTY:</p>
<pre><code class="lang-auto">echo $TERM
linux

xset s off
-bash: xset: command not found

xset -dpms
-bash: xset: command not found

setterm -blank 0

setterm -powerdown 0

echo $TERM
linux</code></pre>
<p>[hr]</p>
<p>Let me know if you need any further tests or clarifications on these ones.</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/7</link>
        <pubDate>Sun, 28 Dec 2014 15:14:41 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-7</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[nrgaway]]></dc:creator>
        <description><![CDATA[
            <p>[quote=“WhonixQubes, post:4, topic:763”][quote author=Patrick link=topic=839.msg6172#msg6172 date=1419743969]<br>
Feel free to disable it conditionally in next Whonix release. By checking some environment variable or file (slightly cleaner, I think) that only exists within Qubes. Please send a pull request or I’ll do it next year. (Pretty easy, small, fast change.) You got some file already, that only exists within Qubes that can be used for checking we’re running inside Qubes?<br>
[/quote]</p>
<p>Great.</p>
<p>Ideally, we could somehow both retain the no screen blanking for vms feature and also resolve this $TERM not defined issue.</p>
<p><a class="mention" href="http://forums.whonix.org/u/nrgaway">@nrgaway</a></p>
<p>You still know the anatomy of your Whonix Qubes implementation much better than I.</p>
<p>We may need to use this same method for making other Qubes specific changes to Whonix in the future.</p>
<p>Going forward, what specific hook would you recommend being most dependable for detecting the presence of our Qubes platform?</p>
<p>No significant rush. Thanks![/quote]</p>
<p>If ‘/var/run/qubes’ exists, you are using a Qubes VM of some sort (template, proxy, etc).  So that would be good to use to determine if running on Qubes.</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/6</link>
        <pubDate>Sun, 28 Dec 2014 15:04:03 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-6</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Maybe it’s just a symptom. Not the cause.</p>
<p>On a wheezy system using KDE, Konsole.</p>
<pre><code class="lang-auto">echo $TERM
xterm</code></pre>
<p>On a wheezy system, using console tty0.</p>
<pre><code class="lang-auto">echo $TERM
linux</code></pre>
<p>I guess the $TERM variable is not set when using Qubes? That would be a Qubes specific bug worth fixing.</p>
<p>Dumbing it down further, getting the whole power-savings-disable-in-vms package out of the equation…</p>
<p>What happens if you run the following in a Qubes plain Debian template? Try in KDE, Konsole as well as in a real login console such as tty0.</p>
<pre><code class="lang-auto">xset s off
xset -dpms
setterm -blank 0
setterm -powerdown 0</code></pre>
<p>I guess you’re getting the $TERM not defined error?</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/5</link>
        <pubDate>Sun, 28 Dec 2014 09:52:24 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-5</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
      <item>
        <title>Error Message: setterm: $TERM is not defined</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="3" data-topic="763">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Feel free to disable it conditionally in next Whonix release. By checking some environment variable or file (slightly cleaner, I think) that only exists within Qubes. Please send a pull request or I’ll do it next year. (Pretty easy, small, fast change.) You got some file already, that only exists within Qubes that can be used for checking we’re running inside Qubes?</p>
</blockquote>
</aside>
<p>Great.</p>
<p>Ideally, we could somehow both retain the no screen blanking for vms feature and also resolve this $TERM not defined issue.</p>
<p><a class="mention" href="http://forums.whonix.org/u/nrgaway">@nrgaway</a></p>
<p>You still know the anatomy of your Whonix Qubes implementation much better than I.</p>
<p>We may need to use this same method for making other Qubes specific changes to Whonix in the future.</p>
<p>Going forward, what specific hook would you recommend being most dependable for detecting the presence of our Qubes platform?</p>
<p>No significant rush. Thanks!</p>
          <p><a href="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763/4</link>
        <pubDate>Sun, 28 Dec 2014 06:28:47 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-763-4</guid>
        <source url="http://forums.whonix.org/t/error-message-setterm-term-is-not-defined/763.rss">Error Message: setterm: $TERM is not defined</source>
      </item>
  </channel>
</rss>

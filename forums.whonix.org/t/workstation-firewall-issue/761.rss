<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Workstation Firewall issue</title>
    <link>http://forums.whonix.org/t/workstation-firewall-issue/761</link>
    <description>On Whonix Workstation 9.4, if you enable the firewall, the internet does not work. Timesync does not progress, whonixcheck reports control port not reachable and Tor Browser does not launch.</description>
    <language>en</language>
    <lastBuildDate>Wed, 04 Feb 2015 03:21:04 +0000</lastBuildDate>
    <category>Support</category>
    <atom:link href="http://forums.whonix.org/t/workstation-firewall-issue/761.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Solved.</p>
<p>(Also the “ping usability rule” (iptables -A OUTPUT ! -p tcp -j REJECT --reject-with icmp-port-unreachable) works again.)</p>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/14</link>
        <pubDate>Wed, 04 Feb 2015 03:21:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-14</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Reopened that ticket. Happening again. More info on ticket.</p>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/13</link>
        <pubDate>Wed, 04 Feb 2015 02:41:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-13</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>[quote=“z, post:10, topic:761”]Could we open a discussion or bug report for enabling this firewall by default? I guess it adds real security depending on various threat models. I guess 99% of users will not complain about it</p>
<p>Or perhaps asking on first boot like whonixsetup[/quote]<br>
You can open a discussion in development forum or so.</p>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/12</link>
        <pubDate>Tue, 27 Jan 2015 18:51:08 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-12</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>[quote=“z, post:9, topic:761”]please replace</p>
<pre><code class="lang-auto"></code></pre>
<p>with</p>
<p><code>iptables -A OUTPUT -p tcp -j ACCEPT
iptables -A OUTPUT -p icmp --icmp-type 3 -j ACCEPT</code></p>
<p>that last line, allowing only that particular icmp type was enough for fixing the issue. Don’t ask me why, I found by testing them[/quote]<br>
Current fixed version works as is.</p>
<p>I am not sure the original “iptables -A OUTPUT ! -p tcp -j REJECT --reject-with icmp-port-unreachable” idea (see comments) above was a good idea to begin with. It was not a rule to improve security. To idea was to improve usability (make ping say instantly failed rather than timeout) while on the other hand it worsens usability by creating confusing in corner cases (not being able to tunnel UDP oder Tor).</p>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/11</link>
        <pubDate>Tue, 27 Jan 2015 18:46:14 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-11</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[z11]]></dc:creator>
        <description><![CDATA[
            <p>Could we open a discussion or bug report for enabling this firewall by default? I guess it adds real security depending on various threat models. I guess 99% of users will not complain about it</p>
<p>Or perhaps asking on first boot like whonixsetup</p>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/10</link>
        <pubDate>Tue, 27 Jan 2015 06:20:06 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-10</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[z11]]></dc:creator>
        <description><![CDATA[
            <p>please replace</p>
<pre><code class="lang-auto"></code></pre>
<p>with</p>
<p><code>iptables -A OUTPUT -p tcp -j ACCEPT
iptables -A OUTPUT -p icmp --icmp-type 3 -j ACCEPT</code></p>
<p>that last line, allowing only that particular icmp type was enough for fixing the issue. Don’t ask me why, I found by testing them</p>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/9</link>
        <pubDate>Tue, 27 Jan 2015 05:13:24 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-9</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>That rule will be disabled in Whonix 10. For more, see also:<br>
<a href="https://github.com/Whonix/whonix-ws-firewall/commit/3e3a5047d4e5d6d18d78f62686f8c60da7abf55f" class="onebox" target="_blank">https://github.com/Whonix/whonix-ws-firewall/commit/3e3a5047d4e5d6d18d78f62686f8c60da7abf55f</a></p>
<p>I consider this fixed.</p>
<p>You can make it work in Whonix 9 as well if you get the updated script. Compare with your existing one. Git commit is singed. No security risk if you check the signature or the diff. Please test (press raw button for copy and paste friendly version):<br>
<a href="https://github.com/Whonix/whonix-ws-firewall/blob/3e3a5047d4e5d6d18d78f62686f8c60da7abf55f/usr/bin/whonix_firewall" class="onebox" target="_blank">https://github.com/Whonix/whonix-ws-firewall/blob/3e3a5047d4e5d6d18d78f62686f8c60da7abf55f/usr/bin/whonix_firewall</a></p>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/8</link>
        <pubDate>Mon, 26 Jan 2015 19:13:02 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-8</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Got an answer.</p>
<blockquote>I'd certainly expect so. Here's the bit where Stem creates the socket...
<p><a href="https://gitweb.torproject.org/stem.git/tree/stem/socket.py#n391">https://gitweb.torproject.org/stem.git/tree/stem/socket.py#n391</a></p>
</blockquote>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/7</link>
        <pubDate>Mon, 26 Jan 2015 19:04:08 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-7</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Wiki:<br>
</p><aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Whonix-Workstation_Firewall" target="_blank" title="09:24PM - 28 October 2019">Whonix – 28 Oct 19</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:466/500;"><img src="https://www.whonix.org/w/images/9/9e/Firewall-34227640.png" class="thumbnail" width="466" height="500"></div>

<h3><a href="https://www.whonix.org/wiki/Whonix-Workstation_Firewall" target="_blank">Whonix-Workstation Firewall - Whonix</a></h3>

<p>How to open a Port in Whonix-Workstation ™ Firewall</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<p></p>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/6</link>
        <pubDate>Mon, 26 Jan 2015 19:03:12 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-6</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Ticket:<br>
<a href="https://phabricator.whonix.org/T112" class="onebox" target="_blank">https://phabricator.whonix.org/T112</a></p>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/5</link>
        <pubDate>Mon, 26 Jan 2015 18:51:01 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-5</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="3" data-topic="761">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Will contact Damain Johnson (author of python-stem, that tor_bootstrap_check.py is using if it’s using any non-TCP connections).</p>
</blockquote>
</aside>
<p>Done.</p>
<blockquote>stem TCP vs other protocols</blockquote>
<blockquote>Hi Damian,
<p>I am currently wondering about some issue. [1]</p>
<p>Does stem use pure TCP or also something else?</p>
<p>The following firewall rule is creating issues.</p>
<p>iptables -A OUTPUT ! -p tcp -j REJECT --reject-with icmp-port-unreachable</p>
<p>(While Tor is running on a different machine.)</p>
<p>Any idea about this?</p>
<p>Cheers,<br>
Patrick</p>
<p>[1] <a href="https://www.whonix.org/forum/index.php/topic,834.0.html">https://www.whonix.org/forum/index.php/topic,834.0.html</a></p>
</blockquote>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/4</link>
        <pubDate>Mon, 26 Jan 2015 18:26:18 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-4</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Figured out the iptables rule, that is causing this issue.</p>
<pre><code class="lang-auto"></code></pre>
<p>Feel free to comment it out.</p>
<pre><code class="lang-auto"></code></pre>
<p>What difference does it make? See the comments above that rules.</p>
<p>Will contact Damain Johnson (author of python-stem, that tor_bootstrap_check.py is using if it’s using any non-TCP connections).</p>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/3</link>
        <pubDate>Mon, 26 Jan 2015 18:24:02 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-3</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>There is currently an issue.</p>
<p>Without firewall.</p>
<pre><code class="lang-auto">~ $ time /usr/lib/anon-shared-helper-scripts/tor_bootstrap_check.py 127.0.0.1 9151 0
NOTICE BOOTSTRAP PROGRESS=100 TAG=done SUMMARY="Done"

real    0m0.104s
user    0m0.064s
sys     0m0.000s</code></pre>
<p>With firewall.</p>
<p>[code]~ $ time /usr/lib/anon-shared-helper-scripts/tor_bootstrap_check.py 127.0.0.1 9151 0<br>
NOTICE BOOTSTRAP PROGRESS=100 TAG=done SUMMARY=“Done”</p>
<p>real    0m26.151s<br>
user    0m0.044s<br>
sys     0m0.024s<br>
[/code]</p>
<p>That will cause the issue you are describing.</p>
<p><span class="bbcode-b">Maybe someone can help finding the bug that causes this in the iptables rules?</span></p>
<p><a href="https://github.com/Whonix/whonix-ws-firewall/blob/master/usr/bin/whonix_firewall" class="onebox" target="_blank">https://github.com/Whonix/whonix-ws-firewall/blob/master/usr/bin/whonix_firewall</a></p>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/2</link>
        <pubDate>Mon, 26 Jan 2015 17:51:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-2</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
      <item>
        <title>Workstation Firewall issue</title>
        <dc:creator><![CDATA[z11]]></dc:creator>
        <description><![CDATA[
            <p>On Whonix Workstation 9.4, if you enable the firewall, the internet does not work. Timesync does not progress, whonixcheck reports control port not reachable and Tor Browser does not launch.</p>
          <p><a href="http://forums.whonix.org/t/workstation-firewall-issue/761/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/workstation-firewall-issue/761/1</link>
        <pubDate>Mon, 22 Dec 2014 00:06:40 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-761-1</guid>
        <source url="http://forums.whonix.org/t/workstation-firewall-issue/761.rss">Workstation Firewall issue</source>
      </item>
  </channel>
</rss>

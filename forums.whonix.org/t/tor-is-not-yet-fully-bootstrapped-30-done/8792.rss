<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Tor is not yet fully bootstrapped. 30 % done</title>
    <link>http://forums.whonix.org/t/tor-is-not-yet-fully-bootstrapped-30-done/8792</link>
    <description>Hi All,

I&#39;m trying to set up whonix gateway in my KVM environment. The VM boots fine but I can&#39;t get it to establish a tor connection. Instead it gets &quot;stuck&quot; at 30%.

More detail:

KVM is working for multiple other windows/linux VMs and is stable.

Whonix image imported per instructions.

All services started
    user@host:~$ sudo systemctl list-units --failed
    0 loaded units listed. Pass --all to see loaded but inactive units, too.
    To show all installed unit files use &#39;systemctl list-unit-files&#39;.

Time sync has been checked and is more or less correct (up to 2 minutes out).

Clearnet test works from gateway - I can curl the tor check page as per the troubleshooting instructions

sdwlog gets spammed with the following:
    2020-01-19 04:27:32 - sdwdate - INFO - The clock is sane.
    Within build timestamp Fri 22 Nov 2019 04:16:03 PM UTC and expiration timestamp Tue 17 May 2033 10:00:00 AM UTC.
    2020-01-19 04:27:32 - sdwdate - WARNING - Tor is not yet fully bootstrapped. 30 % done.   
    Tor reports: NOTICE BOOTSTRAP PROGRESS=30 TAG=loading_status SUMMARY=&quot;Loading networkstatus consensus&quot;

Eventually the daemon times out with this message:
`Tor reports: WARN BOOTSTRAP PROGRESS=30 TAG=loading_status SUMMARY=&quot;Loading networkstatus consensus&quot; WARNING=&quot;Connection timed out&quot; REASON=TIMEOUT COUNT=1`

But it appears to keep trying anyway.

syslog/daemon/journald logs are spammed with this:
`New control connection opened.`

I&#39;ve found that if I drop the firewall (iptables -F) and adjust the default policy for the chain to ACCEPT I get a connection.

Tor itself is not blocked in my country. I can use the tor-browser without problems.</description>
    <language>en</language>
    <lastBuildDate>Sun, 19 Jan 2020 13:35:00 +0000</lastBuildDate>
    <category>KVM</category>
    <atom:link href="http://forums.whonix.org/t/tor-is-not-yet-fully-bootstrapped-30-done/8792.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Tor is not yet fully bootstrapped. 30 % done</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="1" data-topic="8792">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/t/7c8e57/40.png" class="avatar"> tiredlexor:</div>
<blockquote>
<p>syslog/daemon/journald logs are spammed with this:<br>
<code>New control connection opened.</code></p>
</blockquote>
</aside>
<p><a href="https://www.whonix.org/wiki/Tor#Non-Issues">https://www.whonix.org/wiki/Tor#Non-Issues</a></p>
<aside class="quote no-group" data-post="1" data-topic="8792">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/t/7c8e57/40.png" class="avatar"> tiredlexor:</div>
<blockquote>
<p>I’ve found that if I drop the firewall (iptables -F) and adjust the default policy for the chain to ACCEPT I get a connection.</p>
</blockquote>
</aside>
<p>This is the only weird thing. Everything else is expected. The first such report in 7 years. To debug enable logging in Whonix firewall:</p>
<p>sudoedit <a href="https://github.com/Whonix/whonix-firewall/blob/master/usr/bin/whonix-gateway-firewall">/usr/bin/whonix-gateway-firewall</a></p>
<p>Search for<br>
<code>## Log</code></p>
<p>You’ll find:</p>
<pre><code>#$iptables_cmd -A FORWARD -j LOG --log-prefix "Whonix blocked forward4: "
#$iptables_cmd -A OUTPUT -j LOG --log-prefix "Whonix blocked output4: "
#$iptables_cmd -A INPUT -j LOG --log-prefix "Whonix blocked input4: "
</code></pre>
<p>Comment these in by removing the <code>#</code> in front of it.</p>
<pre><code>$iptables_cmd -A FORWARD -j LOG --log-prefix "Whonix blocked forward4: "
$iptables_cmd -A OUTPUT -j LOG --log-prefix "Whonix blocked output4: "
$iptables_cmd -A INPUT -j LOG --log-prefix "Whonix blocked input4: "
</code></pre>
<p>Then journal should show what’s blocked.</p>
          <p><a href="http://forums.whonix.org/t/tor-is-not-yet-fully-bootstrapped-30-done/8792/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/tor-is-not-yet-fully-bootstrapped-30-done/8792/2</link>
        <pubDate>Sun, 19 Jan 2020 13:35:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8792-2</guid>
        <source url="http://forums.whonix.org/t/tor-is-not-yet-fully-bootstrapped-30-done/8792.rss">Tor is not yet fully bootstrapped. 30 % done</source>
      </item>
      <item>
        <title>Tor is not yet fully bootstrapped. 30 % done</title>
        <dc:creator><![CDATA[tiredlexor]]></dc:creator>
        <description><![CDATA[
            <p>Hi All,</p>
<p>I’m trying to set up whonix gateway in my KVM environment. The VM boots fine but I can’t get it to establish a tor connection. Instead it gets “stuck” at 30%.</p>
<p>More detail:</p>
<p>KVM is working for multiple other windows/linux VMs and is stable.</p>
<p>Whonix image imported per instructions.</p>
<p>All services started<br>
user@host:~$ sudo systemctl list-units --failed<br>
0 loaded units listed. Pass --all to see loaded but inactive units, too.<br>
To show all installed unit files use ‘systemctl list-unit-files’.</p>
<p>Time sync has been checked and is more or less correct (up to 2 minutes out).</p>
<p>Clearnet test works from gateway - I can curl the tor check page as per the troubleshooting instructions</p>
<p>sdwlog gets spammed with the following:<br>
2020-01-19 04:27:32 - sdwdate - INFO - The clock is sane.<br>
Within build timestamp Fri 22 Nov 2019 04:16:03 PM UTC and expiration timestamp Tue 17 May 2033 10:00:00 AM UTC.<br>
2020-01-19 04:27:32 - sdwdate - WARNING - Tor is not yet fully bootstrapped. 30 % done.<br>
Tor reports: NOTICE BOOTSTRAP PROGRESS=30 TAG=loading_status SUMMARY=“Loading networkstatus consensus”</p>
<p>Eventually the daemon times out with this message:<br>
<code>Tor reports: WARN BOOTSTRAP PROGRESS=30 TAG=loading_status SUMMARY="Loading networkstatus consensus" WARNING="Connection timed out" REASON=TIMEOUT COUNT=1</code></p>
<p>But it appears to keep trying anyway.</p>
<p>syslog/daemon/journald logs are spammed with this:<br>
<code>New control connection opened.</code></p>
<p>I’ve found that if I drop the firewall (iptables -F) and adjust the default policy for the chain to ACCEPT I get a connection.</p>
<p>Tor itself is not blocked in my country. I can use the tor-browser without problems.</p>
          <p><a href="http://forums.whonix.org/t/tor-is-not-yet-fully-bootstrapped-30-done/8792/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/tor-is-not-yet-fully-bootstrapped-30-done/8792/1</link>
        <pubDate>Sun, 19 Jan 2020 05:25:56 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8792-1</guid>
        <source url="http://forums.whonix.org/t/tor-is-not-yet-fully-bootstrapped-30-done/8792.rss">Tor is not yet fully bootstrapped. 30 % done</source>
      </item>
  </channel>
</rss>

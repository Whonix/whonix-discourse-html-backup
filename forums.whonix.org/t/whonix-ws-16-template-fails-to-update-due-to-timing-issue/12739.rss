<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>whonix-ws-16 Template fails to update due to timing issue</title>
    <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739</link>
    <description>Whonix-ws-16 failed to update using the &quot;Qubes update&quot; utility with the following error:

```
Updating whonix-ws-16

Error on updating whonix-ws-16: Command &#39;[&#39;sudo&#39;, &#39;qubesctl&#39;, &#39;--skip-dom0&#39;, &#39;--targets=whonix-ws-16&#39;, &#39;--show-output&#39;, &#39;state.sls&#39;, &#39;update.qubes-vm&#39;]&#39; returned non-zero exit status 20
whonix-ws-16:
  ----------
            ID: update
      Function: pkg.uptodate
        Result: False
       Comment: E: Release file for tor+https://fasttrack.debian.net/debian/dists/bullseye-fasttrack/InRelease is not valid yet (invalid for another 49s). Updates for this repository will not be applied.
       Started: 08:29:10.411910
      Duration: 5375.832 ms
       Changes:   
  ----------
            ID: notify-updates
      Function: cmd.run
          Name: /usr/lib/qubes/upgrades-status-notify
        Result: False
       Comment: Command &quot;/usr/lib/qubes/upgrades-status-notify&quot; run
       Started: 08:29:15.795184
      Duration: 4028.142 ms
       Changes:   
                ----------
                pid:
                    1806
                retcode:
                    100
                stderr:
                stdout:
  
  Summary for whonix-ws-16
  ------------
  Succeeded: 0 (changed=1)
  Failed:    2
  ------------
  Total states run:     2
  Total run time:   9.404 s
```


[details=&quot;It then updated just fine when done via the terminal (whonix-ws-16 terminal)&quot;]
```shell_session
user@host:~$ sudo apt update &amp;&amp; sudo apt upgrade
Hit:1 tor+https://deb.debian.org/debian bullseye InRelease                     
Hit:2 https://deb.qubes-os.org/r4.0/vm bullseye InRelease                      
Hit:3 tor+https://deb.whonix.org bullseye InRelease                 
Get:4 tor+https://fasttrack.debian.net/debian bullseye-fasttrack InRelease [12.9 kB]
Hit:5 tor+https://deb.debian.org/debian bullseye-updates InRelease
Hit:6 tor+https://deb.debian.org/debian-security bullseye-security InRelease
Hit:7 tor+https://deb.debian.org/debian bullseye-backports InRelease
Fetched 12.9 kB in 2s (6,506 B/s)
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
6 packages can be upgraded. Run &#39;apt list --upgradable&#39; to see them.
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
Calculating upgrade... Done
The following packages will be upgraded:
  qubes-core-agent qubes-core-agent-nautilus qubes-core-agent-networking
  qubes-core-agent-passwordless-root qubes-core-agent-qrexec
  qubes-core-agent-thunar
6 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Need to get 269 kB of archives.
After this operation, 0 B of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 https://deb.qubes-os.org/r4.0/vm bullseye/main amd64 qubes-core-agent-networking amd64 4.0.63-1+deb11u1 [37.0 kB]
Get:2 https://deb.qubes-os.org/r4.0/vm bullseye/main amd64 qubes-core-agent-qrexec amd64 4.0.63-1+deb11u1 [48.3 kB]
Get:3 https://deb.qubes-os.org/r4.0/vm bullseye/main amd64 qubes-core-agent-thunar amd64 4.0.63-1+deb11u1 [30.0 kB]
Get:4 https://deb.qubes-os.org/r4.0/vm bullseye/main amd64 qubes-core-agent-passwordless-root amd64 4.0.63-1+deb11u1 [33.0 kB]
Get:5 https://deb.qubes-os.org/r4.0/vm bullseye/main amd64 qubes-core-agent-nautilus amd64 4.0.63-1+deb11u1 [28.6 kB]
Get:6 https://deb.qubes-os.org/r4.0/vm bullseye/main amd64 qubes-core-agent amd64 4.0.63-1+deb11u1 [91.7 kB]
Fetched 269 kB in 2s (144 kB/s)        
(Reading database ... 95353 files and directories currently installed.)
Preparing to unpack .../0-qubes-core-agent-networking_4.0.63-1+deb11u1_amd64.deb
 ...
Unpacking qubes-core-agent-networking (4.0.63-1+deb11u1) over (4.0.62-1+deb11u1)
 ...
Preparing to unpack .../1-qubes-core-agent-qrexec_4.0.63-1+deb11u1_amd64.deb ...
Unpacking qubes-core-agent-qrexec (4.0.63-1+deb11u1) over (4.0.62-1+deb11u1) ...
Preparing to unpack .../2-qubes-core-agent-thunar_4.0.63-1+deb11u1_amd64.deb ...
Unpacking qubes-core-agent-thunar (4.0.63-1+deb11u1) over (4.0.62-1+deb11u1) ...
Preparing to unpack .../3-qubes-core-agent-passwordless-root_4.0.63-1+deb11u1_am
d64.deb ...
Unpacking qubes-core-agent-passwordless-root (4.0.63-1+deb11u1) over (4.0.62-1+d
eb11u1) ...
Preparing to unpack .../4-qubes-core-agent-nautilus_4.0.63-1+deb11u1_amd64.deb .
..
Unpacking qubes-core-agent-nautilus (4.0.63-1+deb11u1) over (4.0.62-1+deb11u1) .
..
Preparing to unpack .../5-qubes-core-agent_4.0.63-1+deb11u1_amd64.deb ...
Unpacking qubes-core-agent (4.0.63-1+deb11u1) over (4.0.62-1+deb11u1) ...
Setting up qubes-core-agent-qrexec (4.0.63-1+deb11u1) ...
Setting up qubes-core-agent-passwordless-root (4.0.63-1+deb11u1) ...
Setting up qubes-core-agent (4.0.63-1+deb11u1) ...
Installing new version of config file /etc/qubes-rpc/qubes.Restore ...
Removed /etc/systemd/system/sysinit.target.wants/haveged.service.
Removed /etc/systemd/system/multi-user.target.wants/haveged.service.
Created symlink /etc/systemd/system/sysinit.target.wants/haveged.service → /lib/
systemd/system/haveged.service.
Leaving &#39;diversion of /etc/init/plymouth-shutdown.conf to /etc/init/plymouth-shu
tdown.conf.qubes-disabled by qubes-core-agent&#39;
Leaving &#39;diversion of /etc/init/prefdm.conf to /etc/init/prefdm.conf.qubes-disab
led by qubes-core-agent&#39;
Leaving &#39;diversion of /etc/init/splash-manager.conf to /etc/init/splash-manager.
conf.qubes-disabled by qubes-core-agent&#39;
Leaving &#39;diversion of /etc/init/start-ttys.conf to /etc/init/start-ttys.conf.qub
es-disabled by qubes-core-agent&#39;
Leaving &#39;diversion of /etc/init/tty.conf to /etc/init/tty.conf.qubes-disabled by
 qubes-core-agent&#39;
Leaving &#39;diversion of /etc/init/serial.conf to /etc/init/serial.conf.qubes-orig 
by qubes-core-agent&#39;
qubes-sync-time.service is a disabled or a static unit, not starting it.
qubes-update-check.service is a disabled or a static unit, not starting it.
Removing obsolete conffile /etc/systemd/system/haveged.service ...
Setting up qubes-core-agent-nautilus (4.0.63-1+deb11u1) ...
Setting up qubes-core-agent-thunar (4.0.63-1+deb11u1) ...
Processing triggers for mailcap (3.69) ...
Processing triggers for desktop-file-utils (0.26-1) ...
Processing triggers for libglib2.0-0:amd64 (2.66.8-1) ...
Processing triggers for man-db (2.9.4-2) ...
Setting up qubes-core-agent-networking (4.0.63-1+deb11u1) ...
qubes-network.service is a disabled or a static unit, not starting it.
user@host:~$ 
```
[/details]</description>
    <language>en</language>
    <lastBuildDate>Tue, 26 Jul 2022 13:37:03 +0000</lastBuildDate>
    <category>Qubes-Whonix</category>
    <atom:link href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Documentation written just now:</p>
<p><a href="https://www.kicksecure.com/wiki/Operating_System_Software_and_Updates#InRelease_is_not_valid_yet_error">InRelease is not valid yet error</a></p>
<p>(Whonix is based on Kicksecure.)</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/30">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/30</link>
        <pubDate>Tue, 26 Jul 2022 13:37:03 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-30</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[VR2021]]></dc:creator>
        <description><![CDATA[
            <p>Hello jrnn,</p>
<blockquote>
<p>jnrn <a href="//forums.whonix.org/u/jnrn">http://forums.whonix.org/u/jnrn</a><br>
July 25</p>
<p>Hi, it just happened to me. Is there a fix for this issue, please? Thank<br>
you.</p>
</blockquote>
<p>Not that I’m aware of. - In the meantime I’ve upgraded my system to Qubes<br>
OS 4.1, but the problem still persists <img src="//forums.whonix.org/images/emoji/twitter/frowning.png?v=12" title=":frowning:" class="emoji" alt=":frowning:"></p>
<p>With kind regards,</p>
<p>Viktor</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/29">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/29</link>
        <pubDate>Tue, 26 Jul 2022 04:19:33 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-29</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[jnrn]]></dc:creator>
        <description><![CDATA[
            <p>Hi, it just happened to me. Is there a fix for this issue, please? Thank you.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/28">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/28</link>
        <pubDate>Mon, 25 Jul 2022 21:57:19 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-28</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[VR2021]]></dc:creator>
        <description><![CDATA[
            <p>Hello Patrick,</p>
<blockquote>
<aside class="quote no-group" data-username="VR2021" data-post="25" data-topic="12739">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/v/dec6dc/40.png" class="avatar"> VR2021:</div>
<blockquote>
<p>On Qubes R4.0 I’m still experiencing it with every update of a ‘whonix-*-16’ template.</p>
</blockquote>
</aside>
<p>That’s surprising because it never happens to me.</p>
</blockquote>
<p>It just occurred again w/ “whonix-gw-16” template. - Let me know, if any of my own system setup details are important for you …</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/27">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/27</link>
        <pubDate>Sun, 13 Feb 2022 20:53:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-27</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="VR2021" data-post="25" data-topic="12739">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/v/dec6dc/40.png" class="avatar"> VR2021:</div>
<blockquote>
<p>Is there an update available</p>
</blockquote>
</aside>
<p>No, if there is, this forum thread will be updated.</p>
<aside class="quote no-group" data-username="VR2021" data-post="25" data-topic="12739">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/v/dec6dc/40.png" class="avatar"> VR2021:</div>
<blockquote>
<p>how this issue might be fixed?</p>
</blockquote>
</aside>
<p>See my previous post.</p>
<aside class="quote no-group" data-username="VR2021" data-post="25" data-topic="12739">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/v/dec6dc/40.png" class="avatar"> VR2021:</div>
<blockquote>
<p>On Qubes R4.0 I’m still experiencing it with every update of a ‘whonix-*-16’ template.</p>
</blockquote>
</aside>
<p>That’s surprising because it never happens to me.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/26">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/26</link>
        <pubDate>Sat, 12 Feb 2022 09:59:59 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-26</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[VR2021]]></dc:creator>
        <description><![CDATA[
            <p><a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a> : Is there an update available on when &amp; how this issue might be fixed?</p>
<p>On Qubes R4.0 I’m still experiencing it with every update of a ‘whonix-*-16’ template.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/25">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/25</link>
        <pubDate>Sat, 12 Feb 2022 08:30:55 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-25</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[VR2021]]></dc:creator>
        <description><![CDATA[
            <p><a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a> &amp; <a class="mention" href="http://forums.whonix.org/u/marmarek">@marmarek</a> : Thanks a lot for all your work on tracking down the root cause of the reported issue.</p>
<p>It is not clear to me, if at the moment you need additional information from my system.</p>
<p>FYI: Qubes Updater has (again) successfully updated several fedora templates - but - failed to update ‘whonix-ws-16’.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/24">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/24</link>
        <pubDate>Sun, 21 Nov 2021 18:04:43 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-24</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Now I am a bit more sure this is caused by Boot Clock Randomization. It’s not happening in Non-Qubes-Whonix since that is using sdwdate which has much higher accuracy than Boot Clock Randomization. Qubes-Whonix Templates however use only Boot Clock Randomization and do not use sdwdate at time of writing.</p>
<p>Still not sure why this isn’t happening more often to more users and wasn’t reported earlier.</p>
<p>In summary:</p>
<ul>
<li>Non-Qubes-Whonix: Boot Clock Randomization + sdwdate</li>
<li>Qubes App Qubes: Boot Clock Randomization + sdwdate</li>
<li>Qubes Templates: Boot Clock Randomization only</li>
</ul>
<p>Accuracy:</p>
<ul>
<li>Boot Clock Randomization: +/ 180 seconds</li>
<li>sdwdate: quite good, often +/- 1 second</li>
</ul>
<p>Should sdwdate be run inside Qubes Templates?</p>
<p>It would probably be easy to make sdwdate connect through Qubes UpdatesProxy - similar to how already APT and <a href="https://www.whonix.org/wiki/Tor_Browser#Tor_Browser_Downloader_by_Whonix_.E2.84.A2">Tor Browser Downloader by Whonix ™</a> are using networking in Qubes-Whonix Templates.</p>
<p>A more secure solution might be something like <a href="https://phabricator.whonix.org/T387" class="inline-onebox">⚓ T387 Qubes-Whonix-Gateway as ClockVM</a>, i.e. Qubes-Whonix Templates receiving a timestamp with sdwdate accuracy from an App Qube, but also quite harder to implement.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/23">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/23</link>
        <pubDate>Sat, 20 Nov 2021 19:02:29 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-23</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>As for usefulness of Boot Clock Randomization in Qubes-Whonix Template, see:</p>
<aside class="quote quote-modified" data-post="13" data-topic="2200">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="https://forums.whonix.org/t/boot-clock-randomization-bootclockrandomization/2200/13">Boot Clock Randomization - bootclockrandomization</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/development/8"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of components looking for maintainer)">Development</span></a>
  </div>
  <blockquote>
    Due to issues reported in <a href="https://forums.whonix.org/t/whonix-ws-16-fails-to-update-due-to-timing-issue/12739" class="inline-onebox">Whonix-ws-16 fails to update due to timing issue</a>… 
How useful is Boot Clock Randomization in Qubes-Whonix Templates? 
In other words, what is the chance of the VM time from inside a Qubes-Whonix Template being leaked to a Tor exit relay? (<a href="https://www.whonix.org/wiki/Dev/TimeSync#Local_Clock_Leaks">Local Clock Leaks</a>) 
Qubes Templates do not have “full” networking. APT is running through Qubes UpdatesProxy. 
Some users might be running other networked applications from Qubes Templates. For example <a href="https://www.whonix.org/wiki/Operating_System_Software_and_Updates" class="inline-onebox">Operating System Software and Upd…</a>
  </blockquote>
</aside>

<p>I am still not sure <a href="https://www.whonix.org/wiki/Boot_Clock_Randomization">Boot Clock Randomization</a> is the cause since then this issue should be equally happening to Non-Qubes-Whonix users and a lot more users. But to find out…</p>
<aside class="quote no-group" data-username="Patrick" data-post="21" data-topic="12739">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>If someone would like to try if that is the case, try the workaround of <a href="https://www.whonix.org/wiki/Boot_Clock_Randomization#Disable">disabling boot clock randomization</a>.</p>
</blockquote>
</aside>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/22">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/22</link>
        <pubDate>Sat, 20 Nov 2021 18:48:28 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-22</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>I thought suspend/resume as well as long running Templates should be improved by modifying qvm-sync-clock for Qubes-Whonix. Started working on it:</p>
<aside class="onebox githubcommit">
  <header class="source">

      <a href="https://github.com/Whonix/qubes-whonix/commit/f2190c69cb5859b0f0b6242fc20a84811ef83fb3" target="_blank" rel="noopener">github.com/Whonix/qubes-whonix</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/qubes-whonix/commit/f2190c69cb5859b0f0b6242fc20a84811ef83fb3" target="_blank" rel="noopener">initial version of qvm-sync-clock.anondist</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2021-11-20" data-time="18:21:11" data-timezone="UTC">06:21PM - 20 Nov 21 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 1 files with 63 additions and 0 deletions">
        <a href="https://github.com/Whonix/qubes-whonix/commit/f2190c69cb5859b0f0b6242fc20a84811ef83fb3" target="_blank" rel="noopener">
          <span class="added">+63</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>
  </div>
</div>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">

      <a href="https://github.com/Whonix/qubes-whonix/commit/1359ef3e47715c04d4a4d071b3ca0679a4020b01" target="_blank" rel="noopener">github.com/Whonix/qubes-whonix</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/qubes-whonix/commit/1359ef3e47715c04d4a4d071b3ca0679a4020b01" target="_blank" rel="noopener">qvm-sync-clock.anondist code simplification</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2021-11-20" data-time="18:23:35" data-timezone="UTC">06:23PM - 20 Nov 21 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 1 files with 12 additions and 33 deletions">
        <a href="https://github.com/Whonix/qubes-whonix/commit/1359ef3e47715c04d4a4d071b3ca0679a4020b01" target="_blank" rel="noopener">
          <span class="added">+12</span>
          <span class="removed">-33</span>
        </a>
      </div>
    </div>
  </div>
</div>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Not in use yet. And was probably in vain. And probably low priority.</p>
<p>Because…</p>
<hr>
<aside class="quote no-group" data-username="marmarek" data-post="18" data-topic="12739">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/df705f/40.png" class="avatar"> marmarek:</div>
<blockquote>
<p>The Whonix template is ~half a minute in the past. If it’s close enough that the 5 minutes makes a difference (<code>date -s +5min</code> is enough to fix), then I can very well believe that 30s in the past may be problematic at times too. Something clearly is making Whonix’s clock be in the past, and I’d say we should avoid it at all regardless if that’s 30s or 5min.</p>
</blockquote>
</aside>
<p>Then if this “small” difference is causing some much issues… The reason for that is probably:</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">

      <a href="https://www.whonix.org/wiki/Boot_Clock_Randomization" target="_blank" rel="noopener" title="11:25PM - 29 September 2021">Whonix – 29 Sep 21</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:131/44;"><img src="https://www.whonix.org/w/images/a/ab/Randomizationclock321423.jpg" class="thumbnail" width="131" height="44"></div>

<h3><a href="https://www.whonix.org/wiki/Boot_Clock_Randomization" target="_blank" rel="noopener">Boot Clock Randomization</a></h3>

  <p>Boot Clock Randomization</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>If someone would like to try if that is the case, try the workaround of <a href="https://www.whonix.org/wiki/Boot_Clock_Randomization#Disable">disabling boot clock randomization</a>.</p>
<p>Related boot clock randomization development discussion:<br>
<a href="https://forums.whonix.org/t/boot-clock-randomization-bootclockrandomization/2200" class="inline-onebox">Boot Clock Randomization - bootclockrandomization</a></p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/21">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/21</link>
        <pubDate>Sat, 20 Nov 2021 18:38:05 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-21</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Time to revise:</p>
<aside class="onebox githubblob">
  <header class="source">

      <a href="https://github.com/Whonix/qubes-whonix/blob/master/etc/qubes-rpc/qubes.SetDateTime.anondist" target="_blank" rel="noopener">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/Whonix/qubes-whonix/blob/master/etc/qubes-rpc/qubes.SetDateTime.anondist" target="_blank" rel="noopener">Whonix/qubes-whonix/blob/master/etc/qubes-rpc/qubes.SetDateTime.anondist</a></h4>


    <pre><code class="lang-anondist">#!/bin/bash -e

## Copyright (C) 2012 - 2021 ENCRYPTED SUPPORT LP &lt;adrelanos@whonix.org&gt;
## See the file COPYING for copying conditions.

## dom0 should not tell us its time.
## But if it does, create a file, so systemcheck could warn in case this
## file exists.
read timestamp
mkdir -p "/run/qubes-whonix"
echo "$timestamp" &gt; "/run/qubes-whonix/qubes.SetDateTime"
</code></pre>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>New plan:<br>
As for Qubes-Whonix Templates, make it similar to <code>/etc/qubes-rpc/qubes.SetDateTime</code>.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/20">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/20</link>
        <pubDate>Sat, 20 Nov 2021 17:22:36 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-20</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>added to wiki just now…</p>
<p><a href="https://www.whonix.org/wiki/Dev/TimeSync#Qubes_Time_Synchronization_Features">Qubes Time Synchronization Features</a>:</p>
<blockquote>
<p>Xen DomU’s get their initial time from Xen (Qubes dom0) at VM start.</p>
<ul>
<li>qvm-sync-clock.service</li>
<li>qvm-sync-clock.timer</li>
</ul>
<p>qvm-sync-clock gets time from Qubes ClockVM.</p>
<p>It is used because otherwise Xen DomU’s would start to clock drift more and more. This <a href="https://forums.whonix.org/t/whonix-ws-16-fails-to-update-due-to-timing-issue/12739/10">this answer by marmarek</a> <a href="https://web.archive.org/web/https://forums.whonix.org/t/whonix-ws-16-fails-to-update-due-to-timing-issue/12739/10">[archive]</a>.</p>
<p>qvm-sync-clock is unwanted in sys-whonix and anon-whonix because sdwdate runs there.</p>
<p>qvm-sync-clock is disabled in Qubes-Whonix ™ Templates until version Qubes-Whonix ™ <code>16.0.3.7</code>. To be re-considered for later versions. Qubes-Whonix ™ get their time from dom0 at VM startup, which is then randomized using <a href="https://www.whonix.org/wiki/Boot_Clock_Randomization">Boot Clock Randomization</a>.</p>
<p>Future: qvm-sync-clock should be equally safe to run inside Qubes-Whonix ™ Templates, if passed though <code>clock-random-manual-cli</code>.</p>
</blockquote>
<hr>
<p>Now working on making timesync in Qubes-Whonix Template similar to Non-Qubes Templates.</p>
<hr>
<aside class="onebox githubpullrequest">
  <header class="source">

      <a href="https://github.com/QubesOS/qubes-core-admin/pull/437" target="_blank" rel="noopener">github.com/QubesOS/qubes-core-admin</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/QubesOS/qubes-core-admin/pull/437" target="_blank" rel="noopener">--utc</a>
    </h4>

    <div class="branches">
      <code>QubesOS:master</code> ← <code>adrelanos:patch-11</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2021-11-20" data-time="16:33:59" data-timezone="UTC">04:33PM - 20 Nov 21 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="1 commits changed 1 files with 5 additions and 5 deletions">
        <a href="https://github.com/QubesOS/qubes-core-admin/pull/437/files" target="_blank" rel="noopener">
          <span class="added">+5</span>
          <span class="removed">-5</span>
        </a>
      </div>
    </div>
  </div>
</div>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">

      <a href="https://github.com/Whonix/sdwdate/commit/0d43f1a2a6f8796d6d46e34a81788a0a7293f089" target="_blank" rel="noopener">github.com/Whonix/sdwdate</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/sdwdate/commit/0d43f1a2a6f8796d6d46e34a81788a0a7293f089" target="_blank" rel="noopener">`date --utc`</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2021-11-20" data-time="16:36:51" data-timezone="UTC">04:36PM - 20 Nov 21 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 2 files with 4 additions and 4 deletions">
        <a href="https://github.com/Whonix/sdwdate/commit/0d43f1a2a6f8796d6d46e34a81788a0a7293f089" target="_blank" rel="noopener">
          <span class="added">+4</span>
          <span class="removed">-4</span>
        </a>
      </div>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">
https://forums.whonix.org/t/whonix-ws-16-fails-to-update-due-to-timing-issue/12<span class="show-more-container"><a href="https://github.com/Whonix/sdwdate/commit/0d43f1a2a6f8796d6d46e34a81788a0a7293f089" target="_blank" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">739/17</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">

      <a href="https://github.com/Whonix/sdwdate/commit/0d43f1a2a6f8796d6d46e34a81788a0a7293f089" target="_blank" rel="noopener">github.com/Whonix/sdwdate</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/sdwdate/commit/0d43f1a2a6f8796d6d46e34a81788a0a7293f089" target="_blank" rel="noopener">`date --utc`</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2021-11-20" data-time="16:36:51" data-timezone="UTC">04:36PM - 20 Nov 21 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 2 files with 4 additions and 4 deletions">
        <a href="https://github.com/Whonix/sdwdate/commit/0d43f1a2a6f8796d6d46e34a81788a0a7293f089" target="_blank" rel="noopener">
          <span class="added">+4</span>
          <span class="removed">-4</span>
        </a>
      </div>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">
https://forums.whonix.org/t/whonix-ws-16-fails-to-update-due-to-timing-issue/12<span class="show-more-container"><a href="https://github.com/Whonix/sdwdate/commit/0d43f1a2a6f8796d6d46e34a81788a0a7293f089" target="_blank" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">739/17</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">

      <a href="https://github.com/Whonix/sdwdate/commit/7a43153a2fe80eb492b1abf14f1f20bb66da02f5" target="_blank" rel="noopener">github.com/Whonix/sdwdate</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/sdwdate/commit/7a43153a2fe80eb492b1abf14f1f20bb66da02f5" target="_blank" rel="noopener">Qubes suspend pre/post: disable restart of Tor</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2021-11-20" data-time="16:45:04" data-timezone="UTC">04:45PM - 20 Nov 21 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 2 files with 2 additions and 35 deletions">
        <a href="https://github.com/Whonix/sdwdate/commit/7a43153a2fe80eb492b1abf14f1f20bb66da02f5" target="_blank" rel="noopener">
          <span class="added">+2</span>
          <span class="removed">-35</span>
        </a>
      </div>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">
since that is no longer required.

And even if it was required, this would be h<span class="show-more-container"><a href="https://github.com/Whonix/sdwdate/commit/7a43153a2fe80eb492b1abf14f1f20bb66da02f5" target="_blank" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">andled by sdwdate / anondate.</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">

      <a href="https://github.com/Whonix/sdwdate/commit/6215a9ea996e9db970059c3b4ad58d17016b7483" target="_blank" rel="noopener">github.com/Whonix/sdwdate</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/sdwdate/commit/6215a9ea996e9db970059c3b4ad58d17016b7483" target="_blank" rel="noopener">Qubes suspend post: disable qubes.GetRandomizedTime</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2021-11-20" data-time="16:47:54" data-timezone="UTC">04:47PM - 20 Nov 21 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 1 files with 2 additions and 16 deletions">
        <a href="https://github.com/Whonix/sdwdate/commit/6215a9ea996e9db970059c3b4ad58d17016b7483" target="_blank" rel="noopener">
          <span class="added">+2</span>
          <span class="removed">-16</span>
        </a>
      </div>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">
since no longer required. sdwdate / anondate can nowadays fix the time without <span class="show-more-container"><a href="https://github.com/Whonix/sdwdate/commit/6215a9ea996e9db970059c3b4ad58d17016b7483" target="_blank" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">it.</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">

      <a href="https://github.com/Whonix/sdwdate/commit/668417e4032a95415b5647bc331abce20970e868" target="_blank" rel="noopener">github.com/Whonix/sdwdate</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/sdwdate/commit/668417e4032a95415b5647bc331abce20970e868" target="_blank" rel="noopener">comment</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2021-11-20" data-time="16:50:24" data-timezone="UTC">04:50PM - 20 Nov 21 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 1 files with 2 additions and 0 deletions">
        <a href="https://github.com/Whonix/sdwdate/commit/668417e4032a95415b5647bc331abce20970e868" target="_blank" rel="noopener">
          <span class="added">+2</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>
  </div>
</div>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">

      <a href="https://github.com/Whonix/sdwdate/commit/39062a237df8fa3b9007a4b808aa7a51d287a22f" target="_blank" rel="noopener">github.com/Whonix/sdwdate</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/sdwdate/commit/39062a237df8fa3b9007a4b808aa7a51d287a22f" target="_blank" rel="noopener">fix</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2021-11-20" data-time="16:51:27" data-timezone="UTC">04:51PM - 20 Nov 21 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 1 files with 1 additions and 1 deletions">
        <a href="https://github.com/Whonix/sdwdate/commit/39062a237df8fa3b9007a4b808aa7a51d287a22f" target="_blank" rel="noopener">
          <span class="added">+1</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>
  </div>
</div>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">

      <a href="https://github.com/Whonix/sdwdate/commit/caca7f412c4b19b5c7db2e3394a870e4d5124fa7" target="_blank" rel="noopener">github.com/Whonix/sdwdate</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/sdwdate/commit/caca7f412c4b19b5c7db2e3394a870e4d5124fa7" target="_blank" rel="noopener">add `bootclockrandomization.service` to sdwdate-log-viewer</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2021-11-20" data-time="16:53:01" data-timezone="UTC">04:53PM - 20 Nov 21 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 1 files with 1 additions and 0 deletions">
        <a href="https://github.com/Whonix/sdwdate/commit/caca7f412c4b19b5c7db2e3394a870e4d5124fa7" target="_blank" rel="noopener">
          <span class="added">+1</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>
  </div>
</div>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">

      <a href="https://github.com/Whonix/sdwdate/commit/17f3ca8c2aeed07f49412b25e2a9fb6a6c199d3e" target="_blank" rel="noopener">github.com/Whonix/sdwdate</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/sdwdate/commit/17f3ca8c2aeed07f49412b25e2a9fb6a6c199d3e" target="_blank" rel="noopener">comment</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2021-11-20" data-time="16:54:48" data-timezone="UTC">04:54PM - 20 Nov 21 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 1 files with 2 additions and 1 deletions">
        <a href="https://github.com/Whonix/sdwdate/commit/17f3ca8c2aeed07f49412b25e2a9fb6a6c199d3e" target="_blank" rel="noopener">
          <span class="added">+2</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>
  </div>
</div>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">

      <a href="https://github.com/Whonix/sdwdate/commit/8911f33e4d48877ad415379c7e252318c255a9d9" target="_blank" rel="noopener">github.com/Whonix/sdwdate</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/sdwdate/commit/8911f33e4d48877ad415379c7e252318c255a9d9" target="_blank" rel="noopener">add qubes-sync-time.service and qubes-sync-time.timer to sdwdate-log-viewer</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2021-11-20" data-time="16:57:52" data-timezone="UTC">04:57PM - 20 Nov 21 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 1 files with 2 additions and 0 deletions">
        <a href="https://github.com/Whonix/sdwdate/commit/8911f33e4d48877ad415379c7e252318c255a9d9" target="_blank" rel="noopener">
          <span class="added">+2</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>
  </div>
</div>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/19">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/19</link>
        <pubDate>Sat, 20 Nov 2021 17:13:33 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-19</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[marmarek]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="14" data-topic="12739">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Looks good enough.</p>
</blockquote>
</aside>
<p>The Whonix template is ~half a minute in the past. If it’s close enough that the 5 minutes makes a difference (<code>date -s +5min</code> is enough to fix), then I can very well believe that 30s in the past may be problematic at times too. Something clearly is making Whonix’s clock be in the past, and I’d say we should avoid it at all regardless if that’s 30s or 5min.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/18">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/18</link>
        <pubDate>Sat, 20 Nov 2021 17:12:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-18</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>The different time zones might be an issue. dom0 / Templates are “normal” but Qubes-Whonix templates are in UTC.</p>
<p>For Debian 11 / <code>bullseye</code> in sdwdate a change was required (and introduced since the first Debian 11 based Whonix version 16) to set in python:</p>
<pre><code>os.environ["LC_TIME"] = "C"
os.environ["TZ"] = "UTC"
time.tzset()
</code></pre>
<p>This python change may need to be added to any Qubes source code. For example the python based Qubes dom0 file <code>/etc/qubes-rpc/qubes.GetDate</code> might need it.</p>
<p>Furthermore, to improve the robustness (and perhaps even fix this bug) any invocation of <code>date</code> should be prefixed with <code>--utc</code>, i.e. <code>date --utc</code> for any Qubes shell/bash scripts.</p>
<p>Internally, programmatically Qubes should always handle time in UTC. The time shown to the user when manually running <code>date</code> or looking at the systray can remain as is in user local timezone, no problme.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/17">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/17</link>
        <pubDate>Sat, 20 Nov 2021 16:27:12 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-17</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="15" data-topic="12739" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Yet another cause could be Debian indeed setting a wrong valid-from field.</p>
</blockquote>
</aside>
<p>When this issue is happening, could you please check this link/file?<br>
<a href="https://fasttrack.debian.net/debian/dists/bullseye-fasttrack/Release" class="onebox" target="_blank" rel="noopener">https://fasttrack.debian.net/debian/dists/bullseye-fasttrack/Release</a></p>
<p>At time of writing the interesting fields are:</p>
<blockquote>
<p>Date: Sat, 20 Nov 2021 15:30:10 UTC<br>
Valid-Until: Sat, 27 Nov 2021 15:30:10 UTC</p>
</blockquote>
<p>VM:</p>
<pre><code>date --utc
</code></pre>
<blockquote>
<p>Sat 20 Nov 2021 04:00:03 PM UTC</p>
</blockquote>
<p>dom0:</p>
<pre><code>date --utc
</code></pre>
<blockquote>
<p>Sat Nov 20 16:00:29 UTC 2021</p>
</blockquote>
<p>(Few seconds delay due to thinking, typing.)</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/16">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/16</link>
        <pubDate>Sat, 20 Nov 2021 16:01:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-16</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Yet another cause could be Debian indeed setting a wrong valid-from field.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/15</link>
        <pubDate>Sat, 20 Nov 2021 15:57:41 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-15</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group quote-modified" data-username="marmarek" data-post="10" data-topic="12739">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/df705f/40.png" class="avatar"> marmarek:</div>
<blockquote>
<aside class="quote no-group" data-username="Patrick" data-post="7" data-topic="12739">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p><code>qvm-run --pass-io whonix-gw-16 "date --utc" &amp;&amp; date --utc</code></p>
</blockquote>
</aside>
<pre><code class="lang-auto">[user@dom0 ~]$ qvm-run -ap whonix-ws-16 'date --utc' &amp;&amp; date --utc
Sat 20 Nov 2021 03:42:51 PM UTC
Sat 20 Nov 2021 03:43:24 PM UTC
[user@dom0 ~]$ qvm-run -ap debian-11 'date --utc' &amp;&amp; date --utc
Sat 20 Nov 2021 03:44:58 PM UTC
Sat 20 Nov 2021 03:44:59 PM UTC
</code></pre>
<p>This is after fresh system start, and also templates are just started here.</p>
</blockquote>
</aside>
<p>Looks good enough.<br>
Please re-run in case this issue happens again. Or could you please add it to the Qubes Q/A scripts? Seems quite useful anyhow to have this information handy. Checking/comparing dom0/VM time before proceeding with any updates.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/14</link>
        <pubDate>Sat, 20 Nov 2021 15:56:55 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-14</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[marmarek]]></dc:creator>
        <description><![CDATA[
            <p>All the above checks are just after startup, no suspend nor long uptime is involved.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/13</link>
        <pubDate>Sat, 20 Nov 2021 15:55:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-13</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Also suspend/resume time fix is disabled in Qubes-Whonix templates.<br>
(sdwdate <code>/usr/libexec/sdwdate/suspend-post</code>)</p>
<p>Are you using suspend/resume? That might result in time in Qubes-Whonix Templates to become stale.</p>
<p>As a workaround, does it help to shutdown and restart Qubes-Whonix Templates?</p>
<p>Maybe  Qubes-Whonix Templates should use <code>qubes.GetRandomizedTime</code>?</p>
<hr>
<p>Reminds me of <a href="https://phabricator.whonix.org/T387" class="inline-onebox">⚓ T387 Qubes-Whonix-Gateway as ClockVM</a>. I still didn’t get around implementing it since it’s kinda complex, not pretty and daunting to implement. More realistically might be using sdwdate inside the ClockVM (<code>sys-net</code>) or using a Kicksecure based <code>sys-net</code> which comes with sdwdate pre-installed.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/12</link>
        <pubDate>Sat, 20 Nov 2021 15:54:31 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-12</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[marmarek]]></dc:creator>
        <description><![CDATA[
            <p>I have disabled (<code>systemctl mask</code>) <code>qubes-sync-time</code> service in debian-11, and still got correct time there (after template restart ofc).</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/11</link>
        <pubDate>Sat, 20 Nov 2021 15:52:54 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-11</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[marmarek]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="9" data-topic="12739">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Is it because otherwise Xen DomU’s would start to clock drift more and more?</p>
</blockquote>
</aside>
<p>Generally, yes, that’s the reason. In practice it happens when you pause a VM, or in some cases (depending on domU kernel config) under high load. The service is triggered after system suspend and in similar occasions (in addition to a timer).</p>
<p>As for the time on domU boot, it indeed may be the case. Xen does provide some initial clock to domU, but I’m not sure if it’s synchronized properly in all the cases. It is a different clock than dom0 uses.</p>
<p>In case of tests, there is no long system uptime involved. The system is started just before performing updates. And since other templates do not have this issue, I think it’s pretty clear that at least dom0 clock is correct.</p>
<aside class="quote no-group" data-username="Patrick" data-post="7" data-topic="12739">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p><code>qvm-run --pass-io whonix-gw-16 "date --utc" &amp;&amp; date --utc</code></p>
</blockquote>
</aside>
<pre><code class="lang-auto">[user@dom0 ~]$ qvm-run -ap whonix-ws-16 'date --utc' &amp;&amp; date --utc
Sat 20 Nov 2021 03:42:51 PM UTC
Sat 20 Nov 2021 03:43:24 PM UTC
[user@dom0 ~]$ qvm-run -ap debian-11 'date --utc' &amp;&amp; date --utc
Sat 20 Nov 2021 03:44:58 PM UTC
Sat 20 Nov 2021 03:44:59 PM UTC
</code></pre>
<p>This is after fresh system start, and also templates are just started here.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/10</link>
        <pubDate>Sat, 20 Nov 2021 15:49:50 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-10</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>One difference comes to mind…</p>
<p>Non-Whonix Templates are using <code>qubes-sync-time.service</code> / <code>qubes-sync-time.timer</code>.</p>
<p>Whonix templates are not using it.</p>
<pre><code>sudo systemctl status qubes-sync-time.service
</code></pre>
<pre><code class="lang-auto">● qubes-sync-time.service - Update time from ClockVM
     Loaded: loaded (/lib/systemd/system/qubes-sync-time.service; static)
    Drop-In: /usr/lib/systemd/system/qubes-sync-time.service.d
             └─40_qubes-whonix.conf
     Active: inactive (dead)
TriggeredBy: ● qubes-sync-time.timer
  Condition: start condition failed at Sat 2021-11-20 11:26:05 UTC; 3h 59min ago
             └─ ConditionPathExists=!/usr/lib/qubes-whonix was not met

Nov 20 11:26:05 host systemd[1]: Condition check resulted in Update time from ClockVM being skipped.
</code></pre>
<p>When Templates (or any Qubes VM) are started, they initially get their clock from dom0, which is probably a Xen virtualizer feature? That is maybe why for me the clock is correct.</p>
<p>Maybe the issue is happening with long running Qubes-Whonix Templates? Maybe the issue would happen generally with long running Qubes templates that are not using <code>qubes-sync-time</code>? That would also explain why I am not experiencing it since I don’t leave Templates long running.</p>
<p>What’s the purpose of <code>qubes-sync-time</code>? I couldn’t find any documentation/rationale for it. If there is, please let me know. Eager to read.</p>
<p>Is it because otherwise Xen DomU’s would start to clock drift more and more?</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/9</link>
        <pubDate>Sat, 20 Nov 2021 15:29:48 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-9</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[marmarek]]></dc:creator>
        <description><![CDATA[
            <p>Ok, then I need to investigate it in more details, because I have assumed sdwdate is the reason. Anyway, I have hit this issue in Whonix templates only and not on plain Debian templates, so it is somehow related.</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/8</link>
        <pubDate>Sat, 20 Nov 2021 15:23:28 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-8</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="marmarek" data-post="6" data-topic="12739">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/df705f/40.png" class="avatar"> marmarek:</div>
<blockquote>
<p>Maybe you can adjust sdwdate to shift the clock only forward and not backward in templates?</p>
</blockquote>
</aside>
<p>That’s already the case.</p>
<p>sdwdate isn’t running in Qubes templates.</p>
<pre><code>sudo systemctl status sdwdate

● sdwdate.service - Secure Distributed Web Date
     Loaded: loaded (/lib/systemd/system/sdwdate.service; enabled; vendor preset: enabled)
    Drop-In: /usr/lib/systemd/system/sdwdate.service.d
             └─20_arch_syscall_whitelist.conf, 40_qubes.conf
     Active: inactive (dead)
  Condition: start condition failed at Sat 2021-11-20 11:26:08 UTC; 3h 39min ago
             └─ ConditionPathExists=!/run/qubes/this-is-templatevm was not met
       Docs: https://www.whonix.org/wiki/sdwdate

Nov 20 11:26:08 host systemd[1]: Condition check resulted in Secure Distributed Web Date being skipped.
</code></pre>
<p>Generally, sdwdate as implemented now only sets time forward, never backwards.<br>
It is even quite careful about it → <a href="https://www.whonix.org/wiki/Sdwdate#sdwdate_Time_Replay_Protection">sdwdate Time Replay Protection</a>.<br>
The idea is that forward should always be safe (or at least safer) but backwards could produce a mess […].<br>
How/if time/sdwdate should be handled / could be improved in Qubes templates is another interesting question for a different forum thread.</p>
<p>Since sdwdate currently isn’t running inside Qubes templates, I don’t understand how Whonix/sdwdate could cause such an issue.</p>
<p>Non-Qubes-Whonix haven’t been reporting any APT sources no valid yet issues for a very long time. (Cannot recall.)</p>
<p>If this happens, in dom0, please run:</p>
<pre><code>qvm-run --pass-io whonix-gw-16 "date --utc" &amp;&amp; date --utc
</code></pre>
<p>Replace <code>whonix-gw-16</code> with the template that is currently experiencing issues. That will show the time in dom0 and the time in the Qubes TemplateVM. Then of course it would be interesting to compare that time with other Qubes Templates.</p>
<p>The time difference should just be 1 or 2 seconds. It is for me. And even that minor time delay might be from the command execution delay or <a href="https://www.whonix.org/wiki/Boot_Clock_Randomization" class="inline-onebox">Boot Clock Randomization - Whonix</a>. That minor difference isn’t the issue here.</p>
<p>Perhaps your dom0 clock is slow or fast?</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/7</link>
        <pubDate>Sat, 20 Nov 2021 15:17:38 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-7</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
      <item>
        <title>whonix-ws-16 Template fails to update due to timing issue</title>
        <dc:creator><![CDATA[marmarek]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="deeplow" data-post="1" data-topic="12739">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/d/df788c/40.png" class="avatar"> deeplow:</div>
<blockquote>
<p><code>InRelease is not valid yet </code></p>
</blockquote>
</aside>
<p>I hit this issue very often, not only for the fasttrack repo. It’s enough to unlucky enough to update just after debian updates the repo (which AFAIR happens every 6h). It is <strong>very</strong> annoying especially for openQA tests, where such failure makes the whole 3h+ job to fail. Recently (because of fasttrack?) it started to happen more often - to the point I got annoyed enough to apply <a href="https://github.com/QubesOS/openqa-tests-qubesos/commit/d88efe8e662add61765cf9230d9d7b3057d2f845#diff-ef19ea6b0ca7e4175f38fbc13868164b3dbb67132dda82b272134effc72ea753R26" rel="noopener nofollow ugc">a workaround</a> by setting the clock 5 minutes forward in Whonix. This also breaks split-gpg tests (where generated test-key is “not yet valid”) and we have similar workaround there too.</p>
<p>Maybe you can adjust sdwdate to shift the clock only forward and not backward in templates? It does reduce its properties, but maybe for templates (which have limited network connectivity anyway) it isn’t an issue?</p>
          <p><a href="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739/6</link>
        <pubDate>Sat, 20 Nov 2021 14:48:47 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12739-6</guid>
        <source url="http://forums.whonix.org/t/whonix-ws-16-template-fails-to-update-due-to-timing-issue/12739.rss">whonix-ws-16 Template fails to update due to timing issue</source>
      </item>
  </channel>
</rss>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Onion Services Authentication</title>
    <link>http://forums.whonix.org/t/onion-services-authentication/975</link>
    <description>&lt;s&gt;http://tor.stackexchange.com/questions/219/how-to-use-hidden-service-authentication&lt;/s&gt;</description>
    <language>en</language>
    <lastBuildDate>Sat, 09 Jul 2022 17:09:16 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/onion-services-authentication/975.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Abeing1935]]></dc:creator>
        <description><![CDATA[
            <p>UPDATE. I have started with a fresh Whonix with the current version and I can confirm that everything is working fine with hidden services with authentication enabled. It is also working fine with OnionShare v2.5</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/66">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/66</link>
        <pubDate>Sat, 09 Jul 2022 17:09:16 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-66</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Note to self:<br>
Testing onion client authorization was done using OnionShare to simplify setting up an authenticated onion v3.</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/65">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/65</link>
        <pubDate>Sat, 09 Jul 2022 09:35:18 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-65</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Abeing1935]]></dc:creator>
        <description><![CDATA[
            <p>I have tried all of them</p>
<ol>
<li>Checking Remember this key option does not work</li>
<li>Regular toriffed internet connections are functional</li>
<li>Regular connections to unauthenticated onions service are functional<br>
4.1. Same authenticated onion service is functional outside of Whonix and unauthenticated onion service setup worked fine. The only place where it is not working is Whonix</li>
</ol>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/64">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/64</link>
        <pubDate>Fri, 08 Jul 2022 12:33:48 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-64</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Please try the troubleshooting section under <a href="https://www.whonix.org/wiki/Tor_Browser#Onion_Client_Authorization">https://www.whonix.org/wiki/Tor_Browser#Onion_Client_Authorization</a> and comment here which troubleshooting steps you attempted and their result.</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/63">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/63</link>
        <pubDate>Fri, 08 Jul 2022 11:55:11 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-63</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Abeing1935]]></dc:creator>
        <description><![CDATA[
            <p><a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a> Right now with Tor 11.0.15 is not working. If you paste the right private key in the Tor Brower (after extending the onion-grater whitelist), you will get “Unable to configure Tor with your key.”. The same Tor browser version outside Whonix is working fine</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/62">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/62</link>
        <pubDate>Fri, 08 Jul 2022 11:52:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-62</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="8" data-topic="13110">
  <div class="title">
    <div class="quote-controls"></div>
    <img loading="lazy" alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar">
    <a href="https://forums.whonix.org/t/authenticated-onion-service-not-working-using-old-or-new-methods/13110/8">authenticated onion service not working using old or new methods</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/support/5"><span class="badge-category-bg" style="background-color: #8C6238;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="User support for the Whonix operating system. (devs)">Support</span></a>
  </div>
  <blockquote>
    There are two options to setup Onion Service Client Authentication. Chose either option A) or B). 


A) <a href="https://www.whonix.org/wiki/Tor_Browser#Onion_Client_Authorization">Tor Browser Onion Client Authorization</a>, or

B) <a href="https://www.whonix.org/wiki/Onion_Services#Onion_Service_Authentication_Client_Setup">Onion Service Client Authentication setup on Whonix-Gateway ™</a>.
  </blockquote>
</aside>

          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/61">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/61</link>
        <pubDate>Mon, 31 Jan 2022 16:01:42 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-61</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Tor Browser Onion Client Authorization in Whonix works for me. Just now documented:<br>
<a href="https://www.whonix.org/wiki/Tor_Browser#Onion_Client_Authorization">Onion Client Authorization</a></p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/60">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/60</link>
        <pubDate>Sun, 02 Jan 2022 11:51:44 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-60</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="57" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Can <code>ClientOnionAuthDir</code> be set multiple times to different folders?</p>
</blockquote>
</aside>
<p>Does not seem like it:</p>
<p><a href="https://community.torproject.org/onion-services/advanced/client-auth/" class="onebox" target="_blank">https://community.torproject.org/onion-services/advanced/client-auth/</a></p>
<p>While it supports multiple auth files, there is no mention of Tor accepting mutliple dir paths for it.</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/59">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/59</link>
        <pubDate>Thu, 30 Jul 2020 13:33:33 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-59</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="56" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>being overwritten, re-generated. What should be done if either file already exists? I guess not overwrite, notify user and error out?</p>
</blockquote>
</aside>
<p>Perhaps auto rename it to something else/random?</p>
<aside class="quote no-group" data-username="Patrick" data-post="56" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Backup tool part of <code>anon-auth-autogen</code> and/or <code>anon-server-to-client-install</code> ?</p>
</blockquote>
</aside>
<p><code>anon-server-to-client-install</code> makes sense.</p>
<aside class="quote no-group" data-username="Patrick" data-post="56" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Standalone tool?</p>
</blockquote>
</aside>
<p>unnecessary IMO</p>
<aside class="quote no-group" data-username="Patrick" data-post="56" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Restoration tool too?</p>
</blockquote>
</aside>
<p>Yes</p>
<aside class="quote no-group" data-username="Patrick" data-post="56" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Features? Copy from <code>/var/lib/tor/hidden_service</code> to home folder? What if files in <code>/var/lib/tor/hidden_service</code> differ from contents in <code>/home/user/onion-service-backup/hidden_service</code> ? Overwrite? Probably not. Error out?</p>
</blockquote>
</aside>
<p>Perhaps copy to the shared folder straight away? There has to be a sanity check to detect if it is mounted first. I feel like most functionality you are implementing would quickly lead to re-inventing the wheel in many ways that dedicated sync programs  are designed to deal with these problems. Perhaps delegating this to something with a gui like Unison is a good idea. Or even including Unison with preconfigured origin and clone dirs preset would be easier .</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/58">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/58</link>
        <pubDate>Thu, 30 Jul 2020 13:15:35 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-58</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Can <code>ClientOnionAuthDir</code> be set multiple times to different folders?</p>
<hr>
<p><a href="https://phabricator.whonix.org/T996" class="onebox" target="_blank">https://phabricator.whonix.org/T996</a></p>
<blockquote>
<p>A release candidate for next Tuesday’s stable Tor Browser 9.5 has been <a href="https://lists.torproject.org/pipermail/tor-qa/2020-May/000977.html">announced on tor-qa</a>. Some excerpts from the changelog:</p>
<ul>
<li>
<a href="https://trac.torproject.org/projects/tor/ticket/30237">Bug 30237</a>: Control port module improvements for v3 client authentication</li>
</ul>
<p>(Might be impossible to make this work with onion-grater while still isolating VMs)</p>
<p><a href="https://blog.torproject.org/new-release-tor-browser-95">https://blog.torproject.org/new-release-tor-browser-95</a></p>
</blockquote>
<p><a href="https://lists.torproject.org/pipermail/tor-dev/2020-June/014353.html" class="onebox" target="_blank">https://lists.torproject.org/pipermail/tor-dev/2020-June/014353.html</a></p>
<pre><code>    553 Unable to store creds for

Did you set ClientOnionAuthDir in torrc (to a directory with "private
enough" permissions)?

Rusty
</code></pre>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/anon-gw-anonymizer-config/commit/47cf0e376ab4af6a2b9f2165b6e449c2176a3afd" target="_blank">github.com/Whonix/anon-gw-anonymizer-config</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/anon-gw-anonymizer-config/commit/47cf0e376ab4af6a2b9f2165b6e449c2176a3afd" target="_blank">ClientOnionAuthDir /var/lib/tor/authdir</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-07-23" data-time="11:23:22" data-timezone="UTC">11:23AM - 23 Jul 20 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 3 files with 23 additions and 0 deletions">
        <a href="https://github.com/Whonix/anon-gw-anonymizer-config/commit/47cf0e376ab4af6a2b9f2165b6e449c2176a3afd" target="_blank">
          <span class="added">+23</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">https://forums.whonix.org/t/onion-services-authentication/975</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/57">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/57</link>
        <pubDate>Thu, 23 Jul 2020 11:28:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-57</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Not sure about the backup feature yet.</p>
<p><code>anon-auth-autogen</code> is not yet idempotent.</p>
<p>Re-running <code>anon-auth-autogen</code> results in files</p>
<ul>
<li>/var/lib/tor/hidden_service/authorized_clients/1.auth</li>
<li>/var/lib/tor_autogen/hidden_service/1.auth_private</li>
</ul>
<p>being overwritten, re-generated. What should be done if either file already exists? I guess not overwrite, notify user and error out?</p>
<ul>
<li><code>Tor Onion Service Backup Tool</code></li>
<li><code>Tor Authenticated Onion Service Backup Tool</code></li>
<li>Backup tool part of <code>anon-auth-autogen</code> and/or <code>anon-server-to-client-install</code>?</li>
<li>Standalone tool?</li>
<li>Restoration tool too?</li>
</ul>
<p>Features? Copy from <code>/var/lib/tor/hidden_service</code> to home folder? What if files in <code>/var/lib/tor/hidden_service</code> differ from contents in <code>/home/user/onion-service-backup/hidden_service</code>? Overwrite? Probably not. Error out?</p>
<p>What’s the main feature of this? Copying some things from <code>/var/lib/tor</code> to <code>/home/user</code>? And then users are supposed to copy yet again to somewhere else? Why they wouldn’t copy straight from <code>/var/lib/tor</code>?</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/56">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/56</link>
        <pubDate>Mon, 13 Jan 2020 12:20:48 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-56</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>new output:</p>
<pre><code>sudo anon-auth-autogen
</code></pre>
<blockquote>
<p>INFO: Created torconffile ‘/usr/local/etc/torrc.d/43_hidden_service_hs_autogen.conf’.<br>
INFO: Reloading Tor.<br>
INFO: Giving Tor 5 seconds to create hidden service file.<br>
INFO: Installed “.auth” file (public key) ‘/var/lib/tor_autogen/hidden_service/1.auth’ to ‘/var/lib/tor_autogen/hidden_service/1.auth’ to allow client ‘1’ to access hsname ‘hidden_service’ onion_url ‘gky7wbnxkl57vn6bmdoeck4pqsppa3bmjq6i7kkqw3pttkflg7uymjad.onion’.<br>
INFO: Reloading Tor again to activate “.auth” (public key) file for client ‘1’.<br>
INFO: You need to provide client ‘1’ with “.auth_private” file (private key) ‘/var/lib/tor_autogen/hidden_service/1.auth_private’.<br>
INFO: Visitors that use Whonix could store ‘/var/lib/tor_autogen/hidden_service/1.auth_private’ in ‘/home/user/1.auth_private’ and then run ‘sudo sourcefile=/home/user/1.auth_private anon-server-to-client-install’.</p>
</blockquote>
<ul>
<li><a href="https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/man/anon-auth-autogen.8.ronn">anon-auth-autogen man page</a></li>
<li><a href="https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/usr/bin/anon-auth-autogen">anon-auth-autogen</a></li>
</ul>
<hr>
<p><code>anon-server-to-client-install Tor Authenticated Onion Service ".auth_private" file (private key) Server to Client Installer</code> was also creaetd.</p>
<pre><code>sudo anon-server-to-client-install
</code></pre>
<blockquote>
<p>INFO: Installed “.auth_private” file (private key) ‘/home/user/1.auth_private’ to ‘/var/lib/tor/authdir/1.auth_private’.<br>
INFO: Created torconffile ‘/usr/local/etc/torrc.d/43_clientonionauthdir.conf’.<br>
INFO: Reloading Tor to activate “.auth_private” file (private key).<br>
INFO: Success.</p>
</blockquote>
<ul>
<li><a href="https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/man/anon-server-to-client-install.8.ronn">anon-server-to-client-install man page</a></li>
<li><a href="https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/usr/bin/anon-server-to-client-install">anon-server-to-client-install</a></li>
</ul>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/55">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/55</link>
        <pubDate>Mon, 13 Jan 2020 12:05:43 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-55</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Yay. Things get more complicated. Quote <a href="https://gitweb.torproject.org/torspec.git/tree/rend-spec-v3.txt">https://gitweb.torproject.org/torspec.git/tree/rend-spec-v3.txt</a></p>
<blockquote>
<p>The keypair used for client authorization is created by a third party tool for which the public key needs to be transferred to the service operatorin a secure out-of-band way. The third party tool SHOULD add appropriate headers to the private key file to ensure that users won’t accidentally give out their private key.</p>
</blockquote>
<p>Our current process is the server to set up the onion service and client authorization key files.</p>
<p>Tor Project’s idea seems to be vice versa. That clients should create their own <code>".auth_private" file</code> (private key) and <code>".auth" file</code> (public key). Retain their private key, install their private key in Tor’s data directory and then and send their public key to the onion service operator.</p>
<p>Tor Project way: That would have the advantage that 1 client could re-use their private key for multiple services. But is harder for clients.</p>
<p>Whonix way: onion service operators could impersonate clients but does that matter?</p>
<p>I guess arguments could be made for both use cases. Server created authorization files vs client created authorization files.</p>
<p>But not sure we want to follow or ignore this.</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/54">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/54</link>
        <pubDate>Mon, 13 Jan 2020 11:12:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-54</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Could you please English language interpret chapter <code>Client Authorization</code> from <a href="https://2019.www.torproject.org/docs/tor-manual.html.en">https://2019.www.torproject.org/docs/tor-manual.html.en</a> for me? This sentence:</p>
<blockquote>
<p>Revoking a client can be done by removing their “.auth” file, however the revocation will be in effect only after the tor process gets restarted even if a SIGHUP takes place.</p>
</blockquote>
<p>What means <code>even if a SIGHUP takes place.</code>?</p>
<p>Restart or reload required?<br>
Reload (SIGHUP) not sufficient?</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/53">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/53</link>
        <pubDate>Mon, 13 Jan 2020 10:51:47 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-53</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="50" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Let’s make it a concrete statement to guide users on what exactly is wrong.</p>
</blockquote>
</aside>
<p>Info. Not error. Messages starting with <code>INFO:</code> aren’t errors. Errors should always start with <code>ERROR:</code> unless I mess that up in the source code but I didn’t manage to mess that up yet.</p>
<aside class="quote no-group quote-modified" data-post="50" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<blockquote>
<p><strong>Reloading Tor will apply client_authorization_full_path.</strong></p>
</blockquote>
<p>Is this message suggesting auth cookie use?</p>
</blockquote>
</aside>
<p>I don’t remember this exact message.<br>
This is confusing indeed. Both <a href="https://2019.www.torproject.org/docs/tor-manual.html.en">https://2019.www.torproject.org/docs/tor-manual.html.en</a> and don’t use good names for these files.</p>
<p>Tor calls them</p>
<ul>
<li><code>".auth_private" file</code></li>
<li><code>".auth" file</code></li>
</ul>
<p>My interpretation:</p>
<ul>
<li>
<code>".auth_private" file</code>: private key - to be installed on client</li>
<li>
<code>".auth" file</code>: public key - to be installed on onion service</li>
</ul>
<p>I’d preferred if  <code>.auth</code> was <code>.auth_public</code> but it’s not possible as per Tor manual. These file suffixes are hardcoded in Tor. Since I cannot simplify upstream names, I will use the same names in the script output to not invent new terminology to add further confusion.</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/52">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/52</link>
        <pubDate>Mon, 13 Jan 2020 10:49:33 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-52</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="49" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>I think I’d run into the same permissions nightmare I saw above. Its worthwhile to script this too in the same program.</p>
</blockquote>
</aside>
<p>We need to master linux file permissions.</p>
<ul>
<li>Step 1) A tool to record all file permissions. Paste them into a file for backup / later comparison.</li>
<li>Step 2) Do some modifications.</li>
<li>Step 3) Repeat step 1 but store output of permissions diagnosis tool in a different file.</li>
<li>Step 4) Compare the the two outputs of the permissions diagnosis tool using <code>meld</code>, <code>kdiff3</code> or similar.</li>
</ul>
<p>What do we use as permissions diagnosis tool?</p>
<pre><code>sudo find /var/lib/tor | sudo xargs stat -cstat -c "
access rights octal: '%a'
access rights human: '%A'
file type: '%F'
user name of owner: '%U'
group name of owner: '%G'
number of hard links: '%h'
quoted file name with dereference if symbolic link: '%N'"
</code></pre>
<p>Or perhaps simpler…</p>
<pre><code>sudo find /var/lib/tor | sudo xargs stat -cstat -c "%a %A %F %U %G %h %N"
</code></pre>
<p>More readable output?</p>
<p>Redirect output to file one.txt.</p>
<pre><code>sudo find /var/lib/tor | sudo xargs stat -cstat -c "%a %A %F %U %G %h %N" &gt; one.txt
</code></pre>
<p>Redirect output to file two.txt.</p>
<pre><code>sudo find /var/lib/tor | sudo xargs stat -cstat -c "%a %A %F %U %G %h %N" &gt; two.txt
</code></pre>
<p>Compare.</p>
<pre><code>meld one.txt two.txt
</code></pre>
<p>Dunno if I am missing something here. <code>stat</code> supports a lot things to output. Quote <a href="https://manpages.debian.org/stat">https://manpages.debian.org/stat</a></p>
<blockquote>
<p>The valid format sequences for files (without --file-system):</p>
<p>%a<br>
access rights in octal (note ‘#’ and ‘0’ printf flags)<br>
%A<br>
access rights in human readable form<br>
%b<br>
number of blocks allocated (see %B)<br>
…</p>
</blockquote>
<p>Once we know the right permissions / manual commands, I can try to script that.</p>
<aside class="quote no-group" data-post="49" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>I’d limit the scope to HS folders only with contents under them. I imagine users would be surprised if their current guard was changed when restoring an older backup of their service. Selective backup might be nice, but I see it as a niche usecase and not worth the trouble.</p>
</blockquote>
</aside>
<p>Makes sense.</p>
<aside class="quote no-group" data-post="49" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>IMO split the message output into a verbose and quiet mode if easily done.</p>
</blockquote>
</aside>
<p>For “super debug”, just run</p>
<pre><code>sudo bash -x anon-auth-autogen
</code></pre>
<aside class="quote no-group" data-post="49" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>I’d limit the scope to HS folders only with contents under them. I imagine users would be surprised if their current guard was changed when restoring an older backup of their service. Selective backup might be nice, but I see it as a niche usecase and not worth the trouble.</p>
</blockquote>
</aside>
<p>Indeed.</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/51">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/51</link>
        <pubDate>Mon, 13 Jan 2020 10:26:50 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-51</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Suggested backup/restore messages:</p>
<p><em>Your Onion Service conf and keys will be backed up to /home/user. Please transfer to a storage device outside the VM.</em></p>
<p><em>Your Onion Services are now restored</em></p>
<hr>
<p>Suggestion:</p>
<p>Reload Tor to so Tor will load client_authorization_full_path. -&gt;</p>
<blockquote>
<p><strong>Reloading Tor will apply client_authorization_full_path.</strong></p>
</blockquote>
<hr>
<p>Is this message suggesting auth cookie use? Or is it an error message guessing why a failure happened? Let’s make it a concrete statement to guide users on what exactly is wrong.</p>
<blockquote>
<p>INFO: You probably want to provide client ‘$client’ with auth_private_file ‘$auth_private_file’ for hsname ‘$hsname’ onion_url ‘$onion_url’."</p>
</blockquote>
<p>The rest looks good.</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/50">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/50</link>
        <pubDate>Sun, 12 Jan 2020 20:48:01 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-50</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="48" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Can you copy file <code>/var/lib/tor_autogen/hidden_service/1.auth_private</code> to another VM and use it as per <a href="https://www.whonix.org/wiki/Onion_Services#Onion_Service_Authentication_Client_Setup">Onion Service Authentication Client Setup</a> to actually connect to the onion service? Maybe this needs scripting as well?</p>
</blockquote>
</aside>
<p>I think I’d run into the same permissions nightmare I saw above. Its worthwhile to script this too in the same program.</p>
<aside class="quote no-group" data-post="48" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Makes sense. Could you draft please the ideal output of the script (everything, not just backup)?</p>
</blockquote>
</aside>
<p>OK</p>
<aside class="quote no-group" data-post="48" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Maybe some messages such as <code>INFO: Reloading Tor.</code> are superfluous?</p>
</blockquote>
</aside>
<p>I find it useful because otherwise I would think the script stalled or something wrong.</p>
<aside class="quote no-group" data-post="48" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Output <code>INFO: Created torconffile ‘/usr/local/etc/torrc.d/43_hidden_service_hs_autogen.conf’.</code> probably makes sense in principle? Users should understand a bit what actually happened?</p>
</blockquote>
</aside>
<p>I agree. Those who have no idea probably don’t care about the messages and just want to see an “operation completed successfully”. Powerusers want to get an idea of what is going on in case they need to debug. IMO split the message output  into a verbose and quiet mode if easily done.</p>
<aside class="quote no-group" data-post="48" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>What files to backup is a good question. Which ones?</p>
</blockquote>
</aside>
<p>I’d limit the scope to HS folders only with contents under them. I imagine users would be surprised if their current guard was changed when restoring an older backup of their service. Selective backup might be nice, but I see it as a niche usecase and not worth the trouble.</p>
<aside class="quote no-group" data-post="48" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Other files generated in the process do not need backup?</p>
</blockquote>
</aside>
<p>Nothing comes to mind.</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/49">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/49</link>
        <pubDate>Sun, 12 Jan 2020 20:25:01 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-49</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Once that is done, also a onion service generator for non-authenticated onion services could be considered if that looks worthwhile. Easy to provide a “reduced feature” “fork” of that script.</p>
<aside class="quote no-group" data-post="47" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Is there anything else I need to do or is the process complete?</p>
</blockquote>
</aside>
<p>Testing required.</p>
<p>Can you copy file <code>/var/lib/tor_autogen/hidden_service/1.auth_private</code> to another VM and use it as per <a href="https://www.whonix.org/wiki/Onion_Services#Onion_Service_Authentication_Client_Setup">Onion Service Authentication Client Setup</a> to actually connect to the onion service? Maybe this needs scripting as well?</p>
<p>This might require previous exercising with un-authenticated Onion Services.</p>
<aside class="quote no-group" data-post="47" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Perhaps the script should display a clearer message about what folder one needs to backup?</p>
</blockquote>
</aside>
<p>Makes sense. Could you draft please the ideal output of the script (everything, not just backup)?</p>
<p>Maybe some messages such as <code>INFO: Reloading Tor.</code> are superfluous?</p>
<p>Output <code>INFO: Created torconffile ‘/usr/local/etc/torrc.d/43_hidden_service_hs_autogen.conf’.</code> probably makes sense in principle? Users should understand a bit what actually happened? Avoiding “black boxes”. Self-documentation as a goal. But perhaps the output could be better formatted?</p>
<p>Output <code> INFO: Copied client_authorization_full_path ‘/var/lib/tor_autogen/hidden_service/1.auth’ to ‘/var/lib/tor_autogen/hidden_service/1.auth’.</code> might be too verbose? I like to let my scripts explain what they’re doing.</p>
<p>Also worth considering: commands users can copy/paste for backup.</p>
<p>What files to backup is a good question. Which ones?</p>
<p>I guess with a backup of both folders:</p>
<ul>
<li>
<code>/var/lib/tor_autogen</code> and</li>
<li><code>/var/lib/tor</code></li>
</ul>
<p>nothing can be forgotten. But that includes Tor state files (Tor consensus and Tor entry guards).</p>
<p>Or better only backup these two folders</p>
<ul>
<li>
<code>/var/lib/tor_autogen/hidden_service</code> and</li>
<li><code>/var/lib/tor/hidden_service</code></li>
</ul>
<p>?</p>
<p>(Note: <code>hidden_service</code> is a variable. It could be <code>mumble_service</code> or anything else. Useful for multiple Tor onion services. Can be set through variable <code>hsname</code>.)</p>
<p>Otherwise a “more selective” backup might makes copies of these three files:</p>
<ul>
<li><code>/var/lib/tor/hidden_service/hs_ed25519_secret_key</code></li>
<li><code>/var/lib/tor_autogen/hidden_service/1.auth_private</code></li>
<li><code>/var/lib/tor_autogen/hidden_service/1.auth</code></li>
</ul>
<p>Other files generated in the process do not need backup?</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/48">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/48</link>
        <pubDate>Sun, 12 Jan 2020 15:54:07 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-48</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>OK good progress made:</p>
<blockquote>
<p>user@host:~$ sudo anon-auth-autogen<br>
INFO: Created torconffile ‘/usr/local/etc/torrc.d/43_hidden_service_hs_autogen.conf’.<br>
INFO: Reloading Tor.<br>
INFO: Giving Tor 5 seconds to create hidden service file.<br>
INFO: Copied client_authorization_full_path ‘/var/lib/tor_autogen/hidden_service/1.auth’ to ‘/var/lib/tor_autogen/hidden_service/1.auth’.<br>
INFO: You probably want to provide client ‘1’ with auth_private_file ‘/var/lib/tor_autogen/hidden_service/1.auth_private’ for hsname ‘hidden_service’ onion_url ‘verylongv3address.onion’.</p>
</blockquote>
<p>Is there anything else I need to do or is the process complete? Perhaps the script should display a clearer message about what folder one needs to backup?</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/47">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/47</link>
        <pubDate>Sun, 12 Jan 2020 14:36:49 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-47</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>HulaHoop via Whonix Forum:</p>
<blockquote>
<aside class="quote no-group" data-post="44" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Requires using Whonix testers repository. Only that support “real”<br>
<code>torrc.d</code> support.</p>
</blockquote>
</aside>
<p>What package do you mean?</p>
</blockquote>
<p><code>anon-gw-anonymizer-config</code> changes Tor config files to include all of<br>
<code>/usr/local/etc/torrc.d/</code>.</p>
<pre><code>%include /usr/local/etc/torrc.d/
</code></pre>
<p>As per:</p>
<aside class="quote quote-modified" data-post="73" data-topic="4041">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="https://forums.whonix.org/t/torrc-d-is-comming/4041/73">torrc.d is comming</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/development"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    This was implemented in testers repository. In essence: 
/etc/tor/torrc : 
%include /etc/torrc.d/

/etc/torrc.d/95_whonix.conf  : 
%include /usr/local/etc/torrc.d/

/usr/local/etc/torrc.d/ folder: 

40_tor_control_panel.conf  50_user.conf 



<a href="https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/usr/share/tor/tor-service-defaults-torrc.anondist">https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/usr/share/tor/tor-service-defaults-torrc.anondist</a>
<a href="https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/etc/tor/torrc.anondist">https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/etc/tor/torrc.anondist</a>
<a href="https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/etc/torrc.d/95_whonix.conf">https://github.com/Whonix/anon-gw-anonymizer-config/blob…</a>
  </blockquote>
</aside>

<p>Please check if these files look OK:</p>
<ul>
<li><code>/etc/tor/torrc</code></li>
<li><code>/etc/torrc.d/95_whonix.conf</code></li>
</ul>
<blockquote>
<p>Tor or autogen? The later still doesn’t how in Testers</p>
</blockquote>
<p>Expected.</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/46">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/46</link>
        <pubDate>Sat, 11 Jan 2020 16:30:36 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-46</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="44" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Requires using Whonix testers repository. Only that support “real”<br>
<code>torrc.d</code> support.</p>
</blockquote>
</aside>
<p>What package do you mean? Tor or autogen? The later still doesn’t how in Testers</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/45">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/45</link>
        <pubDate>Sat, 11 Jan 2020 15:20:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-45</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Tor currently totally ignores that file I suppose - you can test by<br>
adding any garbage there which would normally result in Tor to fail to<br>
restart - except for that file which is fully ignored.</p>
<p>Requires using Whonix testers repository. Only that support “real”<br>
<code>torrc.d</code> support.</p>
<p>Then please look at /etc/tor/torrc and all files that follow. (follow<br>
whatever <code>%include</code>) See if all of that makes sense. Compare with git<br>
master.</p>
<p>Otherwise Tor will just ignore any other files in torrc.d.</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/44">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/44</link>
        <pubDate>Wed, 08 Jan 2020 17:48:35 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-44</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="42" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Does folder / file exist now?</p>
</blockquote>
</aside>
<p>No</p>
<blockquote>
<p>user@host:~$ sudo chmod +x /usr/bin/anon-auth-autogen<br>
user@host:~$ sudo anon-auth-autogen<br>
INFO: Created torconffile ‘/usr/local/etc/torrc.d/43_hidden_service_hs_autogen.conf’.<br>
INFO: Reloading Tor.<br>
INFO: Giving Tor 5 seconds to create hidden service file.<br>
cat: /var/lib/tor/hidden_service/hostname: No such file or directory<br>
ERROR: exit_code: 1 | BASH_COMMAND: onion_url="$(cat “$onion_url_file”)"<br>
user@host:~$ sudo ls -la /var/lib/tor/hidden_service/<br>
ls: cannot access ‘/var/lib/tor/hidden_service/’: No such file or directory<br>
user@host:~$ sudo ls -la /var/lib/tor/hidden_service/hostname<br>
ls: cannot access ‘/var/lib/tor/hidden_service/hostname’: No such file or directory</p>
</blockquote>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/43">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/43</link>
        <pubDate>Wed, 08 Jan 2020 15:25:32 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-43</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
      <item>
        <title>Onion Services Authentication</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Do contents of <code>/usr/local/etc/torrc.d/43_hidden_service_hs_autogen.conf</code> look sensible?</p>
<p>Does folder / file exist now?</p>
<pre><code>sudo ls -la /var/lib/tor/hidden_service/
sudo ls -la /var/lib/tor/hidden_service/hostname
</code></pre>
<p>If both yes, I think I know why this is happening. After creating <code>/usr/local/etc/torrc.d/43_hidden_service_hs_autogen.conf</code> the script runs <code>systemctl reload tor@default</code> but this command is non-blocking and does not wait for the hidden service files to be created. <code>systemctl restart tor@default</code> would be blocking but also interrupt existing connections.</p>
<p>Now fixed by waiting 5 seconds (configurable). Not the cleanest solution but good enough.</p>
<aside class="quote no-group" data-post="41" data-topic="975">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>sudo bash</p>
</blockquote>
</aside>
<p>Better <code>sudo chmod +x /usr/bin/anon-auth-autogen</code>. Then you can drop <code>bash</code> and it will use whatever interpreter which is used.</p>
          <p><a href="http://forums.whonix.org/t/onion-services-authentication/975/42">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-services-authentication/975/42</link>
        <pubDate>Wed, 08 Jan 2020 08:19:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-975-42</guid>
        <source url="http://forums.whonix.org/t/onion-services-authentication/975.rss">Onion Services Authentication</source>
      </item>
  </channel>
</rss>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>kernel recompilation for better hardening - Development - Whonix Forum</title>
    <meta name="description" content="https://docs.clip-os.org/clipos/kernel.html 


These both look interesting. They‚Äôre mainly for kernel compile options though. 
Is there any way to build Whonix with custom kernel configurations? Or will kernels have to b&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="75983c09.html?page=22" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;kernel recompilation for better hardening&#39;" href="7598.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/kernel-recompilation-for-better-hardening/7598?page=22" />
<meta name="twitter:url" content="https://forums.whonix.org/t/kernel-recompilation-for-better-hardening/7598?page=22" />
<meta property="og:title" content="kernel recompilation for better hardening" />
<meta name="twitter:title" content="kernel recompilation for better hardening" />
<meta property="og:description" content="Yes, Clang can be considered. Though, I wouldn‚Äôt know how to make the  change and also the packaging is an issue still even with gcc.   LATENT_ENTROPY isn‚Äôt that important so the only big losses would be RANDSTRUCT and STACKLEAK.   OK. I guess doesn‚Äôt hurt to keep the kernel command line in case it gets  added at some point in future." />
<meta name="twitter:description" content="Yes, Clang can be considered. Though, I wouldn‚Äôt know how to make the  change and also the packaging is an issue still even with gcc.   LATENT_ENTROPY isn‚Äôt that important so the only big losses would be RANDSTRUCT and STACKLEAK.   OK. I guess doesn‚Äôt hurt to keep the kernel command line in case it gets  added at some point in future." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="105 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="608 ‚ù§" />
<meta property="article:published_time" content="2020-03-02T08:14:05+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="7598e4a7.html?page=21">
        <link rel="next" href="759889ae.html?page=23">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="7598.html">kernel recompilation for better hardening</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/component_security.html' class='discourse-tag' rel="tag">component_security</a>, 
            <a href='../../tag/status_open_issue_todo.html' class='discourse-tag' rel="tag">status_open_issue_todo</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-02T08:14:05Z' class='post-time'>
                March 2, 2020,  8:14am
              </time>
              <meta itemprop='dateModified' content='2020-03-02T08:14:05Z'>
          <span itemprop='position'>#424</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Yes, Clang can be considered. Though, I wouldn‚Äôt know how to make the<br>
change and also the packaging is an issue still even with gcc.</p>
<blockquote>
<p>LATENT_ENTROPY isn‚Äôt that important so the only big losses would be RANDSTRUCT and STACKLEAK.</p>
</blockquote>
<p>OK. I guess doesn‚Äôt hurt to keep the kernel command line in case it gets<br>
added at some point in future.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>
          <meta itemprop='keywords' content='component_security, status_open_issue_todo'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-02T08:42:47Z' class='post-time'>
                March 2, 2020,  8:42am
              </time>
              <meta itemprop='dateModified' content='2020-03-02T08:42:47Z'>
          <span itemprop='position'>#425</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>madaidan via Whonix Forum:</p>
<blockquote>
<aside class="quote no-group" data-username="Patrick" data-post="421" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Same comment as <a href="7598/358.html">kernel recompilation for better hardening</a> applies?</p>
</blockquote>
</aside>
<p>No. I‚Äôm not saying to check <code>/proc/cmdline</code> in security-misc. This would set <code>slub_debug=FZ</code> and <code>page_poison=0</code> by default in the kernel and make sure security-misc can‚Äôt override it.</p>
</blockquote>
<p>Other kernel parameters could still be changed?</p>
<p>If yes this case, OK. It‚Äôs messy, but if there‚Äôs no better solution<br>
non-debug kernel could do it. Debug kernel shouldn‚Äôt do that?</p>
<p>This needs a good technical explanation what issue we‚Äôre working around<br>
with this so this can still be understood some years from now by others<br>
(including me).</p>
<p>What makes this also messy is the fact then kernel parameters aren‚Äôt<br>
only defined in /etc/default/grub.d and/or at boot time using grub edit<br>
function but also hardcoded and forced in kernel config which is defined<br>
elsewhere. Perhaps drop a note in /etc/default/grub.d, adding a kernel<br>
boot parameter that is ignored by the kernel but as a hint for<br>
users/reviewers (and note for developers) that there are ‚Äúextra‚Äù kernel<br>
parameters defined elsewhere?</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-02T11:36:42Z' class='post-time'>
                March 2, 2020, 11:36am
              </time>
              <meta itemprop='dateModified' content='2020-03-02T11:36:42Z'>
          <span itemprop='position'>#426</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="415" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><a href="../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/50">Disable HDLC in host kernel</a></p>
</blockquote>
</aside>
<p>Merged.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-02T11:44:13Z' class='post-time'>
                March 2, 2020, 11:44am
              </time>
              <meta itemprop='dateModified' content='2020-03-02T11:44:13Z'>
          <span itemprop='position'>#427</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>madaidan via Whonix Forum:</p>
<blockquote>
<aside class="quote no-group" data-username="Patrick" data-post="416" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Can you find if this would be needed for something? <a class="mention" href="../../../external.html?link=https://forums.whonix.org/u/hulahoop">@HulaHoop</a></p>
</blockquote>
</aside>
<p>We already blacklist the module in security-misc anyway. If it was needed for something, we‚Äôd know by now.</p>
</blockquote>
<p>OK.</p>
<p>(I am not sure we have that many security-misc on hosts users yet.)</p>
<blockquote>
<aside class="quote no-group" data-username="Patrick" data-post="417" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>No log access for root at all then as a development goal?</p>
</blockquote>
</aside>
<p>Yes. The kernel logs can be very useful to an attacker hence why the dmesg_restrict sysctl exists to restrict it to root. There have been many cases of kernel pointer leaks, bypassing kptr_restrict for example.</p>
</blockquote>
<p>OK. Please add that rationale to the wiki.</p>
<blockquote>
<aside class="quote no-group" data-username="Patrick" data-post="417" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Could capabilities be used instead to prevent access to dmesg for root?</p>
</blockquote>
</aside>
<p>Yes. dmesg_restrict restricts it to CAP_SYSLOG so we can probably remove that capability but CAP_SYSLOG is used for a lot of other functionality so it might break things.</p>
<aside class="quote no-group" data-username="Patrick" data-post="417" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Worst case scenario I see here that our initial version of hardened kernel won‚Äôt even boot after it gets widely deployed - without easy debug - while the debug kernel might actually boot.</p>
</blockquote>
</aside>
<p>If we do decide to extend the dmesg_restrict sysctl, the user can just use superroot and disable the restrictions.</p>
</blockquote>
<p>Kernel patches need to go through <a href="../../../external.html?link=http://kernel.org/">kernel.org</a> upstream or any other<br>
appropriate upstream (hardened-linux) that we can use.</p>
<p>Otherwise I am unfortunately convinced that dmesg (replacements) might<br>
give access to kernel pointer leaks which could then be abused.</p>
<p>Though, no dmesg also means we couldn‚Äôt know if LKRG kills a process or<br>
panics the kernel. Either legitimate or through a false positive. This<br>
is because LKRG communicates through dmesg. I hope we‚Äôre not building<br>
something here which later becomes unusable due to bugs (such as random<br>
poweroff or kernel panic) which nobody can debug since no logs.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-02T11:48:14Z' class='post-time'>
                March 2, 2020, 11:48am
              </time>
              <meta itemprop='dateModified' content='2020-03-02T11:48:14Z'>
          <span itemprop='position'>#428</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>madaidan via Whonix Forum:</p>
<blockquote>
<p><code>CONFIG_EFI_VARS</code> might be good to disable in the host kernel. It exposes a lot of attack surface as it allows you to mess with EFI variables.</p>
<p><a href="../../../external.html?link=https://github.com/torvalds/linux/blob/master/drivers/firmware/efi/Kconfig">https://github.com/torvalds/linux/blob/master/drivers/firmware/efi/Kconfig</a></p>
<p>There have been cases of people bricking their computers by accidentally deleting EFI variables. An attacker might be able to do far more by writing specific things to them.</p>
<p>CLIP OS disables this.</p>
<p><a href="../../../external.html?link=https://github.com/clipos/src_platform_config-linux-hardware/blob/master/kernel_config/blacklist#L60">https://github.com/clipos/src_platform_config-linux-hardware/blob/master/kernel_config/blacklist#L60</a></p>
</blockquote>
<p>Could you please add a ticket to remind ourselves to test the efi vars<br>
config options once we have a few testers using hardened kernel on the<br>
host and EFI?</p>
<blockquote>
<p>There are also the <code>CONFIG_DEV_COREDUMP</code>, <code>CONFIG_WANT_DEV_COREDUMP</code> and <code>CONFIG_ALLOW_DEV_COREDUMP</code> options.</p>
<p><a href="../../../external.html?link=https://github.com/torvalds/linux/blob/master/drivers/base/Kconfig#L92-L114">https://github.com/torvalds/linux/blob/master/drivers/base/Kconfig#L92-L114</a></p>
<p>These seem to add a ‚Äúdevice coredump‚Äù thing regardless of <code>CONFIG_COREDUMP</code> (which we disable).</p>
</blockquote>
<p>I.e. despite our existing coredump disabling settings that is another<br>
vector for coredumps?</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="3" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-02T17:07:05Z' class='post-time'>
                March 2, 2020,  5:07pm
              </time>
              <meta itemprop='dateModified' content='2020-03-02T17:07:05Z'>
          <span itemprop='position'>#429</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="424" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Yes, Clang can be considered. Though, I wouldn‚Äôt know how to make the change</p>
</blockquote>
</aside>
<p>We just need to compile with <code>make CC=clang</code>.</p>
<aside class="quote no-group" data-username="Patrick" data-post="425" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Other kernel parameters could still be changed?</p>
</blockquote>
</aside>
<p>I don‚Äôt know. We‚Äôd need to test.</p>
<aside class="quote no-group" data-username="Patrick" data-post="427" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I hope we‚Äôre not building something here which later becomes unusable due to bugs (such as random poweroff or kernel panic) which nobody can debug since no logs.</p>
</blockquote>
</aside>
<p>We‚Äôll always have the debug/superroot boot modes/kernels.</p>
<aside class="quote no-group" data-username="Patrick" data-post="428" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I.e. despite our existing coredump disabling settings that is another vector for coredumps?</p>
</blockquote>
</aside>
<p>Likely yes, as it‚Äôs not depending on <code>CONFIG_COREDUMP</code>.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-02T17:19:49Z' class='post-time'>
                March 2, 2020,  5:19pm
              </time>
              <meta itemprop='dateModified' content='2020-03-02T17:19:49Z'>
          <span itemprop='position'>#430</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="428" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Could you please add a ticket to remind ourselves to test the efi vars<br>
config options once we have a few testers using hardened kernel on the<br>
host and EFI?</p>
</blockquote>
</aside>
<p><a href="../../../external.html?link=https://phabricator.whonix.org/T967" class="onebox" target="_blank">https://phabricator.whonix.org/T967</a></p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/technonerd'><span itemprop='name'>technonerd</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-04T02:26:10Z' class='post-time'>
                March 4, 2020,  2:26am
              </time>
              <meta itemprop='dateModified' content='2020-03-04T02:26:10Z'>
          <span itemprop='position'>#431</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Attempted to build VM kernel and install on a  EFI kicksecure system and get</p>
<p>mount: /boot/efi: unknown filesystem type ‚Äòvfat‚Äô.</p>
<p>CONFIG_VFAT_FS is not set for vm config but is for the host config.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="3" />
           <span class='post-likes'>3 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-04T11:18:26Z' class='post-time'>
                March 4, 2020, 11:18am
              </time>
              <meta itemprop='dateModified' content='2020-03-04T11:18:26Z'>
          <span itemprop='position'>#432</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>madaidan via Whonix Forum:</p>
<blockquote>
<aside class="quote no-group" data-username="Patrick" data-post="428" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I.e. despite our existing coredump disabling settings that is another vector for coredumps?</p>
</blockquote>
</aside>
<p>Likely yes, as it‚Äôs not depending on <code>CONFIG_COREDUMP</code>.</p>
</blockquote>
<p>Ok, please disable.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-04T13:57:18Z' class='post-time'>
                March 4, 2020,  1:57pm
              </time>
              <meta itemprop='dateModified' content='2020-03-04T13:57:18Z'>
          <span itemprop='position'>#433</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/45" target="_blank">github.com/Whonix/hardened-kernel</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/45" target="_blank">Disable staging drivers</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> ‚Üê <code>madaidan:staging</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-02-21" data-time="18:46:43" data-timezone="UTC">06:46PM - 21 Feb 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/madaidan" target="_blank">
          <img alt="madaidan" src="../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>

      <div class="lines" title="1 commits changed 2 files with 2 additions and 224 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/45/files" target="_blank">
          <span class="added">+2</span>
          <span class="removed">-224</span>
        </a>
      </div>
    </div>

  </div>
</div>
  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>^ Merged.</p>
<p>Not happy with the realtek cards being broken, though. But at least I‚Äôll added these to the wiki so this becomes at least possible to figure out using ‚Äúgoogle‚Äù.</p>
<aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/47" target="_blank">github.com/Whonix/hardened-kernel</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/47" target="_blank">Disable some unneeded drivers</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> ‚Üê <code>madaidan:unneeded</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-02-25" data-time="17:28:52" data-timezone="UTC">05:28PM - 25 Feb 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/madaidan" target="_blank">
          <img alt="madaidan" src="../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>

      <div class="lines" title="5 commits changed 2 files with 45 additions and 921 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/47/files" target="_blank">
          <span class="added">+45</span>
          <span class="removed">-921</span>
        </a>
      </div>
    </div>

  </div>
</div>
  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>^ There is now a merge conflict.</p>
<p>^ Could you please document the devices similar to the ones already documented at <a href="../../../external.html?link=https://www.whonix.org/wiki/Hardened-kernel#Disabled_Devices">https://www.whonix.org/wiki/Hardened-kernel#Disabled_Devices</a>?</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-04T17:57:15Z' class='post-time'>
                March 4, 2020,  5:57pm
              </time>
              <meta itemprop='dateModified' content='2020-03-04T17:57:15Z'>
          <span itemprop='position'>#434</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="technonerd" data-post="431" data-topic="7598" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/t/aeb1de/40.png" class="avatar"> technonerd:</div>
<blockquote>
<p>Attempted to build VM kernel and install on a EFI kicksecure system and get</p>
<p>mount: /boot/efi: unknown filesystem type ‚Äòvfat‚Äô.</p>
<p>CONFIG_VFAT_FS is not set for vm config but is for the host config.</p>
</blockquote>
</aside>
<p>EFI isn‚Äôt supported in VMs. Whonix VMs only support BIOS booting.</p>
<p>No point in enabling a large amount of code barely anyone will be using.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-04T18:44:23Z' class='post-time'>
                March 4, 2020,  6:44pm
              </time>
              <meta itemprop='dateModified' content='2020-03-04T18:44:23Z'>
          <span itemprop='position'>#435</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="433" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>^ There is now a merge conflict.</p>
</blockquote>
</aside>
<p>Created a new PR.</p>
<aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/51" target="_blank">github.com/Whonix/hardened-kernel</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/51" target="_blank">Disable unneeded drivers</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> ‚Üê <code>madaidan:unneeded</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-03-04" data-time="18:44:04" data-timezone="UTC">06:44PM - 04 Mar 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/madaidan" target="_blank">
          <img alt="madaidan" src="../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>

      <div class="lines" title="2 commits changed 2 files with 45 additions and 866 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/51/files" target="_blank">
          <span class="added">+45</span>
          <span class="removed">-866</span>
        </a>
      </div>
    </div>

  </div>
</div>
  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-08T22:18:21Z' class='post-time'>
                March 8, 2020, 10:18pm
              </time>
              <meta itemprop='dateModified' content='2020-03-08T22:18:21Z'>
          <span itemprop='position'>#436</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/52" target="_blank">github.com/Whonix/hardened-kernel</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/52" target="_blank">Update to 4.19.108</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> ‚Üê <code>madaidan:4.19.108</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-03-08" data-time="22:12:20" data-timezone="UTC">10:12PM - 08 Mar 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/madaidan" target="_blank">
          <img alt="madaidan" src="../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>

      <div class="lines" title="1 commits changed 3 files with 7 additions and 5 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/52/files" target="_blank">
          <span class="added">+7</span>
          <span class="removed">-5</span>
        </a>
      </div>
    </div>

  </div>
</div>
  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p><a class="mention" href="../../../external.html?link=https://forums.whonix.org/u/patrick">@Patrick</a> can you maintain the versioning from now on? Updates are frequent and it can take a while for me to update the versions, create a pull request and then for it to get merged which leaves users on an outdated kernel for a while.</p>
<p>You just need to change the <code>version</code> variable in the build script and update the config (there likely won‚Äôt be much change due to us using LTS). You can be notified of new releases by watching the linux-hardened repo: <a href="../../../external.html?link=https://github.com/anthraxx/linux-hardened/watchers">https://github.com/anthraxx/linux-hardened/watchers</a></p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-09T17:48:42Z' class='post-time'>
                March 9, 2020,  5:48pm
              </time>
              <meta itemprop='dateModified' content='2020-03-09T17:48:42Z'>
          <span itemprop='position'>#437</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><a href="../../../external.html?link=https://github.com/a13xp0p0v/kconfig-hardened-check">kconfig-hardened-check</a> and the KSPP <a href="../../../external.html?link=https://kernsec.org/wiki/index.php/Kernel_Self_Protection_Project/Recommended_Settings">recommended kernel settings</a> have both been recently updated but there isn‚Äôt anything relevant to us (as we‚Äôve already done them, they aren‚Äôt in our version or they‚Äôre for clang).</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-11T14:43:13Z' class='post-time'>
                March 11, 2020,  2:43pm
              </time>
              <meta itemprop='dateModified' content='2020-03-11T14:43:13Z'>
          <span itemprop='position'>#438</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="436" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><a class="mention" href="../../../external.html?link=https://forums.whonix.org/u/patrick">@Patrick</a> can you maintain the versioning from now on? Updates are frequent and it can take a while for me to update the versions, create a pull request and then for it to get merged which leaves users on an outdated kernel for a while.</p>
</blockquote>
</aside>
<p>I am not comfortable with hardened-kernel yet. I can‚Äôt give it as much time as it deserves. It‚Äôs still not having the maturity that I‚Äôve set as a goal before recommending it to users of Whonix / Kicksecure. (Comparable to other Whonix packages.) See project status (written just today):<br>
<a href="../../../external.html?link=https://www.whonix.org/wiki/Hardened-kernel#Project_Status">https://www.whonix.org/wiki/Hardened-kernel#Project_Status</a></p>
<p>(And also improved <a href="../../../external.html?link=https://www.whonix.org/wiki/Hardened-kernel">https://www.whonix.org/wiki/Hardened-kernel</a> generally a bit.)</p>
<p>Will take time until these issues are solved.</p>
<p>None of the technical issues are not too hard to solve. Underlying issue are non-technical, lack of time and no current scaling issues of the Whonix project.</p>
<ul>
<li><a href="../linus-doesnt-scale-and-whonix-social-organization-structure-doesnt-scale-yet-either/9097.html" class="inline-onebox">Linus doesn't scale and Whonix social organization structure doesn't scale yet either</a></li>
<li><a href="../focus-on-low-effort-maintainability/9067/2.html" class="inline-onebox">Focus on low-effort maintainability</a></li>
</ul>
<p>Automated test suite:</p>
<ul>
<li>There‚Äôs an automated test suite that focuses on the kernel in development. That would help. Forum thread: <a href="../automated-test-suite/5942.html" class="inline-onebox">automated test suite</a>
</li>
<li>And there‚Äôs also another automated test suite in development which will help too. Forum thread: <a href="../cs-student-capstone-bachelors-senior-project-for-whonix/8821.html" class="inline-onebox">CS Student Capstone (Bachelor's Senior project) for Whonix</a>
</li>
</ul>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-12T19:32:58Z' class='post-time'>
                March 12, 2020,  7:32pm
              </time>
              <meta itemprop='dateModified' content='2020-03-12T19:32:58Z'>
          <span itemprop='position'>#439</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubissue">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/anthraxx/linux-hardened/issues/29" target="_blank">github.com/anthraxx/linux-hardened</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue">
	  <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/anthraxx/linux-hardened/issues/29" target="_blank">Photon OS hardening patches</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-03-12" data-time="19:32:29" data-timezone="UTC">07:32PM - 12 Mar 20 UTC</span>
      </div>


      <div class="user">
        <a href="../../../external.html?link=https://github.com/madaidan" target="_blank">
          <img alt="madaidan" src="../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>
    </div>
  </div>
</div>

<div class="github-row">
  <p class="github-content">VMware's Photon OS includes a few extracted PaX features. MPROTECT, RANDKSTACK and RAP.
https://github.com/vmware/photon/blob/master/SPECS/linux/0001-NOWRITEEXEC-and-PAX-features-MPROTECT-EMUTRAMP.patch
https://github.com/vmware/photon/blob/master/SPECS/linux/0002-Added-PAX_RANDKSTACK.patch
https://github.com/vmware/photon/blob/master/SPECS/linux/0003-Added-rap_plugin.patch
It could be a good idea to include these...</p>
</div>

<div class="labels">
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-16T18:24:38Z' class='post-time'>
                March 16, 2020,  6:24pm
              </time>
              <meta itemprop='dateModified' content='2020-03-16T18:24:38Z'>
          <span itemprop='position'>#440</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="292" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>When APT runs, some script could call the compilation script. And then create a local APT repository. That local APT repository would then be used with APT for proper processing of dependencies and triggers.</p>
</blockquote>
</aside>
<p>If I‚Äôm understanding this right, we can make the build script create <code>${working_folder}/packages</code>, then move all the .debs there after compilation:</p>
<pre><code class="lang-auto">packages_folder="${working_folder}/packages"

if ! [ -d "${packages_folder}" ]; then
  mkdir "${packages_folder}"
fi

mv "${extracted_linux_kernel_sources_folder}/../linux-libc-dev_${version}-rt24-1_amd64.deb" "${packages_folder}/${kernel_config}-libc.deb"
mv "${extracted_linux_kernel_sources_folder}/../linux-headers-${version}-rt24_${version}-rt24-1_amd64.deb" "${packages_folder}/${kernel_config}-headers.deb"
mv "${extracted_linux_kernel_sources_folder}/../linux-image-${version}-rt24_${version}-rt24-1_amd64.deb"  "${packages_folder}/${kernel_config}.deb"
</code></pre>
<p><code>/etc/apt/sources.list.d/hardened-kernel-local.list</code> would then contain:</p>
<pre><code class="lang-auto">deb [trusted=yes] file:/var/lib/hardened-kernel/hardened-vm-kernel/packages local main contrib non-free
deb [trusted=yes] file:/var/lib/hardened-kernel/hardened-host-kernel/packages local main contrib non-free
</code></pre>
<p>We then run <code>apt update</code> and install the kernel image via <code>apt install</code>? e.g.</p>
<pre><code class="lang-auto">apt update
apt install hardened-vm-kernel hardened-vm-kernel-headers hardened-vm-kernel-libc
</code></pre>
<p>Am I getting this right?</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-16T18:43:22Z' class='post-time'>
                March 16, 2020,  6:43pm
              </time>
              <meta itemprop='dateModified' content='2020-03-16T18:43:22Z'>
          <span itemprop='position'>#441</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="440" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>If I‚Äôm understanding this right, we can make the build script create <code>${working_folder}/packages</code> , then move all the .debs there after compilation:</p>
</blockquote>
</aside>
<p>Probably yes.</p>
<aside class="quote no-group" data-username="madaidan" data-post="440" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><code>/etc/apt/sources.list.d/hardened-kernel-local.list</code> would then contain:</p>
<pre><code class="lang-auto">deb [trusted=yes] file:/var/lib/hardened-kernel/hardened-vm-kernel/packages local main contrib non-free
deb [trusted=yes] file:/var/lib/hardened-kernel/hardened-host-kernel/packages local main contrib non-free
</code></pre>
</blockquote>
</aside>
<p>Yes but that folder cannot just contain packages as far as I know. It needs to be in a file structure that apt understands. I.e. APT repository metadata. To be created with <code>reprepro</code>.</p>
<aside class="quote no-group" data-username="madaidan" data-post="440" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>We then run <code>apt update</code> and install the kernel image via <code>apt install</code> ? e.g.</p>
<pre><code class="lang-auto">apt update
apt install hardened-vm-kernel hardened-vm-kernel-headers hardened-vm-kernel-libc
</code></pre>
<p>Am I getting this right?</p>
</blockquote>
</aside>
<p>Not sure this was thought or intended to say, just mentioning in case: by changing the filename such as <code>linux-image-${version}-rt24_${version}-rt24-1_amd64.deb</code> to <code>hardened-vm-kernel.deb</code> actually nothing happens. apt does ‚Äúnot much‚Äù use the file name for anything. The name of the package is derived from the Debian package metadata (<code>/debian</code> folder).</p>
<p>Getting <code>apt</code> to act on <code>sudo apt install hardened-vm-kernel</code> requries the Debian package metadata to use <code>Package: hardened-vm-kernel</code> somewhere. I don‚Äôt know yet how the Debian packaging of linux kernel works yet. Usually for packages (from <a href="../../../external.html?link=http://packages.debian.org/">packages.debian.org</a>) other than linux there is a <code>/debian</code> folder in the source code repository that contains all Debian packaging related files. In case of the linux kernel it seems like that <code>make deb-pkg</code> somehow auto generates that <code>/debian</code> folder during the build process. I wouldn‚Äôt know the best approach yet.</p>
<ul>
<li>Perhaps build the kernel image without using <code>make deb-pkg</code> and then use a <code>/debian</code> folder based on Debian‚Äôs <a href="../../../external.html?link=https://salsa.debian.org/kernel-team/linux">https://salsa.debian.org/kernel-team/linux</a> <code>/debian</code> folder (I speculate that one is better), or</li>
<li>Hack the environment variables / autogeneration code of Linux‚Äôs upstream <code>make deb-pkg</code>. (I speculate this way is worse.)</li>
</ul>
<p>That auto generated <code>/debian</code> folder may or may not differ from the <code>/debian</code> folder for linux-image from <a href="../../../external.html?link=http://packages.debian.org/">packages.debian.org</a>.</p>
<p>For educational / development / debugging purposes I‚Äôd suggest to experiment with packaging something easy first such as the <a href="../../../external.html?link=https://packages.debian.org/buster/hello">hello</a> package. Building that package from source. Maybe adding that package to a local APT repository. Other ‚Äúeasily‚Äù packaged packages might be genmkfile, helper-scripts, kloak, lkrg. (The software itself might be complex but the packaging process wasn‚Äôt the most hard level.)</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-16T18:51:59Z' class='post-time'>
                March 16, 2020,  6:51pm
              </time>
              <meta itemprop='dateModified' content='2020-03-16T18:51:59Z'>
          <span itemprop='position'>#442</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="441" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>In case of the linux kernel it seems like that <code>make deb-pkg</code> somehow auto generates that <code>/debian</code> folder during the build process. I wouldn‚Äôt know the best approach yet.</p>
<ul>
<li>Perhaps build the kernel image without using <code>make deb-pkg</code> and then use a <code>/debian</code> folder based on Debian‚Äôs <a href="../../../external.html?link=https://salsa.debian.org/kernel-team/linux">https://salsa.debian.org/kernel-team/linux</a> <code>/debian</code> folder (I speculate that one is better), or</li>
<li>Hack the environment variables / autogeneration code of Linux‚Äôs upstream <code>make deb-pkg</code> . (I speculate this way is worse.)</li>
</ul>
</blockquote>
</aside>
<p>Can‚Äôt we just unpack the deb, edit it, then re-pack it?</p>
<p>e.g.:</p>
<pre><code class="lang-auto">ar x "${packages_folder}/${kernel_config}.deb"
tar xf "${packages_folder}/control.tar.xz"
str_replace "..." "..." "${packages_folder}/control"
tar cf ... ...
ar m ... ...</code></pre>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-16T21:24:29Z' class='post-time'>
                March 16, 2020,  9:24pm
              </time>
              <meta itemprop='dateModified' content='2020-03-16T21:24:29Z'>
          <span itemprop='position'>#443</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubissue">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/anthraxx/linux-hardened/issues/30" target="_blank">github.com/anthraxx/linux-hardened</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue">
	  <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/anthraxx/linux-hardened/issues/30" target="_blank">Backporting security features to LTS kernels</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-03-16" data-time="21:23:56" data-timezone="UTC">09:23PM - 16 Mar 20 UTC</span>
      </div>


      <div class="user">
        <a href="../../../external.html?link=https://github.com/madaidan" target="_blank">
          <img alt="madaidan" src="../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>
    </div>
  </div>
</div>

<div class="github-row">
  <p class="github-content">Stable kernels have various security features that LTS kernels don't have such as lockdown, SafeSetID, page allocator freelist randomization, init_on_alloc etc....</p>
</div>

<div class="labels">
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="7598e4a7.html?page=21">‚Üê previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="759889ae.html?page=23">next page ‚Üí</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

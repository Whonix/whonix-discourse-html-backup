<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>kernel recompilation for better hardening - #497 by Patrick - Development - Whonix Forum</title>
    <meta name="description" content="https://docs.clip-os.org/clipos/kernel.html 


These both look interesting. They’re mainly for kernel compile options though. 
Is there any way to build Whonix with custom kernel configurations? Or will kernels have to b&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../75988c06.html?page=25" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;kernel recompilation for better hardening&#39;" href="../7598.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/kernel-recompilation-for-better-hardening/7598/497" />
<meta name="twitter:url" content="https://forums.whonix.org/t/kernel-recompilation-for-better-hardening/7598/497" />
<meta property="og:title" content="kernel recompilation for better hardening" />
<meta name="twitter:title" content="kernel recompilation for better hardening" />
<meta property="og:description" content="Probably should not break CPU temperature control. Related:" />
<meta name="twitter:description" content="Probably should not break CPU temperature control. Related:" />
<meta property="article:published_time" content="2020-11-14T19:47:41+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="../75981d82.html?page=24">
        <link rel="next" href="../759819d2.html?page=26">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../7598.html">kernel recompilation for better hardening</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../../tag/component_security.html' class='discourse-tag' rel="tag">component_security</a>, 
            <a href='../../../tag/status_open_issue_todo.html' class='discourse-tag' rel="tag">status_open_issue_todo</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/jonathanvlan'><span itemprop='name'>jonathanvlan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-06-17T16:46:54Z' class='post-time'>
                June 17, 2020,  4:46pm
              </time>
              <meta itemprop='dateModified' content='2020-06-17T16:46:54Z'>
          <span itemprop='position'>#492</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>hi guys , mentioned about IMA Integrity Measurement Architecture<br>
allows greater security , can be automated with one click ,</p>
<p>kernel &gt; ima_policy=appraise_tcb ima_appraise=fix ima_policy=tcb ima_hash=sha512 evm=fix</p>
<p>Debian project, with ima-evm, whonix could include this security<br>
</p><aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://a.fsdn.com/con/img/sandiego/logo-180x180.png" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://sourceforge.net/projects/unknownos/" target="_blank" rel="nofollow noopener">SourceForge</a>
  </header>
  <article class="onebox-body">
    <img src="../../../../external.html?link=https://a.fsdn.com/allura/p/unknownos/icon?1592373194" class="thumbnail onebox-avatar" width="48" height="48">

<h3><a href="../../../../external.html?link=https://sourceforge.net/projects/unknownos/" target="_blank" rel="nofollow noopener">Unknown_</a></h3>

<p>Download Unknown_ for free.  It is a privacy and security project, evading zero-day attacks with a new methodology in cybersecurity. The system is advanced anti forence

Security /
Kernel Random &gt; Security Kernel &gt;  Apparmor | IMA -EVM &gt;...</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>
          <meta itemprop='keywords' content='component_security, status_open_issue_todo'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-06-25T18:07:41Z' class='post-time'>
                June 25, 2020,  6:07pm
              </time>
              <meta itemprop='dateModified' content='2020-06-25T18:07:41Z'>
          <span itemprop='position'>#493</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox twitterstatus">
  <header class="source">
      <a href="../../../../external.html?link=https://twitter.com/spendergrsec/status/1276107106383527936" target="_blank">twitter.com</a>
  </header>
  <article class="onebox-body">
    <img src="../../../../external.html?link=https://pbs.twimg.com/profile_images/1229103528595148802/jdWjVA4k_400x400.jpg" class="thumbnail onebox-avatar" width="60" height="60">

<h4><a href="../../../../external.html?link=https://twitter.com/spendergrsec/status/1276107106383527936" target="_blank">Brad Spengler (spendergrsec)</a></h4>

<div class="tweet"> In my presentation I mention that KSPP work is rarely backported to earlier kernels, sometimes that can be a good thing: <a target="_blank" href="../../../../external.html?link=https://twitter.com/grsecurity/status/1276106234849038337">twitter.com/grsecurity/sta…</a><div class="quoted">
<a class="quoted-link" href="../../../../external.html?link=https://twitter.com/grsecurity/status/1276106234849038337"><p class="quoted-title">grsecurity <span>@grsecurity</span></p></a><div>Our new kernel heap exploitation defense (AUTOSLAB) not only discovered a vulnerability in a KSPP-introduced mitigation that saw a recent fix attempt, but also provided useful metadata to zero in on the culprit: 74ca3fea49711ff4de595297ce2fc148e33441495d9e852c2c35e7584f3effab</div>
</div>
</div>

<div class="date">
  <a href="../../../../external.html?link=https://twitter.com/spendergrsec/status/1276107106383527936" target="_blank">10:56 AM - 25 Jun 2020</a>
    <span class="retweet">
      <svg viewBox="0 0 640 512" width="14px" height="16px" aria-hidden="true">
        <path d="M629.657 343.598L528.971 444.284c-9.373 9.372-24.568 9.372-33.941 0L394.343 343.598c-9.373-9.373-9.373-24.569 0-33.941l10.823-10.823c9.562-9.562 25.133-9.34 34.419.492L480 342.118V160H292.451a24.005 24.005 0 0 1-16.971-7.029l-16-16C244.361 121.851 255.069 96 276.451 96H520c13.255 0 24 10.745 24 24v222.118l40.416-42.792c9.285-9.831 24.856-10.054 34.419-.492l10.823 10.823c9.372 9.372 9.372 24.569-.001 33.941zm-265.138 15.431A23.999 23.999 0 0 0 347.548 352H160V169.881l40.416 42.792c9.286 9.831 24.856 10.054 34.419.491l10.822-10.822c9.373-9.373 9.373-24.569 0-33.941L144.971 67.716c-9.373-9.373-24.569-9.373-33.941 0L10.343 168.402c-9.373 9.373-9.373 24.569 0 33.941l10.822 10.822c9.562 9.562 25.133 9.34 34.419-.491L96 169.881V392c0 13.255 10.745 24 24 24h243.549c21.382 0 32.09-25.851 16.971-40.971l-16.001-16z"></path>
      </svg> 1
    </span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-07-29T13:44:54Z' class='post-time'>
                July 29, 2020,  1:44pm
              </time>
              <meta itemprop='dateModified' content='2020-07-29T13:44:54Z'>
          <span itemprop='position'>#494</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><a href="../../../../external.html?link=https://www.phoronix.com/scan.php?page=news_item&amp;px=Sony-Lock-Up-DebugFS" class="onebox" target="_blank">https://www.phoronix.com/scan.php?page=news_item&amp;px=Sony-Lock-Up-DebugFS</a></p>
<p>Sony contributes more safeguards against debugFS abuse from userland. The KConf becomes effective in more modern versions.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-09-04T18:26:00Z' class='post-time'>
                September 4, 2020,  6:26pm
              </time>
              <meta itemprop='dateModified' content='2020-09-04T18:26:00Z'>
          <span itemprop='position'>#495</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/clipos/src_platform_config-linux-hardware/commit/49ec71b4203f369b06c9a0175076d67434133639" target="_blank" rel="nofollow noopener">github.com/clipos/src_platform_config-linux-hardware</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/clipos/src_platform_config-linux-hardware/commit/49ec71b4203f369b06c9a0175076d67434133639" target="_blank" rel="nofollow noopener">kernel_config: Remove memory hotplug support</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-06-08" data-time="08:47:58" data-timezone="UTC">08:47AM - 08 Jun 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/tsautereau-anssi" target="_blank" rel="nofollow noopener">
          <img alt="tsautereau-anssi" src="../../../../external.html?link=https://avatars2.githubusercontent.com/u/42802201?v=4" class="onebox-avatar-inline" width="20" height="20">
          tsautereau-anssi
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 1 additions and 6 deletions">
        <a href="../../../../external.html?link=https://github.com/clipos/src_platform_config-linux-hardware/commit/49ec71b4203f369b06c9a0175076d67434133639" target="_blank" rel="nofollow noopener">
          <span class="added">+1</span>
          <span class="removed">-6</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">We don't use that and it makes memory management code much more complex.
Change-Id: I07952f925ec8d046b60554ac717bbc86a652352a
Signed-off-by: Thibaut Sautereau &lt;thibaut.sautereau@ssi.gouv.fr&gt;</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/clipos/src_platform_config-linux-hardware/commit/7315f461f34bd25c597e436328fab04faf2d082b" target="_blank" rel="nofollow noopener">github.com/clipos/src_platform_config-linux-hardware</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/clipos/src_platform_config-linux-hardware/commit/7315f461f34bd25c597e436328fab04faf2d082b" target="_blank" rel="nofollow noopener">kernel_config: Blacklist ACPI Windows Management Instrumentation support</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-06-08" data-time="08:45:50" data-timezone="UTC">08:45AM - 08 Jun 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/tsautereau-anssi" target="_blank" rel="nofollow noopener">
          <img alt="tsautereau-anssi" src="../../../../external.html?link=https://avatars2.githubusercontent.com/u/42802201?v=4" class="onebox-avatar-inline" width="20" height="20">
          tsautereau-anssi
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 2 additions and 1 deletions">
        <a href="../../../../external.html?link=https://github.com/clipos/src_platform_config-linux-hardware/commit/7315f461f34bd25c597e436328fab04faf2d082b" target="_blank" rel="nofollow noopener">
          <span class="added">+2</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">Change-Id: I4fae84950bd254306318a7df70bf000cc8a58740
Signed-off-by: Thibaut Sautereau &lt;thibaut.sautereau@ssi.gouv.fr&gt;</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-11-14T19:23:23Z' class='post-time'>
                November 14, 2020,  7:23pm
              </time>
              <meta itemprop='dateModified' content='2020-11-14T19:23:23Z'>
          <span itemprop='position'>#496</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox pdf">
  <header class="source">
      <a href="../../../../external.html?link=https://platypusattack.com/platypus.pdf" target="_blank" rel="nofollow noopener">platypusattack.com</a>
  </header>
  <article class="onebox-body">
    <a href="../../../../external.html?link=https://platypusattack.com/platypus.pdf" target="_blank" rel="nofollow noopener"><span class="pdf-onebox-logo"></span></a>
<h3><a href="../../../../external.html?link=https://platypusattack.com/platypus.pdf" target="_blank" rel="nofollow noopener">platypus.pdf</a></h3>

<p class="filesize">556.55 KB</p>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>We’ve already mitigated exploiting this by non-kernel attackers via apparmor-profile-everything and hide-hardware-info’s sysfs restrictions. However, we can also disable</p>
<pre><code class="lang-auto">CONFIG_INTEL_RAPL
CONFIG_PERF_EVENTS_INTEL_RAPL
</code></pre>
<p>in the kernel configuration. We could probably disable the entire powercap interface as future-proofing against other variations of this type of sidechannel attack but this may be too extreme and hurt usability (depending on how frequently it’s used, I’m not sure).</p>
<aside class="onebox githubblob">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/anthraxx/linux-hardened/blob/4.19/drivers/powercap/Kconfig" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="../../../../external.html?link=https://github.com/anthraxx/linux-hardened/blob/4.19/drivers/powercap/Kconfig" target="_blank" rel="nofollow noopener">anthraxx/linux-hardened/blob/4.19/drivers/powercap/Kconfig</a></h4>
<pre><code class="lang-">#
# Generic power capping sysfs interface configuration
#

menuconfig POWERCAP
	bool "Generic powercap sysfs driver"
	help
	  The power capping sysfs interface allows kernel subsystems to expose power
	  capping settings to user space in a consistent way.  Usually, it consists
	  of multiple control types that determine which settings may be exposed and
	  power zones representing parts of the system that can be subject to power
	  capping.

	  If you want this code to be compiled in, say Y here.

if POWERCAP
# Client driver configurations go here.
config INTEL_RAPL
	tristate "Intel RAPL Support"
	depends on X86 &amp;&amp; IOSF_MBI
</code></pre>

  This file has been truncated. <a href="../../../../external.html?link=https://github.com/anthraxx/linux-hardened/blob/4.19/drivers/powercap/Kconfig" target="_blank" rel="nofollow noopener">show original</a>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-11-14T19:47:41Z' class='post-time'>
                November 14, 2020,  7:47pm
              </time>
              <meta itemprop='dateModified' content='2020-11-14T19:47:41Z'>
          <span itemprop='position'>#497</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Probably should not break CPU temperature control. Related:</p>
<aside class="quote quote-modified" data-post="1" data-topic="10397">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="../../disabling-cpu-msrs-breaks-cpu-temperature-control/10397.html">disabling CPU MSRs breaks CPU temperature control</a> <a class="badge-wrapper  bullet" href="../../../c/development/8.html"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    Disabling CPU MSRs is OK in VMs (where it probably does nothing except getting rid of a kernel module) but problematic on the host in context of a host running Kicksecure or Whonix-Host. 
It breaks CPU temperature control. A high(er) than expected CPU temperature might wear down the CPU more quickly. Also spend more energy than expected (this might be more important in large scale deployments such as servers farms). 
<a href="../../../../external.html?link=https://packages.debian.org/bullseye/powercap-utils" class="onebox" target="_blank">https://packages.debian.org/bullseye/powercap-utils</a> 
sudo apt install linux-cpu…
  </blockquote>
</aside>

        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-11-14T20:53:51Z' class='post-time'>
                November 14, 2020,  8:53pm
              </time>
              <meta itemprop='dateModified' content='2020-11-14T20:53:51Z'>
          <span itemprop='position'>#498</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>GrapheneOS now enables CONFIG_FORTIFY_SOURCE_STRICT_STRING in production builds:</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/GrapheneOS/kernel_google_crosshatch/commit/69efa800e441cce5e67df39dd10f0f4a91c8309b" target="_blank" rel="nofollow noopener">github.com/GrapheneOS/kernel_google_crosshatch</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/GrapheneOS/kernel_google_crosshatch/commit/69efa800e441cce5e67df39dd10f0f4a91c8309b" target="_blank" rel="nofollow noopener">enable FORTIFY_SOURCE_STRICT_STRING</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-08-19" data-time="20:11:29" data-timezone="UTC">08:11PM - 19 Aug 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/thestinger" target="_blank" rel="nofollow noopener">
          <img alt="thestinger" src="../../../../external.html?link=https://avatars1.githubusercontent.com/u/1505226?v=4" class="onebox-avatar-inline" width="20" height="20">
          thestinger
        </a>
        
      </div>

      <div class="lines" title="changed 3 files with 3 additions and 0 deletions">
        <a href="../../../../external.html?link=https://github.com/GrapheneOS/kernel_google_crosshatch/commit/69efa800e441cce5e67df39dd10f0f4a91c8309b" target="_blank" rel="nofollow noopener">
          <span class="added">+3</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">Signed-off-by: anupritaisno1 &lt;www.anuprita804@gmail.com&gt;</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>This is a feature from linux-hardened that I added back to GrapheneOS which makes the FORTIFY_SOURCE feature more strict and better at catching buffer overflows but it wasn’t intended for use in end-user builds, only for bug finding as it can cause false positives so I didn’t enable it before.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/anthraxx/linux-hardened/commit/d4ec31960e637b2839936080348728ead13982e7" target="_blank" rel="nofollow noopener">github.com/anthraxx/linux-hardened</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/anthraxx/linux-hardened/commit/d4ec31960e637b2839936080348728ead13982e7" target="_blank" rel="nofollow noopener">FORTIFY_SOURCE intra-object overflow checking</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2017-06-03" data-time="21:34:13" data-timezone="UTC">09:34PM - 03 Jun 17 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/thestinger" target="_blank" rel="nofollow noopener">
          <img alt="thestinger" src="../../../../external.html?link=https://avatars1.githubusercontent.com/u/1505226?v=4" class="onebox-avatar-inline" width="20" height="20">
          thestinger
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 26 additions and 10 deletions">
        <a href="../../../../external.html?link=https://github.com/anthraxx/linux-hardened/commit/d4ec31960e637b2839936080348728ead13982e7" target="_blank" rel="nofollow noopener">
          <span class="added">+26</span>
          <span class="removed">-10</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">This adds supporting for detecting buffer overflows from inner objects
for the fortified string family functions. It's comparable to the
_FORTIFY_SOURCE=2 feature in...</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>We should test enabling this too and see if it works. CLIP OS only enables it in debug builds.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-04T16:53:18Z' class='post-time'>
                December 4, 2020,  4:53pm
              </time>
              <meta itemprop='dateModified' content='2020-12-04T16:53:18Z'>
          <span itemprop='position'>#499</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote quote-modified" data-post="4" data-topic="10643">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/s/a4c791/40.png" class="avatar">
    <a href="../../error-with-hardened-kernel-script-in-kicksecure-debian/10643/4.html">Error with hardened-kernel script in Kicksecure Debian</a> <a class="badge-wrapper  bullet" href="../../../c/support/5.html"><span class="badge-category-bg" style="background-color: #8C6238;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="User support for the Whonix operating system. (devs)">Support</span></a>
  </div>
  <blockquote>
    I’m running “sudo bash /usr/share/hardened-kernel/build --host” right now on a fresh install of Kicksecure running just base apps and KVM. 
Here is the log: 
sudo bash /usr/share/hardened-kernel/build --host 
[sudo] password for user: 
set -e
:
case $1 in
kernel_config=hardened-host-kernel
shift
:
case $1 in
break
‘[’ hardened-host-kernel = ‘’ ‘]’
+++ dirname /usr/share/hardened-kernel/build
++ cd /usr/share/hardened-kernel
++ pwd
MYDIR=/usr/share/hardened-kernel
whoami
root
env
SHELL=/bin/bash
…
  </blockquote>
</aside>

        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-05T23:39:47Z' class='post-time'>
                December 5, 2020, 11:39pm
              </time>
              <meta itemprop='dateModified' content='2020-12-05T23:39:47Z'>
          <span itemprop='position'>#500</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>GCC plugins (including STRUCTLEAK, STACKLEAK, RANDSTRUCT and others) may get removed because upstream is being pedantic about a <em>single second</em> difference.</p>
<aside class="onebox twitterstatus">
  <header class="source">
      <a href="../../../../external.html?link=https://twitter.com/spendergrsec/status/1335214997887180800" target="_blank" rel="noopener nofollow ugc">twitter.com</a>
  </header>
  <article class="onebox-body">
    <img src="../../../../external.html?link=https://pbs.twimg.com/profile_images/1229103528595148802/jdWjVA4k_400x400.jpg" class="thumbnail onebox-avatar" width="60" height="60">

<h4><a href="../../../../external.html?link=https://twitter.com/spendergrsec/status/1335214997887180800" target="_blank" rel="noopener nofollow ugc">Brad Spengler (spendergrsec)</a></h4>

<div class="tweet"> Upstream maintenance: "it's taking me one 1.5 seconds to generate a config instead of 0.5 seconds, we should remove all the GCC plugins" <a target="_blank" href="../../../../external.html?link=https://lkml.org/lkml/2020/11/28/207" rel="noopener nofollow ugc">lkml.org/lkml/2020/11/2…</a></div>

<div class="date">
  <a href="../../../../external.html?link=https://twitter.com/spendergrsec/status/1335214997887180800" target="_blank" rel="noopener nofollow ugc">1:30 PM - 5 Dec 2020</a>
    <span class="like">
      <svg viewBox="0 0 512 512" width="14px" height="16px" aria-hidden="true">
        <path d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"></path>
      </svg> 4
    </span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://lkml.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://lkml.org/lkml/2020/11/28/207" target="_blank" rel="noopener nofollow ugc">lkml.org</a>
  </header>
  <article class="onebox-body">
    <img src="#" class="thumbnail" width="60" height="60">

<h3><a href="../../../../external.html?link=https://lkml.org/lkml/2020/11/28/207" target="_blank" rel="noopener nofollow ugc">LKML: Linus Torvalds: Re: [GIT PULL 2/2] Kconfig updates for v5.10-rc1</a></h3>



  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://lkml.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://lkml.org/lkml/2020/12/1/1832" target="_blank" rel="noopener nofollow ugc">lkml.org</a>
  </header>
  <article class="onebox-body">
    <img src="#" class="thumbnail" width="60" height="60">

<h3><a href="../../../../external.html?link=https://lkml.org/lkml/2020/12/1/1832" target="_blank" rel="noopener nofollow ugc">LKML: Kees Cook: Re: [GIT PULL 2/2] Kconfig updates for v5.10-rc1</a></h3>



  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Of course Linux maintains century old drivers that nobody ever uses but when it comes to actually important security features, they get rid of them at any chance they get. This is ridiculous and quite worrying.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-07T15:46:34Z' class='post-time'>
                December 7, 2020,  3:46pm
              </time>
              <meta itemprop='dateModified' content='2020-12-07T15:46:34Z'>
          <span itemprop='position'>#501</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I am baffled by Kees’ reply who’s supposed to be the checks and balance on stupid stuff like that.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-13T17:36:31Z' class='post-time'>
                December 13, 2020,  5:36pm
              </time>
              <meta itemprop='dateModified' content='2020-12-13T17:36:31Z'>
          <span itemprop='position'>#502</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/55" target="_blank" rel="noopener nofollow ugc">github.com/Whonix/hardened-kernel</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/55" target="_blank" rel="noopener nofollow ugc">Fix issue with compiling host kernel</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> ← <code>madaidan:system_trusted_keys</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-12-13" data-time="17:33:38" data-timezone="UTC">05:33PM - 13 Dec 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/madaidan" target="_blank" rel="noopener nofollow ugc">
          <img alt="madaidan" src="../../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>

      <div class="lines" title="1 commits changed 1 files with 1 additions and 1 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/55/files" target="_blank" rel="noopener nofollow ugc">
          <span class="added">+1</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>

  </div>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-14T07:26:49Z' class='post-time'>
                December 14, 2020,  7:26am
              </time>
              <meta itemprop='dateModified' content='2020-12-14T07:26:49Z'>
          <span itemprop='position'>#503</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Merged and uploaded to all repositories.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-21T11:10:54Z' class='post-time'>
                December 21, 2020, 11:10am
              </time>
              <meta itemprop='dateModified' content='2020-12-21T11:10:54Z'>
          <span itemprop='position'>#504</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>CI build failing.</p>
<ul>
<li><a href="../../../../external.html?link=https://travis-ci.com/github/Whonix/hardened-kernel">https://travis-ci.com/github/Whonix/hardened-kernel</a></li>
<li><a href="../../../../external.html?link=https://api.travis-ci.com/v3/job/463218766/log.txt">https://api.travis-ci.com/v3/job/463218766/log.txt</a></li>
</ul>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-21T19:42:12Z' class='post-time'>
                December 21, 2020,  7:42pm
              </time>
              <meta itemprop='dateModified' content='2020-12-21T19:42:12Z'>
          <span itemprop='position'>#505</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I can’t tell what’s causing this. Can you?</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-21T20:47:31Z' class='post-time'>
                December 21, 2020,  8:47pm
              </time>
              <meta itemprop='dateModified' content='2020-12-21T20:47:31Z'>
          <span itemprop='position'>#506</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Happening when using <code>--debug</code> with environment variable <code>CI=true</code> being set.</p>
<pre><code>+ true 'Sanity test. '\''make oldconfig'\'' should not modify '\''.config'\''.'
+ true https://forums.whonix.org/t/kernel-recompilation-for-better-hardening/7598/317
+ make oldconfig -C /var/lib/hardened-kernel/hardened-vm-kernel/linux-4.19.122/
...
+ diff /home/travis/build/Whonix/hardened-kernel/usr/share/hardened-kernel/hardened-vm-kernel /var/lib/hardened-kernel/hardened-vm-kernel/linux-4.19.122//.config
</code></pre>
<p><code>diff</code> then exits non-zero.</p>
<p>See the diff.</p>
<pre><code>diff /home/travis/build/Whonix/hardened-kernel/usr/share/hardened-kernel/hardened-vm-kernel /var/lib/hardened-kernel/hardened-vm-kernel/linux-4.19.122//.config
</code></pre>
<p>.</p>
<pre><code>&gt; # CONFIG_GENERIC_IRQ_DEBUGFS is not set
286a288
&gt; # CONFIG_IOSF_MBI_DEBUG is not set
292a295
&gt; # CONFIG_QUEUED_LOCK_STAT is not set
300a304
&gt; # CONFIG_XEN_DEBUG_FS is not set
302a307
&gt; # CONFIG_KVM_DEBUG_FS is not set
344a350
&gt; # CONFIG_X86_MCE_INJECT is not set
488a495
&gt; # CONFIG_ACPI_CUSTOM_METHOD is not set
496a504
&gt; # CONFIG_ACPI_APEI_EINJ is not set
685c693
&lt; # CONFIG_KPROBES is not set
---
&gt; CONFIG_KPROBES=y
687a696
&gt; CONFIG_OPTPROBES=y
689a699
&gt; CONFIG_KRETPROBES=y
758a769
&gt; # CONFIG_GCOV_KERNEL is not set
802a814,815
&gt; CONFIG_BLK_DEBUG_FS=y
&gt; CONFIG_BLK_DEBUG_FS_ZONED=y
1500a1514
&gt; # CONFIG_ZRAM_MEMORY_TRACKING is not set
2079a2094
&gt; # CONFIG_NETDEVSIM is not set
3718a3734
&gt; # CONFIG_SW_SYNC is not set
3895a3912
&gt; # CONFIG_IOMMU_DEBUGFS is not set
3989a4007
&gt; # CONFIG_RAS_CEC is not set
4019a4038
&gt; # CONFIG_INTEL_TH_DEBUG is not set
4616a4636
&gt; # CONFIG_DYNAMIC_DEBUG is not set
4632c4652
&lt; # CONFIG_DEBUG_FS is not set
---
&gt; CONFIG_DEBUG_FS=y
4733a4754
&gt; CONFIG_FUNCTION_ERROR_INJECTION=y
4749a4771
&gt; # CONFIG_LKDTM is not set
4751a4774
&gt; # CONFIG_KPROBES_SANITY_TEST is not set
4808a4832
&gt; # CONFIG_DEBUG_BOOT_PARAMS is not set
</code></pre>
<p>That should not be happening.</p>
<p>Running</p>
<pre><code>make oldconfig -C "$extracted_linux_kernel_sources_folder"
</code></pre>
<p>should not be modifying <code>"$extracted_linux_kernel_sources_folder/.config"</code> <code>"${MYDIR}/${kernel_config}"</code> should already be in a state where a later <code>make oldconfig</code> would do nothing. That is to make the process “less magic”. Less auto generated. Easier to review. More predictable. Allow reviewers to review to full kernel configuration. No implicit filling the blanks during compilation. Solution? Run <code>make oldconfig</code> yourself, review, and update config in git. Make <code>make oldconfig</code> out of work.</p>
<p>Build history reveals that this is only happening since <a href="../../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/55">https://github.com/Whonix/hardened-kernel/pull/55</a> was merged.</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://cdn.travis-ci.com/images/favicon-076a22660830dc325cc8ed70e7146a59.png" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://travis-ci.com/github/Whonix/hardened-kernel/builds" target="_blank" rel="noopener">travis-ci.com</a>
  </header>
  <article class="onebox-body">
    <img src="#" class="thumbnail" width="16" height="16">

<h3><a href="../../../../external.html?link=https://travis-ci.com/github/Whonix/hardened-kernel/builds" target="_blank" rel="noopener">Travis CI - Test and Deploy with Confidence</a></h3>



  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>But I don’t see how that pull request could have caused that since it’s opt in and not used on CI.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-21T21:02:05Z' class='post-time'>
                December 21, 2020,  9:02pm
              </time>
              <meta itemprop='dateModified' content='2020-12-21T21:02:05Z'>
          <span itemprop='position'>#507</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="506" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>should not be modifying <code>"$extracted_linux_kernel_sources_folder/.config"</code> <code>"${MYDIR}/${kernel_config}"</code> should already be in a state where a later <code>make oldconfig</code> would do nothing. That is to make the process “less magic”. Less auto generated. Easier to review. More predictable. Allow reviewers to review to full kernel configuration. No implicit filling the blanks during compilation. Solution? Run <code>make oldconfig</code> yourself, review, and update config in git. Make <code>make oldconfig</code> out of work.</p>
</blockquote>
</aside>
<p>The sanity check runs after the kprobes/ftrace configs are appended: <a href="../../../../external.html?link=https://github.com/Whonix/hardened-kernel/blob/629b62475455ce5ef073e6ba8b970ea76ade88a0/usr/share/hardened-kernel/build#L109" rel="noopener nofollow ugc">https://github.com/Whonix/hardened-kernel/blob/629b62475455ce5ef073e6ba8b970ea76ade88a0/usr/share/hardened-kernel/build#L109</a></p>
<p><code>make oldconfig</code> will then shift those configs about to put them in the correct order in the full file. The sanity test must run before those options are added.</p>
<aside class="quote no-group" data-username="Patrick" data-post="506" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Build history reveals that this is only happening since <a href="../../../../external.html?link=https://github.com/Whonix/hardened-kernel/pull/55" rel="noopener nofollow ugc">https://github.com/Whonix/hardened-kernel/pull/55</a> was merged.</p>
</blockquote>
</aside>
<p>The build for that passed though? It seems to fail because of <a href="../../../../external.html?link=https://github.com/Whonix/hardened-kernel/commit/629b62475455ce5ef073e6ba8b970ea76ade88a0" rel="noopener nofollow ugc">https://github.com/Whonix/hardened-kernel/commit/629b62475455ce5ef073e6ba8b970ea76ade88a0</a></p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-22T13:10:03Z' class='post-time'>
                December 22, 2020,  1:10pm
              </time>
              <meta itemprop='dateModified' content='2020-12-22T13:10:03Z'>
          <span itemprop='position'>#508</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="507" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>The sanity check runs after the kprobes/ftrace configs are appended</p>
</blockquote>
</aside>
<p>Indeed.</p>
<p>That sanity test runs <code>if [ "$debug" = "true" ]; then</code>. It is nested in another IF. <code>if [ "$CI" = "true" ]; then</code>. Btw I don’t see why that should be nested. (Perhaps was implemented this way because CI build uses <code>--debug</code> anyhow.)</p>
<p>Could run that sanity test outside of <code>if [ "$debug" = "true" ]; then</code> and earlier. I’ll try that now.</p>
<aside class="quote no-group" data-username="madaidan" data-post="507" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>The build for that passed though?</p>
</blockquote>
</aside>
<p>No. On <a href="../../../../external.html?link=https://github.com/Whonix/hardened-kernel/commit/629b62475455ce5ef073e6ba8b970ea76ade88a0">https://github.com/Whonix/hardened-kernel/commit/629b62475455ce5ef073e6ba8b970ea76ade88a0</a> the red X indicates a failed Travis CI build. I should have noticed this earlier.</p>
<aside class="quote no-group" data-username="madaidan" data-post="507" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>It seems to fail because of <a href="../../../../external.html?link=https://github.com/Whonix/hardened-kernel/commit/629b62475455ce5ef073e6ba8b970ea76ade88a0">https://github.com/Whonix/hardened-kernel/commit/629b62475455ce5ef073e6ba8b970ea76ade88a0</a></p>
</blockquote>
</aside>
<p>Seems like. But I understand how it can be the cause since it added an opt-in. Didn’t changed actual execution on CI.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-22T13:17:41Z' class='post-time'>
                December 22, 2020,  1:17pm
              </time>
              <meta itemprop='dateModified' content='2020-12-22T13:17:41Z'>
          <span itemprop='position'>#509</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/hardened-kernel/commit/d941ad1bc6c842e932922d792818ac716ccd437c" target="_blank" rel="noopener">github.com/Whonix/hardened-kernel</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/hardened-kernel/commit/d941ad1bc6c842e932922d792818ac716ccd437c" target="_blank" rel="noopener">CI fix</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-12-22" data-time="13:12:17" data-timezone="UTC">01:12PM - 22 Dec 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 7 additions and 7 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/hardened-kernel/commit/d941ad1bc6c842e932922d792818ac716ccd437c" target="_blank" rel="noopener">
          <span class="added">+7</span>
          <span class="removed">-7</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">https://forums.whonix.org/t/kernel-recompilation-for-better-hardening/7598/504</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Now I get why this was happening on CI. <code>--debug</code> results in <code>kprobes="true"</code>.</p>
<p>That CI issue seems now fixed. Build hasn’t completed yet but it’s past that issue.</p>
<hr>
<p>Another thing…</p>
<hr>
<pre><code>if [ "${kprobes}" = "true" ]; then
  cat "${MYDIR}/kprobes-ftrace" &gt;&gt; "$extracted_linux_kernel_sources_folder/.config"
fi
</code></pre>
<p>We don’t run <code>make oldconfig -C "$extracted_linux_kernel_sources_folder"</code>.</p>
<hr>
<p>vs</p>
<hr>
<pre><code>   cat "${MYDIR}/debugging-config" &gt;&gt; "$extracted_linux_kernel_sources_folder/.config"
   if [ "${kernel_config}" = "hardened-host-kernel" ]; then
     cat "${MYDIR}/debugging-config-host" &gt;&gt; "$extracted_linux_kernel_sources_folder/.config"
   fi
   make oldconfig -C "$extracted_linux_kernel_sources_folder"
</code></pre>
<p>We do run <code>make oldconfig -C "$extracted_linux_kernel_sources_folder"</code>.</p>
<hr>
<p>Does that look alright?</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-22T19:08:56Z' class='post-time'>
                December 22, 2020,  7:08pm
              </time>
              <meta itemprop='dateModified' content='2020-12-22T19:08:56Z'>
          <span itemprop='position'>#510</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="509" data-topic="7598">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Does that look alright?</p>
</blockquote>
</aside>
<p>It shouldn’t be too important but running <code>make oldconfig</code> wouldn’t hurt. It’ll rearrange the file properly before build but this isn’t required.</p>
        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7598.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-01-30T01:36:11Z' class='post-time'>
                January 30, 2021,  1:36am
              </time>
              <meta itemprop='dateModified' content='2021-01-30T01:36:11Z'>
          <span itemprop='position'>#511</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubfolder">
  <header class="source">
      <img src="../../../../external.html?link=https://github.githubassets.com/favicons/favicon.svg" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://github.com/tych0/huldufolk" target="_blank" rel="noopener nofollow ugc">github.com</a>
  </header>
  <article class="onebox-body">
    <img src="../../../../external.html?link=https://avatars.githubusercontent.com/u/785111?s=400&amp;amp;v=4" class="thumbnail onebox-full-image" width="60" height="60">

<h3><a href="../../../../external.html?link=https://github.com/tych0/huldufolk" target="_blank" rel="noopener nofollow ugc">tych0/huldufolk</a></h3>


  <p><span class="label1">the userspace side of Linux' CONFIG_STATIC_USERMODEHELPER</span></p>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='kernel recompilation for better hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="../75981d82.html?page=24">← previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="../759819d2.html?page=26">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

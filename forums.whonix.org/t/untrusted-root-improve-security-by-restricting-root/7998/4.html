<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Untrusted Root - improve Security by Restricting Root - #4 by madaidan - Development - Whonix Forum</title>
    <meta name="description" content="Is it currently being argued towards Untrusted Root? 
I.e. do you think it is a good idea to try to restrict malware which gained root access? 
examples which may point into that direction: 

Blacklist more kernel module&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../7998.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Untrusted Root - improve Security by Restricting Root&#39;" href="../7998.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/untrusted-root-improve-security-by-restricting-root/7998/4" />
<meta name="twitter:url" content="https://forums.whonix.org/t/untrusted-root-improve-security-by-restricting-root/7998/4" />
<meta property="og:title" content="Untrusted Root - improve Security by Restricting Root" />
<meta name="twitter:title" content="Untrusted Root - improve Security by Restricting Root" />
<meta property="og:description" content="I see this having some advantage. Kernel privileges are greater than traditional root.   This is one of the reasons why setting kernel.modules_disabled=1 with sysctl would be a good idea.  Edit by Patrick: allow loading signed kernel modules by default / disallow kernel module loading by default" />
<meta name="twitter:description" content="I see this having some advantage. Kernel privileges are greater than traditional root.   This is one of the reasons why setting kernel.modules_disabled=1 with sysctl would be a good idea.  Edit by Patrick: allow loading signed kernel modules by default / disallow kernel module loading by default" />
<meta property="article:published_time" content="2019-09-02T13:17:12+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="next" href="../79984658.html?page=2">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../7998.html">Untrusted Root - improve Security by Restricting Root</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../../tag/component_security.html' class='discourse-tag' rel="tag">component_security</a>, 
            <a href='../../../tag/status_open_issue_todo.html' class='discourse-tag' rel="tag">status_open_issue_todo</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-02T08:23:44Z' class='post-time'>
                September 2, 2019,  8:23am
              </time>
              <meta itemprop='dateModified' content='2019-10-29T15:07:38Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Is it currently being argued towards <code>Untrusted Root</code>?</p>
<p>I.e. do you think it is a good idea to try to restrict malware which gained root access?</p>
<p>examples which may point into that direction:</p>
<ul>
<li><a href="../../blacklist-more-kernel-modules-to-reduce-attack-surface/7989/8.html" class="inline-onebox">Blacklist more kernel modules to reduce attack surface</a></li>
<li><a href="../../enforce-kernel-module-software-signature-verification-module-signing-disallow-kernel-module-loading-by-default/7880.html" class="inline-onebox">allow loading signed kernel modules by default / disallow kernel module loading by default</a></li>
<li><a href="../../enable-linux-kernel-gpg-verification-in-grub-and-or-enable-secure-boot-by-default/7894.html" class="inline-onebox">enable Linux kernel gpg verification in grub and/or enable Secure Boot by default</a></li>
</ul>
<aside class="quote" data-post="10" data-topic="7989">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/a/a183cd/40.png" class="avatar">
    <a href="../../blacklist-more-kernel-modules-to-reduce-attack-surface/7989/10.html">Blacklist more kernel modules to reduce attack surface</a> <a class="badge-wrapper  bullet" href="../../../c/development/8.html"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    Modprobing stuff would be one of the options for  a kernel exploit. Certainly not the only one but at least one options less for the attacker. 
Edit: We also have apparmor which limits what a user, including root, can do.
  </blockquote>
</aside>

<p>Goal of <code>untrusted root</code> could be:</p>
<ul>
<li>to protect the virtualizer (and in effect, avoid host compromise, and similarly the hardware to avoid hardware compromise)</li>
<li>an untrusted root in Whonix-Workstation might have less options attacking Whonix-Gateway?</li>
<li>make kernel compromise non-persistent after reboot through combined use with <a href="../../enable-linux-kernel-gpg-verification-in-grub-and-or-enable-secure-boot-by-default/7894.html">secure boot</a>?</li>
<li>A compromised root is less worse than a compromised kernel? Is that even a valid concept?</li>
<li>different goals?</li>
<li>other goals?</li>
</ul>
<p>I don’t know if <code>untrusted root</code> isn’t a fully developed kernel concept yet (or ever).</p>
<p>On <code>untrusted root</code>: <a href="../../../../external.html?link=https://lwn.net/Articles/523367/" rel="nofollow noopener">https://lwn.net/Articles/523367/</a></p>
<p>It is important to make the case of the usefulness or non-usefulness of <code>untrusted root</code>. In case <code>untrusted root</code> is broken by concept, a usability issues, feature breakage may be introduced and time may be wasted on it.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>
          <meta itemprop='keywords' content='component_security, status_open_issue_todo'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../are-non-perfect-defenses-that-defeat-off-the-shelf-viruses-a-worthwhile-development-goal/8040.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../are-non-perfect-defenses-that-defeat-off-the-shelf-viruses-a-worthwhile-development-goal/8040.html'>
                      <span itemprop='name'>Are non-perfect Defenses that defeat off-the-shelf Viruses a worthwhile Development Goal?</span>
                    </a>
                    <meta itemprop='position' content='6'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../risks-of-writing-to-dev-random-crediting-entropy-rndaddentropy-related-to-untrusted-root/8976/5.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../risks-of-writing-to-dev-random-crediting-entropy-rndaddentropy-related-to-untrusted-root/8976/5.html'>
                      <span itemprop='name'>risks of writing to /dev/random, crediting entropy, RNDADDENTROPY related to untrusted root</span>
                    </a>
                    <meta itemprop='position' content='7'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../apparmor-for-complete-system-including-init-pid1-systemd-everything-full-system-mac-policy/8339/146.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../apparmor-for-complete-system-including-init-pid1-systemd-everything-full-system-mac-policy/8339/146.html'>
                      <span itemprop='name'>AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy</span>
                    </a>
                    <meta itemprop='position' content='8'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../walled-garden-firewall-whitelisting-application-whitelisting-sudo-lockdown-superuser-mode-protected-mode/5725/14.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../walled-garden-firewall-whitelisting-application-whitelisting-sudo-lockdown-superuser-mode-protected-mode/5725/14.html'>
                      <span itemprop='name'>walled garden, firewall whitelisting, application whitelisting, sudo lockdown, superuser mode, protected mode</span>
                    </a>
                    <meta itemprop='position' content='9'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../should-all-kernel-patches-for-cpu-bugs-be-unconditionally-enabled-vs-performance-vs-applicability/7647/23.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../should-all-kernel-patches-for-cpu-bugs-be-unconditionally-enabled-vs-performance-vs-applicability/7647/23.html'>
                      <span itemprop='name'>Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability</span>
                    </a>
                    <meta itemprop='position' content='10'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../blacklist-more-kernel-modules-to-reduce-attack-surface/7989/11.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../blacklist-more-kernel-modules-to-reduce-attack-surface/7989/11.html'>
                      <span itemprop='name'>Blacklist more kernel modules to reduce attack surface</span>
                    </a>
                    <meta itemprop='position' content='11'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../missing-libre-illustrative-images/3912/147.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../missing-libre-illustrative-images/3912/147.html'>
                      <span itemprop='name'>Missing Libre Illustrative Images</span>
                    </a>
                    <meta itemprop='position' content='12'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../apparmor-for-complete-system-including-init-pid1-systemd-everything-full-system-mac-policy/8339.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../apparmor-for-complete-system-including-init-pid1-systemd-everything-full-system-mac-policy/8339.html'>
                      <span itemprop='name'>AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy</span>
                    </a>
                    <meta itemprop='position' content='13'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../whonix-host-operating-system/3931/164.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../whonix-host-operating-system/3931/164.html'>
                      <span itemprop='name'>Whonix host operating system</span>
                    </a>
                    <meta itemprop='position' content='14'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../apparmor-for-complete-system-including-init-pid1-systemd-everything-full-system-mac-policy/8339/461.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../apparmor-for-complete-system-including-init-pid1-systemd-everything-full-system-mac-policy/8339/461.html'>
                      <span itemprop='name'>AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy</span>
                    </a>
                    <meta itemprop='position' content='15'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../qubes-sudo-su-root-hardening-development-discussion/8561.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../qubes-sudo-su-root-hardening-development-discussion/8561.html'>
                      <span itemprop='name'>Qubes sudo / su / root Hardening - Development Discussion</span>
                    </a>
                    <meta itemprop='position' content='16'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../kernel-recompilation-for-better-hardening/7598/139.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../kernel-recompilation-for-better-hardening/7598/139.html'>
                      <span itemprop='name'>kernel recompilation for better hardening</span>
                    </a>
                    <meta itemprop='position' content='17'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../disable-grub-output-verbose-by-default/8656.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../disable-grub-output-verbose-by-default/8656.html'>
                      <span itemprop='name'>disable grub-output-verbose by default</span>
                    </a>
                    <meta itemprop='position' content='18'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../kernel-recompilation-for-better-hardening/7598/450.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../kernel-recompilation-for-better-hardening/7598/450.html'>
                      <span itemprop='name'>kernel recompilation for better hardening</span>
                    </a>
                    <meta itemprop='position' content='19'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../kernel-hardening/7296/386.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../kernel-hardening/7296/386.html'>
                      <span itemprop='name'>Kernel Hardening</span>
                    </a>
                    <meta itemprop='position' content='20'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-02T08:35:00Z' class='post-time'>
                September 2, 2019,  8:35am
              </time>
              <meta itemprop='dateModified' content='2019-09-02T08:35:00Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="10" data-topic="7989">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/a/a183cd/40.png" class="avatar"><a href="../../blacklist-more-kernel-modules-to-reduce-attack-surface/7989/10.html">Blacklist more kernel modules to reduce attack surface</a>
</div>
<blockquote>
<p>Modprobing stuff would be one of the options for a kernel exploit. Certainly not the only one but at least one options less for the attacker.</p>
</blockquote>
</aside>
<p>To use <code>modprobe</code>, root access is required. If malware already has root access, why bother using <code>modprobe</code>?</p>
<aside class="quote no-group" data-post="10" data-topic="7989">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/a/a183cd/40.png" class="avatar"><a href="../../blacklist-more-kernel-modules-to-reduce-attack-surface/7989/10.html">Blacklist more kernel modules to reduce attack surface</a>
</div>
<blockquote>
<p>Edit: We also have apparmor which limits what a user, including root, can do.</p>
</blockquote>
</aside>
<p>If an application runs as root (or any user) under mandatory access control (MAC) such as apparmor or filejail, it cannot use <code>modprobe</code> since MAC would prevent that.</p>
<p>Maybe we have to distinguish between</p>
<ul>
<li>a process running as root and MAC,</li>
<li>“full root compromise”, i.e. a process that runs unconfined (without MAC) as root</li>
<li>and kernel compromise?</li>
</ul>
<hr>
<p>The question of this thread is, is the kernel capable to resist full root compromise?</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Algernon'><span itemprop='name'>Algernon</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-02T08:45:11Z' class='post-time'>
                September 2, 2019,  8:45am
              </time>
              <meta itemprop='dateModified' content='2019-09-02T08:45:11Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="2" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>If malware already has root access, why bother using <code>modprobe</code> ?</p>
</blockquote>
</aside>
<p>Because root and kernel is not the same. As said, there are more ways to compromise the kernel.  Afaik loading a module is the most common/easiest way. Even if it wasn’t, why give the attacker more opportunities.</p>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" target="_blank" rel="nofollow noopener">security.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://security.stackexchange.com/users/106285/forest" target="_blank" rel="nofollow noopener">
    <img alt="forest" src="../../../../external.html?link=https://www.gravatar.com/avatar/9ea7efef9a3212242d84ebc53ccae61d?s=128&amp;d=identicon&amp;r=PG&amp;f=1" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" target="_blank" rel="nofollow noopener">Methods root can use to elevate itself to kernel mode</a>
</h4>

<div class="tags">
  <strong>linux, exploit, privilege-escalation, kernel</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../../external.html?link=https://security.stackexchange.com/users/106285/forest" target="_blank" rel="nofollow noopener">
    forest
  </a>
  on <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" target="_blank" rel="nofollow noopener">02:50AM - 07 Apr 16 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../../external.html?link=https://security.stackexchange.com/questions/139463/why-protect-the-linux-kernel-from-the-root-user" target="_blank" rel="nofollow noopener">security.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://security.stackexchange.com/users/127145/joseph-sible" target="_blank" rel="nofollow noopener">
    <img alt="Joseph Sible" src="../../../../external.html?link=https://lh6.googleusercontent.com/-eT7QDf4HDf0/AAAAAAAAAAI/AAAAAAAAAi8/Hppm678o8WA/photo.jpg?sz=128" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="../../../../external.html?link=https://security.stackexchange.com/questions/139463/why-protect-the-linux-kernel-from-the-root-user" target="_blank" rel="nofollow noopener">Why protect the Linux kernel from the root user?</a>
</h4>

<div class="tags">
  <strong>linux, kernel</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../../external.html?link=https://security.stackexchange.com/users/127145/joseph-sible" target="_blank" rel="nofollow noopener">
    Joseph Sible
  </a>
  on <a href="../../../../external.html?link=https://security.stackexchange.com/questions/139463/why-protect-the-linux-kernel-from-the-root-user" target="_blank" rel="nofollow noopener">04:16PM - 11 Oct 16 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-post="2" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>If an application runs as root (or any user) under mandatory access control (MAC) such as apparmor or filejail, it cannot use <code>modprobe</code> since MAC would prevent that.</p>
</blockquote>
</aside>
<p>Which is a big if. Whonix does not do that by default, and, same as above, even if it would, why give the attacker more opportunities?</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-02T13:17:12Z' class='post-time'>
                September 2, 2019,  1:17pm
              </time>
              <meta itemprop='dateModified' content='2019-09-02T13:32:41Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I see this having some advantage. Kernel privileges are greater than traditional root.</p>
<aside class="quote no-group" data-post="3" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/a/a183cd/40.png" class="avatar"> Algernon:</div>
<blockquote>
<p>Afaik loading a module is the most common/easiest way.</p>
</blockquote>
</aside>
<p>This is one of the reasons why setting <code>kernel.modules_disabled=1</code> with sysctl would be a good idea.</p>
<p>Edit by Patrick: <a href="../../enforce-kernel-module-software-signature-verification-module-signing-disallow-kernel-module-loading-by-default/7880.html" class="inline-onebox">allow loading signed kernel modules by default / disallow kernel module loading by default</a></p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-02T13:34:16Z' class='post-time'>
                September 2, 2019,  1:34pm
              </time>
              <meta itemprop='dateModified' content='2019-09-02T13:34:16Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>One way to do this would be to do something with Linux capabilities.</p>
<p>libpam-cap allows you to give users specific capabilities with /etc/security/capability.conf but this doesn’t seem to work with the root account.</p>
<p>We can drop all privileges as the root user by running <code>capsh --drop=all --</code> but it’d be tricky to somehow set this by default. We could add that to the bashrc and make it immutable but that doesn’t seem like a good way to do this due to it depending on the root user sourcing that file.</p>
<p>SELinux can also restrict individual users but it will be way too complicated to maintain.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-02T13:42:43Z' class='post-time'>
                September 2, 2019,  1:42pm
              </time>
              <meta itemprop='dateModified' content='2019-09-02T13:42:43Z'>
          <span itemprop='position'>#6</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I don’t know yet if this is a good idea or will break a ton of things.  Please test.</p>
<p>However, I hereby contribute to the brainstorming on how this could be implemented technically.</p>
<aside class="quote no-group" data-post="5" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>libpam-cap allows you to give users specific capabilities with /etc/security/capability.conf but this doesn’t seem to work with the root account.</p>
</blockquote>
</aside>
<p>Upstream bug report?</p>
<aside class="quote no-group" data-post="5" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>We could add that to the bashrc and make it immutable but that doesn’t seem like a good way to do this due to it depending on the root user sourcing that file.</p>
</blockquote>
</aside>
<p>Yes and root can make non-immutable or login with a different shell or something else. Therefore other ideas…</p>
<aside class="quote no-group" data-post="5" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>We can drop all privileges as the root user by running <code>capsh --drop=all --</code> but it’d be tricky to somehow set this by default. We could add that to the bashrc and make it immutable but that doesn’t seem like a good way to do this due to it depending on the root user sourcing that file.</p>
</blockquote>
</aside>
<p>Random ideas…</p>
<ol>
<li>Run during boot using systemd? OR</li>
</ol>
<hr>
<ol start="2">
<li>pam_exec? Examples:</li>
</ol>
<ul>
<li><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/usr/share/pam-configs/pam-abort-on-locked-password-security-misc" rel="nofollow noopener">https://github.com/Whonix/security-misc/blob/master/usr/share/pam-configs/pam-abort-on-locked-password-security-misc</a></li>
<li><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/usr/lib/security-misc/pam-abort-on-locked-password" rel="nofollow noopener">https://github.com/Whonix/security-misc/blob/master/usr/lib/security-misc/pam-abort-on-locked-password</a></li>
</ul>
<hr>
<ul>
<li><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/usr/share/pam-configs/permission-lockdown-security-misc" rel="nofollow noopener">https://github.com/Whonix/security-misc/blob/master/usr/share/pam-configs/permission-lockdown-security-misc</a></li>
<li><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/usr/lib/security-misc/permission-lockdown" rel="nofollow noopener">https://github.com/Whonix/security-misc/blob/master/usr/lib/security-misc/permission-lockdown</a></li>
</ul>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-02T13:48:15Z' class='post-time'>
                September 2, 2019,  1:48pm
              </time>
              <meta itemprop='dateModified' content='2019-09-02T13:48:15Z'>
          <span itemprop='position'>#7</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="6" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Upstream bug report?</p>
</blockquote>
</aside>
<p>I don’t think this is a bug. The pam developers probably never intended for root to be restricted with this.</p>
<aside class="quote no-group" data-post="6" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Yes and root can make non-immutable</p>
</blockquote>
</aside>
<p>Only if we give root the CAP_SYS_IMMUTABLE capability which would be disallowed.</p>
<aside class="quote no-group" data-post="6" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>or login with a different shell</p>
</blockquote>
</aside>
<p>We can restrict the amount of valid shells in /etc/shells and add the same command to each of their rcs.</p>
<aside class="quote no-group" data-post="6" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Run during boot using systemd?</p>
</blockquote>
</aside>
<p><code>capsh</code> only applies for the current session. Running it during boot would just apply the changes to that specific service.</p>
<aside class="quote no-group" data-post="6" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>pam_exec?</p>
</blockquote>
</aside>
<p>I’m not sure that would work as pam_exec doesn’t run commands as specific users AFAIK</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-02T14:19:26Z' class='post-time'>
                September 2, 2019,  2:19pm
              </time>
              <meta itemprop='dateModified' content='2019-09-02T14:19:26Z'>
          <span itemprop='position'>#8</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="7" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>I’m not sure that would work as pam_exec doesn’t run commands as specific users AFAIK</p>
</blockquote>
</aside>
<p>Did run pam_exec without <code>seteuid</code> option just now. Result:<br>
<code>whoami</code> returns <code>user</code>.<br>
I.e. pam_exec can run programs as the user which is attempting to login.<br>
Makes sense. pam is there to set up a (user interactive or non-interactive) session. It can run programs before the user can interfere. Might be possible to run capsh.</p>
<p>(With <code>seteuid</code> option used it runs it as root.)</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-04T16:58:44Z' class='post-time'>
                September 4, 2019,  4:58pm
              </time>
              <meta itemprop='dateModified' content='2019-09-04T16:58:44Z'>
          <span itemprop='position'>#9</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><a href="../../../../external.html?link=https://www.linuxjournal.com/magazine/making-root-unprivileged" class="onebox" target="_blank" rel="nofollow noopener">https://www.linuxjournal.com/magazine/making-root-unprivileged</a></p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-06T10:42:36Z' class='post-time'>
                September 6, 2019, 10:42am
              </time>
              <meta itemprop='dateModified' content='2019-09-06T10:42:36Z'>
          <span itemprop='position'>#10</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Untrusted Root makes sense with my current understanding. Reasons:</p>
<p>Quote <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" rel="nofollow noopener">https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode</a></p>
<blockquote>
<p>When most Linux users hear “root”, they think of the maximum possible privilege on a computer. Some even think that root runs in ring 0. But in reality, root is just a regular user running in ring 3, albeit one which the kernel trusts (many sensitive kernel operations are guarded with checks along the lines of <code>if (!uid_eq(current_uid(), GLOBAL_ROOT_UID)) return -EPERM;</code> to prevent abuse, which simply returns an error if <code>uid != 0</code> ).</p>
</blockquote>
<p>It would be good if we could trap a compromised root account in <a href="../../../../external.html?link=https://en.wikipedia.org/wiki/User_space" rel="nofollow noopener">user space</a> and prevent a compromised root from getting kernel mode access.</p>
<p>This would be <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2695#issuecomment-301316132" rel="nofollow noopener">useful to protect the virtualizer</a> or perhaps even the hardware.</p>
<p>Quote Linux kernel developer Kees Cook <a href="../../../../external.html?link=https://lwn.net/Articles/580269/" rel="nofollow noopener">https://lwn.net/Articles/580269/</a> (8 Jan 2014)</p>
<blockquote>
<p>The intention is for using this in environments where “perfect” enforcement is hard. Without a verified boot, along with verified modules, and along with verified kexec, this is trying to give a system a better chance to defend itself (or at least grow the window of discoverability) against attack in the face of a privilege escalation.</p>
</blockquote>
<blockquote>
<p>In my mind, I consider several boot scenarios:</p>
<ol>
<li>Verified boot of read-only verified root fs loading fd-based verification of kexec images.</li>
<li>Secure boot of writable root fs loading signed kexec images.</li>
<li>Regular boot loading kexec (e.g. kcrash) image early and locking it.</li>
<li>Regular boot with no control of kexec image at all.</li>
</ol>
</blockquote>
<p>Since that is an old quote, things might have improved by now.</p>
<p>At first sight untrusted root looks pointless since root has write access to maliciously alter the bootloader, kernel image, initial ramdisk (initrd) or any other file on the disk. Therefore at least after reboot, a compromised root could escalate to compromised kernel mode. But this is not always the case:</p>
<ul>
<li>In Qubes TemplateBasedVMs the root image (where the bootloader, kernel and initrd <a href="../../../../external.html?link=https://www.whonix.org/wiki/Template:Qubes_persistence" rel="nofollow noopener">and more</a> resides) is writeable but non-persistent after reboot. In other words, a malicious modification for example of the kernel image would be gone after reboot of the TemplateBasedVM.</li>
<li>Using this <a href="../../enable-linux-kernel-gpg-verification-in-grub-and-or-enable-secure-boot-by-default/7894/15.html">verified boot</a> idea the same could be accomplished outside of Qubes TemplateBasedVMs. I.e. the same could be accomplished with Debian. A read-only boot medium using <a href="../../../../external.html?link=https://www.elstel.org/debcheckroot/" rel="nofollow noopener">debcheckroot</a> (and more to verify initrd, bootloader and whatnot) could make sure that kernel, bootloader, initrd and all non-auto/non-user files shipped by any packages are verified.</li>
</ul>
<p>And malware re-starting itself from the user’s home folder might be restricted too.</p>
<ul>
<li><a href="../../../../external.html?link=https://github.com/tasket/Qubes-VM-hardening" rel="nofollow noopener">https://github.com/tasket/Qubes-VM-hardening</a></li>
<li><a href="../../../../external.html?link=https://www.whonix.org/wiki/Dev/VirusForget" rel="nofollow noopener">https://www.whonix.org/wiki/Dev/VirusForget</a></li>
</ul>
<p>Vulnerable files such as <code>~/.bashrc</code> or folders such as <code>~/.config/autostart</code> could be checked and/or restored to known sane versions at early boot time when it is considered that no malware is running yet.</p>
<p><strong>The question is, can we disable all the “easy” (non-kernel exploit) ways to prevent root from getting access to kernel space?</strong></p>
<p>That is before reboot - because root can change bootloader, kernel image, etc. and after reboot changes to bootloader, kernel image, etc. must be undone. That might include <a href="../../enforce-kernel-module-software-signature-verification-module-signing-disallow-kernel-module-loading-by-default/7880.html" class="inline-onebox">allow loading signed kernel modules by default / disallow kernel module loading by default</a>, <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/etc/sysctl.d/kexec.conf" rel="nofollow noopener">disable kexec</a> which we are already doing, and whatnot.</p>
<p>A good starting point might be:</p>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" target="_blank" rel="nofollow noopener">security.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://security.stackexchange.com/users/106285/forest" target="_blank" rel="nofollow noopener">
    <img alt="forest" src="../../../../external.html?link=https://www.gravatar.com/avatar/9ea7efef9a3212242d84ebc53ccae61d?s=128&amp;d=identicon&amp;r=PG&amp;f=1" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" target="_blank" rel="nofollow noopener">Methods root can use to elevate itself to kernel mode</a>
</h4>

<div class="tags">
  <strong>linux, exploit, privilege-escalation, kernel</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../../external.html?link=https://security.stackexchange.com/users/106285/forest" target="_blank" rel="nofollow noopener">
    forest
  </a>
  on <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" target="_blank" rel="nofollow noopener">02:50AM - 07 Apr 16 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Perhaps it may even be possible to prevent root from modifying the bootloader, kernel image, initrd? Perhaps it could be configured that such changes must happen through use of <code>apt-get</code>? But then additional, malicious <code>/etc/apt/sources.list.d/</code> <code>sources.list</code> or apt command line parameters to set malicious <code>sources.list</code> might be set. Some restrictions (if even possible) might have to go into separate, opt-in packages or opt-in commands if functionality gets restricted too much (such as <a href="../../../../external.html?link=http://packages.debian.org/" rel="nofollow noopener">packages.debian.org</a> as sources only).</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-07T15:19:05Z' class='post-time'>
                September 7, 2019,  3:19pm
              </time>
              <meta itemprop='dateModified' content='2019-09-07T15:19:05Z'>
          <span itemprop='position'>#11</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="10" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Perhaps it may even be possible to prevent root from modifying the bootloader, kernel image, initrd?</p>
</blockquote>
</aside>
<p>There isn’t really a plausible way to prevent root from modifying it but you can make sure it isn’t executed if it’s modified. For example, see Android’s <a href="../../../../external.html?link=https://source.android.com/security/verifiedboot/" rel="nofollow noopener">verified boot</a> implementation. I’m not sure how this could be implemented in an ordinary Linux distro.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-07T17:44:38Z' class='post-time'>
                September 7, 2019,  5:44pm
              </time>
              <meta itemprop='dateModified' content='2019-09-07T17:44:38Z'>
          <span itemprop='position'>#12</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I am very interested in verified boot latetly. For VMs:<br>
Could be implemented using similar to this idea in this very post: <a href="../../enable-linux-kernel-gpg-verification-in-grub-and-or-enable-secure-boot-by-default/7894/15.html" class="inline-onebox">enable Linux kernel gpg verification in grub and/or enable Secure Boot by default</a><br>
In essence initially boot from a readonly boot medium, do verification and chainload (kexec) (boot) regular disk if verification was ok.</p>
<p>Also described a bit in <a href="../../are-non-perfect-defenses-that-defeat-off-the-shelf-viruses-a-worthwhile-development-goal/8040.html" class="inline-onebox">Are non-perfect Defenses that defeat off-the-shelf Viruses a worthwhile Development Goal?</a></p>
<p>For host: not sure yet. Perhaps using Secure Boot. Perhaps similar to above. Should be possible though because…</p>
<aside class="quote no-group" data-post="2" data-topic="8040">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/a/a183cd/40.png" class="avatar"><a href="../../are-non-perfect-defenses-that-defeat-off-the-shelf-viruses-a-worthwhile-development-goal/8040/2">Are non-perfect Defenses that defeat off-the-shelf Viruses a worthwhile Development Goal?</a>
</div>
<blockquote>
<p>Android, IOS, MacOS does it, some cloud providers do it, Fedora SilverBlue and ClearLinux also do.</p>
</blockquote>
</aside>
<p>SilverBlue and ClearLinux do interesting things related to it. They call it stateless.</p>
<p>This blog describes it very well.</p>
<p><a href="../../../../external.html?link=http://0pointer.net/blog/projects/stateless.html" class="onebox" target="_blank" rel="nofollow noopener">http://0pointer.net/blog/projects/stateless.html</a></p>
<p>Once stateless, verified boot gets a lot simpler.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Algernon'><span itemprop='name'>Algernon</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T12:51:46Z' class='post-time'>
                September 8, 2019, 12:51pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T12:51:46Z'>
          <span itemprop='position'>#13</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>What is root needed for for the average Whonix user?<br>
I can only come up with few stuff like apt-get + some other listed here: <a href="../../../../external.html?link=https://www.whonix.org/wiki/Common_Whonix_CLI_Commands" rel="nofollow noopener">https://www.whonix.org/wiki/Common_Whonix_CLI_Commands</a><br>
Are there any commonly used programs which need root at runtime?</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T13:01:34Z' class='post-time'>
                September 8, 2019,  1:01pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T13:01:34Z'>
          <span itemprop='position'>#14</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Without root/sudo goes long way.</p>
<p>(Maybe search wiki for sudo and grep Whonix source code for sudo.)</p>
<p>Why you’re asking?</p>
<p>Can we somehow disable or even delete the root user? If possible this might make sense in a nonpersistent + noroot boot.</p>
<p>From there we can expand.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Algernon'><span itemprop='name'>Algernon</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T13:53:16Z' class='post-time'>
                September 8, 2019,  1:53pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T13:53:16Z'>
          <span itemprop='position'>#15</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="14" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/p/898d66/40.png" class="avatar"> Patrick_mobile:</div>
<blockquote>
<p>Can we somehow disable or even delete the root user?</p>
</blockquote>
</aside>
<p>Yes, thats the idea I had in mind.<br>
When grepping through the source code most stuff was related to apt, also sdwdate + some whonix scripts. I don’t know if you can restrict sudo to a limited set of commands. Also apparmor could maybe restrict the few remaining cases and forbid everything else for root. In case the system would use something like dm-verity apt-get would also be pointless I guess. You would need some other mechanism to push upgrades.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T14:44:48Z' class='post-time'>
                September 8, 2019,  2:44pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T14:44:48Z'>
          <span itemprop='position'>#16</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>These special cases and upgrading aren’t blockers. Solutions can be searched later. It’s worth pursuing this idea of disabling/deleting independently. For example for boot in live + noroot it totally makes sense.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T17:10:39Z' class='post-time'>
                September 8, 2019,  5:10pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T17:10:39Z'>
          <span itemprop='position'>#17</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="13" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/a/a183cd/40.png" class="avatar"> Algernon:</div>
<blockquote>
<p>Are there any commonly used programs which need root at runtime?</p>
</blockquote>
</aside>
<p>I’d imagine many systemd services would be running as the root user.</p>
<aside class="quote no-group" data-post="14" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/p/898d66/40.png" class="avatar"> Patrick_mobile:</div>
<blockquote>
<p>Can we somehow disable or even delete the root user?</p>
</blockquote>
</aside>
<p>I don’t think this would be the best idea. As I said above, many services would be running as the root user and deleting root entirely would break it unless systemd can somehow grant more privileges as it’s the init process.</p>
<p>Running <code>sudo userdel -f root</code> kinda worked but the root user was back again after a reboot.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T17:40:52Z' class='post-time'>
                September 8, 2019,  5:40pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T17:40:52Z'>
          <span itemprop='position'>#18</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="17" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>I don’t think this would be the best idea. As I said above, many services would be running as the root</p>
</blockquote>
</aside>
<p>Any we care about at live boot?</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T17:47:23Z' class='post-time'>
                September 8, 2019,  5:47pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T17:47:23Z'>
          <span itemprop='position'>#19</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="18" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/p/898d66/40.png" class="avatar"> Patrick_mobile:</div>
<blockquote>
<p>Any we care about at live boot?</p>
</blockquote>
</aside>
<p>Yes. Nearly every service runs as the root user. Running</p>
<pre><code>grep "User=" /lib/systemd/system/*.service
</code></pre>
<p>just shows a few services. If a service doesn’t select a specific user, it uses the root user by default.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Algernon'><span itemprop='name'>Algernon</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-09T09:22:23Z' class='post-time'>
                September 9, 2019,  9:22am
              </time>
              <meta itemprop='dateModified' content='2019-09-09T09:22:23Z'>
          <span itemprop='position'>#20</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="17" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>I’d imagine many systemd services would be running as the root user.</p>
</blockquote>
</aside>
<p>Ahh sure. Let me rephrase it: Is there any reason an average user would need to elevate its privileges to run program X?</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><b><a rel="next" itemprop="url" href="../79984658.html?page=2">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

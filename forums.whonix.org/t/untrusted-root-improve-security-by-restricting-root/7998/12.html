<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Untrusted Root - improve Security by Restricting Root - #12 by Patrick_mobile - Development - Whonix Forum</title>
    <meta name="description" content="Is it currently being argued towards Untrusted Root? 
I.e. do you think it is a good idea to try to restrict malware which gained root access? 
examples which may point into that direction: 

Blacklist more kernel module&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../7998.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Untrusted Root - improve Security by Restricting Root&#39;" href="../7998.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/untrusted-root-improve-security-by-restricting-root/7998/12" />
<meta name="twitter:url" content="https://forums.whonix.org/t/untrusted-root-improve-security-by-restricting-root/7998/12" />
<meta property="og:title" content="Untrusted Root - improve Security by Restricting Root" />
<meta name="twitter:title" content="Untrusted Root - improve Security by Restricting Root" />
<meta property="og:description" content="I am very interested in verified boot latetly. For VMs:  Could be implemented using similar to this idea in this very post: enable Linux kernel gpg verification in grub and/or enable Secure Boot by default  In essence initially boot from a readonly boot medium, do verification and chainload (kexec) (boot) regular disk if verification was ok.  Also described a bit in Are non-perfect Defenses that defeat off-the-shelf Viruses a worthwhile Development Goal?  For host: not sure yet. Perhaps using Se..." />
<meta name="twitter:description" content="I am very interested in verified boot latetly. For VMs:  Could be implemented using similar to this idea in this very post: enable Linux kernel gpg verification in grub and/or enable Secure Boot by default  In essence initially boot from a readonly boot medium, do verification and chainload (kexec) (boot) regular disk if verification was ok.  Also described a bit in Are non-perfect Defenses that defeat off-the-shelf Viruses a worthwhile Development Goal?  For host: not sure yet. Perhaps using Se..." />
<meta property="article:published_time" content="2019-09-07T17:44:38+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="next" href="../79984658.html?page=2">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../7998.html">Untrusted Root - improve Security by Restricting Root</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../../tag/component_security.html' class='discourse-tag' rel="tag">component_security</a>, 
            <a href='../../../tag/status_open_issue_todo.html' class='discourse-tag' rel="tag">status_open_issue_todo</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-02T13:48:15Z' class='post-time'>
                September 2, 2019,  1:48pm
              </time>
              <meta itemprop='dateModified' content='2019-09-02T13:48:15Z'>
          <span itemprop='position'>#7</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="6" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Upstream bug report?</p>
</blockquote>
</aside>
<p>I don’t think this is a bug. The pam developers probably never intended for root to be restricted with this.</p>
<aside class="quote no-group" data-post="6" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Yes and root can make non-immutable</p>
</blockquote>
</aside>
<p>Only if we give root the CAP_SYS_IMMUTABLE capability which would be disallowed.</p>
<aside class="quote no-group" data-post="6" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>or login with a different shell</p>
</blockquote>
</aside>
<p>We can restrict the amount of valid shells in /etc/shells and add the same command to each of their rcs.</p>
<aside class="quote no-group" data-post="6" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Run during boot using systemd?</p>
</blockquote>
</aside>
<p><code>capsh</code> only applies for the current session. Running it during boot would just apply the changes to that specific service.</p>
<aside class="quote no-group" data-post="6" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>pam_exec?</p>
</blockquote>
</aside>
<p>I’m not sure that would work as pam_exec doesn’t run commands as specific users AFAIK</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>
          <meta itemprop='keywords' content='component_security, status_open_issue_todo'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-02T14:19:26Z' class='post-time'>
                September 2, 2019,  2:19pm
              </time>
              <meta itemprop='dateModified' content='2019-09-02T14:19:26Z'>
          <span itemprop='position'>#8</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="7" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>I’m not sure that would work as pam_exec doesn’t run commands as specific users AFAIK</p>
</blockquote>
</aside>
<p>Did run pam_exec without <code>seteuid</code> option just now. Result:<br>
<code>whoami</code> returns <code>user</code>.<br>
I.e. pam_exec can run programs as the user which is attempting to login.<br>
Makes sense. pam is there to set up a (user interactive or non-interactive) session. It can run programs before the user can interfere. Might be possible to run capsh.</p>
<p>(With <code>seteuid</code> option used it runs it as root.)</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-04T16:58:44Z' class='post-time'>
                September 4, 2019,  4:58pm
              </time>
              <meta itemprop='dateModified' content='2019-09-04T16:58:44Z'>
          <span itemprop='position'>#9</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><a href="../../../../external.html?link=https://www.linuxjournal.com/magazine/making-root-unprivileged" class="onebox" target="_blank" rel="nofollow noopener">https://www.linuxjournal.com/magazine/making-root-unprivileged</a></p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-06T10:42:36Z' class='post-time'>
                September 6, 2019, 10:42am
              </time>
              <meta itemprop='dateModified' content='2019-09-06T10:42:36Z'>
          <span itemprop='position'>#10</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Untrusted Root makes sense with my current understanding. Reasons:</p>
<p>Quote <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" rel="nofollow noopener">https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode</a></p>
<blockquote>
<p>When most Linux users hear “root”, they think of the maximum possible privilege on a computer. Some even think that root runs in ring 0. But in reality, root is just a regular user running in ring 3, albeit one which the kernel trusts (many sensitive kernel operations are guarded with checks along the lines of <code>if (!uid_eq(current_uid(), GLOBAL_ROOT_UID)) return -EPERM;</code> to prevent abuse, which simply returns an error if <code>uid != 0</code> ).</p>
</blockquote>
<p>It would be good if we could trap a compromised root account in <a href="../../../../external.html?link=https://en.wikipedia.org/wiki/User_space" rel="nofollow noopener">user space</a> and prevent a compromised root from getting kernel mode access.</p>
<p>This would be <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2695#issuecomment-301316132" rel="nofollow noopener">useful to protect the virtualizer</a> or perhaps even the hardware.</p>
<p>Quote Linux kernel developer Kees Cook <a href="../../../../external.html?link=https://lwn.net/Articles/580269/" rel="nofollow noopener">https://lwn.net/Articles/580269/</a> (8 Jan 2014)</p>
<blockquote>
<p>The intention is for using this in environments where “perfect” enforcement is hard. Without a verified boot, along with verified modules, and along with verified kexec, this is trying to give a system a better chance to defend itself (or at least grow the window of discoverability) against attack in the face of a privilege escalation.</p>
</blockquote>
<blockquote>
<p>In my mind, I consider several boot scenarios:</p>
<ol>
<li>Verified boot of read-only verified root fs loading fd-based verification of kexec images.</li>
<li>Secure boot of writable root fs loading signed kexec images.</li>
<li>Regular boot loading kexec (e.g. kcrash) image early and locking it.</li>
<li>Regular boot with no control of kexec image at all.</li>
</ol>
</blockquote>
<p>Since that is an old quote, things might have improved by now.</p>
<p>At first sight untrusted root looks pointless since root has write access to maliciously alter the bootloader, kernel image, initial ramdisk (initrd) or any other file on the disk. Therefore at least after reboot, a compromised root could escalate to compromised kernel mode. But this is not always the case:</p>
<ul>
<li>In Qubes TemplateBasedVMs the root image (where the bootloader, kernel and initrd <a href="../../../../external.html?link=https://www.whonix.org/wiki/Template:Qubes_persistence" rel="nofollow noopener">and more</a> resides) is writeable but non-persistent after reboot. In other words, a malicious modification for example of the kernel image would be gone after reboot of the TemplateBasedVM.</li>
<li>Using this <a href="../../enable-linux-kernel-gpg-verification-in-grub-and-or-enable-secure-boot-by-default/7894/15.html">verified boot</a> idea the same could be accomplished outside of Qubes TemplateBasedVMs. I.e. the same could be accomplished with Debian. A read-only boot medium using <a href="../../../../external.html?link=https://www.elstel.org/debcheckroot/" rel="nofollow noopener">debcheckroot</a> (and more to verify initrd, bootloader and whatnot) could make sure that kernel, bootloader, initrd and all non-auto/non-user files shipped by any packages are verified.</li>
</ul>
<p>And malware re-starting itself from the user’s home folder might be restricted too.</p>
<ul>
<li><a href="../../../../external.html?link=https://github.com/tasket/Qubes-VM-hardening" rel="nofollow noopener">https://github.com/tasket/Qubes-VM-hardening</a></li>
<li><a href="../../../../external.html?link=https://www.whonix.org/wiki/Dev/VirusForget" rel="nofollow noopener">https://www.whonix.org/wiki/Dev/VirusForget</a></li>
</ul>
<p>Vulnerable files such as <code>~/.bashrc</code> or folders such as <code>~/.config/autostart</code> could be checked and/or restored to known sane versions at early boot time when it is considered that no malware is running yet.</p>
<p><strong>The question is, can we disable all the “easy” (non-kernel exploit) ways to prevent root from getting access to kernel space?</strong></p>
<p>That is before reboot - because root can change bootloader, kernel image, etc. and after reboot changes to bootloader, kernel image, etc. must be undone. That might include <a href="../../enforce-kernel-module-software-signature-verification-module-signing-disallow-kernel-module-loading-by-default/7880.html" class="inline-onebox">allow loading signed kernel modules by default / disallow kernel module loading by default</a>, <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/etc/sysctl.d/kexec.conf" rel="nofollow noopener">disable kexec</a> which we are already doing, and whatnot.</p>
<p>A good starting point might be:</p>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" target="_blank" rel="nofollow noopener">security.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://security.stackexchange.com/users/106285/forest" target="_blank" rel="nofollow noopener">
    <img alt="forest" src="../../../../external.html?link=https://www.gravatar.com/avatar/9ea7efef9a3212242d84ebc53ccae61d?s=128&amp;d=identicon&amp;r=PG&amp;f=1" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" target="_blank" rel="nofollow noopener">Methods root can use to elevate itself to kernel mode</a>
</h4>

<div class="tags">
  <strong>linux, exploit, privilege-escalation, kernel</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../../external.html?link=https://security.stackexchange.com/users/106285/forest" target="_blank" rel="nofollow noopener">
    forest
  </a>
  on <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" target="_blank" rel="nofollow noopener">02:50AM - 07 Apr 16 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Perhaps it may even be possible to prevent root from modifying the bootloader, kernel image, initrd? Perhaps it could be configured that such changes must happen through use of <code>apt-get</code>? But then additional, malicious <code>/etc/apt/sources.list.d/</code> <code>sources.list</code> or apt command line parameters to set malicious <code>sources.list</code> might be set. Some restrictions (if even possible) might have to go into separate, opt-in packages or opt-in commands if functionality gets restricted too much (such as <a href="../../../../external.html?link=http://packages.debian.org/" rel="nofollow noopener">packages.debian.org</a> as sources only).</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-07T15:19:05Z' class='post-time'>
                September 7, 2019,  3:19pm
              </time>
              <meta itemprop='dateModified' content='2019-09-07T15:19:05Z'>
          <span itemprop='position'>#11</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="10" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Perhaps it may even be possible to prevent root from modifying the bootloader, kernel image, initrd?</p>
</blockquote>
</aside>
<p>There isn’t really a plausible way to prevent root from modifying it but you can make sure it isn’t executed if it’s modified. For example, see Android’s <a href="../../../../external.html?link=https://source.android.com/security/verifiedboot/" rel="nofollow noopener">verified boot</a> implementation. I’m not sure how this could be implemented in an ordinary Linux distro.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-07T17:44:38Z' class='post-time'>
                September 7, 2019,  5:44pm
              </time>
              <meta itemprop='dateModified' content='2019-09-07T17:44:38Z'>
          <span itemprop='position'>#12</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I am very interested in verified boot latetly. For VMs:<br>
Could be implemented using similar to this idea in this very post: <a href="../../enable-linux-kernel-gpg-verification-in-grub-and-or-enable-secure-boot-by-default/7894/15.html" class="inline-onebox">enable Linux kernel gpg verification in grub and/or enable Secure Boot by default</a><br>
In essence initially boot from a readonly boot medium, do verification and chainload (kexec) (boot) regular disk if verification was ok.</p>
<p>Also described a bit in <a href="../../are-non-perfect-defenses-that-defeat-off-the-shelf-viruses-a-worthwhile-development-goal/8040.html" class="inline-onebox">Are non-perfect Defenses that defeat off-the-shelf Viruses a worthwhile Development Goal?</a></p>
<p>For host: not sure yet. Perhaps using Secure Boot. Perhaps similar to above. Should be possible though because…</p>
<aside class="quote no-group" data-post="2" data-topic="8040">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/a/a183cd/40.png" class="avatar"><a href="../../are-non-perfect-defenses-that-defeat-off-the-shelf-viruses-a-worthwhile-development-goal/8040/2.html">Are non-perfect Defenses that defeat off-the-shelf Viruses a worthwhile Development Goal?</a>
</div>
<blockquote>
<p>Android, IOS, MacOS does it, some cloud providers do it, Fedora SilverBlue and ClearLinux also do.</p>
</blockquote>
</aside>
<p>SilverBlue and ClearLinux do interesting things related to it. They call it stateless.</p>
<p>This blog describes it very well.</p>
<p><a href="../../../../external.html?link=http://0pointer.net/blog/projects/stateless.html" class="onebox" target="_blank" rel="nofollow noopener">http://0pointer.net/blog/projects/stateless.html</a></p>
<p>Once stateless, verified boot gets a lot simpler.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Algernon'><span itemprop='name'>Algernon</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T12:51:46Z' class='post-time'>
                September 8, 2019, 12:51pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T12:51:46Z'>
          <span itemprop='position'>#13</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>What is root needed for for the average Whonix user?<br>
I can only come up with few stuff like apt-get + some other listed here: <a href="../../../../external.html?link=https://www.whonix.org/wiki/Common_Whonix_CLI_Commands" rel="nofollow noopener">https://www.whonix.org/wiki/Common_Whonix_CLI_Commands</a><br>
Are there any commonly used programs which need root at runtime?</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T13:01:34Z' class='post-time'>
                September 8, 2019,  1:01pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T13:01:34Z'>
          <span itemprop='position'>#14</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Without root/sudo goes long way.</p>
<p>(Maybe search wiki for sudo and grep Whonix source code for sudo.)</p>
<p>Why you’re asking?</p>
<p>Can we somehow disable or even delete the root user? If possible this might make sense in a nonpersistent + noroot boot.</p>
<p>From there we can expand.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Algernon'><span itemprop='name'>Algernon</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T13:53:16Z' class='post-time'>
                September 8, 2019,  1:53pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T13:53:16Z'>
          <span itemprop='position'>#15</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="14" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/p/898d66/40.png" class="avatar"> Patrick_mobile:</div>
<blockquote>
<p>Can we somehow disable or even delete the root user?</p>
</blockquote>
</aside>
<p>Yes, thats the idea I had in mind.<br>
When grepping through the source code most stuff was related to apt, also sdwdate + some whonix scripts. I don’t know if you can restrict sudo to a limited set of commands. Also apparmor could maybe restrict the few remaining cases and forbid everything else for root. In case the system would use something like dm-verity apt-get would also be pointless I guess. You would need some other mechanism to push upgrades.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T14:44:48Z' class='post-time'>
                September 8, 2019,  2:44pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T14:44:48Z'>
          <span itemprop='position'>#16</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>These special cases and upgrading aren’t blockers. Solutions can be searched later. It’s worth pursuing this idea of disabling/deleting independently. For example for boot in live + noroot it totally makes sense.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T17:10:39Z' class='post-time'>
                September 8, 2019,  5:10pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T17:10:39Z'>
          <span itemprop='position'>#17</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="13" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/a/a183cd/40.png" class="avatar"> Algernon:</div>
<blockquote>
<p>Are there any commonly used programs which need root at runtime?</p>
</blockquote>
</aside>
<p>I’d imagine many systemd services would be running as the root user.</p>
<aside class="quote no-group" data-post="14" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/p/898d66/40.png" class="avatar"> Patrick_mobile:</div>
<blockquote>
<p>Can we somehow disable or even delete the root user?</p>
</blockquote>
</aside>
<p>I don’t think this would be the best idea. As I said above, many services would be running as the root user and deleting root entirely would break it unless systemd can somehow grant more privileges as it’s the init process.</p>
<p>Running <code>sudo userdel -f root</code> kinda worked but the root user was back again after a reboot.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T17:40:52Z' class='post-time'>
                September 8, 2019,  5:40pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T17:40:52Z'>
          <span itemprop='position'>#18</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="17" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>I don’t think this would be the best idea. As I said above, many services would be running as the root</p>
</blockquote>
</aside>
<p>Any we care about at live boot?</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T17:47:23Z' class='post-time'>
                September 8, 2019,  5:47pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T17:47:23Z'>
          <span itemprop='position'>#19</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="18" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/p/898d66/40.png" class="avatar"> Patrick_mobile:</div>
<blockquote>
<p>Any we care about at live boot?</p>
</blockquote>
</aside>
<p>Yes. Nearly every service runs as the root user. Running</p>
<pre><code>grep "User=" /lib/systemd/system/*.service
</code></pre>
<p>just shows a few services. If a service doesn’t select a specific user, it uses the root user by default.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Algernon'><span itemprop='name'>Algernon</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-09T09:22:23Z' class='post-time'>
                September 9, 2019,  9:22am
              </time>
              <meta itemprop='dateModified' content='2019-09-09T09:22:23Z'>
          <span itemprop='position'>#20</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="17" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>I’d imagine many systemd services would be running as the root user.</p>
</blockquote>
</aside>
<p>Ahh sure. Let me rephrase it: Is there any reason an average user would need to elevate its privileges to run program X?</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-09T16:21:52Z' class='post-time'>
                September 9, 2019,  4:21pm
              </time>
              <meta itemprop='dateModified' content='2019-09-09T16:21:52Z'>
          <span itemprop='position'>#21</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="20" data-topic="7998">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/a/a183cd/40.png" class="avatar"> Algernon:</div>
<blockquote>
<p>Let me rephrase it: Is there any reason an average user would need to elevate its privileges to run program X?</p>
</blockquote>
</aside>
<p>For ordinary use cases, probably not.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-10-29T15:06:50Z' class='post-time'>
                October 29, 2019,  3:06pm
              </time>
              <meta itemprop='dateModified' content='2019-10-29T15:06:50Z'>
          <span itemprop='position'>#22</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>A step into the direction of untrusted root:</p>
<aside class="quote quote-modified" data-post="1" data-topic="8339">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar">
    <a href="../../apparmor-for-complete-system-including-init-pid1-systemd-everything-full-system-mac-policy/8339.html">AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy</a> <a class="badge-wrapper  bullet" href="../../../c/apparmor/14.html"><span class="badge-category-bg" style="background-color: #12A89D;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Discussion of Whonix AppArmor Profiles for better security. (devs)">AppArmor</span></a>
  </div>
  <blockquote>
    Currently, Whonix only has AppArmor profiles for a few high-risk applications. This isn’t the best. It would be much better to have everything confined by default, including init which would greatly increase security. 
This can also help a lot with the “<a href="../7998.html">untrusted root</a>” idea as we can just develop a system-wide policy to restrict root. 
AppArmor can do this by loading a profile for systemd in the initramfs. 


Even when a user installs some sketchy malware, it will be restricted by default. 
This…
  </blockquote>
</aside>

        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-10-29T15:10:01Z' class='post-time'>
                October 29, 2019,  3:10pm
              </time>
              <meta itemprop='dateModified' content='2019-10-29T15:10:01Z'>
          <span itemprop='position'>#23</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>It restricts root pretty well already. Only 26 capabilities out of 38 are permitted and I’ve plans to restrict this even further.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-10-29T15:21:24Z' class='post-time'>
                October 29, 2019,  3:21pm
              </time>
              <meta itemprop='dateModified' content='2019-10-29T15:21:24Z'>
          <span itemprop='position'>#24</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>stackexchange bounty posted here:</p>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" target="_blank" rel="nofollow noopener">security.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://security.stackexchange.com/users/106285/forest" target="_blank" rel="nofollow noopener">
    <img alt="forest" src="../../../../external.html?link=https://www.gravatar.com/avatar/9ea7efef9a3212242d84ebc53ccae61d?s=128&amp;d=identicon&amp;r=PG&amp;f=1" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" target="_blank" rel="nofollow noopener">Methods root can use to elevate itself to kernel mode</a>
</h4>

<div class="tags">
  <strong>linux, exploit, privilege-escalation, kernel</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../../external.html?link=https://security.stackexchange.com/users/106285/forest" target="_blank" rel="nofollow noopener">
    forest
  </a>
  on <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" target="_blank" rel="nofollow noopener">02:50AM - 07 Apr 16 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-10-31T10:26:07Z' class='post-time'>
                October 31, 2019, 10:26am
              </time>
              <meta itemprop='dateModified' content='2019-10-31T10:26:07Z'>
          <span itemprop='position'>#25</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><a href="../../../../external.html?link=https://security.stackexchange.com/users/165253/forest" rel="nofollow noopener">forest</a> is the author or <a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" rel="nofollow noopener">https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode</a>. Contacted <a href="../../../../external.html?link=https://security.stackexchange.com/users/165253/forest" rel="nofollow noopener">forest</a>.</p>
<p>Quote <a href="../../../../external.html?link=https://www.whonix.org/pipermail/whonix-devel/2019-October/001471.html" rel="nofollow noopener">https://www.whonix.org/pipermail/whonix-devel/2019-October/001471.html</a></p>
<p>On 2019-10-29 03:36 PM, Patrick Schleizer wrote:</p>
<blockquote>
<p>Hi forest,</p>
<p>we are working on software packages towards untrusted root. Please<br>
kindly consider joining our efforts.</p>
<p><a href="../../../../external.html?link=https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode" rel="nofollow noopener">https://security.stackexchange.com/questions/119712/methods-root-can-use-to-elevate-itself-to-kernel-mode</a>&gt;<br>
<a href="../7998.html" class="inline-onebox">Untrusted Root - improve Security by Restricting Root</a>&gt;<br>
<a href="../../../../external.html?link=https://github.com/Whonix/security-misc" rel="nofollow noopener">https://github.com/Whonix/security-misc</a></p>
<p><a href="../../apparmor-for-complete-system-including-init-pid1-systemd-everything-full-system-mac-policy/8339.html" class="inline-onebox">AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy</a>&gt;<br>
Kind regards,<br>
Patrick</p>
</blockquote>
<p>forest <a href="mailto:forestmerge@airmail.cc">forestmerge@airmail.cc</a> relied:</p>
<blockquote>
<p>I’m not able to assist full-time but I may be available for consultancy over email. There are a few things that I should mention about untrusted root that are necessary prerequisites for doing so securely, though:</p>
<ol>
<li>
<p>A solid formal threat model is a must. It’s the only way to ensure all developers are on the same page. It’s even better if it includes data flow diagrams for at-risk processes. Threat modeling becomes more complex if privesc is in-scope, but for a serious project, it’s worth the investment in the long run.</p>
</li>
<li>
<p>AppArmor is probably not going to cut it. Although there are hacky ways to get it to work with PID 1, you’d be much better off with SELinux or, even better, Grsecurity’s RBAC (requires subscription, but provides overwhelmingly better security than possible with vanilla Linux).</p>
</li>
<li>
<p>There’s no safe way to run Xorg with multiple mutually-distrusting users at the same time (e.g. a regular user and a root shell). The same is true with other utilities like tmux, but Xorg is the most common culprit of bypasses for a desktop system.</p>
</li>
</ol>
</blockquote>
<p>Forwarded here with permission.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7998.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-10-31T14:47:53Z' class='post-time'>
                October 31, 2019,  2:47pm
              </time>
              <meta itemprop='dateModified' content='2019-10-31T14:47:53Z'>
          <span itemprop='position'>#26</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>It’s great forest agreed to help us.</p>
<blockquote>
<p>AppArmor is probably not going to cut it. Although there are hacky ways to get it to work with PID 1, you’d be much better off with SELinux or, even better, Grsecurity’s RBAC (requires subscription, but provides overwhelmingly better security than possible with vanilla Linux).</p>
</blockquote>
<p>SELinux would be preferred but I have no experience in writing SELinux policies so I can’t work with it.</p>
<p>Grsec RBAC isn’t really a viable option. We’d need to pay grsec a large amount of money to be able to distribute it in Whonix, if they’d even let us at all.</p>
        </div>

        <meta itemprop='headline' content='Untrusted Root - improve Security by Restricting Root'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><b><a rel="next" itemprop="url" href="../79984658.html?page=2">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

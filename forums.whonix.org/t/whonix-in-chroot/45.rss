<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Whonix in chroot</title>
    <link>http://forums.whonix.org/t/whonix-in-chroot/45</link>
    <description>The chroot installation.
1- Gentoo hardened base system in chroot.
2- xorg-server on Gentoo.
3- Openbox, a small window manager, in Gentoo
4- Virtualbox in Gentoo (the difficult part).

Using.
1- Start a second display in the main OS, with Xnest (geometry 1024x768).
2- In chroot, launch Openbox in the second display.
3- Virtualbox starts in Openbox autostart.  

The setup works, I am using it to post this. It would have to be fine tuned with SELinux and PaX. Now, I am not sure that I fully understand all the implications, about the kernel setup amongst other things. 

Am I right saying that on top of virtualization, it could add two layers of isolation, with chroot and SELinux? Is that worth the effort?

About security, Virtualbox was built with PaX enabled, but there is an issue with &#39;virtualbox.so&#39; saying “it will not work properly (or at all!)”. Well, it works. Searching.</description>
    <language>en</language>
    <lastBuildDate>Tue, 31 Mar 2020 09:02:43 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/whonix-in-chroot/45.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="mirimir" data-post="35" data-topic="45">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/mirimir/40/28_2.png" class="avatar"> mirimir:</div>
<blockquote>
<p>What about LXC?</p>
<p>Would Tor in a LXC container on the host and a workspace VM provide adequate isolation?</p>
<p>Or even both Tor and workspace in separate LXC containers?</p>
</blockquote>
</aside>
<p>Please see:<br>
<a href="https://www.whonix.org/forum/index.php/topic,258.msg1716.html#msg1716" class="onebox" target="_blank">https://www.whonix.org/forum/index.php/topic,258.msg1716.html#msg1716</a></p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/36">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/36</link>
        <pubDate>Wed, 30 Apr 2014 09:15:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-36</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[mirimir]]></dc:creator>
        <description><![CDATA[
            <p>What about LXC?</p>
<p>Would Tor in a LXC container on the host and a workspace VM provide adequate isolation?</p>
<p>Or even both Tor and workspace in separate LXC containers?</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/35">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/35</link>
        <pubDate>Tue, 29 Apr 2014 23:25:16 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-35</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Whonix in chroot thread continuation:<br>
<a href="https://www.whonix.org/forum/index.php/topic,272.0.html" class="onebox" target="_blank">https://www.whonix.org/forum/index.php/topic,272.0.html</a></p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/33">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/33</link>
        <pubDate>Tue, 29 Apr 2014 18:07:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-33</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>I might not have been entirely correct in <a href="https://www.whonix.org/forum/index.php/topic,24.30.html">https://www.whonix.org/forum/index.php/topic,24.30.html</a> about what I said about chroot/security in the begining of the thread.</p>
<p>Recently there has been an interesting discussion on the debian-security mailing list:</p>
<ul>
<li><a href="https://lists.debian.org/debian-security/2014/04/msg00068.html">https://lists.debian.org/debian-security/2014/04/msg00068.html</a></li>
<li><a href="https://lists.debian.org/debian-security/2014/04/msg00069.html">https://lists.debian.org/debian-security/2014/04/msg00069.html</a></li>
</ul>
<p>Links to:<br>
<a href="http://www.elstel.org/xchroot/" class="onebox" target="_blank">http://www.elstel.org/xchroot/</a></p>
<p>Quite interesting.</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/34">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/34</link>
        <pubDate>Tue, 29 Apr 2014 18:07:07 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-34</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[troubadour]]></dc:creator>
        <description><![CDATA[
            <p>AppArmor thread continuation:<br>
<a href="https://www.whonix.org/forum/index.php/topic,97.0.html" class="onebox" target="_blank" rel="nofollow noopener">https://www.whonix.org/forum/index.php/topic,97.0.html</a></p>
<p>Edited by Patrick.</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/32">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/32</link>
        <pubDate>Thu, 27 Feb 2014 19:54:51 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-32</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>I used the profile form <a href="http://whonix.org/wiki/AppArmor">whonix.org/wiki/AppArmor</a>, I assume that was correct.</p>
<p>Works for me in a fresh Whonix 8 VM (also not when installing a fresh Tor Browser). Doesn’t work in an existing Whonix 8 VM (still logs me out).</p>
<p>Got a denied message now in my existing Whonix 8 VM.</p>
<pre><code class="lang-auto"></code></pre>
<p>In my fresh Whonix 8 VM I got a different denied message.</p>
<pre><code class="lang-auto">apparmor="DENIED" operation="open" parent=1 profile="/home/user/tor-browser_en-US/Browser/firefox" name="/home/user/.cache/event-sound-cache.tdb.b08dfa6083e7567a1921a715000001fb.i486-pc-linux-gnu" pid=6881 comm="firefox" requested_mask="rwc" denied_mask="rwc" fsuid=1000 ouid=1000</code></pre>
<p>Git would be good. If this is going to be a generic profile, please don’t add “whonix” into its repository name.</p>
<p>I am not sure that everyone else is reading this topic. The title and beginning of the topic was about something else. Perhaps we should close this topic? Could you create a new topic please? (Title perhaps: “Whonix Security Hardening: Help Test AppArmor Profiles” or something like that?) (Feel free to copy and paste anything useful.)</p>
<p>(Oh, and in case I didn’t say yet, don’t consider my wiki changes final. Always open for improvement.)</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/31">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/31</link>
        <pubDate>Thu, 27 Feb 2014 12:45:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-31</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[troubadour]]></dc:creator>
        <description><![CDATA[
            <p>Ah, we might have a strange problem here. The profile works for me, just a couple of minor messages to fix. When using the Tor browser, I am actually well confined: VirtualBox in the host and TBB in Whonix are enforced.</p>
<p>I assume you are using a freshly built Whonix workstation. This is the only thing I see that can explain the difference between yours and mine, regarding AppArmor. So, either I take the plunge into git now (anyhow, I will have tot do it, sooner or later), or in the meantime, someone working with Whonix development, building on an everyday basis, takes ten minutes once in while to test the profile and forward the results in this thread.</p>
<p>I am not asking you, Patrick, I am sure you have enough to do. May be Occq? Cerberus?</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/30">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/30</link>
        <pubDate>Thu, 27 Feb 2014 08:04:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-30</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Generally speaking:<br>
We don’t have to backport things to Whonix 7 when Whonix 8 is out. Support for Whonix 7 will be ended shortly after Whonix 8 is released.</p>
<p>In this particular case:<br>
Backporting could be useful, because Whonix 7 is based on Debian testing (currently jessie) while Whonix 8 is based on Debian stable (currently wheezy). (jessie &gt; wheezy) Some day Whonix will be based on jessie, having the profile ready is a good thing.</p>
<p>The profile itself:<br>
I don’t know the answers. Can only say, the TBB profile doesn’t work for me, unfortunately. Still logs me out. No AppArmor messages in syslog. Does it work for you already?</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/29">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/29</link>
        <pubDate>Wed, 26 Feb 2014 23:13:05 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-29</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[troubadour]]></dc:creator>
        <description><![CDATA[
            <p>I have started <a href="https://www.whonix.org/wiki/AppArmor" rel="nofollow noopener">https://www.whonix.org/wiki/AppArmor</a>, basically copying/pasting from the Advanced Security Guide with a new TBB profile. Please feel free to modify my preamble.</p>
<p>I had to add a few lines due to changing to Whonix 7.7.9.8. The apparmor message you report with ‘/etc/gnome-vfs-2.0/modules/’ does not happen here. The directory is not existing. I have added two lines for that, though, rather blindly. Which brings a question: “Why?”.</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/28">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/28</link>
        <pubDate>Wed, 26 Feb 2014 20:35:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-28</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Logged into the default desktop KDE / KDM.</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/27">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/27</link>
        <pubDate>Wed, 26 Feb 2014 12:19:48 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-27</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[troubadour]]></dc:creator>
        <description><![CDATA[
            <blockquote>I tested the Tor Browser profile on Whonix 7.7.9.8. Doesn't work there. Got logged out and needed to re-login in KDM.</blockquote>
<p>In which environment were you logged? I am in Whonix 7.7.9.8 and the only choice I am given seems to be KDM.</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/26">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/26</link>
        <pubDate>Tue, 25 Feb 2014 21:04:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-26</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <blockquote>I have downloaded and verified 7.7.9.8, but I am still using 7.7.8.6. It should be fixed soon. That is a problem I have encountered already while testing TBB in the host. A new DE brings new denied messages. I have Debian wheezy with Gnome3, KDE, Xfce4 and LXDE in four different VMs. The plan is trying to write 'universal' profiles, but I prefer to work first on the tailored ones for Whonix.</blockquote>
Sounds good.
<blockquote>That would be much better. I was actually thinking in the same line, but I thought it would be too big a step. The fact of linking the page from different places in the wiki would attract more attention from the users.</blockquote>
Not that a big step. The Advanced Security Guide has limited use for most users. It contains good inspiration and suggestions, but these are time intensive to learn and apply. A bit theoretic. While the AppArmor profiles are are very practical thing. Once fixed, they can be easily applied by quickly copying and pasting a few commands.
<p>I’ve created an empty page:<br>
</p><aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/AppArmor" target="_blank" title="09:28PM - 25 April 2020">Whonix – 25 Apr 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:640/480;"><img src="https://www.whonix.org/w/images/f/f1/Coat-of-mail-948960640.jpg" class="thumbnail" width="640" height="480"></div>

<h3><a href="https://www.whonix.org/wiki/AppArmor" target="_blank">AppArmor</a></h3>

<p>AppArmor profiles (Security Hardening) for Whonix ™ and other Linux distributions.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/25">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/25</link>
        <pubDate>Tue, 25 Feb 2014 15:39:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-25</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[troubadour]]></dc:creator>
        <description><![CDATA[
            <blockquote>Have you tested it on Debian-stable based Whonix already (7.7.9.8 )? 7.7.9.8 will most likely soon become Whonix 8 unless someone reports a severe bug.</blockquote>
<p>I have downloaded and verified 7.7.9.8, but I am still using 7.7.8.6. It should be fixed soon. That is a problem I have encountered already while testing TBB in the host. A new DE brings new denied messages. I have Debian wheezy with Gnome3, KDE, Xfce4 and LXDE in four different VMs. The plan is trying to write ‘universal’ profiles, but I prefer to work first on the tailored ones for Whonix.</p>
<blockquote>Could do. Alternative suggestion. What do you think about creating an own page for AppArmor profiles? Looks like we're overloading the Advanced Security Guide and we have enough content to justify an own AppArmor page. (The AppArmor page would of course be linked form Advanced Security Guide and other important pages such as Documentation.)</blockquote>
<p>That would be much better. I was actually thinking in the same line, but I thought it would be too big a step. The fact of linking the page from different places in the wiki would attract more attention from the users.</p>
<p>After the profiles are thoroughly tested, creating a separate package would of course be perfect.</p>
<p>I’ll update on the progress. Fisrt, Whonix 8.</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/24">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/24</link>
        <pubDate>Tue, 25 Feb 2014 14:48:54 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-24</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>I tested the Tor Browser profile on Whonix 7.7.9.8. Doesn’t work there. Got logged out and needed to re-login in KDM.</p>
<pre><code class="lang-auto"></code></pre>
<p>Have you tested it on Debian-stable based Whonix already (7.7.9.8)? 7.7.9.8 will most likely soon become Whonix 8 unless someone reports a severe bug.</p>
<blockquote>Could you briefly explain how to create a template and import it in the page?</blockquote>
Create a page https://www.whonix.org/wiki/Template:SomethingX and in some other page such as https://www.whonix.org/wiki/Pagename you can use {{SomethingX}} as a magic word then.
<blockquote>I think we could create a new subsection in the Advanced Security Guide ('AppArmor Profiles' or something) and edit it from the template. For the moment, we would put  Pidgin and TBB there. Later on, Icedove (I am working on it) and any network facing application you and others might think of. I'd be happy to try to confine them.</blockquote>
Could do. Alternative suggestion. What do you think about creating an own page for AppArmor profiles? Looks like we're overloading the Advanced Security Guide and we have enough content to justify an own AppArmor page. (The AppArmor page would of course be linked form Advanced Security Guide and other important pages such as Documentation.)
<p>I am happy for any work on AppArmor profiles. Already thinking about creating a separate package for them or even one package per profile. (Profile installation can be simplified for users as in “sudo apt-get install apparmor-torbrowser” or so.)</p>
<p>A quick thought, my personal wishlist for most endangered, network facing applications is (starting with most important): TBB, Icedove, Pidgin, XChat, timesync.</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/23">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/23</link>
        <pubDate>Tue, 25 Feb 2014 12:49:57 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-23</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[troubadour]]></dc:creator>
        <description><![CDATA[
            <blockquote>In this particular case, we could also move the AppArmor profile to a template,
and import it in the Advanced Security Guide. Then you'd only get notification
for profiles changes, not for other changes to that page.</blockquote>
<p>Could you briefly explain how to create a template and import it in the page? I think we could create a new subsection in the Advanced Security Guide (‘AppArmor Profiles’ or something) and edit it from the template. For the moment, we would put  Pidgin and TBB there. Later on, Icedove (I am working on it) and any network facing application you and others might think of. I’d be happy to try to confine them. Now, if someone wants to join, she/he is welcome.</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/22">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/22</link>
        <pubDate>Tue, 25 Feb 2014 08:20:42 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-22</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Done.<br>
(Template: <a href="https://www.whonix.org/wiki/Template:AppArmorProfileWarning">https://www.whonix.org/wiki/Template:AppArmorProfileWarning</a>)</p>
<p>No malicious edits until now. Trolling unfortunately gets more problematic as the project grows.</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/21">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/21</link>
        <pubDate>Mon, 24 Feb 2014 13:18:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-21</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[troubadour]]></dc:creator>
        <description><![CDATA[
            <p>I am now ‘watching’ the wiki page. In the experimental warning, could you please replace ‘Pidgin’ with ‘TBB’? I do not know how to do that.</p>
<blockquote>Please inform me, should there be ever malicious changes in the wiki.</blockquote>
Do you see many malicious edits of the wiki?
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/20">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/20</link>
        <pubDate>Mon, 24 Feb 2014 13:03:10 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-20</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>I reviewed the wiki change but not the profile itself. I’ll test that profile myself soon.</p>
<p>Also added “troubadour created this profile. You can discuss it in this forum thread.” and improved the experimental warning.</p>
<p>It would be nice if you could “watch” the pages you’ve edited. Which<br>
means, you’d get automatically informed by e-mail.</p>
<p>If you want…</p>
<p>Please check on <a href="https://www.whonix.org/wiki/Special:Preferences">https://www.whonix.org/wiki/Special:Preferences</a> you see<br>
"Your email address was confirmed…"</p>
<p>And please enable</p>
<ul>
<li>Email me when a page or file on my watchlist is changed</li>
<li>Email me also for minor edits of pages and files</li>
</ul>
<p>Then go for example to the wiki page you edited. Near<br>
top there is a “View history” button. Next to it is a button with an<br>
arrow down. There you’ll find the “watch” function.</p>
<p>Alternatively there is the recent changes page<br>
<a href="https://www.whonix.org/w/index.php?title=Special:RecentChanges&amp;hidemyself=1" class="onebox" target="_blank">https://www.whonix.org/w/index.php?title=Special:RecentChanges&amp;hidemyself=1</a><br>
and if desired we could try to get a working rss feed for it. Or perhaps just<br>
a rss feed for that wiki page.</p>
<p>In this particular case, we could also move the AppArmor profile to a template,<br>
and import it in the Advanced Security Guide. Then you’d only get notification<br>
for profiles changes, not for other changes to that page.</p>
<p>Please inform me, should there be ever malicious changes in the wiki.</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/19">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/19</link>
        <pubDate>Mon, 24 Feb 2014 10:16:32 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-19</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[troubadour]]></dc:creator>
        <description><![CDATA[
            <p>I have added the TBB profile in the wiki.  <a href="https://www.whonix.org/w/index.php?title=Advanced_Security_Guide&amp;stable=0&amp;shownotice=1&amp;fromsection=Whonix-Workstation_Security#Tor_Browser_Bundle_.28TBB.29" rel="nofollow noopener">https://www.whonix.org/w/index.php?title=Advanced_Security_Guide&amp;stable=0&amp;shownotice=1&amp;fromsection=Whonix-Workstation_Security#Tor_Browser_Bundle_.28TBB.29</a></p>
<p>Can you review it?</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/18">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/18</link>
        <pubDate>Sun, 23 Feb 2014 21:48:49 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-18</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>When the user runs Whonix’s torbrowser updater as another user other than user such as user2, it stores the profile in user2’s home folder. This is untested, but should work.</p>
<p>Anyway, if it would help, the extraction path for torbrowser can be easily changed. Even be configurable through whatever means are comfortable. These would be simple changes I am happy to make.</p>
<p>If /opt is non-writable, how can settings such as bookmarks be stored?</p>
<p>Using /opt seems like a non-standard way and always when you go non-standard ways there is risk to hit issues sooner or later. I though /home/ is the standard way to extract tbb.</p>
<blockquote>Before linking the profile in the wiki, perhaps I should wait for more testing?</blockquote>
No need to wait. You may edit the wiki. As long we're honest about things, I see no issues with that.
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/17">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/17</link>
        <pubDate>Fri, 21 Feb 2014 00:23:23 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-17</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[troubadour]]></dc:creator>
        <description><![CDATA[
            <p>The latest TBB profile. I put it here first.</p>
<p>File ‘/etc/apparmor.d/home.user.tor-browser_en-US.Browser.firefox’</p>
<pre><code class="lang-auto"># Last Modified: Thu Feb 20 21:22:24 2014
#include &lt;tunables/global&gt;

/home/user/tor-browser_en-US/Browser/firefox {
	#include &lt;abstractions/base&gt;
	#include &lt;abstractions/user-tmp&gt;
	#include &lt;abstractions/bash&gt;
	
	capability sys_ptrace,

	network,
	network tcp,

	deny /etc/host.conf r,
	deny /etc/hosts r,
	deny /etc/nsswitch.conf r,
	deny /etc/resolv.conf r,
	deny /proc/9881/mountinfo r,
	deny @{HOME}/.config/user-dirs.dirs r,
	deny @{HOME}/.gtk-bookmarks r,
	deny @{HOME}/.local/share/recently-used.xbel* rw,

	/bin/dash rix,
	/bin/open rix,
	/bin/ps rix,		
	
	/dev/dri/card0 rw,
	/dev/vboxuser rw,
	/dev/tty r,

	/etc/drirc r,
	/etc/X11/cursors/* r,
	/etc/fonts/** r,
	/etc/mime.types r,
	/etc/mailcap r,
	deny /etc/passwd r,
	deny /etc/resolv.conf.whonix r,
	deny /etc/hosts.whonix r,

	owner @{HOME}/tor-browser_en-US/.mozilla/ w,
	owner @{HOME}/tor-browser_en-US/.mozilla/*/ w,
	owner @{HOME}/tor-browser_en-US/Browser/** r,
	owner @{HOME}/tor-browser_en-US/Browser/*.so mr,
	owner @{HOME}/tor-browser_en-US/Browser/browser/components/*.so mr,
	owner @{HOME}/tor-browser_en-US/Browser/components/*.so mr,
	owner @{HOME}/tor-browser_en-US/Browser/firefox rix,
	owner @{HOME}/tor-browser_en-US/Data/Browser/ r,
	owner @{HOME}/tor-browser_en-US/Data/Browser/** rwk,
	owner @{HOME}/tor-browser_en-US/Desktop/ rw,
	owner @{HOME}/tor-browser_en-US/Desktop/** rw,
	owner @{HOME}/tor-browser_en-US/Downloads/ rw,
	owner @{HOME}/tor-browser_en-US/Downloads/** rw,
	owner @{HOME}/tor-browser_en-US/Tor/tor Px,

	
	## Authentification for user. Probably required with Gnome.
	deny /run/gdm3/** r,

	/sys/devices/system/cpu/ r,
	/sys/devices/system/cpu/* r,

	/tmp/.X0-lock r,

	## Looks like a nvidia audio driver. Hardware dependent.
	deny /usr/lib/i386-linux-gnu/dri/swrast_dri.so m,

	## Alphabets libraries.
	/usr/lib/i386-linux-gnu/pango/1.6.0/modules/* m,

	/usr/share/ r,
	/usr/share/fonts/ r,
	/usr/share/fonts/** r,
	/usr/share/icons/ r,
	/usr/share/icons/** r,
	deny /usr/share/mime/ r,
	deny /usr/share/mime/** r,
	/usr/share/pixmaps/ r,
	/usr/share/pixmaps/** r,
	/usr/share/themes/ r,
	/usr/share/themes/** r,

	## Desktop environment dependent.
	deny /usr/share/applications/** r,

	/var/cache/fontconfig/* r,
	/var/lib/dbus/machine-id r,

	## In 'Edit/Preferences', set 'Saves files to' -&gt; 'Downloads'.	
	owner @{HOME}/Downloads/* rw,

	owner @{HOME}/.Xauthority r,
	deny owner @{HOME}/.local/share/applications/mimeapps.list r,
	owner @{HOME}/.icons/ r,
	owner @{HOME}/.icons/** r,
	owner @{HOME}/.local/share/icons/ r,
	owner @{HOME}/.themes/** r,
	deny owner @{HOME}/.local/share/gvfs-metadata/home r,
	owner @{HOME}/.cache/ r,
	owner @{HOME}/.cache/* rwk,
	
	@{PROC} r,
	@{PROC}/[0-9]*/maps r,
	deny @{PROC}/[0-9]*/mounts r,
	deny @{PROC}/[0-9]*/mountinfo r,
	@{PROC}/[0-9]*/stat r,
	@{PROC}/[0-9]*/status r,
	@{PROC}/[0-9]*/task/*/stat r,
	@{PROC}/cpuinfo r,
	@{PROC}/filesystems r,
	@{PROC}/meminfo r,
	@{PROC}/stat r,
	@{PROC}/sys/kernel/pid_max r,
	@{PROC}/uptime r,
}</code></pre>
<p>I believe it is not too lax as is. I have used it for a few days.There will certainly be some situations when it will flash some denied messages, so the more people use it, the better the testing.</p>
<p>The procedure to enforce the profile.</p>
<ul>
<li>Copy/paste the the code in kwrite.</li>
<li>Save the file as ‘home.user.tor-browser_en-US.Browser.firefox’</li>
<li>Copy the file in ‘/etc/apparmor.d’</li>
<li>‘sudo chown root:root /etc/apparmor.d/user.tor-browser_en-US.Browser.firefox’</li>
<li>‘sudo chmod +x /etc/apparmor.d/user.tor-browser_en-US.Browser.firefox’</li>
<li>‘sudo aa-enforce /etc/apparmor.d/user.tor-browser_en-US.Browser.firefox’</li>
</ul>
<p>Start the Tor browser.<br>
‘sudo aa-status’ should output</p>
<p><code>AppArmor available in kernel.
2 profiles are loaded.
2 profiles are in enforce mode.
   /*
   /home/user/tor-browser_en-US/Browser/firefox
0 profiles are in complain mode.
1 processes have profiles defined.
1 processes are in enforce mode.
   /home/user/tor-browser_en-US/Browser/firefox (5735) 
0 processes are in complain mode.
0 processes are unconfined but have a profile defined.</code></p>
<p>You should see more info there, as I have cleaned the ‘apparmor.d’ directory to leave only the profile under test. AppArmor loads some profile by default.</p>
<p>Adrelanos, a problem I can foresee. In Whonix, TBB is installed in ‘/home/user’, the default home directory. If a user decides to change this to his name or whatever, and I am sure some do, then he would have to modify the profile.<br>
Radostan Riedel, the author of the profile I have based mine on, installs TBB in ‘/opt’. That seems to be a fair move, as it refers to a non modifiable location.</p>
<p>Before linking the profile in the wiki, perhaps I should wait for more testing?</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/16">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/16</link>
        <pubDate>Thu, 20 Feb 2014 22:59:28 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-16</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[troubadour]]></dc:creator>
        <description><![CDATA[
            <p>The TBB profile is now working in Whonix. The problem mentioned earlier in <a href="https://www.whonix.org/forum/index.php/topic,56.0.html" rel="nofollow noopener">https://www.whonix.org/forum/index.php/topic,56.0.html</a> (process not enforced) was a typo in the profile name.  :-[</p>
<p>It still looks too permissive, I have to fine tune it before putting it here and in the wiki. I’ll probably push a less specific  version to Debian. i have read somewhere that it is in their wish list, so they might react…</p>
<p>Edit. The profile is tested with Xfce4. All the references to KDE are commented.</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/15</link>
        <pubDate>Wed, 19 Feb 2014 04:55:55 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-15</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[troubadour]]></dc:creator>
        <description><![CDATA[
            <blockquote>To whom?</blockquote>
To Intrigeri. He was replying to your bug report https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=732578 and another one, earlier.
<p>I will pass the profile to Ubuntu. They look more active where it concerns AppArmor. To get some inspiration, they have a good list of profiles at <a href="https://bazaar.launchpad.net/~apparmor-dev/apparmor-profiles/master/files/head:/ubuntu/" rel="nofollow noopener">https://bazaar.launchpad.net/~apparmor-dev/apparmor-profiles/master/files/head:/ubuntu/</a></p>
<p>Just installed Whonix 7.7.8.6 (testers). I have noticed tat the process ‘system-tor’ is no longer enforced in the gateway.</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/14</link>
        <pubDate>Sat, 15 Feb 2014 14:13:15 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-14</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <blockquote>Even if this is more a Debian than a Whonix issue, here is the latest on the profile.</blockquote>
Thank you for sharing this!
<blockquote>I have submitted the profile to Debian.</blockquote>
To whom?
<blockquote>I am waiting for a reply from apparmor@packages.debian.org.</blockquote>
Last time I mailed it didn't take long. A day or two or so.
<blockquote>If I submit it to Ubuntu, is there a chance that it spreads back to Debian?</blockquote>
There are chances for seeing the profile automagically flowing back to Debian, but these are low and could take years, I think. Anyway. It doesn't need to happen automagically. Working with Ubuntu will improve your Debian skill as well, since Ubuntu in essence is also just Debian with modifications. Having the profile accepted in Ubuntu, which seems simpler, makes it more likely to get the profile accepted in Debian, because you can say "it's already merged in Ubuntu". So working with them is useful in any case.
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/13</link>
        <pubDate>Sat, 15 Feb 2014 11:03:23 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-13</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
      <item>
        <title>Whonix in chroot</title>
        <dc:creator><![CDATA[troubadour]]></dc:creator>
        <description><![CDATA[
            <p>Even if this is more a Debian than a Whonix issue, here is the latest on the profile.</p>
<p>In my previous post, I was over-reacting. It was the matter of one line. Had to find it.<br>
It was tested with Debian testing and Ubuntu 12.04 in VMs, so in enforce mode.</p>
<p>I have submitted the profile to Debian. Here is the first reply:</p>
<blockquote>I'm not personally directly interested in such a profile, and am not
using VirtualBox, so it would be better to send it to the apparmor
mailing-list? I'm sure someone else will happily review it :)
<p>(Don’t hesitate to ping them every two weeks <img src="//forums.whonix.org/images/emoji/twitter/wink.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
</blockquote><br>
I am waiting for a reply from <a href="mailto:apparmor@packages.debian.org">apparmor@packages.debian.org</a>. They have no mailing list that I know of. If I submit it to Ubuntu, is there a chance that it spreads back to Debian?
<p>For those interested, the updated profile.</p>
<p>[code]<span class="hashtag">#include</span> &lt;tunables/global&gt;</p>
<p>/usr/bin/VBox {<br>
<span class="hashtag">#include</span> &lt;abstractions/base&gt;<br>
<span class="hashtag">#include</span> &lt;abstractions/bash&gt;<br>
<span class="hashtag">#include</span> &lt;abstractions/fonts&gt;	<br>
<span class="hashtag">#include</span> &lt;abstractions/audio&gt;</p>
<pre><code>capability net_admin, 
capability net_raw,
capability sys_ptrace,

owner @{HOME}/.ICEauthority r,
owner @{HOME}/.Xauthority r,
owner @{HOME}/.config/** r,
owner @{HOME}/.config/VirtualBox/** rw,
owner @{HOME}/.config/Trolltech.conf rk,
owner @{HOME}/.local/share/mime/* r,			
owner @{HOME}/.gtk-bookmarks r,

owner @{HOME}/ r,
</code></pre>
<h2>The disk images have to be there. All the other locations are denied.</h2>
<pre><code>owner @{HOME}/Disk_Images/ r,
owner @{HOME}/Disk_Images/* r,
</code></pre>
<h2>The default virtual machines directory.</h2>
<pre><code>owner "@{HOME}/VirtualBox VMs/" r,
owner "@{HOME}/VirtualBox VMs/**" rw,
</code></pre>
<h2>When importing an appliance, default opening directory.</h2>
<pre><code>owner @{HOME}/Documents/ r,
</code></pre>
<h2>Shared foders. Replace with your own host share.</h2>
<pre><code>owner @{HOME}/share/* r,
</code></pre>
<h2>Guest settings. Required?</h2>
<pre><code>/usr/lib/x86_64-linux-gnu/pango/** 	m,
/usr/lib/x86_64-linux-gnu/dri/* 	m,
/dev/dri/card0 rw,
/etc/drirc  r,
</code></pre>
<h2>Some directories (themes, pixmap) denied. Check.</h2>
<p>###############################</p>
<h1>/usr/share/icons/* r,</h1>
<h1>/usr/share/themes/** r,</h1>
<h1>/usr/share/icons/** rk,</h1>
<h1>/usr/share/mime/** r,</h1>
<h1>/usr/share/pixmaps/** r,</h1>
<h1>/usr/share/virtualbox/** r,</h1>
<p>###############################</p>
<h2>So, the easy way.</h2>
<pre><code>/usr/share/** rk,
/usr/local/share/** r,     	

/bin/dash 	ix,
/bin/kmod 	ix,
/bin/grep 	ix,
/bin/uname 	ix,
/bin/cat 	ix,
/bin/gawk 	ix,
</code></pre>
<h2>Pops two ‘denied’ messages at vbox start when uncommented. No other penalty.</h2>
<h2>Giving permission to ‘rm’ and ‘rmdir’ makes one nervous.</h2>
<p>#######################################</p>
<h1>/bin/ps PUx,		## ‘rix’ denied.</h1>
<h1>/bin/rm PUx,		## ‘rix’ denied.</h1>
<h1>/bin/rmdir PUx,		## ‘rix’ denied.</h1>
<h1>/bin/open rPUx,		## ‘rix’ denied.</h1>
<p>#######################################</p>
<pre><code>/usr/bin/whoami		ix,
/usr/bin/gawk 		ix,
/usr/bin/mawk 		ix,
/usr/bin/basename 	ix,
/usr/bin/VBox 		rix,
</code></pre>
<h1>owner /tmp/** rw,</h1>
<h2>Could use only the necessary libs. Gain?</h2>
<pre><code>/usr/lib/virtualbox/** mrix,
</code></pre>
<h2>unconfined ??? ‘rix’ denied.</h2>
<pre><code>/usr/lib/virtualbox/VBoxXPCOMIPCD cux,	

/etc/nsswitch.conf 	r,
/etc/passwd 		r,
/etc/resolv.conf 	r,

/dev/vboxdrv 		rw,
/dev/vboxdrvu 		rw,

/proc/ 				r,
/proc/cmdline 		r,
/proc/modules 		r,
/proc/net 			r,
/proc/*/cmdline 	r,
/proc/*/net/** 		r,

/sys/devices/pci0000:00/** 				r,
/sys/devices/virtual/** 				r,
/sys/devices/system/cpu/** 				r,
/sys/devices/LNXSYSTM:00/LNXSYBUS:00/** r,
/sys/module/** 							r,		## tweak
/sys/block/ 							r,
/sys/class/** 							r,	
</code></pre>
<h2>If missing, guest error  ‘No audio devices could be opened’.</h2>
<pre><code>/var/lib/dbus/machine-id r,
</code></pre>
<h2>Authorisation for user: ‘/auth-for-userxxxx/database’.</h2>
<pre><code>/run/gdm3/** r,
</code></pre>
<h2>Site-specific additions and overrides.</h2>
<h1>
<span class="hashtag">#include</span> &lt;local/usr.bin.VBox&gt;</h1>
<p>}[/code]</p>
          <p><a href="http://forums.whonix.org/t/whonix-in-chroot/45/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-in-chroot/45/12</link>
        <pubDate>Sat, 15 Feb 2014 08:32:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-45-12</guid>
        <source url="http://forums.whonix.org/t/whonix-in-chroot/45.rss">Whonix in chroot</source>
      </item>
  </channel>
</rss>

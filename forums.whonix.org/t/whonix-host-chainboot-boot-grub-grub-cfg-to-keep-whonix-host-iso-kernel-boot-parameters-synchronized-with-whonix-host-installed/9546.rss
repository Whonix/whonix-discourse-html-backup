<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Whonix-Host: chainboot /boot/grub/grub.cfg to keep Whonix-Host ISO kernel boot parameters synchronized with Whonix-Host Installed</title>
    <link>http://forums.whonix.org/t/whonix-host-chainboot-boot-grub-grub-cfg-to-keep-whonix-host-iso-kernel-boot-parameters-synchronized-with-whonix-host-installed/9546</link>
    <description>Goal: keep Whonix-Host ISO kernel boot parameters synchronized with Whonix-Host Installed with no manual code changes requires as kernel boot parameters change.

[quote=&quot;Patrick, post:219, topic:3894&quot;]
Why are kernel boot paramaters (such as `spectre_v2=on spec_store_bypass_disable=on tsx=off` …) defined in both files:

* [grub.cfg](https://github.com/Whonix/Whonix/blob/master/iso/grub.cfg)
* [isolinux.cfg](https://github.com/Whonix/Whonix/blob/master/iso/isolinux.cfg)
[/quote]

[quote=&quot;onion_knight, post:220, topic:3894&quot;]
One is for GRUB (when booting in EFI), the other is for Isolinux (when booting in BIOS).
[/quote]
In both cases...
(isolinux -&gt; chainload grub?)

Could we `embed` `/boot/grub/grub.cfg` to keep kernel boot parameters of Whonix-Host in ISO mode in sync with Whonix-Host Installed?

What I mean by `embed`:

* grub supports a feature similar to bash&#39;s `source` command
* (Or `sh`&#39;s `.` command).
* https://www.gnu.org/software/grub/manual/grub/grub.html#Embedded-configuration
* https://www.gnu.org/software/grub/manual/grub/grub.html#configfile
  * &gt; Command: **configfile** *file*
    * &gt;Load file as a configuration file. If file defines any menu entries, then show a menu containing them immediately. Any environment variable changes made by the commands in file will not be preserved after configfile returns.
* https://www.gnu.org/software/grub/manual/grub/grub.html#index-source
  * &gt; Command: **source** *file*
    *  &gt; Read file as a configuration file, as if its contents had been incorporated directly into the sourcing file. Unlike configfile (see configfile), this executes the contents of file without changing context: any environment variable changes made by the commands in file will be preserved after source returns, and the menu will not be shown immediately.

----

Ideally [grub.cfg](https://github.com/Whonix/Whonix/blob/master/iso/grub.cfg) runs &quot;`source /boot/grub/grub.cfg`&quot;.
 
[isolinux.cfg](https://github.com/Whonix/Whonix/blob/master/iso/isolinux.cfg) -&gt; chainboots grub -&gt; &quot;`source /boot/grub/grub.cfg`&quot;..

&quot;`source /boot/grub/grub.cfg`&quot; might not work as if. Might need to define device somehow.</description>
    <language>en</language>
    <lastBuildDate>Sun, 17 May 2020 09:00:16 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/whonix-host-chainboot-boot-grub-grub-cfg-to-keep-whonix-host-iso-kernel-boot-parameters-synchronized-with-whonix-host-installed/9546.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Whonix-Host: chainboot /boot/grub/grub.cfg to keep Whonix-Host ISO kernel boot parameters synchronized with Whonix-Host Installed</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Goal: keep Whonix-Host ISO kernel boot parameters synchronized with Whonix-Host Installed with no manual code changes requires as kernel boot parameters change.</p>
<aside class="quote no-group" data-username="Patrick" data-post="219" data-topic="3894">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"><a href="//forums.whonix.org/t/whonix-live-mode-amnesia-amnesic-non-persistent-anti-forensics/3894/219">Whonix live mode / amnesia / amnesic / non-persistent / anti-forensics</a>
</div>
<blockquote>
<p>Why are kernel boot paramaters (such as <code>spectre_v2=on spec_store_bypass_disable=on tsx=off</code> …) defined in both files:</p>
<ul>
<li><a href="https://github.com/Whonix/Whonix/blob/master/iso/grub.cfg">grub.cfg</a></li>
<li><a href="https://github.com/Whonix/Whonix/blob/master/iso/isolinux.cfg">isolinux.cfg</a></li>
</ul>
</blockquote>
</aside>
<aside class="quote no-group" data-username="onion_knight" data-post="220" data-topic="3894">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"><a href="//forums.whonix.org/t/whonix-live-mode-amnesia-amnesic-non-persistent-anti-forensics/3894/220">Whonix live mode / amnesia / amnesic / non-persistent / anti-forensics</a>
</div>
<blockquote>
<p>One is for GRUB (when booting in EFI), the other is for Isolinux (when booting in BIOS).</p>
</blockquote>
</aside>
<p>In both cases…<br>
(isolinux -&gt; chainload grub?)</p>
<p>Could we <code>embed</code> <code>/boot/grub/grub.cfg</code> to keep kernel boot parameters of Whonix-Host in ISO mode in sync with Whonix-Host Installed?</p>
<p>What I mean by <code>embed</code>:</p>
<ul>
<li>grub supports a feature similar to bash’s <code>source</code> command</li>
<li>(Or <code>sh</code>'s <code>.</code> command).</li>
<li><a href="https://www.gnu.org/software/grub/manual/grub/grub.html#Embedded-configuration">https://www.gnu.org/software/grub/manual/grub/grub.html#Embedded-configuration</a></li>
<li>
<a href="https://www.gnu.org/software/grub/manual/grub/grub.html#configfile">https://www.gnu.org/software/grub/manual/grub/grub.html#configfile</a>
<ul>
<li>
<blockquote>
<p>Command: <strong>configfile</strong> <em>file</em></p>
</blockquote>
<ul>
<li>
<blockquote>
<p>Load file as a configuration file. If file defines any menu entries, then show a menu containing them immediately. Any environment variable changes made by the commands in file will not be preserved after configfile returns.</p>
</blockquote>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href="https://www.gnu.org/software/grub/manual/grub/grub.html#index-source">https://www.gnu.org/software/grub/manual/grub/grub.html#index-source</a>
<ul>
<li>
<blockquote>
<p>Command: <strong>source</strong> <em>file</em></p>
</blockquote>
<ul>
<li>
<blockquote>
<p>Read file as a configuration file, as if its contents had been incorporated directly into the sourcing file. Unlike configfile (see configfile), this executes the contents of file without changing context: any environment variable changes made by the commands in file will be preserved after source returns, and the menu will not be shown immediately.</p>
</blockquote>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<p>Ideally <a href="https://github.com/Whonix/Whonix/blob/master/iso/grub.cfg">grub.cfg</a> runs “<code>source /boot/grub/grub.cfg</code>”.</p>
<p><a href="https://github.com/Whonix/Whonix/blob/master/iso/isolinux.cfg">isolinux.cfg</a> -&gt; chainboots grub -&gt; “<code>source /boot/grub/grub.cfg</code>”…</p>
<p>“<code>source /boot/grub/grub.cfg</code>” might not work as if. Might need to define device somehow.</p>
          <p><a href="http://forums.whonix.org/t/whonix-host-chainboot-boot-grub-grub-cfg-to-keep-whonix-host-iso-kernel-boot-parameters-synchronized-with-whonix-host-installed/9546/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-host-chainboot-boot-grub-grub-cfg-to-keep-whonix-host-iso-kernel-boot-parameters-synchronized-with-whonix-host-installed/9546/1</link>
        <pubDate>Sun, 17 May 2020 09:00:16 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9546-1</guid>
        <source url="http://forums.whonix.org/t/whonix-host-chainboot-boot-grub-grub-cfg-to-keep-whonix-host-iso-kernel-boot-parameters-synchronized-with-whonix-host-installed/9546.rss">Whonix-Host: chainboot /boot/grub/grub.cfg to keep Whonix-Host ISO kernel boot parameters synchronized with Whonix-Host Installed</source>
      </item>
  </channel>
</rss>

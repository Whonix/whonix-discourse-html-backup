<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>replacing initramfs-tools with dracut</title>
    <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487</link>
    <description>If we want to implement a [live boot](https://phabricator.whonix.org/T714) option for Whonix we maybe need to change the default tool for generating the initramfs from the current initramfs-tools to [dracut](https://dracut.wiki.kernel.org/index.php/Main_Page). Therefore, also some minor changes to the build scripts are required.

Dracut is mostly used by everything Fedora based (RedHat, CentOS, Qubes) and OpenSuse. Initramfs-tools is used by Debian and derivatives by default. 
I couldn&#39;t find any important differences between both, which doesn&#39;t mean they don&#39;t exist. Dracut is also in the Debian repos and seems to be well maintained.

The current patches for live boot are based on the dracut version in testing. Compared to the version from stable/stretch the major difference for us is the lack of overlayfs support which is present in testing. However, live systems are still possible with device mapper which should be the default imho. 
For differences between overlayfs  and devicemapper see [here](https://phabricator.whonix.org/T714#14714) .
In contrast, initramfs-tools from debian supports overlayfs but not device-mapper. But in principle it should also be possible to have such a live system with initramfs-tools. 

I currently don&#39;t expect any major issues from changing initramfs-tools to dracut though including the patches it might be more tricky.
We have several options:

1.
Use the version from stable/stretch and patch it so we can use live systems with device mapper. 
Pro: Would have the lowest risk of breaking something.
Con: Somewhat lower functionality/flexibility since no overlayfs.

2. 
Wait for the testing package to be backported and then use this + our patches.
Pro: Would have overlayfs support. Low risk of breaking something.
Con: There is a backport from the current version for jessie. Not sure if there will be one for the version we need. Maybe ask the maintainer of the package.

3.
Use the package from testing + add our patches.
Pro: Would have overlayfs support. We don&#39;t have to wait for a backport.
Con: We need to watch out for upstream changes. Need to ensure the right version is used or adapt the patch. Higher risk that something might break.
I&#39;m not sure if it is possible to install a package from testing during an upgrade where the testing package is an exact version and is listed as &quot;Depends&quot; in the control file. This is relevant if we want to go from Whonix 13 to Whonix 14 + dracut.

4.
Maintain our own dracut from testing with patches already included
Pro: Would have overlayfs support. We don&#39;t have to wait for a backport.
       We don&#39;t need an extra live patch package.
Con: We probably still need to look out for changes when some package which dracut depends on gets changed. Maybe higher maintenence burden.

5.
 Take a look at initramfs-tools again and try to implement our live mode there.
Pro: Fewer changes. Initramfs-tools is debian default.
Con: Only overlayfs support. Probably also some patches required.

The patches deal only with the live system. If something breaks due to a new upstream package then only the live system should break. Normal boot should still work. 
At the moment I mostly dealt with option 3 and 1 going to look at 5 again. Dracut itself depends only on a few packages and I don&#39;t know if anything would break if it suddenly would pull in dependencies with a higher version number than currently installed.</description>
    <language>en</language>
    <lastBuildDate>Sun, 03 Jul 2022 10:05:41 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Good progress.</p>
<aside class="quote no-group" data-username="Patrick" data-post="17" data-topic="4487">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>document how to install dracut in a chroot</p>
</blockquote>
</aside>
<ul>
<li><a href="https://github.com/dracutdevs/dracut/issues/1596#issuecomment-1166326409">https://github.com/dracutdevs/dracut/issues/1596#issuecomment-1166326409</a></li>
</ul>
<aside class="quote no-group" data-username="Patrick" data-post="16" data-topic="4487">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>dracut support</p>
</blockquote>
</aside>
<ul>
<li><a href="https://github.com/grml/grml-debootstrap/issues/186#issuecomment-1167412137">https://github.com/grml/grml-debootstrap/issues/186#issuecomment-1167412137</a></li>
</ul>
<aside class="onebox githubpullrequest" data-onebox-src="https://github.com/grml/grml-debootstrap/pull/196">
  <header class="source">

      <a href="https://github.com/grml/grml-debootstrap/pull/196" target="_blank" rel="noopener">github.com/grml/grml-debootstrap</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/grml/grml-debootstrap/pull/196" target="_blank" rel="noopener">Add dracut support</a>
    </h4>

    <div class="branches">
      <code>grml:master</code> ← <code>DanWin:dracut-support</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2022-07-01" data-time="20:06:39" data-timezone="UTC">08:06PM - 01 Jul 22 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/DanWin" target="_blank" rel="noopener">
          <img alt="DanWin" src="https://avatars.githubusercontent.com/u/3327912?v=4" class="onebox-avatar-inline" width="20" height="20">
          DanWin
        </a>
      </div>

      <div class="lines" title="1 commits changed 3 files with 14 additions and 2 deletions">
        <a href="https://github.com/grml/grml-debootstrap/pull/196/files" target="_blank" rel="noopener">
          <span class="added">+14</span>
          <span class="removed">-2</span>
        </a>
      </div>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">Implements #186</p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/20">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/20</link>
        <pubDate>Sun, 03 Jul 2022 10:05:41 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-20</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Dark_Coder" data-post="18" data-topic="4487">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/dark_coder/40/2788_2.png" class="avatar"> Dark_Coder:</div>
<blockquote>
<p>Is this what you meant by “live mode” in this thread? Where on directly boots into kernel and stays in there the first time?</p>
</blockquote>
</aside>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">

      <a href="https://www.whonix.org/wiki/VM_Live_Mode" target="_blank" rel="noopener" title="03:47PM - 28 April 2021">Whonix – 28 Apr 21</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:131/72;"><img src="https://www.whonix.org/w/images/b/bf/Live_boot.png" class="thumbnail" width="131" height="72"></div>

<h3><a href="https://www.whonix.org/wiki/VM_Live_Mode" target="_blank" rel="noopener">VM Live Mode: Stop Persistent Malware</a></h3>

  <p>Read-only mode. Make all writes go to non-persistent memory (RAM) instead of the hard disk. This is NOT an anti-forensics feature! For anti-forensics, check out Host Live Mode.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">

      <a href="https://www.whonix.org/wiki/Host_Live_Mode" target="_blank" rel="noopener" title="08:37PM - 11 September 2021">Whonix – 11 Sep 21</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:131/101;"><img src="https://www.whonix.org/w/images/b/b3/Hostlive.png" class="thumbnail" width="131" height="101"></div>

<h3><a href="https://www.whonix.org/wiki/Host_Live_Mode" target="_blank" rel="noopener">Host Live Mode: Boot existing Host Operating System into Live Mode</a></h3>

  <p>Add a Live Mode entry to the grub boot menu on your existing Debian host platform. Stop Persistent Malware. Read-only mode. Make all writes go to non-persistent storage (RAM) instead of the hard disk.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">

      <a href="https://www.whonix.org/wiki/grub-live" target="_blank" rel="noopener" title="04:13PM - 16 September 2021">Whonix – 16 Sep 21</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:131/87;"><img src="https://www.whonix.org/w/images/a/a6/Grublive123123.jpg" class="thumbnail" width="131" height="87"></div>

<h3><a href="https://www.whonix.org/wiki/grub-live" target="_blank" rel="noopener">grub-live: Boot existing Host Operating System or VM into Live Mode</a></h3>

  <p>Add a Live Mode entry to the grub boot menu on your existing Debian host platform. Stop Persistent Malware. Read-only mode. Make all writes go to non-persistent storage (RAM) instead of the hard disk.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-username="Dark_Coder" data-post="18" data-topic="4487">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/dark_coder/40/2788_2.png" class="avatar"> Dark_Coder:</div>
<blockquote>
<p>Having made many initramfs … by hand, <code>update-initramfs</code> seems the fastest (but of course).</p>
<p>I remember the days of Kconfig trimming until got it to work without modules yet still does PGP signing (mostly for WiFi country code frequency database.</p>
</blockquote>
</aside>
<p>Could you help please getting Whonix build process compatible with dracut?</p>
<p>Currently the issue is that it won’t boot. Won’t find root device. This is because dracut even with <code>dracut-config-generic</code> installed fails to create a generic initramfs. Got the issue that either drivers used on the build host system are leaked into the VMs initramfs or that the VMs initramfs is lacking essential drivers such as <code>ext4.ko</code> and whatnot.</p>
<p>Didn’t manage to write a full bug report for dracut yet since it’s really complex.</p>
<p>Dracut would need to create a generic + reproducible (deterministic) initramfs inside the build chroot.</p>
<p>Simplified, desired output is: grml-debootstrap + grub + dracut → Whonix VirtualBox bootable VM image.</p>
          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/19">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/19</link>
        <pubDate>Mon, 04 Oct 2021 13:27:02 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-19</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Dark_Coder]]></dc:creator>
        <description><![CDATA[
            <p>Having made many initramfs … by hand, <code>update-initramfs</code> seems the fastest (but of course).</p>
<p>I remember the days of Kconfig trimming until got it to work without modules yet still does PGP signing (mostly for WiFi country code frequency database.</p>
<p>Is this what you meant by “live mode” in this thread? Where on directly boots into kernel and stays in there the first time?</p>
          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/18">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/18</link>
        <pubDate>Sun, 03 Oct 2021 20:39:24 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-18</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox githubissue">
  <header class="source">

      <a href="https://github.com/dracutdevs/dracut/issues/1596" target="_blank" rel="noopener">github.com/dracutdevs/dracut</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue">
	  <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/dracutdevs/dracut/issues/1596" target="_blank" rel="noopener">document how to install dracut in a chroot</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2021-09-05" data-time="00:50:56" data-timezone="UTC">12:50AM - 05 Sep 21 UTC</span>
      </div>


      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>
    </div>

    <div class="labels">
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">documents</span>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">I'd like to create a bootable VM image with dracut using chroot. Cannot find any<span class="show-more-container"><a href="http://forums.whonix.org" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden"> documentation except [this](https://piiis.blogspot.com/2013/07/fedora-dracut-in-chroot-environment.html) which doesn't work for me.

After the VM is booted, dracut takes a long time to timeout and then in the debut shell I can see that folder `/dev/disk` does not exist.

How to install dracut inside a chroot?</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/17">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/17</link>
        <pubDate>Sun, 05 Sep 2021 00:51:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-17</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox githubissue">
  <header class="source">

      <a href="https://github.com/grml/grml-debootstrap/issues/186" target="_blank" rel="noopener">github.com/grml/grml-debootstrap</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue">
	  <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/grml/grml-debootstrap/issues/186" target="_blank" rel="noopener">dracut support</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2021-09-02" data-time="23:22:00" data-timezone="UTC">11:22PM - 02 Sep 21 UTC</span>
      </div>


      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>
    </div>

    <div class="labels">
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">Could you add dracut support please?

https://packages.debian.org/dracut
</p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/16">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/16</link>
        <pubDate>Thu, 02 Sep 2021 23:22:39 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-16</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>dracut advantages:</p>
<ul>
<li>early sysctl settings by default (<a href="https://forums.whonix.org/t/kernel-hardening/7296/459" class="inline-onebox">Kernel Hardening - #459 by Patrick</a>)</li>
<li><a href="https://www.freedesktop.org/wiki/Software/systemd/InitrdInterface/" class="inline-onebox">InitrdInterface</a></li>
<li>arm64 initramfs build issues experienced by <a class="mention" href="http://forums.whonix.org/u/hulahoop">@HulaHoop</a> might not be happening with dracut</li>
<li>easier to implement Wipe RAM on shutdown (<a href="https://forums.whonix.org/t/is-ram-wipe-possible-inside-whonix-cold-boot-attack-defense/5596" class="inline-onebox">Is RAM Wipe possible inside Whonix? Cold Boot Attack Defense</a>)</li>
<li>maybe easier to implement <a href="https://forums.whonix.org/t/re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707" class="inline-onebox">(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?</a>
</li>
<li>maybe faster since dracut is using systemd at initramfs stage already</li>
</ul>
<p>dracut is kinda a “pre operating system” (“preOS”) as well as a “post operating system” (“postOS”). Similar to initramfs-tools but with an easier to use interface. initramfs-tools as far as I know also lacks a “postOS” feature.</p>
<hr>
<p><a href="https://wiki.gentoo.org/wiki/Dracut#List_of_modules" class="onebox" target="_blank" rel="noopener">https://wiki.gentoo.org/wiki/Dracut#List_of_modules</a></p>
<p><a href="https://mirrors.edge.kernel.org/pub/linux/utils/boot/dracut/dracut.html#_description_6" class="onebox" target="_blank" rel="noopener">https://mirrors.edge.kernel.org/pub/linux/utils/boot/dracut/dracut.html#_description_6</a></p>
          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/15</link>
        <pubDate>Wed, 01 Sep 2021 17:16:52 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-15</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>This post is Qubes specific only:</p>
<p>Trying to fix the Qubes-Whonix side:</p>
<aside class="onebox githubcommit">
  <header class="source">

      <a href="https://github.com/Whonix/qubes-whonix/commit/683c5ee6247dd562fa52789c5475621f43a95377" target="_blank" rel="noopener">github.com/Whonix/qubes-whonix</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/qubes-whonix/commit/683c5ee6247dd562fa52789c5475621f43a95377" target="_blank" rel="noopener">drop initramfs-tools from qubes-whonix-shared-packages-recommended</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2021-09-01" data-time="15:16:03" data-timezone="UTC">03:16PM - 01 Sep 21 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 1 files with 1 additions and 1 deletions">
        <a href="https://github.com/Whonix/qubes-whonix/commit/683c5ee6247dd562fa52789c5475621f43a95377" target="_blank" rel="noopener">
          <span class="added">+1</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">
leave that to Qubes

for dracut support

https://forums.whonix.org/t/replacing-<span class="show-more-container"><a href="https://github.com/Whonix/qubes-whonix/commit/683c5ee6247dd562fa52789c5475621f43a95377" target="_blank" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">initramfs-tools-with-dracut/4487/13</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>That fix was useful but not sure is sufficient. Qubes-Whonix side of fixing this should be complete. But I don’t know if Qubes Debian templates support dracut. If the answer is yes, it would be sufficient for Qubes-Whonix too. Otherwise still not.</p>
<p>Without using Qubes VM kernel initramfs-tools vs dracut is meaningless.</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.qubes-os.org/attachment/icons/512x512/apps/qubes-logo-icon.png" class="site-icon" width="16" height="16">

      <a href="https://www.qubes-os.org/doc/managing-vm-kernels/#using-kernel-installed-in-the-vm" target="_blank" rel="noopener">Qubes OS</a>
  </header>

  <article class="onebox-body">
    <img src="https://www.qubes-os.org/attachment/icons/qubes-logo-icon-name-slogan-fb.png" class="thumbnail onebox-avatar" width="16" height="16">

<h3><a href="https://www.qubes-os.org/doc/managing-vm-kernels/#using-kernel-installed-in-the-vm" target="_blank" rel="noopener">Managing qube kernels</a></h3>

  <p>By default, VMs kernels are provided by dom0. (See here for information about upgrading kernels in dom0.) This means that: You can select the kernel version (using GUI VM Settings tool or qvm-prefs commandline tool); You can modify kernel options...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-username="Patrick" data-post="12" data-topic="4487">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<pre><code class="lang-auto">sudo apt install --no-install-recommends dracut
</code></pre>
<p><code>--no-install-recommends</code> is mandatory.</p>
</blockquote>
</aside>
<p>Maybe not mandatory but <code>--no-install-recommends</code> highly recommended here.</p>
          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/14</link>
        <pubDate>Wed, 01 Sep 2021 15:48:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-14</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[TNT_BOM_BOM]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="235" data-topic="3894">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>grub-live dracut support has been implemented.</p>
</blockquote>
</aside>
<p>tested on whonix kvm (with live mode/read only)= working good.</p>
<p>but in qubes it gonna remove more/important packages:</p>
<pre><code>root@host:~# apt install dracut
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following packages were automatically installed and are no longer required:
  dctrl-tools dkms gettext-base grub-common grub2-common initramfs-tools-core
  klibc-utils libefiboot1 libefivar1 libklibc linux-base os-prober
  python3-distro python3-jinja2 python3-markupsafe python3-msgpack
  python3-pycryptodome python3-zmq qubes-core-agent-thunar
  qubes-input-proxy-sender qubes-kernel-vm-support
  qubes-mgmt-salt-vm-connector qubes-usb-proxy salt-common salt-ssh usbutils
Use 'apt autoremove' to remove them.
The following additional packages will be installed:
  console-setup console-setup-linux cryptsetup cryptsetup-bin
  cryptsetup-initramfs cryptsetup-run dmeventd dmraid dracut-core exim4-base
  exim4-config exim4-daemon-light gsasl-common guile-2.2-libs kbd kpartx
  libaio1 libdevmapper-event1.02.1 libdmraid1.0.0.rc16 libgnutls-dane0
  libgsasl7 liblvm2cmd2.03 libmailutils7 libmariadb3 libntlm0 libunbound8 lvm2
  mailutils mailutils-common mariadb-common mdadm mysql-common pigz pkg-config
  thin-provisioning-tools
Suggested packages:
  dosfstools keyutils dracut-network exim4-doc-html | exim4-doc-info eximon4
  spf-tools-perl swaks dns-root-data mailutils-mh mailutils-doc
The following packages will be REMOVED:
  initramfs-tools qubes-whonix-gateway
  qubes-whonix-shared-packages-recommended
The following NEW packages will be installed:
  console-setup console-setup-linux cryptsetup cryptsetup-bin
  cryptsetup-initramfs cryptsetup-run dmeventd dmraid dracut dracut-core
  exim4-base exim4-config exim4-daemon-light gsasl-common guile-2.2-libs kbd
  kpartx libaio1 libdevmapper-event1.02.1 libdmraid1.0.0.rc16 libgnutls-dane0
  libgsasl7 liblvm2cmd2.03 libmailutils7 libmariadb3 libntlm0 libunbound8 lvm2
  mailutils mailutils-common mariadb-common mdadm mysql-common pigz pkg-config
  thin-provisioning-tools
0 upgraded, 36 newly installed, 3 to remove and 0 not upgraded.
Need to get 17.4 MB of archives.
After this operation, 77.3 MB of additional disk space will be used.
Do you want to continue? [Y/n]</code></pre>
          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/13</link>
        <pubDate>Wed, 01 Sep 2021 01:58:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-13</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Whonix has now dracut support.<br>
grub-live has now dracut support as well.<br>
Available in all Whonix 16 repositories.<br>
To test:</p>
<pre><code>sudo apt install --no-install-recommends dracut
</code></pre>
<p><code>--no-install-recommends</code> is mandatory. Otherwise some package <code>Recommends:</code> <code>exim</code> (or MTA) which results in a dependency mess.</p>
<p>Whonix 16 might come with dracut by default.</p>
          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/12</link>
        <pubDate>Sun, 29 Aug 2021 19:41:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-12</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://gitlab.com/assets/favicon-7901bd695fb93edb07975966062049829afb56cf11511236e61bcf425070e36e.png" class="site-icon" width="16" height="16">

      <a href="https://gitlab.com/whonix/grub-live/-/commit/1989d6e12ac4e5eec03ed3b492c4c84fd6695fd9" target="_blank" rel="noopener">GitLab</a>
  </header>

  <article class="onebox-body">
    <img src="https://gitlab.com/assets/gitlab_logo-7ae504fe4f68fdebb3c2034e36621930cd36ea87924c11ff65dbcb8ed50dca58.png" class="thumbnail onebox-avatar" width="16" height="16">

<h3><a href="https://gitlab.com/whonix/grub-live/-/commit/1989d6e12ac4e5eec03ed3b492c4c84fd6695fd9" target="_blank" rel="noopener">add dracut support (1989d6e1) · Commits · Whonix / grub-live</a></h3>

  <p>Based on, and thanks to @friedrich12! https://github.com/friedrich12/dracut-grub-live https://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/10</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://gitlab.com/assets/favicon-7901bd695fb93edb07975966062049829afb56cf11511236e61bcf425070e36e.png" class="site-icon" width="16" height="16">

      <a href="https://gitlab.com/whonix/grub-live/-/commit/3bded2153eb311ee6f8571bf67483d3514d97ed0" target="_blank" rel="noopener">GitLab</a>
  </header>

  <article class="onebox-body">
    <img src="https://gitlab.com/assets/gitlab_logo-7ae504fe4f68fdebb3c2034e36621930cd36ea87924c11ff65dbcb8ed50dca58.png" class="thumbnail onebox-avatar" width="16" height="16">

<h3><a href="https://gitlab.com/whonix/grub-live/-/commit/3bded2153eb311ee6f8571bf67483d3514d97ed0" target="_blank" rel="noopener">remove dracut `hostonly="yes"` since that's Debian default anyhow (3bded215)...</a></h3>

  <p>optional grub live boot menu entry as second option https://www.whonix.org/wiki/Grub-live</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://gitlab.com/assets/favicon-7901bd695fb93edb07975966062049829afb56cf11511236e61bcf425070e36e.png" class="site-icon" width="16" height="16">

      <a href="https://gitlab.com/whonix/grub-live/-/commit/cb94f18bd47a56d0427e9ae822f966f32fd55f2e" target="_blank" rel="noopener">GitLab</a>
  </header>

  <article class="onebox-body">
    <img src="https://gitlab.com/assets/gitlab_logo-7ae504fe4f68fdebb3c2034e36621930cd36ea87924c11ff65dbcb8ed50dca58.png" class="thumbnail onebox-avatar" width="16" height="16">

<h3><a href="https://gitlab.com/whonix/grub-live/-/commit/cb94f18bd47a56d0427e9ae822f966f32fd55f2e" target="_blank" rel="noopener">fix, remove dracut `kernel_cmdline="rootovl"` (cb94f18b) · Commits · Whonix /...</a></h3>

  <p>since that is conditionally set in grub boot menu anyhow and otherwise the system would always boot into live mode</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://gitlab.com/assets/favicon-7901bd695fb93edb07975966062049829afb56cf11511236e61bcf425070e36e.png" class="site-icon" width="16" height="16">

      <a href="https://gitlab.com/whonix/kicksecure-meta-packages/-/commit/3b67c5c18981c7a3072ece594f94f98e9537cb1f" target="_blank" rel="noopener">GitLab</a>
  </header>

  <article class="onebox-body">
    <img src="https://gitlab.com/assets/gitlab_logo-7ae504fe4f68fdebb3c2034e36621930cd36ea87924c11ff65dbcb8ed50dca58.png" class="thumbnail onebox-avatar" width="16" height="16">

<h3><a href="https://gitlab.com/whonix/kicksecure-meta-packages/-/commit/3b67c5c18981c7a3072ece594f94f98e9537cb1f" target="_blank" rel="noopener">remove initramfs-tools from non-qubes-vm-enhancements-cli (3b67c5c1) · Commits...</a></h3>

  <p>for dracut support</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/11</link>
        <pubDate>Sun, 29 Aug 2021 19:25:20 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-11</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>This was sent to me:</p>
<pre><code class="lang-auto">hostonly="yes"
kernel_cmdline="rootovl"
filesystems+=overlay
</code></pre>
<pre><code>sudo dracut /boot/nonp.img
</code></pre>
<blockquote>
<p>Here is the boot entry I added to grub.cfg, which is just the regular boot entry with a different initrd.</p>
</blockquote>
<pre><code>menuentry 'Debian GNU/Linux Non-Persistent Live Mode' --class debian
--class gnu-linux --class gnu --class os $menuentry_id_option
'gnulinux-simple-845ea599-84cb-40c4-b556-f999fa4d389a' {

load_video

insmod gzio

if [ x$grub_platform = xxen ]; then insmod xzio; insmod lzopio; fi

insmod part_msdos

insmod ext2

set root='hd0,msdos1'

if [ x$feature_platform_search_hint = xy ]; then

  search --no-floppy --fs-uuid --set=root --hint-bios=hd0,msdos1
--hint-efi=hd0,msdos1 --hint-baremetal=ahci0,msdos1
e04cb268-48ff-46ef-8335-e7a954f6a9bd

else

  search --no-floppy --fs-uuid --set=root
e04cb268-48ff-46ef-8335-e7a954f6a9bd

fi

echo 'Loading Linux 5.10.0-8-amd64 ...'

linux /vmlinuz-5.10.0-8-amd64 root=/dev/mapper/magian--vg-root ro  quiet ro
rd.live.image

echo 'Loading initial ramdisk ...'

initrd /nonp.img #MY NEW IMAGE CREATED WITH sudo dracut /boot/nonp.img
--force

}
</code></pre>
<p>Untested.</p>
          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/10</link>
        <pubDate>Sat, 28 Aug 2021 10:22:37 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-10</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox githubissue">
  <header class="source">

      <a href="https://github.com/dracutdevs/dracut/issues/1565" target="_blank" rel="noopener">github.com/dracutdevs/dracut</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue">
	  <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/dracutdevs/dracut/issues/1565" target="_blank" rel="noopener">Boot Existing, Usual Linux Installation from Hard Disk in Live Mode / read-only mode with dracut</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2021-07-19" data-time="17:24:30" data-timezone="UTC">05:24PM - 19 Jul 21 UTC</span>
      </div>


      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>
    </div>

    <div class="labels">
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">enhancement</span>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">Feature request. What I would like to do:

1. Install Debian to HDD with encry<span class="show-more-container"><a href="http://forums.whonix.org" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">pted lvm using the usual installer.
2. Make any persistent changes normally.
3. Add dracut parameters to boot into non-persistent live mode.
(add an additional grub boot menu entry for ease of use to have a choice to boot into persistent mode or live (read-only) mode) 

Similar to [this](https://forums.opensuse.org/showthread.php/540709-Booting-a-persistent-USB-Live-15-1-stick-without-further-persistence) (alternative way to phrase this question).

Is this already possible with dracut?

By comparison, this is possible with initramfs-tools and grub.

* [Essentially just only 1 grub configuration drop-in file.](https://gitlab.com/whonix/grub-live/-/blob/master/etc/grub.d/11_linux_live) + `sudo update-grub`
* [Screenshots here.](https://www.whonix.org/wiki/Grub-live)</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/9</link>
        <pubDate>Mon, 19 Jul 2021 17:24:47 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-9</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>I haven’t found out that dpkg trigger:</p>
<blockquote>
<p>activate dracut</p>
</blockquote>
<p>exists. We can likely keep:</p>
<blockquote>
<p>activate update-initramfs</p>
</blockquote>
<hr>
<p><a href="https://packages.debian.org/bullseye/dracut-live" class="onebox" target="_blank" rel="noopener">https://packages.debian.org/bullseye/dracut-live</a></p>
<hr>
<p>/etc/dracut.conf.d/10-debian.conf as suggested by <a class="mention" href="http://forums.whonix.org/u/algernon">@Algernon</a></p>
<pre><code class="lang-auto">do_prelink=no
hostonly=no
add_dracutmodules+=" dmsquash-live pollcdrom crypt crypt-loop "
</code></pre>
<hr>
<pre><code class="lang-auto">apt-file list dracut-config-rescue
dracut-config-rescue: /etc/dracut.conf.d/20-rescue.conf
</code></pre>
<pre><code class="lang-auto">cat /etc/dracut.conf.d/20-rescue.conf
dracut_rescue_image="yes"
</code></pre>
<hr>
<pre><code class="lang-auto">apt-file list dracut-config-generic 
dracut-config-generic: /etc/dracut.conf.d/20-generic-image.conf
</code></pre>
<pre><code class="lang-auto">cat /etc/dracut.conf.d/20-generic-image.conf
hostonly="no"
</code></pre>
<hr>
<p>grml-debootstrap will probably need (calls update-initramfs):</p>
<pre><code class="lang-auto">export INITRD='no'
</code></pre>
          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/8</link>
        <pubDate>Mon, 19 Jul 2021 16:49:29 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-8</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Quote:</p>
<blockquote>
<p>Oh, and one last question before closing: instead of implementing these features in your own distro’s initrd, may I suggest just using Dracut instead? It’s all already implemented there!</p>
</blockquote>
<p>Source:<br>
<a href="https://www.freedesktop.org/wiki/Software/systemd/InitrdInterface/" class="onebox" target="_blank">https://www.freedesktop.org/wiki/Software/systemd/InitrdInterface/</a></p>
          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/7</link>
        <pubDate>Sat, 07 Mar 2020 17:29:22 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-7</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="360" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Or pass on dracut too and wait until minitrd is available from <a href="http://packages.debian.org">packages.debian.org</a>?</p>
</blockquote>
</aside>
<p>I wouldn’t hold my breath for minitrd unless the author tells you he’s going to put it in Debian for sure.</p>
          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/6</link>
        <pubDate>Mon, 03 Feb 2020 14:44:06 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-6</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>In <a href="https://forums.whonix.org/t/kernel-hardening/7296/360" class="inline-onebox">Kernel Hardening</a> I was wondering:</p>
<p>Or pass on dracut too and wait until minitrd is available from <a href="http://packages.debian.org">packages.debian.org</a>?</p>
<aside class="quote" data-post="1" data-topic="8865">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar">
    <a href="https://forums.whonix.org/t/minitrd-a-minimal-initramfs/8865">Minitrd - A minimal initramfs</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/development"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    minitrd is 20 times faster than dracut. It is part of the experimental distri distro that is about implementing fast package management with no goal to make it readily support other OSs. 
<a href="https://michael.stapelberg.ch/posts/2020-01-21-initramfs-from-scratch-golang/" class="onebox" target="_blank">https://michael.stapelberg.ch/posts/2020-01-21-initramfs-from-scratch-golang/</a> 
<a href="https://www.phoronix.com/scan.php?page=news_item&amp;px=Slow-Dracut-Minitrd-Faster" class="onebox" target="_blank">https://www.phoronix.com/scan.php?page=news_item&amp;px=Slow-Dracut-Minitrd-Faster</a>
  </blockquote>
</aside>

          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/5</link>
        <pubDate>Mon, 03 Feb 2020 07:03:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-5</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Alright, please change the Whonix default to <code>dracut</code> by submitting a pull request. <a class="mention" href="http://forums.whonix.org/u/algernon">@Algernon</a></p>
          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/4</link>
        <pubDate>Sun, 05 Nov 2017 23:41:36 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-4</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Thumbs up to Dracut. Its the modern, standardized successor to intramfs-tools</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://lwn.net/images/favicon.png" class="site-icon" width="32" height="32">
      <a href="https://lwn.net/Articles/317793/" target="_blank" rel="nofollow noopener">lwn.net</a>
  </header>
  <article class="onebox-body">
    

<h3><a href="https://lwn.net/Articles/317793/" target="_blank" rel="nofollow noopener">Dracut looks to replace the initramfs patchwork [LWN.net]</a></h3>

<p>Creating initramfs images, for use by the kernel at "early boot" time, is a
rather messy business.  It is made more so by the fact that each individual
distribution has its own tools to build the image, as well as its own set
of tools inside it.  At...</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/3</link>
        <pubDate>Sun, 05 Nov 2017 03:10:49 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-3</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Any reasons against moving to dracut? <a class="mention" href="http://forums.whonix.org/u/hulahoop">@HulaHoop</a></p>
          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/2</link>
        <pubDate>Sat, 04 Nov 2017 01:50:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-2</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
      <item>
        <title>replacing initramfs-tools with dracut</title>
        <dc:creator><![CDATA[Algernon]]></dc:creator>
        <description><![CDATA[
            <p>If we want to implement a <a href="https://phabricator.whonix.org/T714" rel="nofollow noopener">live boot</a> option for Whonix we maybe need to change the default tool for generating the initramfs from the current initramfs-tools to <a href="https://dracut.wiki.kernel.org/index.php/Main_Page" rel="nofollow noopener">dracut</a>. Therefore, also some minor changes to the build scripts are required.</p>
<p>Dracut is mostly used by everything Fedora based (RedHat, CentOS, Qubes) and OpenSuse. Initramfs-tools is used by Debian and derivatives by default.<br>
I couldn’t find any important differences between both, which doesn’t mean they don’t exist. Dracut is also in the Debian repos and seems to be well maintained.</p>
<p>The current patches for live boot are based on the dracut version in testing. Compared to the version from stable/stretch the major difference for us is the lack of overlayfs support which is present in testing. However, live systems are still possible with device mapper which should be the default imho.<br>
For differences between overlayfs  and devicemapper see <a href="https://phabricator.whonix.org/T714#14714" rel="nofollow noopener">here</a> .<br>
In contrast, initramfs-tools from debian supports overlayfs but not device-mapper. But in principle it should also be possible to have such a live system with initramfs-tools.</p>
<p>I currently don’t expect any major issues from changing initramfs-tools to dracut though including the patches it might be more tricky.<br>
We have several options:</p>
<ol>
<li>
</li>
</ol>
<p>Use the version from stable/stretch and patch it so we can use live systems with device mapper.<br>
Pro: Would have the lowest risk of breaking something.<br>
Con: Somewhat lower functionality/flexibility since no overlayfs.</p>
<ol start="2">
<li>
</li>
</ol>
<p>Wait for the testing package to be backported and then use this + our patches.<br>
Pro: Would have overlayfs support. Low risk of breaking something.<br>
Con: There is a backport from the current version for jessie. Not sure if there will be one for the version we need. Maybe ask the maintainer of the package.</p>
<ol start="3">
<li>
</li>
</ol>
<p>Use the package from testing + add our patches.<br>
Pro: Would have overlayfs support. We don’t have to wait for a backport.<br>
Con: We need to watch out for upstream changes. Need to ensure the right version is used or adapt the patch. Higher risk that something might break.<br>
I’m not sure if it is possible to install a package from testing during an upgrade where the testing package is an exact version and is listed as “Depends” in the control file. This is relevant if we want to go from Whonix 13 to Whonix 14 + dracut.</p>
<ol start="4">
<li>
</li>
</ol>
<p>Maintain our own dracut from testing with patches already included<br>
Pro: Would have overlayfs support. We don’t have to wait for a backport.<br>
We don’t need an extra live patch package.<br>
Con: We probably still need to look out for changes when some package which dracut depends on gets changed. Maybe higher maintenence burden.</p>
<ol start="5">
<li>
</li>
</ol>
<p>Take a look at initramfs-tools again and try to implement our live mode there.<br>
Pro: Fewer changes. Initramfs-tools is debian default.<br>
Con: Only overlayfs support. Probably also some patches required.</p>
<p>The patches deal only with the live system. If something breaks due to a new upstream package then only the live system should break. Normal boot should still work.<br>
At the moment I mostly dealt with option 3 and 1 going to look at 5 again. Dracut itself depends only on a few packages and I don’t know if anything would break if it suddenly would pull in dependencies with a higher version number than currently installed.</p>
          <p><a href="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/1</link>
        <pubDate>Fri, 03 Nov 2017 22:02:28 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4487-1</guid>
        <source url="http://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487.rss">replacing initramfs-tools with dracut</source>
      </item>
  </channel>
</rss>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</title>
    <link>http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951</link>
    <description>&lt;s&gt;Icons are missing on the desktop. They are in the /home/user/Desktop folder, however. This got lost somewhere between 13 and 14.&lt;/s&gt; (edit by Patrick to concentrate on initramfs in this split thread only.)

When the initramfs gets updated due to whatever reason (like new kernel, grub-live, manually running update-initramfs -u -k all) you get an additional boot delay of ~30 sec where it runs some scripts/local-block. This is a known issue:  https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=860533

RESUME=none has to be added either to /etc/initramfs-tools/initramfs.conf or to some file in /etc/initramfs-tools/conf.d/ and then upgrade the initramfs.
Not sure if this will have  any adverse effects though.

&lt;s&gt;Important for grub-live testers: ip=frommedia has to be added to the kernel command line either during boot or in grub.cfg. Otherwise the network interfaces won&#39;t be configured.&lt;/s&gt;

&gt; `Begin: Running /scripts/local-block ... done.`
&gt; `Begin: Running /scripts/local-block ... done.`
&gt; `Begin: Running /scripts/local-block ... done.`
&gt; `Begin: Running /scripts/local-block ... done.`
&gt; `Begin: Running /scripts/local-block ... done.`</description>
    <language>en</language>
    <lastBuildDate>Tue, 31 Dec 2019 12:26:44 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/swap-file-creator/commit/76b4c9fa064d92186bff12208430f8ecccc21732" target="_blank">github.com/Whonix/swap-file-creator</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/swap-file-creator/commit/76b4c9fa064d92186bff12208430f8ecccc21732" target="_blank">fix Non-Qubes-Whonix Whonix-Gateway slow boot</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-31" data-time="12:17:32" data-timezone="UTC">12:17PM - 31 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 9 additions and 0 deletions">
        <a href="https://github.com/Whonix/swap-file-creator/commit/76b4c9fa064d92186bff12208430f8ecccc21732" target="_blank">
          <span class="added">+9</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none
https://forums.whonix.org/t/swap-swap-file-whonix-gateway-freezing-during-apt-get-dist-upgrade-encrypted-swap-file-creator/8317
Thanks to Algernon for reporting this...</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/7</link>
        <pubDate>Tue, 31 Dec 2019 12:26:44 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4951-7</guid>
        <source url="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951.rss">initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</source>
      </item>
      <item>
        <title>initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>swap-file-creator is back.</p>
<aside class="quote quote-modified" data-post="1" data-topic="8317">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="https://forums.whonix.org/t/swap-swap-file-whonix-gateway-freezing-during-apt-get-dist-upgrade-encrypted-swap-file-creator/8317">swap - swap file - Whonix-Gateway freezing during apt-get dist-upgrade - encrypted swap-file-creator</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/development"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    Whonix-Gateway default RAM is currently set to 768 MB. 
(Whonix-Workstation default RAM is currently set to 2048 MB.) 
During upgrade Whonix-Gateway freezes. Not totally. But it looks frozen. The seconds on the clock stay at the same number for several minutes. This happens during module building (VirtualBox guest additions) as well as kernel header package upgrade. During that time, Tor running on Whonix-Gateway is not accessible from Whonix-Workstation. 
Hence, I plan to re-vitalize swap-file-…
  </blockquote>
</aside>

<p>And this issue is back too.</p>
          <p><a href="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/6</link>
        <pubDate>Tue, 31 Dec 2019 12:17:16 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4951-6</guid>
        <source url="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951.rss">initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</source>
      </item>
      <item>
        <title>initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</title>
        <dc:creator><![CDATA[Algernon]]></dc:creator>
        <description><![CDATA[
            <p>Works here.</p>
          <p><a href="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/5</link>
        <pubDate>Thu, 08 Mar 2018 22:45:20 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4951-5</guid>
        <source url="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951.rss">initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</source>
      </item>
      <item>
        <title>initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>swap-file-creator was removed from anon-meta-packages with today’s package upgrades for Whonix 14.</p>
<pre><code>sudo apt-get update
sudo apt-get dist-upgrade
</code></pre>
<p>Important, one has to apt-get autoremove so swap-file-creator gets removed.</p>
<pre><code>sudo apt-get autoremove
</code></pre>
<p>Please check if really removed.</p>
<pre><code>dpkg -l | grep swap-file-creator
</code></pre>
<p>After removal of swap-file-creator, I’ve run</p>
<pre><code>sudo update-initramfs -u
</code></pre>
<p>then after and didn’t see the <code>Begin: Running /scripts/local-block ... done.</code> that slowed down the boot.</p>
<p>Does this fix this issue for everyone else as well?</p>
          <p><a href="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/4</link>
        <pubDate>Thu, 08 Mar 2018 16:11:02 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4951-4</guid>
        <source url="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951.rss">initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</source>
      </item>
      <item>
        <title>initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</title>
        <dc:creator><![CDATA[Algernon]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="18" data-topic="4642">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Said to be fixed in 0.129 and stretch has 0.130? Are you sure this is still relevant?</p>
</blockquote>
</aside>
<p>Yes I was also wondering why but it still happens. According to man initramfs.conf the default behavior is to now resume from the largest swap partition which in case of Whonix is the encrypted one generated each time on boot.</p>
          <p><a href="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/3</link>
        <pubDate>Mon, 08 Jan 2018 19:33:13 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4951-3</guid>
        <source url="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951.rss">initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</source>
      </item>
      <item>
        <title>initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="17" data-topic="4642">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/a/a183cd/40.png" class="avatar"> Algernon:</div>
<blockquote>
<p>When the initramfs gets updated due to whatever reason (like new kernel, grub-live, manually running update-initramfs -u -k all) you get an additional boot delay of ~30 sec where it runs some scripts/local-block. This is a known issue:  <a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=860533">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=860533</a></p>
</blockquote>
</aside>
<p>Said to be fixed in <code>0.129</code> and stretch has <code>0.130</code>? Are you sure this is still relevant?</p>
<p>( <a href="https://packages.debian.org/stretch/initramfs-tools">https://packages.debian.org/stretch/initramfs-tools</a> )</p>
<aside class="quote" data-post="17" data-topic="4642">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/a/a183cd/40.png" class="avatar"> Algernon:</div>
<blockquote>
<p>RESUME=none has to be added either to /etc/initramfs-tools/initramfs.conf or to some file in /etc/initramfs-tools/conf.d/ and then upgrade the initramfs.</p>
</blockquote>
</aside>
<p><code>.d</code> always preferred.</p>
<aside class="quote" data-post="17" data-topic="4642">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/a/a183cd/40.png" class="avatar"> Algernon:</div>
<blockquote>
<p>Not sure if this will have  any adverse effects though.</p>
</blockquote>
</aside>
<p>Yes.</p>
<p>From their discussion… Is there a resume device UUID specified in <code>/etc/initramfs-tools/conf.d/resume</code> that does not exist? (Or any other initramfs config file?) If so, that could be a leftover from chroot build system, which I’d clean/up prevent somehow instead.</p>
<aside class="quote" data-post="17" data-topic="4642">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/a/a183cd/40.png" class="avatar"> Algernon:</div>
<blockquote>
<p>Icons are missing on the desktop. They are in the /home/user/Desktop folder, however. This got lost somewhere between 13 and 14.</p>
</blockquote>
</aside>
<p><code>sudo bash -x /var/lib/dpkg/info/whonix-ws-desktop-shortcuts.postinst configure</code> is probably fine. <code>~/Desktop</code> is probably fine. Requires enabling kde folderview desktop setting.</p>
<p>Problem is, no one knows how to enable kde-folderview in Stretch’s KDE version. So no more desktop shortcuts by default.</p>
<p><a href="https://phabricator.whonix.org/T633" class="onebox" target="_blank">https://phabricator.whonix.org/T633</a></p>
          <p><a href="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/2</link>
        <pubDate>Sun, 07 Jan 2018 14:51:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4951-2</guid>
        <source url="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951.rss">initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</source>
      </item>
      <item>
        <title>initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</title>
        <dc:creator><![CDATA[Algernon]]></dc:creator>
        <description><![CDATA[
            <p><s>Icons are missing on the desktop. They are in the /home/user/Desktop folder, however. This got lost somewhere between 13 and 14.</s> (edit by Patrick to concentrate on initramfs in this split thread only.)</p>
<p>When the initramfs gets updated due to whatever reason (like new kernel, grub-live, manually running update-initramfs -u -k all) you get an additional boot delay of ~30 sec where it runs some scripts/local-block. This is a known issue:  <a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=860533" rel="nofollow noopener">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=860533</a></p>
<p>RESUME=none has to be added either to /etc/initramfs-tools/initramfs.conf or to some file in /etc/initramfs-tools/conf.d/ and then upgrade the initramfs.<br>
Not sure if this will have  any adverse effects though.</p>
<p><s>Important for grub-live testers: ip=frommedia has to be added to the kernel command line either during boot or in grub.cfg. Otherwise the network interfaces won’t be configured.</s></p>
<blockquote>
<p><code>Begin: Running /scripts/local-block ... done.</code><br>
<code>Begin: Running /scripts/local-block ... done.</code><br>
<code>Begin: Running /scripts/local-block ... done.</code><br>
<code>Begin: Running /scripts/local-block ... done.</code><br>
<code>Begin: Running /scripts/local-block ... done.</code></p>
</blockquote>
          <p><a href="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951/1</link>
        <pubDate>Sat, 06 Jan 2018 19:26:58 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-4951-1</guid>
        <source url="http://forums.whonix.org/t/initramfs-tools-begin-running-scripts-local-block-done-takes-a-long-time-during-boot-resume-none/4951.rss">initramfs-tools - Begin: Running /scripts/local-block ... done. - takes a long time during boot - RESUME=none</source>
      </item>
  </channel>
</rss>

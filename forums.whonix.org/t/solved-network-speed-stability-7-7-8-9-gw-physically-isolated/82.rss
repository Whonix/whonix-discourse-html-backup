<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>[SOLVED]network speed/stability (7.7.8.9 GW, physically isolated)</title>
    <link>http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82</link>
    <description>Hi,

I&#39;m two days now into testing a physically isolated 7.7.8.9 GW and I&#39;m having big problems with network stability + speed. That is to say, I encounter a very bad network performance with both the GW and the connected workstation host. At times it works with acceptable Tor network performance (then it randomly stalls) but more often than not I have 1-2 KBit/s DL speed, going down to 500 Bit/s, so basically not usable.

I did thorough testing to isolate the issue:

1. Booting the GW hardware from a Linux Live CD and downloading from the very same Debian mirror the GW is using as a repository -&gt; fast (through clearnet). GW hardware is OK.
2. I&#39;m using Tails on a daily basis with the very same upstream connection -&gt; fast (through Tor - via Tails).
3. I tested the network performance between the GW and the workstation host utilizing iperf -&gt; fast at 90-95 MBit/s.
4. I switched Tor curcuits on the GW several times to make sure it&#39;s not a particular Tor curcuit that&#39;s failing.

I come to the conclusion that the GW implementation itself (and/or Debian) needs to be the issue here. Maybe the Whonix firewall (it feels like a clogged tube)? That is to say, even &quot;apt-get update&quot; takes forever to complete. I noticed that if it works for a minute or so, it just randomly stalls and is back to 1-2 KBit/s, going down to 500 Bit/s.

Now, I&#39;m asking for support here. How may I troubleshoot this further? I read that at least one other community member has similar issues with network performance (with Whonix 7)*. I encounter the very same thing with the 7.7.8.9 GW here.

Thanks!

(*) https://www.whonix.org/forum/index.php/topic,51.msg395.html#msg395 - Bullet point 4</description>
    <language>en</language>
    <lastBuildDate>Wed, 19 Feb 2014 22:51:21 +0000</lastBuildDate>
    <category>Support</category>
    <atom:link href="http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>[SOLVED]network speed/stability (7.7.8.9 GW, physically isolated)</title>
        <dc:creator><![CDATA[Cerberus]]></dc:creator>
        <description><![CDATA[
            <p>Let me rephrase that <img src="//forums.whonix.org/images/emoji/twitter/wink.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
<p>Please do not drop physical isolation support - ever! It’s so awesome to have it. Now, if we finally manage to convince you to switch from a HighFat KDE to a LowFat Xfce or LXDE Workstation VM + terminal-only Gateway by default, I’m totally happy. I know: there is still a lot of convincing work involved <img src="//forums.whonix.org/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"> I’m not giving up yet.</p>
          <p><a href="http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82/6</link>
        <pubDate>Wed, 19 Feb 2014 22:51:21 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-82-6</guid>
        <source url="http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82.rss">[SOLVED]network speed/stability (7.7.8.9 GW, physically isolated)</source>
      </item>
      <item>
        <title>[SOLVED]network speed/stability (7.7.8.9 GW, physically isolated)</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <blockquote>Please do not drop support for physical isolation though.</blockquote>
Dropping support isn't planed yet. Physical Isolation code is all set. Mostly just some "if physical isolation", then "don't do this if physical isolation". Simple to keep support.
          <p><a href="http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82/5</link>
        <pubDate>Wed, 19 Feb 2014 22:46:16 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-82-5</guid>
        <source url="http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82.rss">[SOLVED]network speed/stability (7.7.8.9 GW, physically isolated)</source>
      </item>
      <item>
        <title>[SOLVED]network speed/stability (7.7.8.9 GW, physically isolated)</title>
        <dc:creator><![CDATA[Cerberus]]></dc:creator>
        <description><![CDATA[
            <blockquote>I guess that's why I am not maintaining Linux distribution mainly targeting real hardware. Support of hardware is a real nightmare. Linux forums are full of it.</blockquote>
Yes. Please do not drop support for physical isolation though. You do not need to support this after all. That said, I'm almost certain in the meantime that it's the wireless card. The Linux Live CD I was using ships with a much older 2.6-something kernel and the chipset I'm using is known to have issues with most recent kernels.
<p>Best thing is: While I have a replacement card, this very (other) chipset also seems to not work with most recent kernels - used to work great some years ago though - not sure what driver-amok that is? But I currently remember why I switched to other chipsets with my newest machines.</p>
<p>All that said, I doubt that the GW implementation is the issue here, i.e. I rule it out. It’s the network card and I have to come up with a solution here. I downloaded some driver sources that I remember used to work for the first card but they do not compile on Debian Wheezy. I fiddled with the C code for two hours now and while I got closer (less compiling errors), it still doesn’t build. Connecting by wire isn’t an option here as the GW is running on an old laptop machine (one ethernet interface).</p>
<p>Just wanted to get back to you quickly to say that it’s - almost certainly - not the GW. It’s shitty network hardware + lousy drivers. That most prominently explains the instabilities. I mean, a firewall issue would either clog the tube or not.</p>
          <p><a href="http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82/4</link>
        <pubDate>Wed, 19 Feb 2014 12:41:52 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-82-4</guid>
        <source url="http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82.rss">[SOLVED]network speed/stability (7.7.8.9 GW, physically isolated)</source>
      </item>
      <item>
        <title>[SOLVED]network speed/stability (7.7.8.9 GW, physically isolated)</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>I guess that’s why I am not maintaining Linux distribution mainly targeting real hardware. Support of hardware is a real nightmare. Linux forums are full of it.</p>
<p>Testing with by wire, if that’s possible and see if it still happens would also be great to exclude possibility that Whonix itself is the cause.</p>
<p>Whonix-Gateway’s firewall hasn’t changed a lot during these versions. Please feel free to see the diff.</p>
<p>Whonix 0.5.6<br>
whonix_gateway/usr/local/bin/whonix_firewall</p>
<p>Whonix 7/8<br>
whonix_gateway/usr/bin/whonix_firewall</p>
<blockquote>git diff 7 whonix_gateway/usr/bin/whonix_firewall</blockquote>
<p>I couldn’t reproduce the issue the other user described and there are no other reports. The user didn’t reply to my follow up questions yet. Depending on these answers, I hope it’s a non-Whonix caused issue. Otherwise it would be really difficult to track, since I never experienced it myself.</p>
<p>As for debugging Whonix’s firewall, you could also completely disable it. Then you’d still be able to access ports Tor is providing (such as 192.168.0.10:9152 … 9153 etc. [<a href="https://www.whonix.org/wiki/Stream_Isolation">https://www.whonix.org/wiki/Stream_Isolation</a>]). (Transparent Proxying would be disabled then.) And then do Tor benchmarks.</p>
<p>Sdwdate could be a cause for Tor issues. It changes time and Tor may not cope up with that well. Sdwdate doesn’t run often on Whonix-Gateway, though. Sdwdate can be shut down (sudo service sdwdate stop) or you can watch when it runs (tail -f /var/log/sdwdate.log).</p>
<p>I might come up with more if needed.</p>
          <p><a href="http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82/3</link>
        <pubDate>Wed, 19 Feb 2014 11:12:23 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-82-3</guid>
        <source url="http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82.rss">[SOLVED]network speed/stability (7.7.8.9 GW, physically isolated)</source>
      </item>
      <item>
        <title>[SOLVED]network speed/stability (7.7.8.9 GW, physically isolated)</title>
        <dc:creator><![CDATA[Cerberus]]></dc:creator>
        <description><![CDATA[
            <p>UPDATE: I have a feeling that it could very well be the wireless driver (my uplink). While it works with a Linux Live CD, it could nevertheless be the case that the Debian kernel (kernel module) for that chipset isn’t playing as nice. I’m now trying to compile another driver from source and see if that improves the situation. Will keep you updated.</p>
          <p><a href="http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82/2</link>
        <pubDate>Wed, 19 Feb 2014 08:01:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-82-2</guid>
        <source url="http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82.rss">[SOLVED]network speed/stability (7.7.8.9 GW, physically isolated)</source>
      </item>
      <item>
        <title>[SOLVED]network speed/stability (7.7.8.9 GW, physically isolated)</title>
        <dc:creator><![CDATA[Cerberus]]></dc:creator>
        <description><![CDATA[
            <p>Hi,</p>
<p>I’m two days now into testing a physically isolated 7.7.8.9 GW and I’m having big problems with network stability + speed. That is to say, I encounter a very bad network performance with both the GW and the connected workstation host. At times it works with acceptable Tor network performance (then it randomly stalls) but more often than not I have 1-2 KBit/s DL speed, going down to 500 Bit/s, so basically not usable.</p>
<p>I did thorough testing to isolate the issue:</p>
<ol>
<li>Booting the GW hardware from a Linux Live CD and downloading from the very same Debian mirror the GW is using as a repository -&gt; fast (through clearnet). GW hardware is OK.</li>
<li>I’m using Tails on a daily basis with the very same upstream connection -&gt; fast (through Tor - via Tails).</li>
<li>I tested the network performance between the GW and the workstation host utilizing iperf -&gt; fast at 90-95 MBit/s.</li>
<li>I switched Tor curcuits on the GW several times to make sure it’s not a particular Tor curcuit that’s failing.</li>
</ol>
<p>I come to the conclusion that the GW implementation itself (and/or Debian) needs to be the issue here. Maybe the Whonix firewall (it feels like a clogged tube)? That is to say, even “apt-get update” takes forever to complete. I noticed that if it works for a minute or so, it just randomly stalls and is back to 1-2 KBit/s, going down to 500 Bit/s.</p>
<p>Now, I’m asking for support here. How may I troubleshoot this further? I read that at least one other community member has similar issues with network performance (with Whonix 7)*. I encounter the very same thing with the 7.7.8.9 GW here.</p>
<p>Thanks!</p>
<p>(*) <a href="https://www.whonix.org/forum/index.php/topic,51.msg395.html#msg395" rel="nofollow noopener">https://www.whonix.org/forum/index.php/topic,51.msg395.html#msg395</a> - Bullet point 4</p>
          <p><a href="http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82/1</link>
        <pubDate>Wed, 19 Feb 2014 05:34:47 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-82-1</guid>
        <source url="http://forums.whonix.org/t/solved-network-speed-stability-7-7-8-9-gw-physically-isolated/82.rss">[SOLVED]network speed/stability (7.7.8.9 GW, physically isolated)</source>
      </item>
  </channel>
</rss>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Flushing iptables once, else no connection</title>
    <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420</link>
    <description>Using Whonix 15.0.1.4.9 libvirt for Debian, I had similiar problems to tiredlexor&#39;s: [Tor is not yet fully bootstrapped. 30 % done](http://forums.whonix.org/t/tor-is-not-yet-fully-bootstrapped-30-done/8792)

After nothing seemed to get blocked by iptables (nothing related showed up in journalctl), I again tried to flush and set the policy to allow for the chains. At least, I thought, it works like this.

What puzzles me is the following: Whonix connects fine after rebooting now, after having done the above once. I assumed it would stop working again, because it didn&#39;t with the default policies in place from the start, right?

So here is my question, I guess … is this a good thing?

I am not sure about the implications of having it connect once without any rules in place. Any idea if I should try something else? And what is going on, even? I&#39;m tired.

**tltr:**
* gateway boots fine, but get&#39;s stuck at establishing tor connection at 30%
* flushing iptables and setting chains to ALLOW &quot;fixes&quot; this, which is the only weird thing happening
* after flushing/allowing once, then using default policies, it works</description>
    <language>en</language>
    <lastBuildDate>Tue, 20 Oct 2020 14:47:04 +0000</lastBuildDate>
    <category>KVM</category>
    <atom:link href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Similar problem and answer:<br>
</p><aside class="onebox stackexchange">
  <header class="source">
      <a href="https://security.stackexchange.com/questions/131214/what-are-all-these-connection-attempts-in-my-firewall-log/131227#131227" target="_blank">security.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="https://security.stackexchange.com/users/15194/ay0" target="_blank">
    <img alt="Ay0" src="https://i.stack.imgur.com/bjZjz.jpg?s=128&amp;g=1" class="thumbnail onebox-avatar" width="128" height="128">
  </a>
<h4>
  <a href="https://security.stackexchange.com/questions/131214/what-are-all-these-connection-attempts-in-my-firewall-log/131227#131227" target="_blank">What are all these connection attempts in my firewall log?</a>
</h4>

<div class="tags">
  <strong>firewalls, ubuntu</strong>
</div>

<div class="date">
  
  answered by
  <a href="https://security.stackexchange.com/users/15194/ay0" target="_blank">
    Ay0
  </a>
  on <a href="https://security.stackexchange.com/questions/131214/what-are-all-these-connection-attempts-in-my-firewall-log/131227#131227" target="_blank">07:15AM - 28 Jul 16 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Have no idea why it’s a problem now after so many years</p>
<p>Something related;</p>
<p><a href="https://www.linuxquestions.org/questions/linux-networking-3/iptables-and-tcp-ack-psh-fin-urgp%3D0-problem-887848/" class="onebox" target="_blank">https://www.linuxquestions.org/questions/linux-networking-3/iptables-and-tcp-ack-psh-fin-urgp%3D0-problem-887848/</a></p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/23">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/23</link>
        <pubDate>Tue, 20 Oct 2020 14:47:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-23</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="LavenderLevitator" data-post="19" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/7ab992/40.png" class="avatar"> LavenderLevitator:</div>
<blockquote>
<p>But like this, it can’t be really considered a Whonix related problem, can it? Because else bridges wouldn’t work too, I guess?</p>
</blockquote>
</aside>
<p>Difficult to say in this case. The iptables issue is still a mystery and could cause issues.</p>
<p>Otherwise, related:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Network_Obstacle" target="_blank" title="10:53PM - 09 October 2020">Whonix – 9 Oct 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:110/55;"><img src="https://www.whonix.org/w/images/7/73/Networkobstacle123123455.png" class="thumbnail" width="110" height="55"></div>

<h3><a href="https://www.whonix.org/wiki/Network_Obstacle" target="_blank">Network Obstacle</a></h3>

<p>Organizational background on Network Obstacles.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-username="HulaHoop" data-post="17" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Perhaps try again after resetting Tor state to use other guards (</p>
</blockquote>
</aside>
<aside class="quote no-group" data-username="HulaHoop" data-post="20" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Try : Whisker menu -&gt; Tor Data -&gt; delete everything in that folder</p>
</blockquote>
</aside>
<p>This might not work. Need to stop Tor first. Documented here:</p>
<p><a href="https://www.whonix.org/wiki/Tor_Entry_Guards#Fresh_Tor_Entry_Guards_by_Regenerating_the_Tor_State_File">https://www.whonix.org/wiki/Tor_Entry_Guards#Fresh_Tor_Entry_Guards_by_Regenerating_the_Tor_State_File</a></p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/22">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/22</link>
        <pubDate>Mon, 19 Oct 2020 15:44:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-22</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[LavenderLevitator]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="HulaHoop" data-post="20" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Perhaps changing them is enough to fix this.</p>
</blockquote>
</aside>
<p>Unfortunately, still no. Directly connecting after doing this still results in the same issue.</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/21">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/21</link>
        <pubDate>Mon, 19 Oct 2020 15:24:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-21</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Try : Whisker menu -&gt; Tor Data -&gt; delete everything in that folder -&gt; anon-connection-wizard and choose to connect directly to the Tor network.</p>
<p>It could be the guards you are using doing something weird with the connections. Perhaps changing them is enough to fix this.</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/20">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/20</link>
        <pubDate>Mon, 19 Oct 2020 15:07:33 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-20</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[LavenderLevitator]]></dc:creator>
        <description><![CDATA[
            <p>Wanted to give an update here. For the last 24 hours, I had a more or less reliable connections through obfs4 bridges. I.e. I could update the systems and perform normal activities.</p>
<p>That it doesn’t function well without bridges still is something that strikes me as odd thought, as I never really had to rely on them for a functioning connection?</p>
<p>But like this, it can’t be really considered a Whonix related problem, can it? Because else bridges wouldn’t work too, I guess?</p>
<p>Whatever, just sharing my thoughts on the matter.</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/19">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/19</link>
        <pubDate>Sun, 18 Oct 2020 21:44:06 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-19</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[LavenderLevitator]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="HulaHoop" data-post="17" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Try using bridges and report back?</p>
</blockquote>
</aside>
<p>With bridges it gets connected a little bit faster (it’s still random) and it loses connection quite often (like it does without bridges), i. e. there are still popping up all these blocked addresses, to the point I can’t even update/upgrade the system for the first time.</p>
<p>Thank you for all the answers so far, by the way! Appreciate it.</p>
<p>Little update: Just to rule out something weird on the host side I put a fresh Debian stable install on another set of hardware and it’s exactly the same there. <em>shrugs</em></p>
<aside class="quote no-group" data-username="HulaHoop" data-post="17" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Perhaps try again after resetting Tor state to use other guards</p>
</blockquote>
</aside>
<p>Almost forgot: AFAIA they change when you switch bridges? Still, tried it with a deleted <code>state</code> file; no difference.</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/18">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/18</link>
        <pubDate>Thu, 15 Oct 2020 13:11:16 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-18</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <ul>
<li>
<p>Perhaps try again after resetting Tor state to use other guards (<a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a> any steps for that?)</p>
</li>
<li>
<p>Try using bridges and report back?</p>
</li>
</ul>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/17">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/17</link>
        <pubDate>Thu, 15 Oct 2020 12:56:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-17</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[LavenderLevitator]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="14" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Did you change any settings on Whonix-Gateway?</p>
<p>Modified something?</p>
<p>Hosting onion services?</p>
<p>Did you run <code>tor</code> from command line?</p>
</blockquote>
</aside>
<p>The only thing I changed (after the first time doing it with the standard amount) is the amount of RAM for the gateway + in the GW the lines for the logging to happen. That’s it, i swear.</p>
<p>I’m not hosting anything nor did I run tor from command line.</p>
<aside class="quote no-group" data-username="HulaHoop" data-post="15" data-topic="10420" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Also tell us if you’ve tried connecting to a VPN on the GW or running any other setup than default.</p>
</blockquote>
</aside>
<p>Nothing fancy like that. It’s like this:<br>
boot fresh 15.0.1.4.9 Gateway XFCE (from .xz archive) -&gt; accepting terms -&gt; open console -&gt; sudoedit the logging settings for iptables -&gt; start the anon con wizard</p>
<p>That’s literally it.</p>
<p>Would it help if I’d try to use another version? I can compile it too, but I thought going with the currently available archive would be the best case for troubleshooting.</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/16">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/16</link>
        <pubDate>Thu, 15 Oct 2020 12:53:48 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-16</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Also tell us if you’ve tried connecting to a VPN on the GW or running any other setup than default.</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/15</link>
        <pubDate>Thu, 15 Oct 2020 12:49:09 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-15</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Did you change any settings on Whonix-Gateway?</p>
<p>Modified something?</p>
<p>Hosting onion services?</p>
<p>Did you run <code>tor</code> from command line?</p>
<p>Whonix is using system Tor from the Debian <code>tor</code> package. User <code>debian-tor</code> is allowed to make external connections. Relevant parts…</p>
<p><a href="https://github.com/Whonix/whonix-firewall/blob/master/usr/bin/whonix-gateway-firewall">https://github.com/Whonix/whonix-firewall/blob/master/usr/bin/whonix-gateway-firewall</a></p>
<pre><code>   [ -n "$TOR_USER" ] || TOR_USER="$(id -u debian-tor)"

      NO_NAT_USERS+=" $TOR_USER"

   local no_nat_user
   for no_nat_user in $NO_NAT_USERS ; do
      $iptables_cmd -t nat -A OUTPUT -m owner --uid-owner "$no_nat_user" -j RETURN
   done

   for no_nat_user in $NO_NAT_USERS ; do
      $iptables_cmd -A OUTPUT -m owner --uid-owner "$no_nat_user" -j ACCEPT
   done
</code></pre>
<p>And then incoming connections are allowed.</p>
<pre><code>$iptables_cmd -A INPUT -m state --state ESTABLISHED -j ACCEPT
</code></pre>
<p>Long time ago we were using <code>ESTABLISHED,RELATED</code> but this was changed for hardening.</p>
<ul>
<li><a href="https://phabricator.whonix.org/T28">https://phabricator.whonix.org/T28</a></li>
<li><a href="https://forums.whonix.org/t/have-firewall-accept-icmp-fragmentation-needed/10233" class="inline-onebox">Have firewall accept ICMP Fragmentation Needed</a></li>
</ul>
<p>Maybe Tor, linux kernel or some other change I am unaware off now necessities making that <code>ESTABLISHED,RELATED</code> again.</p>
<p>Otherwise I am at loss why only now and only in your case firewall is blocking this.</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/14</link>
        <pubDate>Thu, 15 Oct 2020 12:42:23 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-14</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[LavenderLevitator]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="HulaHoop" data-post="12" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Did you import the Whonix-external network settings config?</p>
</blockquote>
</aside>
<p>I did, actually.</p>
<aside class="quote no-group" data-username="HulaHoop" data-post="12" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>VBox is using the same network range try uninstalling it then attempt connecting again.</p>
</blockquote>
</aside>
<p>Not installed anymore!</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/13</link>
        <pubDate>Thu, 15 Oct 2020 12:41:05 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-13</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Did you import the Whonix-external network settings config? VBox is using the same network range try uninstalling it then attempt connecting again.</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/12</link>
        <pubDate>Thu, 15 Oct 2020 12:37:01 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-12</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[LavenderLevitator]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="HulaHoop" data-post="8" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>What version Whonix are you running and when did you notice this? What host OS are you using?</p>
</blockquote>
</aside>
<p>I’m using 15.0.1.4.9 and noticed it about two days before I came here to post about it. Didn’t use Whonix for KVM earlier, Virtualbox worked fine before but that was another version. Running a Debian buster host.</p>
<aside class="quote no-group" data-username="Patrick" data-post="9" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Do you use any fireball on the host operating system?</p>
</blockquote>
</aside>
<p>Iptables normally, but I deactivated it.</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/11</link>
        <pubDate>Thu, 15 Oct 2020 12:36:09 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-11</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="9" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Can you reproduce this too?</p>
</blockquote>
</aside>
<p>No, however I haven’t updated from 15.0.1.3.9 yet and I have ufwall on the host FWIW</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/10</link>
        <pubDate>Thu, 15 Oct 2020 12:29:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-10</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Do you use any fireball on the host operating system?</p>
<p>This is weird since these firewall rules are unchanged for a very long term now and we didn’t have such reports before.</p>
<p>The probably most relevant log entry, firewall related log entry seems to be this one:</p>
<aside class="quote no-group quote-modified" data-username="LavenderLevitator" data-post="7" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/7ab992/40.png" class="avatar"> LavenderLevitator:</div>
<blockquote>
<p>Oct 14 17:43:14 host kernel: Whonix blocked input4: IN=eth0 OUT= MAC=xxx SRC=xxx DST=10.0.2.15</p>
</blockquote>
</aside>
<p>Can you reproduce this too? <a class="mention" href="http://forums.whonix.org/u/hulahoop">@HulaHoop</a></p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/9</link>
        <pubDate>Thu, 15 Oct 2020 12:26:53 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-9</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>iptables is strangely blocking connections from your guards AFAICT.</p>
<p>What version Whonix are you running and when did you notice this? What host OS are you using?</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/8</link>
        <pubDate>Thu, 15 Oct 2020 12:23:18 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-8</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[LavenderLevitator]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="HulaHoop" data-post="6" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Please post what you have from journalctl</p>
</blockquote>
</aside>
<p>It’s just the following messages (with the debugging messages obviously differing in details) repeating all the time. I guess those are the ones you’d need?</p>

journal <a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/7">(click for more details)</a>
<p>There are no other messages inbetween. If its a full log you want, I wouldn’t know how to post that on here properly, so any clue would be appreciated!</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/7</link>
        <pubDate>Wed, 14 Oct 2020 18:03:49 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-7</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="LavenderLevitator" data-post="5" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/7ab992/40.png" class="avatar"> LavenderLevitator:</div>
<blockquote>
<p>So, maybe I just was(/am) too impatient? It does work now, which means in theory I am able to use the workstation, too. I’m not used for the first startup to take so long, so maybe that’s why I got confused. Did I just waste all of our time?</p>
</blockquote>
</aside>
<p>Please post what you have from journalctl</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/6</link>
        <pubDate>Wed, 14 Oct 2020 17:07:48 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-6</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[LavenderLevitator]]></dc:creator>
        <description><![CDATA[
            <p>Okay, now something happened. I wrote the previous post for an extended amount of time and had the fresh cloned gateway running in the background.<br>
The first line about blocking something happened more than 10 minutes after booting:</p>

Line of journalctl <a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/5">(click for more details)</a>
<p>Nearly 1000 lines like this appeared, surrounded by message about it not finding the needed directory. It took until 17:11 (i. e. 30 minutes after the first block appearing) for those messages to disappear and the gateway is now able to connect - without having to flush iptables etc.</p>
<p>So, maybe I just was(/am) too impatient? It does work now, which means in theory I am able to use the workstation, too. I’m not used for the first startup to take so long, so maybe that’s why I got confused. Did I just waste all of our time?</p>
<p>Update: Just wanted to add that I decided to replicate the scenario once again so I cloned another fresh gateway today and it obviously is stuck at 30% for a few hours now, so I guess I was lucky (or unlucky?) yesterday.<br>
Or am I just missing something out of incompetence?</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/5</link>
        <pubDate>Tue, 13 Oct 2020 17:46:54 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-5</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[LavenderLevitator]]></dc:creator>
        <description><![CDATA[
            <p>Let me start by thanking you for your replies! I really appreciate it.</p>
<aside class="quote no-group" data-username="HulaHoop" data-post="2" data-topic="10420" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Can you follow <a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a>’s debug instructions in the linked thread and post the logs? It will help us fix the problem</p>
</blockquote>
</aside>
<aside class="quote no-group" data-username="Patrick" data-post="3" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Nothing blocked shows up by default in systemd journal. This needs to be explicitly enabled.</p>
</blockquote>
</aside>
<p>I followed the instructions provided in the mentioned post, but I didn’t find anything mentioning iptable etc., but it wouldn’t be the first time for me to miss something. So I repeated the step. What’s the best way for posting logs here? I’ll try putting it into the details tag. This is on a cloned (i. e. fresh) gateway. I truncated it only a bit.</p>

Log <a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/4">(click for more details)</a>
<p>Would I have looked closer in the first place, I probably would have noticed vanguards panicing about tor needing descriptors. The only files/folders existing in /var/lib/tor are authdir, keys, lock and state. I went and booted up the previous mentioned gateway (which had its iptables flushed once) … on which the needed files exist. If I could guess I’d say they didn’t before flushing iptables (duh).</p>
<p>If you want, it would be my pleasure to repeat the process with something debugging it.</p>
<aside class="quote no-group" data-username="Patrick" data-post="3" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Flush iptables inside Whonix-Gateway or the host?</p>
</blockquote>
</aside>
<p>Inside the Whonix-Gateway.</p>
<aside class="quote no-group" data-username="Patrick" data-post="3" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Please also check this:</p>
</blockquote>
</aside>
<p>I should have mentioned: TBB works fine on the host. Whonix worked fine on this specific host with Virtualbox, from which I wanted to finally migrate. I say worked, because I unfortunately removed it already. Could reinstall if necessary.</p>
<p>And of course I don’t want to waste your limited time! I just thought it would be a good idea to share my problem. So thank you again for your time and for creating this project in particular.</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/4</link>
        <pubDate>Tue, 13 Oct 2020 17:30:28 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-4</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="LavenderLevitator" data-post="1" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/7ab992/40.png" class="avatar"> LavenderLevitator:</div>
<blockquote>
<p>After nothing seemed to get blocked by iptables (nothing related showed up in journalctl)</p>
</blockquote>
</aside>
<p>Nothing blocked shows up by default in systemd journal. This needs to be explicitly enabled.</p>
<aside class="quote no-group" data-username="LavenderLevitator" data-post="1" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/7ab992/40.png" class="avatar"> LavenderLevitator:</div>
<blockquote>
<p>I again tried to flush and set the policy to allow for the chains.</p>
</blockquote>
</aside>
<p>Flush iptables inside Whonix-Gateway or the host?</p>
<aside class="quote no-group" data-username="LavenderLevitator" data-post="1" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/7ab992/40.png" class="avatar"> LavenderLevitator:</div>
<blockquote>
<p>is this a good thing?</p>
</blockquote>
</aside>
<p>No. Certainly not expected.</p>
<aside class="quote no-group" data-username="LavenderLevitator" data-post="1" data-topic="10420">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/7ab992/40.png" class="avatar"> LavenderLevitator:</div>
<blockquote>
<p>gateway boots fine, but get’s stuck at establishing tor connection at 30%</p>
</blockquote>
</aside>
<p>Please also check this:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Network_Obstacle" target="_blank" title="10:53PM - 09 October 2020">Whonix – 9 Oct 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:101/50;"><img src="https://www.whonix.org/w/images/7/73/Networkobstacle123123455.png" class="thumbnail" width="101" height="50"></div>

<h3><a href="https://www.whonix.org/wiki/Network_Obstacle" target="_blank">Network Obstacle</a></h3>

<p>Organizational background on Network Obstacles.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/3</link>
        <pubDate>Tue, 13 Oct 2020 13:49:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-3</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Can you follow <a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a>’s debug instructions in the linked thread and post the logs? It will help us fix the problem</p>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/2</link>
        <pubDate>Tue, 13 Oct 2020 13:39:41 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-2</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
      <item>
        <title>Flushing iptables once, else no connection</title>
        <dc:creator><![CDATA[LavenderLevitator]]></dc:creator>
        <description><![CDATA[
            <p>Using Whonix 15.0.1.4.9 libvirt for Debian, I had similiar problems to tiredlexor’s: <a href="//forums.whonix.org/t/tor-is-not-yet-fully-bootstrapped-30-done/8792">Tor is not yet fully bootstrapped. 30 % done</a></p>
<p>After nothing seemed to get blocked by iptables (nothing related showed up in journalctl), I again tried to flush and set the policy to allow for the chains. At least, I thought, it works like this.</p>
<p>What puzzles me is the following: Whonix connects fine after rebooting now, after having done the above once. I assumed it would stop working again, because it didn’t with the default policies in place from the start, right?</p>
<p>So here is my question, I guess … is this a good thing?</p>
<p>I am not sure about the implications of having it connect once without any rules in place. Any idea if I should try something else? And what is going on, even? I’m tired.</p>
<p><strong>tltr:</strong></p>
<ul>
<li>gateway boots fine, but get’s stuck at establishing tor connection at 30%</li>
<li>flushing iptables and setting chains to ALLOW “fixes” this, which is the only weird thing happening</li>
<li>after flushing/allowing once, then using default policies, it works</li>
</ul>
          <p><a href="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420/1</link>
        <pubDate>Tue, 13 Oct 2020 08:05:06 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10420-1</guid>
        <source url="http://forums.whonix.org/t/flushing-iptables-once-else-no-connection/10420.rss">Flushing iptables once, else no connection</source>
      </item>
  </channel>
</rss>

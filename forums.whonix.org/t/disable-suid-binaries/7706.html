<!DOCTYPE html>
<html lang="en-US">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Disable SUID Binaries - Development - Whonix Forum</title>
    <meta name="description" content="https://github.com/QubesOS/qubes-issues/issues/2695 has interesting ideas. 
Quote Solar Designer (someone that Joanna Rutkowska respects): 

Ideally, there should be no SUID binaries reachable from the user account, as o&amp;hellip;">
    <meta name="generator" content="Discourse 2.5.0 - https://github.com/discourse/discourse version 6a42acbfb72d4ea7dc501ff2240abc8e89f650c6">
<link rel="icon" type="image/png" href="../../../external.html?link=https://forums.whonix.org/uploads/default/optimized/2X/f/f75358a50c52ba88d6c2e29e16841d4e8c0bc01d_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../external.html?link=https://forums.whonix.org/uploads/default/optimized/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="7706.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../external.html?link=https://forums.whonix.org/opensearch.xml" title="Whonix Forum Search">

      <link href="../../../external.html?link=https://forums.whonix.org/stylesheets/desktop_04105d0113a0b7029ab523cd468e4a6e2d4d4408.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop" data-theme-id="4"/>
      <link href="../../../external.html?link=https://forums.whonix.org/stylesheets/desktop_theme_4_339d45fd2bb5da93c350b8031070d36d0033feb1.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Disable SUID Binaries&#39;" href="7706-2.html" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/d/dd02aea8470f79c9c64a22fa02463adaf9c8d08d.png" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/9/997bef28d9dd0e3a84553afa8e33f383970adcab.png" />
<meta property="og:url" content="https://forums.whonix.org/t/disable-suid-binaries/7706" />
<meta name="twitter:url" content="https://forums.whonix.org/t/disable-suid-binaries/7706" />
<meta property="og:title" content="Disable SUID Binaries" />
<meta name="twitter:title" content="Disable SUID Binaries" />
<meta property="og:description" content="https://github.com/QubesOS/qubes-issues/issues/2695 has interesting ideas.  Quote Solar Designer (someone that Joanna Rutkowska respects):   Ideally, there should be no SUID binaries reachable from the user account, as otherwise significant extra attack surface inside the VM is exposed (dynamic linker, libc startup, portions of Linux kernel including ELF loader, etc.)   No idea yet.  Related:  walled garden, firewall whitelisting, application whitelisting, sudo lockdown, superuser mode, protecte..." />
<meta name="twitter:description" content="https://github.com/QubesOS/qubes-issues/issues/2695 has interesting ideas.  Quote Solar Designer (someone that Joanna Rutkowska respects):   Ideally, there should be no SUID binaries reachable from the user account, as otherwise significant extra attack surface inside the VM is exposed (dynamic linker, libc startup, portions of Linux kernel including ELF loader, etc.)   No idea yet.  Related:  walled garden, firewall whitelisting, application whitelisting, sudo lockdown, superuser mode, protecte..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="16 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="63 ‚ù§" />
<meta property="article:published_time" content="2019-07-07T01:15:35+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="next" href="77064658.html?page=2">


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="7706.html">Disable SUID Binaries</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/status_open_issue_todo.html' class='discourse-tag' rel="tag">status_open_issue_todo</a>, 
            <a href='../../tag/component_security.html' class='discourse-tag' rel="tag">component_security</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick.html'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-07-07T01:15:35Z'>
              <time itemprop='dateModified' datetime='2019-09-10T06:00:42Z' class='post-time'>
                September 10, 2019,  6:00am
              </time>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><a href="../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2695" rel="nofollow noopener">https://github.com/QubesOS/qubes-issues/issues/2695</a> has interesting ideas.</p>
<p>Quote Solar Designer (someone that Joanna Rutkowska respects):</p>
<blockquote>
<p>Ideally, there should be no SUID binaries reachable from the user account, as otherwise significant extra attack surface inside the VM is exposed (dynamic linker, libc startup, portions of Linux kernel including ELF loader, etc.)</p>
</blockquote>
<p>No idea yet.</p>
<p>Related:<br>
<a href="../walled-garden-firewall-whitelisting-application-whitelisting-sudo-lockdown-superuser-mode-protected-mode/5725.html" class="inline-onebox">walled garden, firewall whitelisting, application whitelisting, sudo lockdown, superuser mode, protected mode</a></p>
<p>Edit by Patrick:<br>
See also <a href="../re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707.html" class="inline-onebox">(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?</a></p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>
          <meta itemprop='keywords' content='status_open_issue_todo, component_security'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../document-installation-and-setup-of-the-new-security-focused-hardened-debian-linux-distribution-selected-by-whonix-for-season-of-docs-2019/7887/30.html" itemprop='item'>
                      <meta itemprop='url' content='../document-installation-and-setup-of-the-new-security-focused-hardened-debian-linux-distribution-selected-by-whonix-for-season-of-docs-2019/7887/30.html'>
                      <meta itemprop='position' content='4'>
                      <span itemprop='name'>&quot;Document Installation and Setup of the New Security-focused Hardened Debian Linux Distribution&quot; selected by Whonix for Season of Docs 2019</span>
                    </a>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../disk-usb-automount-in-kicksecure/8728/17.html" itemprop='item'>
                      <meta itemprop='url' content='../disk-usb-automount-in-kicksecure/8728/17.html'>
                      <meta itemprop='position' content='5'>
                      <span itemprop='name'>Disk &amp; USB Automount in Kicksecure</span>
                    </a>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../kernel-hardening/7296/285.html" itemprop='item'>
                      <meta itemprop='url' content='../kernel-hardening/7296/285.html'>
                      <meta itemprop='position' content='6'>
                      <span itemprop='name'>Kernel Hardening</span>
                    </a>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../kernel-hardening/7296/284.html" itemprop='item'>
                      <meta itemprop='url' content='../kernel-hardening/7296/284.html'>
                      <meta itemprop='position' content='7'>
                      <span itemprop='name'>Kernel Hardening</span>
                    </a>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../walled-garden-firewall-whitelisting-application-whitelisting-sudo-lockdown-superuser-mode-protected-mode/5725/14.html" itemprop='item'>
                      <meta itemprop='url' content='../walled-garden-firewall-whitelisting-application-whitelisting-sudo-lockdown-superuser-mode-protected-mode/5725/14.html'>
                      <meta itemprop='position' content='8'>
                      <span itemprop='name'>walled garden, firewall whitelisting, application whitelisting, sudo lockdown, superuser mode, protected mode</span>
                    </a>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../kernel-recompilation-for-better-hardening/7598/450.html" itemprop='item'>
                      <meta itemprop='url' content='../kernel-recompilation-for-better-hardening/7598/450.html'>
                      <meta itemprop='position' content='9'>
                      <span itemprop='name'>kernel recompilation for better hardening</span>
                    </a>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../kernel-hardening/7296/119.html" itemprop='item'>
                      <meta itemprop='url' content='../kernel-hardening/7296/119.html'>
                      <meta itemprop='position' content='10'>
                      <span itemprop='name'>Kernel Hardening</span>
                    </a>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../whonix-kvm-kicksecure-15-0-0-8-7-released-a-qunatum-leap-forward/8921.html" itemprop='item'>
                      <meta itemprop='url' content='../whonix-kvm-kicksecure-15-0-0-8-7-released-a-qunatum-leap-forward/8921.html'>
                      <meta itemprop='position' content='11'>
                      <span itemprop='name'>Whonix KVM / Kicksecure 15.0.0.8.7 Released! - A Qunatum Leap Forward</span>
                    </a>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../whonix-virtualbox-15-0-0-8-9-point-release-vanguards-tcp-isn-leak-protection-extensive-hardening/8994.html" itemprop='item'>
                      <meta itemprop='url' content='../whonix-virtualbox-15-0-0-8-9-point-release-vanguards-tcp-isn-leak-protection-extensive-hardening/8994.html'>
                      <meta itemprop='position' content='12'>
                      <span itemprop='name'>Whonix VirtualBox 15.0.0.8.9 - Point Release! - vanguards; TCP ISN Leak Protection; Extensive Hardening! üî•</span>
                    </a>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../whonix-virtualbox-15-0-0-8-7-testers-wanted-vanguards-tcp-isn-leak-protection-extensive-hardening/8914.html" itemprop='item'>
                      <meta itemprop='url' content='../whonix-virtualbox-15-0-0-8-7-testers-wanted-vanguards-tcp-isn-leak-protection-extensive-hardening/8914.html'>
                      <meta itemprop='position' content='13'>
                      <span itemprop='name'>Whonix VirtualBox 15.0.0.8.7 - Testers Wanted! - vanguards; TCP ISN Leak Protection; Extensive Hardening! üî•</span>
                    </a>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../missing-libre-illustrative-images/3912/147.html" itemprop='item'>
                      <meta itemprop='url' content='../missing-libre-illustrative-images/3912/147.html'>
                      <meta itemprop='position' content='14'>
                      <span itemprop='name'>Missing Libre Illustrative Images</span>
                    </a>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/madaidan.html'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-07-07T12:15:06Z'>
              <time itemprop='dateModified' datetime='2019-07-07T12:44:21Z' class='post-time'>
                July 7, 2019, 12:44pm
              </time>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>To remove all SUID bits from binaries, we can run</p>
<pre><code>chmod u-s -R / &amp;&amp; chmod g-s -R /
</code></pre>
<p>This will break some binaries though. For example, <code>ping</code> needs to be setuid to open a socket.</p>
<p>These can be fixed by only giving them the needed capabilities with the <code>setcap</code> command. For example, we can give <code>ping</code> just the CAP_NET_RAW capability without having to give it full root access.</p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick.html'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-07-07T12:28:57Z'>
              <time itemprop='dateModified' datetime='2019-07-07T12:44:21Z' class='post-time'>
                July 7, 2019, 12:44pm
              </time>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="120" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>chmod u-s -R / &amp;&amp; chmod g-s -R /</p>
</blockquote>
</aside>
<p>Looks like a sledge hammer approach. I mean, implementations that are ok as a sysadmin for its own computer are not necessarily advisable to be applied by default in a Linux distribution.</p>
<p>Does this change survive package re-installation?</p>
<p>It certainly takes no effect for newly installed packages.</p>
<p>How to reverse this?</p>
<p>What kind of feature breakage is to be expected?</p>
<p>Are there any alternative ways to implement this?</p>
<p>Are there any other linux distributions implementing this so we can look at their implementation for comparison?</p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/madaidan.html'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-07-07T12:36:58Z'>
              <time itemprop='dateModified' datetime='2019-07-07T12:44:21Z' class='post-time'>
                July 7, 2019, 12:44pm
              </time>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="121" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Does this change survive package re-installation?</p>
</blockquote>
</aside>
<p>Likely, no as the package manager would give it back the setuid bit.</p>
<aside class="quote no-group" data-post="121" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>How to reverse this?</p>
</blockquote>
</aside>
<p>Create a list of all current setuid and setgid binaries before running this and then you can just give the setuid/setgid bit back to them.</p>
<p>A list of all setuid and setgid binaries can be gotten by running</p>
<pre><code>find / -type f \( -perm -4000 -o -perm -2000 \)
</code></pre>
<aside class="quote no-group" data-post="121" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>What kind of feature breakage is to be expected?</p>
</blockquote>
</aside>
<p>Assuming you haven‚Äôt given the binary the required capabilities, it will not work. Some binaries like <code>su</code> will pretend to work but then always give a permission denied error.</p>
<aside class="quote no-group" data-post="121" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Are there any alternative ways to implement this?</p>
</blockquote>
</aside>
<p>We can create a list of common setuid and setgid binaries that are usually found on a system and remove their setuid/setgid bits individually. This way, we have a lot more control over what happens but there may be certain binaries that slip past.</p>
<aside class="quote no-group" data-post="121" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Are there any other linux distributions implementing this so we can look at their implementation for comparison?</p>
</blockquote>
</aside>
<p>Not that I know of.</p>
<p>The Arch Wiki has a page on this that may be useful.</p>
<p><a href="../../../external.html?link=https://wiki.archlinux.org/index.php/Capabilities" class="onebox" target="_blank" rel="nofollow noopener">https://wiki.archlinux.org/index.php/Capabilities</a></p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick.html'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-07-07T13:00:05Z'>
              <time itemprop='dateModified' datetime='2019-07-19T11:39:50Z' class='post-time'>
                July 19, 2019, 11:39am
              </time>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Good ideas.</p>
<p>What about <code>(re</code>)-<code>mount</code> with <code>nosuid</code> [among other useful mount options]?</p>
<p>Edit by Patrick:<br>
Created <a href="../re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707.html" class="inline-onebox">(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?</a> for it.</p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../multiple-boot-modes-for-better-security-persistent-user-live-user-persistent-admin-persistent-superadmin-persistent-recovery-mode/7708.html" itemprop='item'>
                      <meta itemprop='url' content='../multiple-boot-modes-for-better-security-persistent-user-live-user-persistent-admin-persistent-superadmin-persistent-recovery-mode/7708.html'>
                      <meta itemprop='position' content='1'>
                      <span itemprop='name'>multiple boot modes for better security: persistent user | live user | persistent secureadmin | persistent superadmin | persistent recovery mode</span>
                    </a>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707.html" itemprop='item'>
                      <meta itemprop='url' content='../re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707.html'>
                      <meta itemprop='position' content='2'>
                      <span itemprop='name'>(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?</span>
                    </a>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/madaidan.html'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-07-07T13:09:48Z'>
              <time itemprop='dateModified' datetime='2019-07-19T11:42:00Z' class='post-time'>
                July 19, 2019, 11:42am
              </time>
          <span itemprop='position'>#6</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="5" data-topic="7706">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>What about <code>(re</code> )- <code>mount</code> with <code>nosuid</code> [among other useful mount options]?</p>
</blockquote>
</aside>
<p>That sounds like something that‚Äôd be good for /etc/fstab.d, similar to <code>hidepid</code>.</p>
<p>Mounting certain directories (/bin, /usr/bin etc.) would break many things with <code>nosuid</code>. Mounting directories like /home with nosuid may be useful but then it wouldn‚Äôt have any effect on the other setuid binaries.</p>
<p>We could use one of the methods above to remove setuid bits from most binaries and then use <code>nosuid</code> on directories like /home.</p>
<p>Using multiple different mount options for increased security would be a whole other topic.</p>
<p>Edit by Patrick:<br>
Created <a href="../re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707.html" class="inline-onebox">(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?</a> for it.</p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/madaidan.html'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-08T20:20:18Z' class='post-time'>
                July 8, 2019,  8:20pm
              </time>
              <meta itemprop='dateModified' content='2019-07-08T20:20:18Z'>
          <span itemprop='position'>#7</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Good news. Debian seems to use capabilities over setuid bits for most default binaries. Things like <code>ping</code> don‚Äôt have setuid by default.</p>
<p>All binaries with setuid on a fresh Whonix installation are</p>
<pre><code class="lang-auto">/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/bin/chfn
/usr/bin/sudo
/usr/bin/passwd
/usr/bin/gpasswd
/usr/bin/pkexec
/usr/bin/newgrp
/usr/bin/firejail
/usr/bin/chsh
/bin/su
/bin/umount
/bin/mount
</code></pre>
<p>There are no setgid binaries by default.</p>
<p>firejail probably just needs CAP_SETUID  and CAP_SETGID for user namespaces. Maybe CAP_SYS_ADMIN too but I‚Äôm not sure.</p>
<p>Some firejail commands will need others. For example, <code>firejail --chroot</code> will need CAP_SYS_CHROOT.</p>
<p>mount and umount will likely just need CAP_SYS_ADMIN.</p>
<p>su and sudo probably just need CAP_SETUID and CAP_SETGID.</p>
<p>These will need a lot of testing.</p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick.html'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-22T06:24:38Z' class='post-time'>
                September 22, 2019,  6:24am
              </time>
              <meta itemprop='dateModified' content='2019-09-22T06:24:38Z'>
          <span itemprop='position'>#8</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="2" data-topic="7706">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>To remove all SUID bits from binaries, we can run</p>
<pre><code class="lang-auto">chmod u-s -R / &amp;&amp; chmod g-s -R /
</code></pre>
</blockquote>
</aside>
<p>Alternatively, could we identify suid binaries and then run <code>chmod o-x</code> [0] on them. I.e. <code>o</code> (‚Äúothers‚Äù) (i.e. user <code>user</code>) may not execute them. In result only root could execute suid binaries but non-root could not. Would that help to reduce the risk of suid binaries?</p>
<p>Tested. It‚Äôs possible to remove executable permission for binaries for others (user <code>user</code>) while root can still execute the binary.</p>
<p>Either,</p>
<ul>
<li>chmod all suid binaries except a whitelist [1], OR</li>
<li>we manually maintain a blacklist of suid binaries (the ones shipped by default but we want to disable). [2]</li>
</ul>
<p>That would prevent non-root users from executing suid binaries.</p>
<p>A dpkg hook or something could re-apply these changes on upgrades. But not great since malware could wait for the upgrade to happen and there would a vulnerable time window between package upgrade and suid re-disable.</p>
<p>Maybe ACL or something similar could enforce keeping the file permissions (<code>chmod o-x</code>) during upgrades?</p>
<hr>
<p>[0] Or <code>chmod og-x</code> or <code>chmod o-rx</code> or <code>chmod og-rwx</code> or something?</p>
<p>[1] In a <a href="../multiple-boot-modes-for-better-security-persistent-root-persistent-noroot-live-root-live-noroot/7708.html">noroot boot mode</a>, even <code>sudo</code> could be set to <code>chmod o-x</code> since during such sessions the user decided to trade sudo not being accessible for better security.</p>
<p>[2] On top, there could be a tool to search and warn against newly installed suid binaries.</p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/madaidan.html'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-22T12:37:15Z' class='post-time'>
                September 22, 2019, 12:37pm
              </time>
              <meta itemprop='dateModified' content='2019-09-22T12:37:15Z'>
          <span itemprop='position'>#9</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="8" data-topic="7706">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Alternatively, could we identify suid binaries and then run <code>chmod o-x</code> [0] on them. I.e. <code>o</code> (‚Äúothers‚Äù) (i.e. user <code>user</code> ) may not execute them. In result only root could execute suid binaries but non-root could not. Would that help to reduce the risk of suid binaries?</p>
</blockquote>
</aside>
<p>The entire point of SUID binaries are so unprivileged users can do some privileged operations so why not just remove the SUID bit instead?</p>
<aside class="quote no-group" data-post="8" data-topic="7706">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>we manually maintain a blacklist of suid binaries (the ones shipped by default but we want to disable).</p>
</blockquote>
</aside>
<p>This seems like the best approach as it would have minimal breakage.</p>
<p>The whitelist idea would be more effective in ensuring only needed SUID binaries can be executed but then it would break binaries a user creates themselves.</p>
<p>Unless there‚Äôs something we can make that checks if a new SUID binary has been created and says ‚ÄúSUID binaries are not allowed by default, see <a href="../../../external.html?link=https://www.whonix.org/wiki/wiki_page" rel="nofollow noopener">https://www.whonix.org/wiki/wiki_page</a> and whitelist your binary‚Äù or something like that.</p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick.html'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-22T16:51:38Z' class='post-time'>
                September 22, 2019,  4:51pm
              </time>
              <meta itemprop='dateModified' content='2019-09-22T16:51:38Z'>
          <span itemprop='position'>#10</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="9" data-topic="7706">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>The entire point of SUID binaries are so unprivileged users can do some privileged operations so why not just remove the SUID bit instead?</p>
</blockquote>
</aside>
<p>Didn‚Äôt have this in mind indeed. Therefore also <code>chmod u-s</code> would do. <code>chmod u-s</code> would not limit root from using these binaries.</p>
<p>However, making these binaries non-executable (and/or non-readable) might have another advantage: we fail closed and loudly (with error message) rather than leading to stranger to interpret issues, such as:</p>
<aside class="quote no-group" data-post="4" data-topic="7706">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Some binaries like <code>su</code> will pretend to work but then always give a permission denied error.</p>
</blockquote>
</aside>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick_mobile.html'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-22T09:03:20Z' class='post-time'>
                November 22, 2019,  9:03am
              </time>
              <meta itemprop='dateModified' content='2019-11-22T09:03:20Z'>
          <span itemprop='position'>#11</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><code>dpkg-statoverride</code> could be used make sure SUID stays disabled after apt dist-upgrade / install anything.</p>
<p><a href="../../../external.html?link=https://manpages.debian.org/buster/dpkg/dpkg-statoverride.1.en.html" class="onebox" target="_blank" rel="nofollow noopener">https://manpages.debian.org/buster/dpkg/dpkg-statoverride.1.en.html</a></p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/madaidan.html'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-12-19T17:02:43Z'>
              <time itemprop='dateModified' datetime='2019-12-21T12:46:27Z' class='post-time'>
                December 21, 2019, 12:46pm
              </time>
          <span itemprop='position'>#12</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/pull/44" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/pull/44" target="_blank">Remove SUID bits</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> ‚Üê <code>madaidan:permission-hardening</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2019-12-19" data-time="17:02:27" data-timezone="UTC">05:02PM - 19 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/madaidan" target="_blank">
          <img alt="madaidan" src="../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>

      <div class="lines" title="2 commits changed 2 files with 75 additions and 8 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/security-misc/pull/44/files" target="_blank">
          <span class="added">+75</span>
          <span class="removed">-8</span>
        </a>
      </div>
    </div>

  </div>
</div>
  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick.html'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-12-20T07:36:47Z'>
              <time itemprop='dateModified' datetime='2019-12-21T12:46:27Z' class='post-time'>
                December 21, 2019, 12:46pm
              </time>
          <span itemprop='position'>#13</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Added some refactoring, debugging, code simplification, and stylistic changes. Btw I make no claim that my code style is superior in any form but it is easier to grasp by my participial biased brain. Hope that is ok.</p>
<p>Found some issues.</p>
<blockquote>
<p>run: dpkg-statoverride --add --update root root 0755 /home<br>
run: dpkg-statoverride --add --update user user 0700 /home/user<br>
run: dpkg-statoverride --add --update root root 0700 /root<br>
run: dpkg-statoverride --add --update root root 0700 /boot<br>
run: dpkg-statoverride --add --update root root 0600 /etc/permission-hardening.conf<br>
run: dpkg-statoverride --remove /bin/<br>
fso: /bin/<br>
suid - file_name: ‚Äò/bin/mount‚Äô | existing_mode: ‚Äò4755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /bin/mount<br>
suid - file_name: ‚Äò/bin/ntfs-3g‚Äô | existing_mode: ‚Äò4755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /bin/ntfs-3g<br>
suid - file_name: ‚Äò/bin/umount‚Äô | existing_mode: ‚Äò4755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /bin/umount<br>
run: dpkg-statoverride --remove /usr/bin/<br>
fso: /usr/bin/<br>
suid - file_name: ‚Äò/usr/bin/atrm‚Äô | existing_mode: ‚Äò777‚Äô | existing_mode:1: ‚Äò77‚Äô<br>
run: dpkg-statoverride --add --update root root 77 /usr/bin/atrm<br>
suid - file_name: ‚Äò/usr/bin/bwrap‚Äô | existing_mode: ‚Äò4755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/bwrap<br>
suid - file_name: ‚Äò/usr/bin/chfn‚Äô | existing_mode: ‚Äò4755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/chfn<br>
suid - file_name: ‚Äò/usr/bin/chsh‚Äô | existing_mode: ‚Äò4755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/chsh<br>
suid - file_name: ‚Äò/usr/bin/dotlock‚Äô | existing_mode: ‚Äò777‚Äô | existing_mode:1: ‚Äò77‚Äô<br>
run: dpkg-statoverride --add --update root root 77 /usr/bin/dotlock<br>
suid - file_name: ‚Äò/usr/bin/dotlock.mailutils‚Äô | existing_mode: ‚Äò2755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/dotlock.mailutils<br>
suid - file_name: ‚Äò/usr/bin/firejail‚Äô | existing_mode: ‚Äò4755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/firejail<br>
suid - file_name: ‚Äò/usr/bin/gpasswd‚Äô | existing_mode: ‚Äò4755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/gpasswd<br>
suid - file_name: ‚Äò/usr/bin/newaliases‚Äô | existing_mode: ‚Äò777‚Äô | existing_mode:1: ‚Äò77‚Äô<br>
run: dpkg-statoverride --add --update root root 77 /usr/bin/newaliases<br>
suid - file_name: ‚Äò/usr/bin/newgrp‚Äô | existing_mode: ‚Äò4755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/newgrp<br>
suid - file_name: ‚Äò/usr/bin/pkexec.security-misc-orig‚Äô | existing_mode: ‚Äò4755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/pkexec.security-misc-orig<br>
suid - file_name: ‚Äò/usr/bin/sg‚Äô | existing_mode: ‚Äò777‚Äô | existing_mode:1: ‚Äò77‚Äô<br>
run: dpkg-statoverride --add --update root root 77 /usr/bin/sg<br>
suid - file_name: ‚Äò/usr/bin/sudo‚Äô | existing_mode: ‚Äò4755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/sudo<br>
suid - file_name: ‚Äò/usr/bin/write‚Äô | existing_mode: ‚Äò777‚Äô | existing_mode:1: ‚Äò77‚Äô<br>
run: dpkg-statoverride --add --update root root 77 /usr/bin/write<br>
INFO: fso ‚Äò/usr/local/bin/‚Äô does not exist!<br>
fso: /sbin/<br>
suid - file_name: ‚Äò/sbin/mount.nfs‚Äô | existing_mode: ‚Äò4755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /sbin/mount.nfs<br>
suid - file_name: ‚Äò/sbin/mount.ntfs‚Äô | existing_mode: ‚Äò777‚Äô | existing_mode:1: ‚Äò77‚Äô<br>
run: dpkg-statoverride --add --update root root 77 /sbin/mount.ntfs<br>
suid - file_name: ‚Äò/sbin/umount.nfs4‚Äô | existing_mode: ‚Äò777‚Äô | existing_mode:1: ‚Äò77‚Äô<br>
run: dpkg-statoverride --add --update root root 77 /sbin/umount.nfs4<br>
suid - file_name: ‚Äò/sbin/unix_chkpwd‚Äô | existing_mode: ‚Äò2755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root shadow 755 /sbin/unix_chkpwd<br>
fso: /usr/sbin/<br>
suid - file_name: ‚Äò/usr/sbin/exim4‚Äô | existing_mode: ‚Äò4755‚Äô | existing_mode:1: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/sbin/exim4<br>
suid - file_name: ‚Äò/usr/sbin/runq‚Äô | existing_mode: ‚Äò777‚Äô | existing_mode:1: ‚Äò77‚Äô<br>
run: dpkg-statoverride --add --update root root 77 /usr/sbin/runq<br>
INFO: fso ‚Äò/usr/local/sbin/‚Äô does not exist!<br>
run: dpkg-statoverride --remove /lib/<br>
fso: /lib/<br>
usr/lib/security-misc/permission-hardening: line 19: /usr/bin/stat: Argument list too long<br>
fso: /lib32/<br>
fso: /lib64/<br>
run: dpkg-statoverride --remove /usr/lib/<br>
fso: /usr/lib/<br>
usr/lib/security-misc/permission-hardening: line 19: /usr/bin/stat: Argument list too long<br>
fso: /usr/lib32/<br>
INFO: fso ‚Äò/usr/lib64/‚Äô does not exist!<br>
INFO: fso ‚Äò/usr/local/lib/‚Äô does not exist!<br>
INFO: fso ‚Äò/usr/local/lib32/‚Äô does not exist!<br>
INFO: fso ‚Äò/usr/local/lib64/‚Äô does not exist!<br>
run: dpkg-statoverride --add --update root root 4755 /usr/bin/sudo<br>
run: dpkg-statoverride --add --update root root 4755 /usr/bin/bwrap<br>
run: dpkg-statoverride --add --update root root 4755 /usr/lib/policykit-1/polkit-agent-helper-1<br>
run: dpkg-statoverride --remove /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>
run: dpkg-statoverride --add --update root messagebus 4754 /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>
INFO: fso ‚Äò/usr/lib/spice-gtk/spice-client-glib-usb-acl-helper‚Äô does not exist!<br>
run: dpkg-statoverride --add --update root utmp 2755 /usr/lib/x86_64-linux-gnu/utempter/utempter</p>
</blockquote>
<hr>
<blockquote>
<p>run: dpkg-statoverride --remove /bin/</p>
</blockquote>
<p>Do we want to do this?</p>
<blockquote>
<p>suid - file_name: ‚Äò/usr/bin/atrm‚Äô | existing_mode: ‚Äò777‚Äô | existing_mode:1: ‚Äò77‚Äô<br>
run: dpkg-statoverride --add --update root root 77 /usr/bin/atrm</p>
</blockquote>
<p>This is because:</p>
<pre><code>stat -c "%n %a %U %G" /usr/bin/atrm
</code></pre>
<blockquote>
<p>/usr/bin/atrm 777 root root</p>
</blockquote>
<p>Therefore need to check string length of permission variable. I will fix this very soon.</p>
<blockquote>
<p>fso: /lib/<br>
usr/lib/security-misc/permission-hardening: line 19: /usr/bin/stat: Argument list too long</p>
</blockquote>
<p>Can reproduce manually too.</p>
<pre><code>shopt -s globstar
stat -c "%n %a %U %G" /lib/**
</code></pre>
<blockquote>
<p>bash: /usr/bin/stat: Argument list too long</p>
</blockquote>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick.html'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-12-20T07:57:40Z'>
              <time itemprop='dateModified' datetime='2019-12-21T12:46:27Z' class='post-time'>
                December 21, 2019, 12:46pm
              </time>
          <span itemprop='position'>#14</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>symlinks are probably (a or the) cause for the permission variable length issue above.</p>
<pre><code>stat -c "%n %a %U %G" /usr/bin/sg
</code></pre>
<blockquote>
<p>/usr/bin/sg 777 root root</p>
</blockquote>
<pre><code>test -u /usr/bin/sg ; echo $?
</code></pre>
<blockquote>
<p>0</p>
</blockquote>
<pre><code>test -g /usr/bin/sg ; echo $?
</code></pre>
<blockquote>
<p>1</p>
</blockquote>
<pre><code>test -h /usr/bin/sg ; echo $?
</code></pre>
<blockquote>
<p>0</p>
</blockquote>
<pre><code>ls -la /usr/bin/sg
</code></pre>
<blockquote>
<p>lrwxrwxrwx 1 root root 6 Jul 27  2018 /usr/bin/sg -&gt; newgrp</p>
</blockquote>
<pre><code>realpath /usr/bin/sg
</code></pre>
<blockquote>
<p>/usr/bin/newgrp</p>
</blockquote>
<p>The question is, how should we handle symlinks?</p>
<p>Should we just skip symlinks in <code>nosuid</code> mode? That is what I have implemented for now. Config entries such as <code>/bin/ nosuid</code> should catch such entries anyhow since these would be in other folders which config will ‚Äúrun nosuid‚Äù on anyhow. Except, it would miss custom made symlinks linking to folders which we don‚Äôt parse.</p>
<p>Otherwise we could resolve the symlink (maybe using <code>realpath</code>) and then ‚Äúrun nosuid‚Äù on wherever it links to even if a weird path such as hypothetically <code>/usr/share/somesuid/somesuidbinary</code>. Such entries however would likely never be updated/removed when the symlink changed.</p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick.html'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-12-20T09:15:25Z'>
              <time itemprop='dateModified' datetime='2019-12-21T12:46:27Z' class='post-time'>
                December 21, 2019, 12:46pm
              </time>
          <span itemprop='position'>#15</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Let‚Äôs not use <code>add_statoverride_entry</code> for both, case of <code>nosuid</code> and regular modes. That is because when we‚Äôre using <code>nosuid</code> that is totally different. In that case we iterate over folders. For other modes, we don‚Äôt iterate but set specific modes. There is not any code that would be repeated. Therefore made that  <code>add_nosuid_statoverride_entry</code>.</p>
<aside class="quote no-group" data-post="307" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>dpkg-statoverride: warning: stripping trailing /</p>
</blockquote>
</aside>
<p>This is fixed.</p>
<aside class="quote no-group quote-modified" data-post="322" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<blockquote>
<p>run: dpkg-statoverride --remove /bin/</p>
</blockquote>
<p>Do we want to do this?</p>
</blockquote>
</aside>
<p>For now, no longer doing this. That was only only a bug when using nosuid entries. Not a deliberate choice in config. If this was wanted, another entry should be added to config (similar to <code>/boot/ 0700 root root</code> but would have to think about mode/owner/group but there may be no fitting config file and does not seem important).</p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick.html'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-12-20T09:18:40Z'>
              <time itemprop='dateModified' datetime='2019-12-21T12:46:27Z' class='post-time'>
                December 21, 2019, 12:46pm
              </time>
          <span itemprop='position'>#16</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I don‚Äôt think we should support iterating over folders for nosuid while at the same time setting specific modes/owner/groups. To specific what I mean:</p>
<p>This is OK:</p>
<blockquote>
<p>/bin/ nosuid</p>
</blockquote>
<p>This is also OK:</p>
<blockquote>
<p>/etc/permission-hardening.conf 0600 root root</p>
</blockquote>
<p>This does not seem useful:</p>
<blockquote>
<p>/bin/ nosuid 0600 root root</p>
</blockquote>
<p>This does not seem useful:</p>
<blockquote>
<p>/bin/ nosuid root root</p>
</blockquote>
<p>If both nosuid and a mode/owner/group change is wanted, better add another config line.</p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick.html'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-12-20T09:46:35Z'>
              <time itemprop='dateModified' datetime='2019-12-21T12:46:27Z' class='post-time'>
                December 21, 2019, 12:46pm
              </time>
          <span itemprop='position'>#17</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="322" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<blockquote>
<p>fso: /lib/<br>
usr/lib/security-misc/permission-hardening: line 19: /usr/bin/stat: Argument list too long</p>
</blockquote>
<p>Can reproduce manually too.</p>
<pre><code class="lang-auto">shopt -s globstar
stat -c "%n %a %U %G" /lib/**
</code></pre>
<blockquote>
<p>bash: /usr/bin/stat: Argument list too long</p>
</blockquote>
</blockquote>
</aside>
<p>We are hitting <code>ARG_MAX</code></p>
<pre><code>getconf ARG_MAX
</code></pre>
<p>more info:<br>
<a href="../../../external.html?link=https://www.linuxjournal.com/article/6060" class="onebox" target="_blank">https://www.linuxjournal.com/article/6060</a></p>
<p><a href="../../../external.html?link=https://unix.stackexchange.com/questions/318470/how-can-i-prevent-arguments-to-xargs-from-being-prefixed-with-spaces">https://unix.stackexchange.com/questions/318470/how-can-i-prevent-arguments-to-xargs-from-being-prefixed-with-spaces</a> said <code>xargs</code> can split it up.</p>
<p>Will use</p>
<pre><code>done &lt; &lt;( find "${fso_without_trailing_slash}/" -print0 | xargs -I{} -0 stat -c "%n %a %U %G" {} )
</code></pre>
<p>to fix it.</p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick.html'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-12-20T10:03:25Z'>
              <time itemprop='dateModified' datetime='2019-12-21T12:46:27Z' class='post-time'>
                December 21, 2019, 12:46pm
              </time>
          <span itemprop='position'>#18</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>It‚Äôs fixed. But by fixing the parsing of /lib it‚Äôs also very slow. Needs 3 minutes to finish.</p>
<p>(And only using dry mode, i.e. not running the <code>dpkg-statoverwrite --add</code> / <code>--remove</code> commands yet actuary. I don‚Äôt think that would change much to the worse, though.)</p>
<pre><code>time sudo usr/lib/security-misc/permission-hardening
</code></pre>
<blockquote>
<p>fso: /home/<br>
run: dpkg-statoverride --add --update root root 0755 /home<br>
fso: /home/user/<br>
run: dpkg-statoverride --add --update user user 0700 /home/user<br>
fso: /root/<br>
run: dpkg-statoverride --add --update root root 0700 /root<br>
fso: /boot/<br>
run: dpkg-statoverride --add --update root root 0700 /boot<br>
fso: /etc/permission-hardening.conf<br>
run: dpkg-statoverride --add --update root root 0600 /etc/permission-hardening.conf<br>
fso: /bin/<br>
suid - file_name: ‚Äò/bin/fusermount‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /bin/fusermount<br>
suid - file_name: ‚Äò/bin/su‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /bin/su<br>
suid - file_name: ‚Äò/bin/ntfs-3g‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /bin/ntfs-3g<br>
fso: /usr/bin/<br>
suid - file_name: ‚Äò/usr/bin/sudo‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/sudo<br>
suid - file_name: ‚Äò/usr/bin/chsh‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/chsh<br>
suid - file_name: ‚Äò/usr/bin/crontab‚Äô | existing_mode: ‚Äò2755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --remove /usr/bin/crontab<br>
run: dpkg-statoverride --add --update root crontab 755 /usr/bin/crontab<br>
suid - file_name: ‚Äò/usr/bin/chfn‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/chfn<br>
suid - file_name: ‚Äò/usr/bin/ssh-agent‚Äô | existing_mode: ‚Äò2755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root ssh 755 /usr/bin/ssh-agent<br>
suid - file_name: ‚Äò/usr/bin/newuidmap‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/newuidmap<br>
suid - file_name: ‚Äò/usr/bin/pkexec.security-misc-orig‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/pkexec.security-misc-orig<br>
suid - file_name: ‚Äò/usr/bin/bwrap‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/bwrap<br>
suid - file_name: ‚Äò/usr/bin/chage‚Äô | existing_mode: ‚Äò2755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root shadow 755 /usr/bin/chage<br>
INFO: fso ‚Äò/usr/local/bin/‚Äô does not exist!<br>
fso: /sbin/<br>
suid - file_name: ‚Äò/sbin/mount.nfs‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /sbin/mount.nfs<br>
fso: /usr/sbin/<br>
INFO: fso ‚Äò/usr/local/sbin/‚Äô does not exist!<br>
fso: /lib/<br>
fso: /lib32/<br>
fso: /lib64/<br>
fso: /usr/lib/<br>
suid - file_name: ‚Äò/usr/lib/policykit-1/polkit-agent-helper-1‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/policykit-1/polkit-agent-helper-1<br>
suid - file_name: ‚Äò/usr/lib/eject/dmcrypt-get-device‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/eject/dmcrypt-get-device<br>
suid - file_name: ‚Äò/usr/lib/virtualbox/VBoxNetDHCP‚Äô | existing_mode: ‚Äò6755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/virtualbox/VBoxNetDHCP<br>
suid - file_name: ‚Äò/usr/lib/virtualbox/VBoxNetNAT‚Äô | existing_mode: ‚Äò6755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/virtualbox/VBoxNetNAT<br>
suid - file_name: ‚Äò/usr/lib/virtualbox/VBoxHeadless‚Äô | existing_mode: ‚Äò6755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/virtualbox/VBoxHeadless<br>
suid - file_name: ‚Äò/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic<br>
suid - file_name: ‚Äò/usr/lib/dbus-1.0/dbus-daemon-launch-helper‚Äô | existing_mode: ‚Äò4754‚Äô | new_mode: ‚Äò754‚Äô<br>
run: dpkg-statoverride --remove /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>
run: dpkg-statoverride --add --update root messagebus 754 /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>
suid - file_name: ‚Äò/usr/lib/kde4/libexec/fileshareset‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/kde4/libexec/fileshareset<br>
suid - file_name: ‚Äò/usr/lib/kde4/libexec/kdesud‚Äô | existing_mode: ‚Äò2755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root nogroup 755 /usr/lib/kde4/libexec/kdesud<br>
suid - file_name: ‚Äò/usr/lib/chromium/chrome-sandbox‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/chromium/chrome-sandbox<br>
suid - file_name: ‚Äò/usr/lib/qubes/qfile-unpacker‚Äô | existing_mode: ‚Äò4755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/qubes/qfile-unpacker<br>
suid - file_name: ‚Äò/usr/lib/evolution/camel-lock-helper-1.2‚Äô | existing_mode: ‚Äò2755‚Äô | new_mode: ‚Äò755‚Äô<br>
run: dpkg-statoverride --add --update root mail 755 /usr/lib/evolution/camel-lock-helper-1.2<br>
fso: /usr/lib32/<br>
INFO: fso ‚Äò/usr/lib64/‚Äô does not exist!<br>
INFO: fso ‚Äò/usr/local/lib/‚Äô does not exist!<br>
INFO: fso ‚Äò/usr/local/lib32/‚Äô does not exist!<br>
INFO: fso ‚Äò/usr/local/lib64/‚Äô does not exist!<br>
fso: /usr/bin/sudo<br>
run: dpkg-statoverride --add --update root root 4755 /usr/bin/sudo<br>
fso: /usr/bin/bwrap<br>
run: dpkg-statoverride --add --update root root 4755 /usr/bin/bwrap<br>
fso: /usr/lib/policykit-1/polkit-agent-helper-1<br>
run: dpkg-statoverride --add --update root root 4755 /usr/lib/policykit-1/polkit-agent-helper-1<br>
fso: /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>
INFO: fso ‚Äò/usr/lib/spice-gtk/spice-client-glib-usb-acl-helper‚Äô does not exist!<br>
fso: /usr/lib/x86_64-linux-gnu/utempter/utempter<br>
run: dpkg-statoverride --add --update root utmp 2755 /usr/lib/x86_64-linux-gnu/utempter/utempter</p>
<p>real    3m3.306s<br>
user    1m12.419s<br>
sys     1m57.067s</p>
</blockquote>
<p>The xtrace (<code>sudo bash -x usr/lib/security-misc/permission-hardening</code> or setting <code>set -x</code>) at the top of the script looks efficient. We don‚Äôt call <code>stat</code> a million times and we are using bash built-ins.</p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick.html'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-12-20T10:17:01Z'>
              <time itemprop='dateModified' datetime='2019-12-21T12:46:27Z' class='post-time'>
                December 21, 2019, 12:46pm
              </time>
          <span itemprop='position'>#19</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Added some benchmarking code (but not clean, will not publish unless deemed required).</p>
<blockquote>
<p>fso: /bin/ | benchmark: 00:00:01<br>
fso: /usr/bin/ | benchmark: 00:00:05<br>
fso: /sbin/ | benchmark: 00:00:00<br>
fso: /usr/sbin/ | benchmark: 00:00:01<br>
fso: /lib/ | benchmark: 00:00:57<br>
fso: /lib32/ | benchmark: 00:00:00<br>
fso: /lib64/ | benchmark: 00:00:00<br>
fso: /usr/lib/ | benchmark: 00:02:01<br>
fso: /usr/lib32/ | benchmark: 00:00:00</p>
</blockquote>
<p>Parsing <code>/lib/</code> and <code>/usr/lib/</code> takes far most of the time.</p>
<p>Fortunately <code>/lib</code> does not have any <code>suid</code> binaries by default on my system.</p>
<p>Maybe we can mount <code>/lib</code> as <code>nodev,nosuid</code>. As per <a href="../../../external.html?link=https://seifried.org/lasg/installation/">https://seifried.org/lasg/installation/</a> we can. Then we could remove <code>/lib</code> from permission hardening config and safe 1 minute.</p>
<p>Related: <a href="../re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707/21.html" class="inline-onebox">(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?</a></p>
<p>Parsing <code>/usr/lib</code> though seems important.</p>
        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707/22.html" itemprop='item'>
                      <meta itemprop='url' content='../re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707/22.html'>
                      <meta itemprop='position' content='3'>
                      <span itemprop='name'>(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?</span>
                    </a>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/1/1fe0587524112f37ca32e0541d281d3d0a4eedf9.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../u/Patrick.html'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <meta itemprop='datePublished' content='2019-12-20T10:30:31Z'>
              <time itemprop='dateModified' datetime='2019-12-21T12:46:27Z' class='post-time'>
                December 21, 2019, 12:46pm
              </time>
          <span itemprop='position'>#20</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="328" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../external.html?link=http://forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Fortunately <code>/lib</code> does not have any <code>suid</code> binaries by default on my system.</p>
<p>Maybe we can mount <code>/lib</code> as <code>nodev,nosuid</code> . As per <a href="../../../external.html?link=https://seifried.org/lasg/installation/">https://seifried.org/lasg/installation/</a> we can. Then we could remove <code>/lib</code> from permission hardening config and safe 1 minute.</p>
<p>Related: <a href="../re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707/21.html">(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?</a></p>
</blockquote>
</aside>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/af0f074987b21ba4ad3f331ddaa622082d76fceb" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/af0f074987b21ba4ad3f331ddaa622082d76fceb" target="_blank">remount /lib with nosuid,nodev</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-20" data-time="10:27:11" data-timezone="UTC">10:27AM - 20 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 10 additions and 0 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/af0f074987b21ba4ad3f331ddaa622082d76fceb" target="_blank">
          <span class="added">+10</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">https://forums.whonix.org/t/re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707/22</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="quote quote-modified" data-post="23" data-topic="7707">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../external.html?link=https://forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="../re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707/23.html">(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?</a> <a class="badge-wrapper  bullet" href="../../c/development.html"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    
  </blockquote>
</aside>

<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/6c8127e3cd32c04a6eb4641ad856c7bf2c777fee" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/6c8127e3cd32c04a6eb4641ad856c7bf2c777fee" target="_blank">remove "/lib/ nosuid" from permission hardening</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-20" data-time="10:29:37" data-timezone="UTC">10:29AM - 20 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 6 additions and 1 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/6c8127e3cd32c04a6eb4641ad856c7bf2c777fee" target="_blank">
          <span class="added">+6</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">Takes 1 minute to parse. No SUID binaries there by default.
remount-secure mounts it with nosuid anyhow.
Therefore no processing it here.</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Disable SUID Binaries'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><b><a rel="next" itemprop="url" href="77064658.html?page=2">next page ‚Üí</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Qubes + Whonix - Qubes-Whonix - Whonix Forum</title>
    <meta name="description" content="Update: 

An initial version of Qubes + Whonix integration has been successfully achieved. 

Qubes + Whonix wiki page: 

https://www.whonix.org/wiki/Qubes 

Qubes + Whonix mailing list announcement: 

https://www.whonix.&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="3749ba9.html?page=3" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Qubes + Whonix&#39;" href="374.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/qubes-whonix/374?page=3" />
<meta name="twitter:url" content="https://forums.whonix.org/t/qubes-whonix/374?page=3" />
<meta property="og:title" content="Qubes + Whonix" />
<meta name="twitter:title" content="Qubes + Whonix" />
<meta property="og:description" content="Here’s another tough challenge with Whonix VM images that I haven’t found a workaround for yet. Maybe someone here can offer a solution?  The Whonix VM disk images are allocated 100GB of space.  I’ve tried a number of ways to extract and convert Whonix VM images into RAW formatted .img files for Qubes.  tar -xvf Whonix-Gateway.qcow2.xz  qemu-img convert Whonix.qcow2 -O raw Whonix.img The problem is that the bootable raw .img file ends up being ~100GB file. And it takes a LONG time (~1.5 hrs) to ..." />
<meta name="twitter:description" content="Here’s another tough challenge with Whonix VM images that I haven’t found a workaround for yet. Maybe someone here can offer a solution?  The Whonix VM disk images are allocated 100GB of space.  I’ve tried a number of ways to extract and convert Whonix VM images into RAW formatted .img files for Qubes.  tar -xvf Whonix-Gateway.qcow2.xz  qemu-img convert Whonix.qcow2 -O raw Whonix.img The problem is that the bootable raw .img file ends up being ~100GB file. And it takes a LONG time (~1.5 hrs) to ..." />
<meta property="article:published_time" content="2014-08-14T15:30:22+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="3744658.html?page=2">
        <link rel="next" href="374fdb0.html?page=4">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="374.html">Qubes + Whonix</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/qubes-whonix/12.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #63a0ff'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Qubes-Whonix</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-14T15:30:22Z' class='post-time'>
                August 14, 2014,  3:30pm
              </time>
              <meta itemprop='dateModified' content='2014-08-14T15:30:22Z'>
          <span itemprop='position'>#41</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Here’s another tough challenge with Whonix VM images that I haven’t found a workaround for yet. Maybe someone here can offer a solution?</p>
<p>The Whonix VM disk images are allocated 100GB of space.</p>
<p>I’ve tried a number of ways to extract and convert Whonix VM images into RAW formatted .img files for Qubes.</p>
<pre><code class="lang-auto">tar -xvf Whonix-Gateway.qcow2.xz

qemu-img convert Whonix.qcow2 -O raw Whonix.img</code></pre>
<p>The problem is that the bootable raw .img file ends up being ~100GB file. And it takes a LONG time (~1.5 hrs) to transfer between Qubes VMs to dom0 as is needed.</p>
<p>Every other way I do it ultimately fails to boot, which might be related to what Patrick mentioned…</p>
<aside class="quote" data-post="39" data-topic="374">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Historically this is because creating a Debian/grub bootable (raw) image is quite difficult.</p>
</blockquote>
</aside>
<p>Using qemu-img to resize it, does resize it, but it then fails to boot.</p>
<pre><code class="lang-auto">qemu-img resize Whonix.img 5G</code></pre>
<p>Would the only way to put this down to a smaller disk allocation be to build Whonix from scratch?</p>
<p>If not a big deal, could a temporary testers-only release have a small disk allocation, like maybe ~ 10GB?</p>
<p>Thanks!</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-14T15:51:58Z' class='post-time'>
                August 14, 2014,  3:51pm
              </time>
              <meta itemprop='dateModified' content='2014-08-14T15:51:58Z'>
          <span itemprop='position'>#42</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="41" data-topic="374">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/w/c5a1d2/40.png" class="avatar"> WhonixQubes:</div>
<blockquote>
<p>Here’s another tough challenge with Whonix VM images that I haven’t found a workaround for yet. Maybe someone here can offer a solution?</p>
</blockquote>
</aside>
<p>Does Qubes OS support qcow2 images? Can you ask them please? If not, post a feature request against Qubes OS?</p>
<p>Then we wouldn’t have need to also supply official raw images. Also qcow2 images are more feature rich.</p>
<blockquote>The Whonix VM disk images are allocated 100GB of space.</blockquote>
No. Those are sparse files.
<p>For explanation, please see this chapter:</p>
<ul>
<li><a href="../../../external.html?link=https://www.whonix.org/wiki/KVM#Moving_Whonix_Image_Files">https://www.whonix.org/wiki/KVM#Moving_Whonix_Image_Files</a></li>
</ul>
<p>It contains commands on how to handle them without losing sparse feature.</p>
<p>As well as:</p>
<ul>
<li><a href="../../../external.html?link=https://www.whonix.org/wiki/sparse_files">https://www.whonix.org/wiki/sparse_files</a></li>
</ul>
<blockquote>I've tried a number of ways to extract and convert Whonix VM images into RAW formatted .img files for Qubes.</blockquote>
Maybe try to make them sparse files. Would solve this whole issue.
<p>Also maybe try this search terms:</p>
<ul>
<li>site:qubes-os.org sparse</li>
<li>raw image sparse file</li>
</ul>
<blockquote>The problem is that the bootable raw .img file ends up being ~100GB file. And it takes a LONG time (~1.5 hrs) to transfer between Qubes VMs to dom0 as is needed.</blockquote>
Would be solved with sparse files.
<blockquote>Every other way I do it ultimately fails to boot, which might be related to what Patrick mentioned...</blockquote>
Not sure if this is related.
<blockquote>Using qemu-img to resize it, does resize it, but it then fails to boot.
<p><code>
qemu-img resize Whonix.img 5G
</code></p>
</blockquote><br>
Not required when using sparse files.
<blockquote>Would the only way to put this down to a smaller disk allocation be to build Whonix from scratch?</blockquote>
VMSIZE is supported as build option but I hope and guess it won't be required.
<blockquote>If not a big deal, could a temporary testers-only release have a small disk allocation, like maybe ~ 10GB?</blockquote>
I hope and guess we can prevent this by using sparse files. I would wonder a lot if Qubes OS doesn't support it. I would also wonder if Qubes OS supported only raw images, no qcow2.
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-15T01:57:40Z' class='post-time'>
                August 15, 2014,  1:57am
              </time>
              <meta itemprop='dateModified' content='2014-08-15T01:57:40Z'>
          <span itemprop='position'>#43</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“Patrick, post:42, topic:374”]Does Qubes OS support qcow2 images? Can you ask them please? If not, post a feature request against Qubes OS?</p>
<p>Then we wouldn’t have need to also supply official raw images. Also qcow2 images are more feature rich.[/quote]</p>
<p>I tested the Whonix 8.2 .qcow2 images in Qubes and they did not work for me.</p>
<ol>
<li>
<p>Tested with “qvm-create --root-move-from” command. This changes the .qcow2 image filename to “root.img” for the Qubes HVM. But as the machine starts it reports that there is no bootable device.</p>
</li>
<li>
<p>Tested by manually copying the .qcow2 image into a Qubes AppVM directory as “root.qcow2” and then manually edited the VM’s .conf file to point to “root.qcow2” instead of “root.img” for the “xvda” device. But as the machine starts it reports that the “root.img” file is missing and cannot boot.</p>
</li>
</ol>
<p>I will ask the Qubes team to be sure and also put in a feature request to support .qcow2 images.</p>
<p>And thanks for the tips on working with the images as sparse files. I will try to utilize this sparse attribute for keeping the image sizes down when working with them in Qubes.</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-17T07:07:29Z' class='post-time'>
                August 17, 2014,  7:07am
              </time>
              <meta itemprop='dateModified' content='2014-08-17T07:07:29Z'>
          <span itemprop='position'>#44</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I’m currently working on getting networking configured and working between Whonix 8.2 VM images in Qubes HVMs.</p>
<p>The mechanisms by which I am tweaking the networking are:</p>
<ul>
<li>
<p>Xen “xl” commands (<a href="../../../external.html?link=https://groups.google.com/d/topic/qubes-users/RFXoZ3zt-PE" rel="nofollow noopener">https://groups.google.com/d/topic/qubes-users/RFXoZ3zt-PE</a>)</p>
</li>
<li>
<p>Whonix settings in “/etc/network/interfaces”</p>
</li>
</ul>
<p>Qubes utilizes 10.137.2.X ip addresses.</p>
<p>Question:</p>
<p>Other than in the “/etc/network/interfaces” file, does Whonix hardcode or rely upon the 192.168.0.10 / 192.168.0.11 ip addresses? Could I simply change them here to 10.137.2.X based addresses and expect Whonix to work?</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-17T13:57:32Z' class='post-time'>
                August 17, 2014,  1:57pm
              </time>
              <meta itemprop='dateModified' content='2014-08-17T13:57:32Z'>
          <span itemprop='position'>#45</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="44" data-topic="374">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/w/c5a1d2/40.png" class="avatar"> WhonixQubes:</div>
<blockquote>
<p>Other than in the “/etc/network/interfaces” file, does Whonix hardcode or rely upon the 192.168.0.10 / 192.168.0.11 ip addresses? Could I simply change them here to 10.137.2.X based addresses and expect Whonix to work?</p>
</blockquote>
</aside>
<p>Good news is, they’re not hard coded in the strong sense. Internal LAN IP addresses are more or less arbitrarily chosen and there is no inherit dependency on 192.168[…].</p>
<p>We changed IP’s between Whonix 8 and Whonix 9. Perhaps diff the files /etc/network/interfaces7 [/etc/network/interfaces.whonix] and see what has changed. [As per dev discussion <a href="../../../external.html?link=https://www.whonix.org/forum/index.php/topic,107.0.html.%5D">https://www.whonix.org/forum/index.php/topic,107.0.html.]</a></p>
<p>Whonix 8:<br>
<aside class="onebox githubblob">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/Whonix/blob/Whonix8/whonix_gateway/etc/network/interfaces.whonix" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://github.com/Whonix/Whonix/blob/Whonix8/whonix_gateway/etc/network/interfaces.whonix" target="_blank" rel="nofollow noopener">Whonix/Whonix/blob/Whonix8/whonix_gateway/etc/network/interfaces.whonix</a></h4>
<pre><code class="lang-whonix">## This file is part of Whonix.
## Copyright (C) 2012 - 2014 Patrick Schleizer &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions.

## for more information see interfaces(5)

## Whonix /etc/network/interfaces

## You can find a backup of the original interfaces under /etc/network/interfaces.backup.

## Unfortunately, we can not use /etc/network/if-pre-up.d
## to load Whonix-Firewall, because of a Debian upstream bug.
## - interface comes up even if a script in /etc/network/if-pre-up.d/ fails:
##   http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=700811

## Loopback interface.
auto lo
iface lo inet loopback

## When using Virtual Machines (not Physical Isolation),
</code></pre>

  This file has been truncated. <a href="../../../external.html?link=https://github.com/Whonix/Whonix/blob/Whonix8/whonix_gateway/etc/network/interfaces.whonix" target="_blank" rel="nofollow noopener">show original</a>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>Whonix 9<br>
<a href="../../../external.html?link=https://github.com/Whonix/whonix-gw-network-conf/blob/master/etc/network/interfaces.whonix" class="onebox" target="_blank">https://github.com/Whonix/whonix-gw-network-conf/blob/master/etc/network/interfaces.whonix</a></p>
<p>Unfortunately they are hard coded in non-strict sense in various files. Which means, if you change them in one place, you must change them in all places. [And due to the nature of config files, there is no way to use variables.]</p>
<p>To find out in which you need to make changes.</p>
<ol>
<li>checkout the git tag of the Whonix version you are using such as 8.2</li>
<li>
</li>
</ol>
<pre><code class="lang-auto"></code></pre>
<p>And if you’re unsure, compare those files with Whonix 9. IP’s were changed there as well.</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-17T14:02:47Z' class='post-time'>
                August 17, 2014,  2:02pm
              </time>
              <meta itemprop='dateModified' content='2014-08-17T14:02:47Z'>
          <span itemprop='position'>#46</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Patrick, I put in a feature request for qcow2 images over at the Qubes developer mailing list.</p>
<p>Joanna just left a reply here…</p>
<p><a href="../../../external.html?link=https://groups.google.com/d/topic/qubes-devel/zHrCA8Zp7No" class="onebox" target="_blank" rel="nofollow noopener">https://groups.google.com/d/topic/qubes-devel/zHrCA8Zp7No</a></p>
<p>They don’t want to add the extra features of qcow2 images in dom0 to the TCB, compared to raw.</p>
<p>She pointed out a potential way to boot from qcow2 images in other less trusted non-dom0 VMs. However, at first glance, this seems a bit too messy for an officially packaged Qubes + Whonix solution.</p>
<p>She was quite happy to hear that there is consideration of Qubes support for Whonix though!</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-17T14:11:15Z' class='post-time'>
                August 17, 2014,  2:11pm
              </time>
              <meta itemprop='dateModified' content='2014-08-17T14:11:15Z'>
          <span itemprop='position'>#47</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="45" data-topic="374">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Good news is…</p>
</blockquote>
</aside>
<p>Thanks Patrick for the info on Whonix internal IPs. Got it.</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-18T10:01:28Z' class='post-time'>
                August 18, 2014, 10:01am
              </time>
              <meta itemprop='dateModified' content='2014-08-18T10:01:28Z'>
          <span itemprop='position'>#48</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Update:</p>
<p>As previously mentioned, I’ve got the Whonix-Gateway and Whonix-Workstation VM images booted up and can operate the desktops fine as HardwareVMs (HVM).</p>
<p>But I’m presently bottlenecked on getting the basic networking infrastructure in place for the 2 Whonix HVMs.</p>
<p>By default Qubes allocates a single NIC (network interface card) to each HVM, which Debian/Whonix can use as (eth0).</p>
<p>The Whonix-Gateway HVM needs a 2nd NIC to establish an internal network between the Whonix-Gateway and Whonix-Workstation.</p>
<p>On the Qubes mailing list, I was recommended using the native Xen “xl” toolkit commands to attach and modify network interfaces for the HVMs.</p>
<p>Reference: <a href="../../../external.html?link=https://groups.google.com/d/topic/qubes-users/RFXoZ3zt-PE" rel="nofollow noopener">https://groups.google.com/d/topic/qubes-users/RFXoZ3zt-PE</a></p>
<p>Example code to attach new network interface to Qubes VM:</p>
<pre><code class="lang-auto">xl network-attach VMNAME script=/etc/xen/scripts/vif-route-qubes ip=IPADDRESS backend=BACKEND_VMNAME</code></pre>
<p>I’ve tested this out with a number of different VMs.</p>
<p>Xen consistently reports that a new network interface is attached.</p>
<p>However, depending upon the precise scenario, the VM OS will or will not be able to use it for establishing a second NIC (eth1) inside the VM OS.</p>
<p>It gives differing results depending on the varying scenarios.</p>
<p>Variables that seem to affect successful eth1 establishment:</p>
<ul>
<li>VM OS Type (Debian, Whonix, etc)</li>
<li>PV Para-virtualized or HVM Fully-virtualized (Qubes Templates vs. HVM)</li>
<li>xl Command “backend=” Selection</li>
</ul>
<p>One of the more interesting results I get is with the Whonix-Gateway 8.2 HVM where in the “xl network-attach” command, if I set the “backend=firewallvm” then I can establish eth1 in Whonix-Gateway, but if I set the “backend=whonix-workstation” then I cannot establish eth1 in Whonix-Gateway.</p>
<p>Same/similar issues when attempting to detach and attach Whonix-Workstation eth0 with “backend=whonix-gateway”.</p>
<p>Things should start to come alive with Qubes + Whonix once this base networking is established and the packets can flow.</p>
<p>Working to find a consistent and working method for getting the networking infrastructure setup for Whonix’s internal network between the Gateway and Workstation.</p>
<p>No luck yet. Still persisting.</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-18T12:39:09Z' class='post-time'>
                August 18, 2014, 12:39pm
              </time>
              <meta itemprop='dateModified' content='2014-08-18T12:39:09Z'>
          <span itemprop='position'>#49</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I suggest learning how to do this without Whonix being involved first. This is because Whonix adds extra complexity such as Whonix’s firewall that may break your efforts.</p>
<p>Two plain Debian HVM’s may be better suited for these tests. Maybe for learning this also the existing Qubes OS Debian template AppVMs would suffice. When you are at this point, go back to trying it with Whonix. If it then still doesn’t work, the error should has been narrowed to Whonix.</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-18T14:18:12Z' class='post-time'>
                August 18, 2014,  2:18pm
              </time>
              <meta itemprop='dateModified' content='2014-08-18T14:18:12Z'>
          <span itemprop='position'>#50</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“Patrick, post:49, topic:374”]I suggest learning how to do this without Whonix being involved first. This is because Whonix adds extra complexity such as Whonix’s firewall that may break your efforts.</p>
<p>Two plain Debian HVM’s may be better suited for these tests.[/quote]</p>
<p>Thanks for the astute suggestion Patrick. Yes, I have been using plain Debian as a baseline comparison for a number of my configuration tests, in order to isolate out any Whonix specific issues, including this one involving the networking. Checking baselines against Fedora, AppVMs vs. HVMs, when necessary, etc.</p>
<p>Some good news…</p>
<p>I’ve got PING packets flowing between the Whonix-Gateway HVM (eth1) and Whonix-Workstation HVM (eth0) and showing up to the other HVM’s adapter inside of Whonix (ifconfig).</p>
<p>This was accomplished using Qubes IP addresses (10.137.2.X).</p>
<p>I’ve so far only changed the IP configurations in “/etc/network/interfaces” to match the Qubes allocated IPs.</p>
<p>The “backend” for all of these HVM’s adapters is set to “firewallvm”. So all the packets from these HVMs are flowing through this firewallvm domain.</p>
<p>I then modified the iptables of the firewallvm to forward the packets between the HVMs, using the instructions provided by the Qubes firewall documentation.</p>
<pre><code class="lang-auto">sudo iptables -I FORWARD 2 -s &lt;IP address of A&gt; -d &lt;IP address of B&gt; -j ACCEPT</code></pre>
<p>Reference: <a href="../../../external.html?link=https://qubes-os.org/wiki/QubesFirewall" rel="nofollow noopener">https://qubes-os.org/wiki/QubesFirewall</a></p>
<p>And so some packets are flowing between the Whonix-Gateway HVM and Whonix-Workstation HVM.</p>
<p>Going to work on getting full Whonix Tor traffic flowing next. Getting closer! <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-20T08:27:31Z' class='post-time'>
                August 20, 2014,  8:27am
              </time>
              <meta itemprop='dateModified' content='2014-08-20T08:27:31Z'>
          <span itemprop='position'>#51</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Update:</p>
<p>Here’s the situation I’m presently in with getting inter-VM Whonix traffic flowing:</p>
<p>I believe I’ve got the proper network adapters (NICs) established for Whonix VMs.</p>
<p>The present hangup is with getting Qubes IP and Whonix IP address configurations in sync with each other.</p>
<p>Potential Approaches:</p>
<ul>
<li>
<p>Approach <span class="hashtag">#1</span>) Adapting Qubes IP configuration to Whonix-based IPs (xl network-detach / xl network-attach).</p>
</li>
<li>
<p>Issues: Using the Xen “xl” toolstack, I can seemingly get the IPs set to Whonix-based IPs for the network adapters. However, the traffic does not flow. Maybe this is just a matter of modifying the rules in iptables for the “firewallvm”.</p>
</li>
<li>
<p>Approach <span class="hashtag">#2</span>) Replacing Whonix IPs to Qubes IPs within running binary Whonix VM image.</p>
</li>
<li>
<p>Issues: When I grep the running Linux filesystem for Whonix IPs, there are a lot of them, and some in binary files. Unsure as to whether replacing all Whonix IPs within a running Whonix image would work that well. Also, maybe not a convenient and predictable process for reconfiguring when Qubes IPs get reallocated or new Whonix VMs are added.</p>
</li>
<li>
<p>Approach <span class="hashtag">#3</span>) Replacing Whonix IPs to Qubes IPs within pre-compile Whonix physical isolation build.</p>
</li>
<li>
<p>Issues: Too slow of a process anytime Qubes IPs get reallocated or new VMs are added.</p>
</li>
</ul>
<p>I’m going to try hacking on the iptables rules for the firewallvm to see if I can open up Approach <span class="hashtag">#1</span> here.</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-20T14:03:38Z' class='post-time'>
                August 20, 2014,  2:03pm
              </time>
              <meta itemprop='dateModified' content='2014-08-20T14:03:38Z'>
          <span itemprop='position'>#52</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>Here's the situation I'm presently in with getting inter-VM Whonix traffic flowing:
<p>I believe I’ve got the proper network adapters (NICs) established for Whonix VMs.</p>
<p>The present hangup is with getting Qubes IP and Whonix IP address configurations in sync with each other.</p>
<ul>
<li>Issues: Using the Xen “xl” toolstack, I can seemingly get the IPs set to Whonix-based IPs for the network adapters. However, the traffic does not flow. Maybe this is just a matter of modifying the rules in iptables for the “firewallvm”.</li>
</ul>
</blockquote><br>
I advice a two step approach:

<ol>
<li>disable Whonix’s firewall (comment out pre-up in /etc/network/interfaces and reboot) to see if traffic could flow should there be no firewall that disturbed it.</li>
<li>re-enable Whonix’s firewall, perhaps modify it</li>
</ol>
<blockquote>- Approach #2) Replacing Whonix IPs to Qubes IPs within running binary Whonix VM image.
<ul>
<li>Issues: When I grep the running Linux filesystem for Whonix IPs, there are a lot of them, and some in binary files. Unsure as to whether replacing all Whonix IPs within a running Whonix image would work that well.</li>
</ul>
</blockquote><br>
I don’t think you should/need grep the running Linux filesystem or that purpose. Would be better to do as advices in a previous blog post. grep the git version tag for the Whonix version you are using for the IPs to get a list of files where they are used. Then you can also change them in the running Linux filesystem. After reboot that should be as good as an installation with these changed IPs because there is no magic involved (<a href="../../../external.html?link=https://www.whonix.org/wiki/About#Based_on_Debian">https://www.whonix.org/wiki/About#Based_on_Debian</a>).

<blockquote>- Approach #3) Replacing Whonix IPs to Qubes IPs within pre-compile Whonix physical isolation build.
<ul>
<li>Issues: Too slow of a process anytime Qubes IPs get reallocated or new VMs are added.</li>
</ul>
</blockquote><br>
Indeed.

<blockquote>Also, maybe not a convenient and predictable process for reconfiguring when Qubes IPs get reallocated or new Whonix VMs are added.</blockquote>
Indeed.
<p>Qubes OS’s TorVM sorted this out somehow but I never found time to look how.</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-20T15:18:33Z' class='post-time'>
                August 20, 2014,  3:18pm
              </time>
              <meta itemprop='dateModified' content='2014-08-20T15:18:33Z'>
          <span itemprop='position'>#53</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Problem:</p>
<p>First some progress, I think I’ve now got normal traffic opened and flowing between Whonix-Workstation and Whonix-Gateway using “Approach <span class="hashtag">#1</span>) Adapting Qubes IP configuration to Whonix-based IPs”.</p>
<p>But I am unable to test it with normal Tor internet traffic, because, on the Whonix-Gateway, I am strangely unable to get an internet connection on eth0.</p>
<p>I can successfully get a DHCP and Static eth0 internet connection with Qubes using my baseline plain Debian HVMs.</p>
<p>I’ve tried DHCP and Static in “/etc/network/interfaces”, then reset network connection using:</p>
<pre><code class="lang-auto">sudo /etc/init.d/networking restart</code></pre>
<p>During network restart, DHCPDISCOVER process fails with:</p>
<pre><code class="lang-auto">DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 7
...
No DHCPOFFERS received.
No working leases in persistent database - sleeping.</code></pre>
<p>Commenting out DHCP in “/etc/network/interfaces” and matching static network settings to Qubes IPs doesn’t work either after network restart. But it does in other plain Debian HVMs.</p>
<p>Such as:</p>
<pre><code class="lang-auto">auto eth0
iface eth0 inet static
address 10.137.2.16
netmask 255.255.255.0
gateway 10.137.2.1
broadcast 10.137.2.255
# pre-up /usr/bin/whonix_firewall (tried commented and not commented)</code></pre>
<p>Seems to be a Whonix related issue on Qubes for the Whonix-Gateway not making internet connection on eth0.</p>
<p>Also, on the Whonix-Gateway, I opened “/etc/whonix_firewall.d/30_default” and lifted all of the “dangerous” restrictions to try and get a basic internet connection working on the Gateway.</p>
<pre><code class="lang-auto">GATEWAY_TRANSPARENT_TCP=1
GATEWAY_TRANSPARENT_UDP=1
GATEWAY_TRANSPARENT_DNS=1
ALLOW_GATEWAY_ROOT_USER=1
ALLOW_GATEWAY_USER_USER=1</code></pre>
<p>And reloaded Whonix firewall:</p>
<pre><code class="lang-auto">sudo /usr/bin/whonix_firewall</code></pre>
<p>No success on internet connection for Whonix-Gateway.</p>
<p>If I can get this internet connection working on the Whonix-Gateway, then I might just have a fully functional Qubes + Whonix system up and running at this stage.</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-20T21:21:05Z' class='post-time'>
                August 20, 2014,  9:21pm
              </time>
              <meta itemprop='dateModified' content='2014-08-20T21:21:05Z'>
          <span itemprop='position'>#54</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>This could be related. Recent change in whonix-gw-firewall that will be introduced in version 0.4. Pretty simple change:<br>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/whonix-firewall/commit/827ea83bed41256bda33ab69c173df2878966a30" target="_blank">github.com/Whonix/whonix-firewall</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/whonix-firewall/commit/827ea83bed41256bda33ab69c173df2878966a30" target="_blank">Added 10.0.2.2/24 to NON_TOR_GATEWAY and LOCAL_NET to prevent spamming syslog with:</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2014-08-18" data-time="13:08:39" data-timezone="UTC">01:08PM - 18 Aug 14 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 8 additions and 4 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/whonix-firewall/commit/827ea83bed41256bda33ab69c173df2878966a30" target="_blank">
          <span class="added">+8</span>
          <span class="removed">-4</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">host dhclient: DHCPREQUEST on eth0 to 10.0.2.2 port 67
host dhclient: send_packet: Operation not permitted</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>In other words you need to allow traffic to the dhcp server.</p>
<p>In /etc/whonix_firewall.d/50_user use something like:<br>
NON_TOR_GATEWAY=“192.168.1.0/24 192.168.0.0/24 127.0.0.0/8 10.152.152.0/24 10.0.2.2/24”</p>
<p>And replace 10.0.2.2 with the IP of the dhcp server.</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-21T06:44:56Z' class='post-time'>
                August 21, 2014,  6:44am
              </time>
              <meta itemprop='dateModified' content='2014-08-21T06:44:56Z'>
          <span itemprop='position'>#55</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“Patrick, post:54, topic:374”]This could be related. Recent change in whonix-gw-firewall that will be introduced in version 0.4. Pretty simple change:<br>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/whonix-firewall/commit/827ea83bed41256bda33ab69c173df2878966a30" target="_blank" rel="nofollow noopener">github.com/Whonix/whonix-firewall</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/whonix-firewall/commit/827ea83bed41256bda33ab69c173df2878966a30" target="_blank" rel="nofollow noopener">Added 10.0.2.2/24 to NON_TOR_GATEWAY and LOCAL_NET to prevent spamming syslog with:</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2014-08-18" data-time="13:08:39" data-timezone="UTC">01:08PM - 18 Aug 14 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 8 additions and 4 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/whonix-firewall/commit/827ea83bed41256bda33ab69c173df2878966a30" target="_blank" rel="nofollow noopener">
          <span class="added">+8</span>
          <span class="removed">-4</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">host dhclient: DHCPREQUEST on eth0 to 10.0.2.2 port 67
host dhclient: send_packet: Operation not permitted</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>In other words you need to allow traffic to the dhcp server.</p>
<p>In /etc/whonix_firewall.d/50_user use something like:<br>
NON_TOR_GATEWAY=“192.168.1.0/24 192.168.0.0/24 127.0.0.0/8 10.152.152.0/24 10.0.2.2/24”</p>
<p>And replace 10.0.2.2 with the IP of the dhcp server.[/quote]</p>
<p>Did not work, using Whonix 8.2 images in Qubes HVM.</p>
<p>In my working plain Debian Wheezy HVM, I found the DHCP server IP to be “10.137.2.254” with this command:</p>
<pre><code class="lang-auto">sudo grep -R "DHCPOFFER" /var/log/*</code></pre>
<p>Reported several instances of:</p>
<pre><code class="lang-auto">debian dhclient: DHCPOFFER from 10.137.2.254</code></pre>
<p>In the Whonx-Gateway, I created a new file “/etc/whonix_firewall.d/50_user”.</p>
<p>Tried it several different ways in “50_user”:</p>
<pre><code class="lang-auto">NON_TOR_GATEWAY="192.168.1.0/24 192.168.0.0/24 127.0.0.0/8 10.152.152.0/24 10.137.2.254/24"

NON_TOR_GATEWAY="192.168.1.0/24 192.168.0.0/24 127.0.0.0/8 10.152.152.0/24 10.137.2.0/24"

NON_TOR_GATEWAY="192.168.1.0/24 192.168.0.0/24 127.0.0.0/8 10.152.152.0/24 10.137.2.1/24"

NON_TOR_GATEWAY="192.168.1.0/24 192.168.0.0/24 127.0.0.0/8 10.152.152.0/24 10.137.2.254"

NON_TOR_GATEWAY="192.168.1.0/24 192.168.0.0/24 127.0.0.0/8 10.152.152.0/24 10.137.2.254 255.255.255.255"

etc</code></pre>
<p>Also tried putting this “NON_TOR_GATEWAY” command into “/etc/whonix_firewall.d/30_default”.</p>
<p>Also tried modifying the original “NON_TOR_GATEWAY” command in “/usr/bin/whonix_firewall”.</p>
<p>Also tried blanking the entire “/usr/bin/whonix_firewall” file contents with white space.</p>
<p>Each time, I reset the Whonix firewall and then reset the network connection.</p>
<pre><code class="lang-auto">sudo /usr/bin/whonix_firewall
sudo /etc/init.d/networking restart</code></pre>
<p>Have tried with DHCP settings in “/etc/network/interfaces”.</p>
<pre><code class="lang-auto">auto eth0
iface eth0 inet dhcp</code></pre>
<p>Have tried with Static settings in “/etc/network/interfaces”.</p>
<pre><code class="lang-auto">auto eth0
iface eth0 inet static
address 10.137.2.16
netmask 255.255.255.0
gateway 10.137.2.1
broadcast 10.137.2.255</code></pre>
<p>No success.</p>
<p>Yet, as mentioned, both DHCP and Static networking works fine with plain Debian Wheezy in Qubes HVM.</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-21T11:11:20Z' class='post-time'>
                August 21, 2014, 11:11am
              </time>
              <meta itemprop='dateModified' content='2014-08-21T11:11:20Z'>
          <span itemprop='position'>#56</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>Also tried blanking the entire "/usr/bin/whonix_firewall" file contents with white space.</blockquote>
This probably won't work. I said in /etc/network/interfaces you can comment out the pre-up if you want to entirely disable it, because when /usr/bin/whonix_firewall does not exit 0, network will not come up. The shortest possible /usr/bin/whonix_firewall would be
<p><code>#!/bin/bash
exit 0</code></p>
<p>and be executable. Writing the “exit 0”  right below “#!/bin/bash” archives the same. Blanking the file is not required.</p>
<p>So when Whonix’s firewall is disabled, dhcp / networking does fully work?</p>
<p>If not, you can isolate the offending package by starting with a plain Debian VM and then installing Whonix network related settings packages one by one or maybe also by starting with a Whonix-Gateway VM and uninstalling network related packages one by one. Alternative to uninstalling you could also look what the package is actually doing and manually undo it to have the same effect.</p>
<p>The full package list can be found here:<br>
</p><aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../external.html?link=https://github.githubassets.com/favicons/favicon.svg" class="site-icon" width="32" height="32">
      <a href="../../../external.html?link=https://github.com/Whonix" target="_blank">GitHub</a>
  </header>
  <article class="onebox-body">
    <img src="../../../external.html?link=https://avatars0.githubusercontent.com/u/4500165?s=280&amp;v=4" class="thumbnail onebox-avatar" width="280" height="280">

<h3><a href="../../../external.html?link=https://github.com/Whonix" target="_blank">Whonix</a></h3>

<p>Anonymous Operating System. Whonix has 116 repositories available. Follow their code on GitHub.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<br>
(~5 pages; ~100 packages, only a fraction related to network)
<p>Main gateway networking related packages are that might cause this:</p>
<p>anon-gw-anonymizer-config<br>
whonix-gw-firewall<br>
ipv4-forward-disable<br>
ipv6-disable<br>
anon-gw-dhcp-conf<br>
anon-gw-dns-conf<br>
whonix-gw-network-conf<br>
uwt</p>
<p>To automatically manage package dependencies, you can install them either from official Whonix APT repository from testers (!) repository:<br>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../external.html?link=https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="../../../external.html?link=https://www.whonix.org/wiki/Whonix-APT-Repository" target="_blank" title="04:56PM - 01 May 2020">Whonix – 1 May 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:579/411;"><img src="../../../external.html?link=https://www.whonix.org/w/images/d/d8/Changerepositorygui234234.png" class="thumbnail" width="579" height="411"></div>

<h3><a href="../../../external.html?link=https://www.whonix.org/wiki/Whonix-APT-Repository" target="_blank">Project-APT-Repository - Whonix</a></h3>

<p>Whonix ™ stable / testers / developers APT Repository. How to change from one suite to another? How to disable Whonix ™ APT Repository?</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>Instructions similar to:<br>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../external.html?link=https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="../../../external.html?link=https://www.whonix.org/wiki/Upgrading_Whonix_8_to_Whonix_9#Upgrading_Whonix-Gateway" target="_blank" title="03:23AM - 18 June 2019">Whonix – 18 Jun 19</a>
  </header>
  <article class="onebox-body">
    <img src="#" class="thumbnail" width="" height="">

<h3><a href="../../../external.html?link=https://www.whonix.org/wiki/Upgrading_Whonix_8_to_Whonix_9#Upgrading_Whonix-Gateway" target="_blank">Upgrading Whonix 8 to Whonix 9 - Whonix</a></h3>

<p>How to Upgrade from Whonix ™ 8.x to Whonix ™ 9.x</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>(Drop the uwt if you don’t have uwt installed yet. [In the line using apt-get, drop everything before apt-get.])</p>
<p>Alternatively you could also create a local apt repository and install one by one from there. We have scripts to mostly automate it but they need some editing and documentation is scare (because we don’t support this use case yet).</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-21T14:43:14Z' class='post-time'>
                August 21, 2014,  2:43pm
              </time>
              <meta itemprop='dateModified' content='2014-08-21T14:43:14Z'>
          <span itemprop='position'>#57</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="56" data-topic="374">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I said in /etc/network/interfaces you can comment out the pre-up if you want to entirely disable it</p>
</blockquote>
</aside>
<p>Tried that too.</p>
<p>[quote=“Patrick, post:56, topic:374”]because when /usr/bin/whonix_firewall does not exit 0, network will not come up. The shortest possible /usr/bin/whonix_firewall would be</p>
<p><code>#!/bin/bash
exit 0</code>[/quote]</p>
<p>Good to know. Just tired that too.</p>
<aside class="quote" data-post="56" data-topic="374">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>So when Whonix’s firewall is disabled, dhcp / networking does fully work?</p>
</blockquote>
</aside>
<p>On Whonix-Gateway DHCP does not seem to work under any condition, either with whonix_firewall enabled or disabled.</p>
<p>Maybe this could have something to do with it?..</p>
<blockquote>Even though we do have a small DHCP server (that runs inside HVM untrusted stub domain) to make the manual network configuration not necessary for many VMs, this won't work for most modern Linux distributions which contain Xen networking PV drivers built in (but not Qubes tools) and which bypass the stub-domain networking (their net frontends connect directly to the net backend in the netvm), and so our DHCP server is not useful.</blockquote>
https://qubes-os.org/wiki/HvmCreate
<p>But DHCP does work successfully in my baseline plain Debian Wheezy HVM.</p>
<p>When attempting DHCPDISCOVER is says:</p>
<pre><code class="lang-auto">DHCPDISCOVER on eth0 to 255.255.255.255 port 67 interval 7</code></pre>
<p>Maybe this call to “255.255.255.255 port 67” is an issue for Whonix in Qubes HVM?</p>
<p>Interesting result…</p>
<p>With Static networking on the Whonix-Gateway eth0, and opening up iptables in the firewallvm, I did some “curl” calls to test Apache webservers I installed in other HVMs on the Qubes system.</p>
<p>My Whonix-Gateway had the following Static IP configuration in “/etc/network/interfaces”:</p>
<pre><code class="lang-auto">auto eth0
iface eth0 inet static
address 10.137.2.16
netmask 255.255.255.0
gateway 10.137.2.1
broadcast 10.137.2.255</code></pre>
<p>When I make a “curl” call to another plain Debian Wheezy HVM (IP: 10.137.2.19) running Apache webserver, it does not work from the Whonix-Gateway, even though it works from other HVMs, with iptables adjusted in firewallvm.</p>
<pre><code class="lang-auto">curl.whonix-orig 10.137.2.19</code></pre>
<p>However, the interesting part happens when I do the same “curl” call to the Whonix-Workstation HVM (IP: 192.168.0.11) from the statically configured Whonix-Gateway eth0 (IP: 10.137.2.16), it actually goes through and successfully downloads the test Apache webserver page “It works!”.</p>
<pre><code class="lang-auto">curl.whonix-orig 192.168.0.11</code></pre>
<p>So this test suggests to me that Static networking on Whonix-Gateway (eth0) is seemingly working, at least partially, since it was able to go fetch a webpage from another HVM on port 80.</p>
<p>During this test, the Whonix-Gateway whonix_firewall was disabled, and there was no eth1 adapter present on the system.</p>
<p>But for whatever reason, the Whonix-Gateway is unable to reach the internet or other 10.137.2.X IP addresses. Yet with Static (10.137.2.X) networking it successfully accessed an Apache webserver at the Whonix-Workstation HVM (192.168.0.11) though.</p>
<p>[quote=“Patrick, post:56, topic:374”]If not, you can isolate the offending package by starting with a plain Debian VM and then installing Whonix network related settings packages one by one or maybe also by starting with a Whonix-Gateway VM and uninstalling network related packages one by one. Alternative to uninstalling you could also look what the package is actually doing and manually undo it to have the same effect.</p>
<p>…[/quote]</p>
<p>Thanks Patrick. I may have to get into this networking package isolation approach next.</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-22T20:42:59Z' class='post-time'>
                August 22, 2014,  8:42pm
              </time>
              <meta itemprop='dateModified' content='2014-08-22T20:42:59Z'>
          <span itemprop='position'>#58</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Success!</p>
<p>Qubes + Whonix is now officially working on my system.</p>
<p>Full Tor traffic is flowing from Whonix-Workstation HVM to Whonix-Gateway HVM to the internet, all inside of Qubes OS.</p>
<p>Currently using:</p>
<ul>
<li>Qubes OS R2rc2</li>
<li>Whonix 8.2</li>
</ul>
<p>I’ve presently got Qubes + Whonix fully functional for the very first time, just now.</p>
<p>I’m going to have to do some optimization work now to streamline the process a bit. Plus I should do some leak testing, etc.</p>
<p>Then I will be sure to do a full step by step instructional write-up for everyone.</p>
<p>Maybe such Qubes + Whonix instructions could be incorporated into the Whonix Wiki somewhere?</p>
<p>And from there, we can work on further fixes, streamlining, and expanding out to other versions and approaches for Qubes + Whonix.</p>
<p>Thanks for everyone’s help so far! Especially Patrick!</p>
<p>As of today, Qubes + Whonix is finally now a reality. <img src="../../images/emoji/twitter/smileyae52.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-22T21:08:30Z' class='post-time'>
                August 22, 2014,  9:08pm
              </time>
              <meta itemprop='dateModified' content='2014-08-22T21:08:30Z'>
          <span itemprop='position'>#59</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Congratulations!</p>
<p>[quote=“WhonixQubes, post:58, topic:374”]Then I will be sure to do a full step by step instructional write-up for everyone.</p>
<p>Maybe such Qubes + Whonix instructions could be incorporated into the Whonix Wiki somewhere?[/quote]<br>
I’d appreciate and hope for that VERY MUCH!</p>
<p>We already have:</p>
<ul>
<li><a href="../../../external.html?link=https://www.whonix.org/wiki/QEMU">https://www.whonix.org/wiki/QEMU</a></li>
<li><a href="../../../external.html?link=https://www.whonix.org/wiki/KVM">https://www.whonix.org/wiki/KVM</a></li>
<li><a href="../../../external.html?link=https://www.whonix.org/wiki/VMware">https://www.whonix.org/wiki/VMware</a></li>
</ul>
<p>So let’s call that page</p>
<ul>
<li>
<a href="../../../external.html?link=https://www.whonix.org/wiki/Qubes_OS">https://www.whonix.org/wiki/Qubes_OS</a> (just now created that page)</li>
</ul>
<p>Unless, you have a better suggestion, of course.</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="374.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-08-22T21:52:40Z' class='post-time'>
                August 22, 2014,  9:52pm
              </time>
              <meta itemprop='dateModified' content='2014-08-22T21:52:40Z'>
          <span itemprop='position'>#60</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="59" data-topic="374">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Congratulations!</p>
</blockquote>
</aside>
<p>Thanks! You’ve been a BIG help, Patrick. Very much appreciated.</p>
<p>[quote=“Patrick, post:59, topic:374”][quote author=WhonixQubes link=topic=392.msg3584#msg3584 date=1408740179]<br>
Then I will be sure to do a full step by step instructional write-up for everyone.</p>
<p>Maybe such Qubes + Whonix instructions could be incorporated into the Whonix Wiki somewhere?<br>
[/quote]<br>
I’d appreciate and hope for that VERY MUCH![/quote]</p>
<p>Will absolutely make sure to do this for the Whonix community.</p>
<p>I’d like to see and help make Qubes + Whonix development go even further. Hopefully others can start jumping on the Qubes + Whonix bandwagon. Getting step by step instructions out there will hopefully get more people using and contributing to Qubes + Whonix.</p>
<p>[quote=“Patrick, post:59, topic:374”]We already have:</p>
<ul>
<li><a href="../../../external.html?link=https://www.whonix.org/wiki/QEMU" rel="nofollow noopener">https://www.whonix.org/wiki/QEMU</a></li>
<li><a href="../../../external.html?link=https://www.whonix.org/wiki/KVM" rel="nofollow noopener">https://www.whonix.org/wiki/KVM</a></li>
<li><a href="../../../external.html?link=https://www.whonix.org/wiki/VMware" rel="nofollow noopener">https://www.whonix.org/wiki/VMware</a></li>
</ul>
<p>So let’s call that page</p>
<ul>
<li>
<a href="../../../external.html?link=https://www.whonix.org/wiki/Qubes_OS" rel="nofollow noopener">https://www.whonix.org/wiki/Qubes_OS</a> (just now created that page)</li>
</ul>
<p>Unless, you have a better suggestion, of course.[/quote]</p>
<p>Thanks Patrick!</p>
<p>Small suggestion…</p>
<p>Maybe a “cleaner”, more streamlined URL would simply be:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../external.html?link=https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="../../../external.html?link=https://www.whonix.org/wiki/Qubes" target="_blank" rel="nofollow noopener" title="06:39AM - 10 March 2020">Whonix – 10 Mar 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:200/215;"><img src="../../../external.html?link=https://www.whonix.org/w/images/5/55/Qubes-logo-icon.png" class="thumbnail" width="200" height="215"></div>

<h3><a href="../../../external.html?link=https://www.whonix.org/wiki/Qubes" target="_blank" rel="nofollow noopener">Qubes - Whonix</a></h3>

<p>Qubes-Whonix ™ -- Security + Anonymity</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>without the “_OS” in the URL.</p>
<p>Basis of reasoning:</p>
<ul>
<li>Cleaner URL for referring people to.</li>
<li>Matches one word look of the other virtualization platform pages you mentioned.</li>
<li>Qubes developers and others refer to Qubes OS as just “Qubes” a lot anyway.</li>
<li>Joanna explicitly talked about Qubes without the “OS” suffix in her Odyssey Framework blog about moving Qubes OS beyond just being Qubes as a standalone OS. Quoted below:</li>
</ul>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../external.html?link=http://theinvisiblethings.blogspot.com/favicon.ico" class="site-icon" width="32" height="32">
      <a href="../../../external.html?link=http://theinvisiblethings.blogspot.com/2013/03/introducing-qubes-odyssey-framework.html" target="_blank" rel="nofollow noopener">theinvisiblethings.blogspot.com</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/361;"><img src="../../../external.html?link=http://3.bp.blogspot.com/-x0nnYdPBMWY/UUsxEwJCxhI/AAAAAAAAAKs/_jpzGFGXT4k/w1200-h630-p-k-no-nu/Qubes+Odyssey+Diagrams+1.png" class="thumbnail" width="690" height="361"></div>

<h3><a href="../../../external.html?link=http://theinvisiblethings.blogspot.com/2013/03/introducing-qubes-odyssey-framework.html" target="_blank" rel="nofollow noopener">Introducing Qubes Odyssey Framework</a></h3>

<p>Qubes OS is becoming more and more  advanced, polished, and user friendly OS.   But Qubes OS, even as advanced as it is now, surely hav...</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<blockquote>There is also one more “limitation” of Qubes OS, particularly difficult to overcome... Namely that it is a standalone Operating System, not an application that could be installed inside the user's existing OS. While installing a new application that increases system's security is a no-brianer for most people, switching to a new, exotic OS, is quite a different story...
<p>So, what is Qubes then? Qubes (note how I’ve suddenly dropped the OS suffix) is several things:</p>
<p>Turns out this is not as difficult as we originally thought, and this is exactly the direction we’re taking right now with Qubes Odyssey!</p>
<p>So, we might imagine Qubes that is based on Hyper-V or even Virtual Box or VMWare Workstation. In the case of the last two Qubes would no longer be a standalone OS, but rather an “application” that one installs on top of an existing OS, such as Windows.</p>
</blockquote>
<p>Ultimately I am fine with the page either way.</p>
<p>Thanks again!</p>
        </div>

        <meta itemprop='headline' content='Qubes + Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="3744658.html?page=2">← previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="374fdb0.html?page=4">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

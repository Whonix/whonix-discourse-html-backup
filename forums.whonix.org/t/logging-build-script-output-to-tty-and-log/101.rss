<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Logging build script output to tty and log</title>
    <link>http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101</link>
    <description>I&#39;ve written down the requirements for a perfect log command:

- show stdout/stderr of the script in tty while the script is running
- show colors produced by the script in tty while the script is running
- create a log file of all stdout/stderr the script produced
- have the log without colors
- don&#39;t break the ability to read input from stdin

Apparently no such jack of all trades device has been found. The following command fulfills all requirements everything, but stripping colors from the log.

[code]sudo script -a -f ~/log -c &quot;./whonix_build --build --tor-gateway&quot;[/code]

Stripping the color from the log is possible as well.

[code]logname=~/log ; cat $logname | perl -pe &#39;s/\e([^\[\]]|\[.*?[a-zA-Z]|\].*?\a)//g&#39; | col -b &gt; $logname-processed[/code]

([url=http://www.commandlinefu.com/commands/view/2318/fix-a-typescript-file-created-by-the-script-program-to-remove-control-characters]source[/url]); (There might be [url=https://unix.stackexchange.com/questions/14684/removing-control-chars-including-console-codes-colours-from-script-output]other[/url] methods or entirely different (better/perfect) approaches to the log issue.

Haven&#39;t tested a full build using the `script` approach yet.

Does this suffice?</description>
    <language>en</language>
    <lastBuildDate>Wed, 26 Feb 2014 22:34:25 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Logging build script output to tty and log</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Colors in Whonix’s build script can also be disabled by running.</p>
<pre><code class="lang-auto"></code></pre>
<p>No kidding.  <img src="//forums.whonix.org/images/emoji/twitter/wink.png?v=5" title=":wink:" class="emoji" alt=":wink:"> (It’s a standard feature, looks like.)</p>
<p>Before building. (Don’t forget to use adding -E to sudo then (sudo -E …) then, because environment variables need to preserved.)</p>
          <p><a href="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/8</link>
        <pubDate>Wed, 26 Feb 2014 22:34:25 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-101-8</guid>
        <source url="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101.rss">Logging build script output to tty and log</source>
      </item>
      <item>
        <title>Logging build script output to tty and log</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="6" data-topic="101">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/o/49beb7/40.png" class="avatar"> Occq:</div>
<blockquote>
<p>Colors encoding ([[0m  ) that appears in a log are disturbing (IMO). If it’s either no colors or that encoding (00;32m) I would rather go with no colors.</p>
</blockquote>
</aside>
<p>I preferred an alternative command or log wrapper script, that can do that. There must be some way.</p>
<aside class="quote" data-post="6" data-topic="101">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/o/49beb7/40.png" class="avatar"> Occq:</div>
<blockquote>
<p>Disabling user input by default gives us time to figure out something that works.</p>
</blockquote>
</aside>
<p>What doesn’t work? The colors in the log? I consider this a minor issue. Is it that bad to run a single command to strip colors from it?</p>
          <p><a href="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/7</link>
        <pubDate>Wed, 26 Feb 2014 22:31:50 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-101-7</guid>
        <source url="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101.rss">Logging build script output to tty and log</source>
      </item>
      <item>
        <title>Logging build script output to tty and log</title>
        <dc:creator><![CDATA[Occq]]></dc:creator>
        <description><![CDATA[
            <p>Colors encoding ([[0m  ) that appears in a log are disturbing (IMO). If it’s either no colors or that encoding (00;32m) I would rather go with no colors.</p>
<p>Disabling user input by default gives us time to figure out something that works.</p>
          <p><a href="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/6</link>
        <pubDate>Wed, 26 Feb 2014 21:36:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-101-6</guid>
        <source url="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101.rss">Logging build script output to tty and log</source>
      </item>
      <item>
        <title>Logging build script output to tty and log</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Why disable colors? Because it may help to strip colors from the log?</p>
<p>Colors are configured in help-steps/pre in function “colors”. By not running the “colors” function (which could be configured by a command line option, environment variable and/or build configuration), variables such as ${red} would be empty and therefore not producing any output, i.e. no color.</p>
<p>I personally like having colors in tty output. Makes following the process, noticing important messages, navigation, debugging simpler.</p>
          <p><a href="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/5</link>
        <pubDate>Wed, 26 Feb 2014 18:42:58 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-101-5</guid>
        <source url="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101.rss">Logging build script output to tty and log</source>
      </item>
      <item>
        <title>Logging build script output to tty and log</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Command needs to be quotes. Fixed in original post.</p>
<blockquote>sudo script -a -f ~/log -c "./whonix_build --build --tor-gateway"</blockquote>
<p>With the <code>script</code> (typescript) logging method working, is there still benefit in disabling user input in the error handler?</p>
          <p><a href="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/4</link>
        <pubDate>Wed, 26 Feb 2014 18:39:07 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-101-4</guid>
        <source url="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101.rss">Logging build script output to tty and log</source>
      </item>
      <item>
        <title>Logging build script output to tty and log</title>
        <dc:creator><![CDATA[Occq]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="1" data-topic="101">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p><code>sudo script -a -f ~/log -c ./whonix_build --build --tor-gateway</code></p>
</blockquote>
</aside>
<p>script: unrecognized option ‘–build’.</p>
<p>Can we disable colors in the Whonix build script?</p>
<p>[quote=“Patrick, post:7, topic:89”][quote author=Occq link=topic=70.msg605#msg605 date=1393189348]<br>
There is one problem with the build script error handler.</p>
<p>If the build fails in the middle (for whatever reason, like if you forgot to set disk space to more than 8GB. Stupid mistake) the script keeps running because it requires user input. That is highly impractical for those of us who use input log redirection. We don’t see the question, we can’t answer it.</p>
<pre><code class="lang-auto">"Please enter c and press enter to continue..
"Please enter to cleanup and exit"</code></pre>
<p>Short term solution is to delete user input option and end the script when it breaks (no continue choice, direct auto exit).</p>
<p>Oh and bare metal was run successfull with India as the location (the same settings failed in the last version) so update-locale seems fixed.<br>
[/quote]</p>
<p>I see. This is non-ideal. Should documented for now. And improved for Whonix 8 + 1.</p>
<p>I don’t want to entirely remove this feature. Has proven very useful in development. Could be disabled by default and enabled with a build configuration.[/quote]</p>
<p>So far the disabled-by-default option seems most easy to implement.</p>
          <p><a href="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/3</link>
        <pubDate>Wed, 26 Feb 2014 18:33:07 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-101-3</guid>
        <source url="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101.rss">Logging build script output to tty and log</source>
      </item>
      <item>
        <title>Logging build script output to tty and log</title>
        <dc:creator><![CDATA[Occq]]></dc:creator>
        <description><![CDATA[
            <p>First one look great, second one looks like a nightmare <img src="//forums.whonix.org/images/emoji/twitter/smiley.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>I’ll give both a test when time allows.</p>
          <p><a href="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/2</link>
        <pubDate>Tue, 25 Feb 2014 16:53:20 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-101-2</guid>
        <source url="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101.rss">Logging build script output to tty and log</source>
      </item>
      <item>
        <title>Logging build script output to tty and log</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>I’ve written down the requirements for a perfect log command:</p>
<ul>
<li>show stdout/stderr of the script in tty while the script is running</li>
<li>show colors produced by the script in tty while the script is running</li>
<li>create a log file of all stdout/stderr the script produced</li>
<li>have the log without colors</li>
<li>don’t break the ability to read input from stdin</li>
</ul>
<p>Apparently no such jack of all trades device has been found. The following command fulfills all requirements everything, but stripping colors from the log.</p>
<pre><code class="lang-auto"></code></pre>
<p>Stripping the color from the log is possible as well.</p>
<pre><code class="lang-auto"></code></pre>
<p>(<a href="http://www.commandlinefu.com/commands/view/2318/fix-a-typescript-file-created-by-the-script-program-to-remove-control-characters" data-bbcode="true">source</a>); (There might be <a href="https://unix.stackexchange.com/questions/14684/removing-control-chars-including-console-codes-colours-from-script-output" data-bbcode="true">other</a> methods or entirely different (better/perfect) approaches to the log issue.</p>
<p>Haven’t tested a full build using the <code>script</code> approach yet.</p>
<p>Does this suffice?</p>
          <p><a href="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101/1</link>
        <pubDate>Tue, 25 Feb 2014 15:32:52 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-101-1</guid>
        <source url="http://forums.whonix.org/t/logging-build-script-output-to-tty-and-log/101.rss">Logging build script output to tty and log</source>
      </item>
  </channel>
</rss>

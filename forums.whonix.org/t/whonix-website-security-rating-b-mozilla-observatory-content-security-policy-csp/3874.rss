<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
    <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874</link>
    <description>Re: Whonix website settings via Mozilla observatory. Overall whonix.org gets a &quot;B&quot; rating.

Everything looks pretty good e.g. ciphers used and so on (A, A+ etc), except _HTTP Headers &amp; Content Security_, which gets a &quot;D&quot; rating.

https://observatory.mozilla.org/analyze.html?host=whonix.org

Why? The problem relates to Content Secutiry Policy, X Content Type Options and Referrer Policy

Check this output:

https://securityheaders.io/?followRedirects=on&amp;hide=on&amp;q=whonix.org

**Missing Headers**

_Content-Security-Policy_	

&gt; Content Security Policy is an effective measure to protect your site from XSS attacks. By whitelisting sources of approved content, you can prevent the browser from loading malicious assets.

_X-Content-Type-Options_	

&gt; X-Content-Type-Options stops a browser from trying to MIME-sniff the content type and forces it to stick with the declared content-type. The only valid value for this header is &quot;X-Content-Type-Options: nosniff&quot;.

_Referrer-Policy_

&gt; Referrer Policy is a new header that allows a site to control how much information the browser includes with navigations away from a document and should be set by all sites.

It also doesn&#39;t like the Strict Transport Security setting, for whatever reason:

**Strict-Transport-Security**

&gt; HTTP Strict Transport Security is an excellent feature to support on your site and strengthens your implementation of TLS. That said, the HSTS header must not be returned over a HTTP connection, only HTTPS.

It also seems to suggest the server advertises the software running it, but sometimes that can be configured to be hidden:

**Server**

&gt; This Server header seems to advertise the software being run on the server but you can remove or change this value.

The links at the website show how the website maintainer can address these issues with various settings. It doesn&#39;t look like rocket science. See:

https://scotthelme.co.uk/a-new-security-header-referrer-policy/
https://scotthelme.co.uk/content-security-policy-an-introduction/
https://scotthelme.co.uk/hardening-your-http-response-headers/

Hopefully fixable.

Cheers</description>
    <language>en</language>
    <lastBuildDate>Fri, 05 Aug 2022 21:06:53 +0000</lastBuildDate>
    <category>Website</category>
    <atom:link href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>CSP simplification.</p>
<p>Reason for simplification: Website breaks in corner cases and the more complex CSP also does not provide higher security. It’s just more complex. <a href="https://www.kicksecure.com/wiki/Website_Tests" class="inline-onebox">Website and Server Tests</a> scores are unchanged.</p>
<p>Old:</p>
<blockquote>
<p>content-security-policy: default-src ‘none’; connect-src ‘self’; script-src ‘self’ https://<em>.whonix.org ‘unsafe-inline’ ‘unsafe-eval’; style-src ‘self’ https://</em>.whonix.org ‘unsafe-inline’; img-src ‘self’ data: https://<em>.whonix.org; font-src ‘self’ https://</em>.whonix.org;</p>
</blockquote>
<p>New:</p>
<blockquote>
<p>content-security-policy: default-src ‘self’ ‘unsafe-inline’ ‘unsafe-eval’;</p>
</blockquote>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/22">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/22</link>
        <pubDate>Fri, 05 Aug 2022 21:06:53 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-22</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>CSP issue. Not reasonable to work on this. Reasoning here:</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Website_Tests" target="_blank" rel="noopener" title="03:47PM - 28 April 2021">Whonix – 28 Apr 21</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:110/84;"><img src="https://www.whonix.org/w/images/0/0d/Websitetest.jpg" class="thumbnail" width="110" height="84"></div>

<h3><a href="https://www.whonix.org/wiki/Website_Tests" target="_blank" rel="noopener">Website Tests</a></h3>

<p>Testing the Whonix ™ server with test websites such as hardenize.com / securityheaders.com / Mozilla Observatory / SSL Labs / hstspreload.org.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Applicable chapters:</p>
<ul>
<li><a href="https://www.whonix.org/wiki/Website_Tests#Introduction">Introduction</a></li>
<li><a href="https://www.whonix.org/wiki/Website_Tests#Content-Security-Policy_CSP">Content-Security-Policy CSP</a></li>
<li><a href="https://www.whonix.org/wiki/Website_Tests#Comparison_with_Others">Comparison with Others</a></li>
</ul>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/21">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/21</link>
        <pubDate>Sun, 02 May 2021 15:27:57 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-21</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[TNT_BOM_BOM]]></dc:creator>
        <description><![CDATA[
            <p>Until now whonix considered B, And according to these sites:</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.hardenize.com/favicon/favicon-32x32.png" class="site-icon" width="16" height="16">
      <a href="https://www.hardenize.com/report/whonix.org/1619966056#www_csp" target="_blank" rel="noopener nofollow ugc">hardenize.com</a>
  </header>
  <article class="onebox-body">
    <img src="" class="thumbnail" width="16" height="16">

<h3><a href="https://www.hardenize.com/report/whonix.org/1619966056#www_csp" target="_blank" rel="noopener nofollow ugc">Hardenize Report: whonix.org</a></h3>

<p>Hardenize continuously monitors security and configuration of your domain name, email servers, and web site.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p><a href="https://observatory.mozilla.org/analyze/whonix.org" class="onebox" target="_blank" rel="noopener nofollow ugc">https://observatory.mozilla.org/analyze/whonix.org</a></p>
<p>Issue is:</p>
<blockquote>
<p>script-src ‘self’   https://*.whonix.org <strong>‘unsafe-inline’  'unsafe-eval’</strong></p>
</blockquote>
<blockquote>
<p>style-src ‘self’   https://*.whonix.org  <strong>'unsafe-inline’</strong></p>
</blockquote>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/20">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/20</link>
        <pubDate>Sun, 02 May 2021 14:47:54 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-20</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>4 posts were split to a new topic: <a href="http://forums.whonix.org/t/fix-extra-white-space-on-all-pdf-embedded-links/8781">fix extra white space on all PDF embedded links</a></p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/19">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/19</link>
        <pubDate>Fri, 17 Jan 2020 08:01:55 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-19</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p>Whatever you are doing is working as the server is running much better than the old days. Seems upgrades etc are beneficial, as .onion is not super flaky anymore.</p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/18">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/18</link>
        <pubDate>Mon, 16 Jul 2018 10:47:25 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-18</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[mig5]]></dc:creator>
        <description><![CDATA[
            <p>CSPs now deployed:</p>
<aside class="quote quote-modified" data-post="1" data-topic="5494">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/user_avatar/forums.whonix.org/mig5/40/1647_1.png" class="avatar">
    <a href="https://forums.whonix.org/t/content-security-policy-now-deployed-on-whonix-websites/5494">Content-Security-Policy now deployed on Whonix websites</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/website"><span class="badge-category-bg" style="background-color: #0E76BD;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Issues and improvements with the Whonix website. (website devs) (user documentation devs)">Website</span></a>
  </div>
  <blockquote>
    Good news! We’ve implemented Content-Security-Policy headers on various areas of the  Whonix infrastructure. 
This includes the main site, the wiki, this forum, and a few other places. 
We also implemented Referrer-Policy and some other headers in recent weeks. 
We now get an A+ rating on the main page at <a href="https://securityheaders.com">https://securityheaders.com</a> \o/ 
 <a class="lightbox" href="//forums.whonix.org/uploads/default/original/2X/f/fa5ca0696e7ba3c5d8c704d65419aa34e389b984.png" data-download-href="//forums.whonix.org/uploads/default/fa5ca0696e7ba3c5d8c704d65419aa34e389b984" title="whonix-securityheaders-rating-july2018.png">[whonix-securityheaders-rating-july2018]</a>
Some things to note: 


We deliberately are not allowing loading images from third party sites on the forum and also i…
  </blockquote>
</aside>

          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/17">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/17</link>
        <pubDate>Mon, 16 Jul 2018 02:08:16 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-17</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[mig5]]></dc:creator>
        <description><![CDATA[
            <p>Hi <a class="mention" href="http://forums.whonix.org/u/hexagon">@Hexagon</a>,</p>
<p>I’m currently looking at the CSP headers (new sysadmin).</p>
<p>Your examples are really useful and I’ll be using those as a basis with which to achieve it.</p>
<p>I agree with <a class="mention" href="http://forums.whonix.org/u/fortasse">@fortasse</a>’s reservations, but I also agree with you that having a CSP with unsafe-inline is better than none at all for other reasons.</p>
<p>I was just wondering what was the purpose behind unsafe-eval? Did you find cases on Discourse or the Wiki where that was actually required?</p>
<p>In the time since this ticket, Phabricator actually implemented a CSP, and since we upgraded Phabricator recently, we have pulled that in. <a href="https://phabricator.wikimedia.org/T135963">https://phabricator.wikimedia.org/T135963</a></p>
<p>It looks like MediaWiki <a href="https://phabricator.wikimedia.org/T135963">merged in code for it recently too</a> (March 2018), albeit they think it may break many gadgets/extensions so we’ll have to tread carefully.</p>
<p>Discourse is a ways off, they don’t consider it a priority/have no resources for it. <a href="https://meta.discourse.org/t/how-to-configure-content-security-policy/53308">Same link as you found</a>.</p>
<p>I’ll be looking at adding individual CSP headers to the various other areas (ignoring /blog since that’s been sunset in favour of Discourse) soon.</p>
<p>Currently fighting with my own site’s CSP when under .onion, despite the .onion host being whitelisted! Grrr…</p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/16">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/16</link>
        <pubDate>Mon, 09 Jul 2018 07:31:15 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-16</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Hexagon]]></dc:creator>
        <description><![CDATA[
            <p>Yes, those CSPs won’t effectively stop an XSS attack, but still limit what an attacker can do and make it harder to do something useful if an XSS injection succeeds, for example interactive communication (<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/connect-src" rel="nofollow noopener">connect-src</a>) with remote servers is still prevented by the CSP.</p>
<p>The first CSP I proposed is safe enough to not DoS yourself. Even if a future application requires more permissions (for example embedding a flash object) most features will still work as expected and should remain usable, also you get a report as soon as it happens and a fix would be pretty easy (just add the missing permission, reload, done).</p>
<p>You could try the CSP in report-only mode for a month or so and see if it would block anything that shouldn’t be blocked or change the <code>default-src</code> to <code>'self'</code> or even <code>*.whonix.org</code> instead of <code>'none'</code> which would permit applications to do anything as long as its on the same host or hosted on a Whonix subdomain (unless a more specific directive is given) if you fear DoSsing yourself.</p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/15</link>
        <pubDate>Wed, 24 May 2017 10:18:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-15</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[fortasse]]></dc:creator>
        <description><![CDATA[
            <p>It’s worth noting that <code>unsafe-inline</code> and <code>unsafe-eval</code> essentially make the CSP worthless - this still allows XSS to fire, since an XSS payload would be “inline”. I don’t have the time, knowledge, or ability to go through the myriad of software this website runs to “fix” their inline scripts.</p>
<p>If/when upstream projects (phabricator, mediawiki) do away with inline scripts, I would be definitely willing to take another look at this.</p>
<p>I have to say thanks for your hard work in making the policies, as well as your concern about our security posture. I feel like, for the time being, we have a sane balance between securing ourselves (HSTS, x-xss-protection) while avoiding potentially DoSing ourselves by setting things up wrong (HPKP, to a lesser extent CSP).</p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/14</link>
        <pubDate>Tue, 23 May 2017 22:18:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-14</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Hexagon]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="12" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/h/848f3c/40.png" class="avatar"> Hexagon:</div>
<blockquote>
<p>I could make some CSPs which allows the use unsafe-inline code</p>
</blockquote>
</aside>
<p>CSP for <code>*.whonix.org/*</code> (in case you want to manage just one CSP for everything):</p>
<pre><code>default-src 'none';
script-src  'self' 'unsafe-inline' 'unsafe-eval';
style-src   'self' 'unsafe-inline';
img-src     * data:;
font-src    'self';
connect-src 'self'
</code></pre>
<p>Other CSPs I have created during my tests:</p>
<p>CSP for <code>forums.whonix.org/*</code> (the Onebox feature embeds external images from various locations):</p>
<pre><code>default-src 'none';
script-src  'self' 'unsafe-inline' 'unsafe-eval';
style-src   'self' 'unsafe-inline';
img-src     *;
font-src    'self';
connect-src 'self'
</code></pre>
<p>CSP for <code>phabricator.whonix.org/*</code>:</p>
<pre><code>default-src 'none';
script-src  'self' 'unsafe-inline';
style-src   'self' 'unsafe-inline';
img-src     data: 'self';
font-src    'self';
connect-src 'self'
</code></pre>
<p>CSP for <code>www.whonix.org/blog/*</code> (profile images from the forum are embedded using HTTP):</p>
<pre><code>default-src 'none';
script-src  'self' 'unsafe-inline';
style-src   'self' 'unsafe-inline';
img-src     data: http://forums.whonix.org https://forums.whonix.org 'self'
</code></pre>
<p>CSP for <code>www.whonix.org/wiki/*</code> (one image was requested from wikimedia):</p>
<pre><code>default-src 'none';
script-src  'self' 'unsafe-inline' 'unsafe-eval';
style-src   'self' 'unsafe-inline';
img-src     https://upload.wikimedia.org 'self';
font-src    'self'
</code></pre>
<p>CSP for <code>https://www.whonix.org/</code> (has an inline onclick event to hide the donation message):</p>
<pre><code>default-src 'none';
script-src  'unsafe-inline';
style-src   'self' 'unsafe-inline';
img-src     'self'
</code></pre>
<p>CSP for <code>https://www.whonix.org/download/</code>:</p>
<pre><code>default-src 'none';
style-src   'self';
img-src     'self'
</code></pre>
<p>CSP for <code>www.whonix.org/cgi-bin/mailman/*</code> (has an inline script):</p>
<pre><code>default-src 'none';
script-src  'unsafe-inline';
img-src     'self'
</code></pre>
<p>CSP for <code>www.whonix.org/pipermail/*</code> (has an inline style):</p>
<pre><code>default-src 'none';
style-src   'unsafe-inline';
img-src     'self'
</code></pre>
<p>Note: I’d recommend setting up an endpoint for CSP violation reports for debugging purposes in case something needs more permissions.</p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/13</link>
        <pubDate>Tue, 23 May 2017 21:13:13 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-13</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Hexagon]]></dc:creator>
        <description><![CDATA[
            <p>For MediaWiki it’s an open ticket: <a href="https://phabricator.wikimedia.org/T135963" rel="nofollow noopener">https://phabricator.wikimedia.org/T135963</a></p>
<p>For Phabricator it’s an open ticket: <a href="https://secure.phabricator.com/T4340" rel="nofollow noopener">https://secure.phabricator.com/T4340</a></p>
<p>For discourse I could only find a from post: <a href="https://meta.discourse.org/t/how-to-configure-content-security-policy/53308" rel="nofollow noopener">https://meta.discourse.org/t/how-to-configure-content-security-policy/53308</a></p>
<p>For wordpress there is an old (6 years) plugin which allows automatic creation of the CSP header: <a href="https://people-mozilla.org/~bsterne/content-security-policy/wordpress.html" rel="nofollow noopener">https://people-mozilla.org/~bsterne/content-security-policy/wordpress.html</a><br>
and a newer one which seems to be manual: <a href="https://de.wordpress.org/plugins/wp-content-security-policy/" rel="nofollow noopener">https://de.wordpress.org/plugins/wp-content-security-policy/</a></p>
<p>I could make some CSPs which allows the use unsafe-inline code if required until those apps are compatible. This would at least prevent an attacker from embedding external sources.</p>
<aside class="quote" data-post="11" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Which makes this require constant maintenance.</p>
</blockquote>
</aside>
<p>You could setup a small script which logs policy violations to fix them as they occur (<a href="https://mathiasbynens.be/notes/csp-reports" rel="nofollow noopener">example</a>).</p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/12</link>
        <pubDate>Tue, 23 May 2017 14:12:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-12</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Generally, a CSP would be great!</p>
<aside class="quote" data-post="9" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/h/848f3c/40.png" class="avatar"> Hexagon:</div>
<blockquote>
<p>Making the headers more effective (i.e. not using unsafe options) is a bit harder as this would require some code changes. Currently you are using some inline-JS and inline-CSS which would be ideally moved to a file or at least get a hash or nonce.</p>
</blockquote>
</aside>
<aside class="quote" data-post="9" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/h/848f3c/40.png" class="avatar"> Hexagon:</div>
<blockquote>
<p>And you are using some style-Attributes which are can’t get a hash or nonce and thus can be used only with unsafe-inline, these should be replaced by css classes if possible</p>
</blockquote>
</aside>
<p>We don’t develop any web apps. We are using Libre Software. Mediawiki (wiki), wordpress (blog), phabricator (issue tracker) and discourse (forum). We don’t have resources to make changes on the code level. But if you wish, please feel very free to report any such issues against these projects. Because then these fixes would flow down as we update these web apps.</p>
<aside class="quote" data-post="9" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/h/848f3c/40.png" class="avatar"> Hexagon:</div>
<blockquote>
<p>The CSP header might has to be modified if an application changes</p>
</blockquote>
</aside>
<p>Which makes this require constant maintenance.</p>
<p>Perhaps mediawiki, wordpress, phabricator and/or discourse are providing boiler plate CSPs we just can copy/paste and are free to use? If not, could you make a feature request against these projects please?</p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/11</link>
        <pubDate>Tue, 23 May 2017 13:15:25 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-11</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="8" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Since you seem knowledgeable, how hard is it to turn these red table items into green i.e. for website maintainer? -&gt;</p>
</blockquote>
</aside>
<p>Sorry, I don’t understand your question. Could you please provide more details? Maybe you mean this?</p>
<pre><code>{{Yes}}
</code></pre>
<p>Or.</p>
<pre><code>{{No}}
</code></pre>
<ul>
<li><a href="https://www.whonix.org/wiki/Template:Yes">https://www.whonix.org/wiki/Template:Yes</a></li>
<li><a href="https://www.whonix.org/wiki/Template:No">https://www.whonix.org/wiki/Template:No</a></li>
</ul>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/10</link>
        <pubDate>Tue, 23 May 2017 13:10:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-10</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Hexagon]]></dc:creator>
        <description><![CDATA[
            <p>CSP:</p>
<ul>
<li>Generating the headers should be quite easy, depending on the granularity. I’d suggest creating one for each application (wiki, blog, forum, phabricator) starting with a restrictive report-only version and when no more reports come in enforcing it.</li>
<li>Making the headers more effective (i.e. not using unsafe options) is a bit harder as this would require some code changes. Currently you are using some inline-JS and inline-CSS which would be ideally moved to a file or at least get a hash or nonce.</li>
<li>And you are using some style-Attributes which are can’t get a hash or nonce and thus can be used only with unsafe-inline, these should be replaced by css classes if possible</li>
<li>The CSP header might has to be modified if an application changes</li>
</ul>
<p>I haven’t used PK or CA pinning yet, so the following is just as far as i know.</p>
<p>PK pinning:</p>
<ul>
<li>Requires two certificates using different public keys in case one has to be revoked</li>
<li>It’s dangerous! Start with short time periods and test both certificates</li>
<li>If you get a new public key you have to update your header soon enough to include it during a transitional period</li>
<li>After testing you shouldn’t have to touch it until you plan to get a new key pair</li>
</ul>
<p>CA pinning:</p>
<ul>
<li>Requires two certificates from different CAs in case one has to be revoked</li>
<li>Less dangerous, but still start with short time periods and test both certificates</li>
<li>If you change your CA or they get a new public key you have to update your header soon enough to include it during a transitional period</li>
<li>After testing you shouldn’t have to touch it until you change your CA or your CA gets a new key pair to sign certificates</li>
</ul>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/9</link>
        <pubDate>Tue, 23 May 2017 03:47:21 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-9</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p>Good to know, thanks. All the website server stuff is a complete mystery to us mere mortals <img src="//forums.whonix.org/images/emoji/twitter/wink.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
<p>Since you seem knowledgeable, how hard is it to turn these red table items into green i.e. for website maintainer? -&gt;</p>
<p><a href="http://kkkkkkkkkk63ava6.onion/wiki/Datenschutz#Technical_Information" class="onebox" target="_blank">http://kkkkkkkkkk63ava6.onion/wiki/Datenschutz#Technical_Information</a></p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/8</link>
        <pubDate>Mon, 22 May 2017 23:38:48 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-8</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Hexagon]]></dc:creator>
        <description><![CDATA[
            <p>If it was a feature that browsers would support you could inject this header in the HTTP traffic to execute a denial of service attack on websites that don’t have (full) HTTPS support, which is probably the reason why browsers are supposed to ignore it.<br>
It also wouldn’t have any real advantage over being redirected to HTTPS and then getting an HSTS header which you can trust.<br>
But adding it doesn’t really harm as long as HTTPS is supported and/or browsers keep ignoring it .</p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/7</link>
        <pubDate>Mon, 22 May 2017 21:48:44 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-7</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Hexagon:</p>
<blockquote>
<p>You have entered just <a href="http://whonix.org">whonix.org</a> to be scanned which is equal to<br>
<a href="http://whonix.org">http://whonix.org</a> and the HTTP response does indeed include a HSTS<br>
header but I wouldn’t consider this to be a big problem because […]</p>
</blockquote>
<p>I would consider that a feature.</p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/6</link>
        <pubDate>Mon, 22 May 2017 21:24:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-6</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Hexagon]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="1" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>It also doesn’t like the Strict Transport Security setting, for whatever reason:</p>
<p>Strict-Transport-Security</p>
<p>HTTP Strict Transport Security is an excellent feature to support on your site and strengthens your implementation of TLS. <strong>That said, the HSTS header must not be returned over a HTTP connection, only HTTPS</strong>.</p>
</blockquote>
</aside>
<p>You have entered just <a href="http://whonix.org" rel="nofollow noopener">whonix.org</a> to be scanned which is equal to <a href="http://whonix.org" rel="nofollow noopener">http://whonix.org</a> and the HTTP response does indeed include a HSTS header but I wouldn’t consider this to be a big problem because browsers should just ignore it (<a href="https://tools.ietf.org/html/rfc6797#section-8.1" rel="nofollow noopener">RFC 6797, sect. 8.1</a>) on the first request and accept it after the redirect to HTTPS. If you scan <a href="https://whonix.org" rel="nofollow noopener">https://whonix.org</a> it doesn’t complain about the HSTS header:<br>
<a href="https://securityheaders.io/?q=https%3A%2F%2Fwhonix.org%2F&amp;hide=on&amp;followRedirects=on" rel="nofollow noopener">https://securityheaders.io/?q=https%3A%2F%2Fwhonix.org%2F&amp;hide=on&amp;followRedirects=on</a></p>
<p>Edit:<br>
The “Onebox” fearure seems to be unable to handle &amp;-signs correctly, they show up encoded as HTML-entity <code>&amp;amp;</code> in the URL. Here is the correct link: <a href="https://securityheaders.io/?q=https%3A%2F%2Fwhonix.org%2F&amp;hide=on&amp;followRedirects=on" rel="nofollow noopener">https://securityheaders.io/?q=https%3A%2F%2Fwhonix.org%2F&amp;hide=on&amp;followRedirects=on</a></p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/5</link>
        <pubDate>Mon, 22 May 2017 20:50:14 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-5</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="3" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>The server header is advertising the software being run on the server. <a href="https://securityheaders.io/?followRedirects=on&amp;hide=on&amp;q=whonix.org">https://securityheaders.io/?followRedirects=on&amp;hide=on&amp;q=whonix.org</a></p>
</blockquote>
</aside>
<p>That’s the same thing as Content-Security-Policy.</p>
<aside class="quote" data-post="3" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Maybe change HSTS to yellow also due to Mozilla Observatory not liking the strict transport security settings (but not specifying why).</p>
</blockquote>
</aside>
<p>I don’t see where they are. But even if they did, with all due respect for Mozilla, we shouldn’t take it without sensible justification.</p>
<aside class="quote" data-post="3" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Transparency with users and all that. Right now the table makes it look like everything is fine and dandy, when it isn’t.</p>
</blockquote>
</aside>
<p>Yes.</p>
<aside class="quote" data-post="3" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Also, a privacy policy should really be available in English.</p>
</blockquote>
</aside>
<p>No, it’s only there for legal purposes.</p>
<aside class="quote" data-post="3" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Shall I run that German stuff on the same page through Bing translator and fix up the quirky English result?</p>
</blockquote>
</aside>
<p>No. It’s legal text. To be effective, it needs to be in German language. Until something or someone has been found to take responsibility to set up a better legal framework for Whonix. The editing of <a href="https://www.whonix.org/wiki/Datenschutz">https://www.whonix.org/wiki/Datenschutz</a> is blocked, because we cannot accept changes to the legal text. (Similar to editing the text of licenses such as GPL - very bad idea.)</p>
<p>The technical information part however is volunteer, not required for legal reasons. Therefore I have split it into a separate template <a href="https://www.whonix.org/wiki/Template:Whonix.org_security">https://www.whonix.org/wiki/Template:Whonix.org_security</a> in case you wish to edit it further.</p>
<hr>
<p>Also addded:</p>
<p>Certificate Authority (CA) Pinning<br>
<a href="https://phabricator.whonix.org/T66" class="onebox" target="_blank">https://phabricator.whonix.org/T66</a></p>
<p>HTTP Public Key Pinning<br>
<a href="https://phabricator.whonix.org/T84" class="onebox" target="_blank">https://phabricator.whonix.org/T84</a></p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/4</link>
        <pubDate>Mon, 22 May 2017 13:08:38 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-4</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p>As <a href="http://kkkkkkkkkk63ava6.onion/wiki/Whonix:Privacy_policy">http://kkkkkkkkkk63ava6.onion/wiki/Whonix:Privacy_policy</a> is locked from editing, please add to the “Technical Information” table -&gt;</p>
<blockquote>
<p>HTTP Headers &amp; Content Security</p>
</blockquote>
<p>Then (in red):</p>
<blockquote>
<p>D Rating. <a href="https://securityheaders.io/?followRedirects=on&amp;hide=on&amp;q=whonix.org">https://securityheaders.io/?followRedirects=on&amp;hide=on&amp;q=whonix.org</a> Content Security Policy is not enacted, X-Content-Type-Options are vulnerable to MIME-sniffing, and Referrer Policy is not set.</p>
</blockquote>
<p>Also suggest adding to the table -&gt;</p>
<blockquote>
<p>Server Security</p>
</blockquote>
<p>Then (in yellow or red):</p>
<blockquote>
<p>The server header is advertising the software being run on the server. <a href="https://securityheaders.io/?followRedirects=on&amp;hide=on&amp;q=whonix.org">https://securityheaders.io/?followRedirects=on&amp;hide=on&amp;q=whonix.org</a></p>
</blockquote>
<p>Maybe change HSTS to yellow also due to Mozilla Observatory not liking the strict transport security settings (but not specifying why).</p>
<p>Transparency with users and all that. Right now the table makes it look like everything is fine and dandy, when it isn’t.</p>
<p>Also, a privacy policy should really be available in English. Shall I run that German stuff on the same page through Bing translator and fix up the quirky English result?</p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/3</link>
        <pubDate>Mon, 22 May 2017 05:38:03 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-3</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Long standing TODO.</p>
<p><code>Use a Content-Security-Policy</code><br>
<a href="https://phabricator.whonix.org/T70" class="onebox" target="_blank">https://phabricator.whonix.org/T70</a></p>
<p>Not trivial to implement.</p>
<p>//cc <a class="mention" href="http://forums.whonix.org/u/fortasse">@fortasse</a></p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/2</link>
        <pubDate>Fri, 12 May 2017 17:38:54 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-2</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
      <item>
        <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p>Re: Whonix website settings via Mozilla observatory. Overall <a href="http://whonix.org">whonix.org</a> gets a “B” rating.</p>
<p>Everything looks pretty good e.g. ciphers used and so on (A, A+ etc), except <em>HTTP Headers &amp; Content Security</em>, which gets a “D” rating.</p>
<p><a href="https://observatory.mozilla.org/analyze.html?host=whonix.org" class="onebox" target="_blank">https://observatory.mozilla.org/analyze.html?host=whonix.org</a></p>
<p>Why? The problem relates to Content Secutiry Policy, X Content Type Options and Referrer Policy</p>
<p>Check this output:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://securityheaders.com/images/favicon.ico" class="site-icon" width="64" height="64">
      <a href="https://securityheaders.com/?followRedirects=on&amp;hide=on&amp;q=whonix.org" target="_blank">securityheaders.com</a>
  </header>
  <article class="onebox-body">
    <img src="https://securityheaders.com/images/C.png" class="thumbnail onebox-avatar" width="128" height="128">

<h3><a href="https://securityheaders.com/?followRedirects=on&amp;hide=on&amp;q=whonix.org" target="_blank">Scan results for whonix.org</a></h3>

<p>These are the scan results for whonix.org which scored the grade C.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p><strong>Missing Headers</strong></p>
<p><em>Content-Security-Policy</em></p>
<blockquote>
<p>Content Security Policy is an effective measure to protect your site from XSS attacks. By whitelisting sources of approved content, you can prevent the browser from loading malicious assets.</p>
</blockquote>
<p><em>X-Content-Type-Options</em></p>
<blockquote>
<p>X-Content-Type-Options stops a browser from trying to MIME-sniff the content type and forces it to stick with the declared content-type. The only valid value for this header is “X-Content-Type-Options: nosniff”.</p>
</blockquote>
<p><em>Referrer-Policy</em></p>
<blockquote>
<p>Referrer Policy is a new header that allows a site to control how much information the browser includes with navigations away from a document and should be set by all sites.</p>
</blockquote>
<p>It also doesn’t like the Strict Transport Security setting, for whatever reason:</p>
<p><strong>Strict-Transport-Security</strong></p>
<blockquote>
<p>HTTP Strict Transport Security is an excellent feature to support on your site and strengthens your implementation of TLS. That said, the HSTS header must not be returned over a HTTP connection, only HTTPS.</p>
</blockquote>
<p>It also seems to suggest the server advertises the software running it, but sometimes that can be configured to be hidden:</p>
<p><strong>Server</strong></p>
<blockquote>
<p>This Server header seems to advertise the software being run on the server but you can remove or change this value.</p>
</blockquote>
<p>The links at the website show how the website maintainer can address these issues with various settings. It doesn’t look like rocket science. See:</p>
<p><a href="https://scotthelme.co.uk/a-new-security-header-referrer-policy/" class="onebox" target="_blank">https://scotthelme.co.uk/a-new-security-header-referrer-policy/</a><br>
<a href="https://scotthelme.co.uk/content-security-policy-an-introduction/" class="onebox" target="_blank">https://scotthelme.co.uk/content-security-policy-an-introduction/</a><br>
<a href="https://scotthelme.co.uk/hardening-your-http-response-headers/" class="onebox" target="_blank">https://scotthelme.co.uk/hardening-your-http-response-headers/</a></p>
<p>Hopefully fixable.</p>
<p>Cheers</p>
          <p><a href="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/1</link>
        <pubDate>Fri, 12 May 2017 17:06:44 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3874-1</guid>
        <source url="http://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874.rss">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</source>
      </item>
  </channel>
</rss>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP) - #17 by mig5 - Website - Whonix Forum</title>
    <meta name="description" content="Re: Whonix website settings via Mozilla observatory. Overall whonix.org gets a “B” rating. 
Everything looks pretty good e.g. ciphers used and so on (A, A+ etc), except HTTP Headers &amp;amp; Content Security, which gets a “D” r&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../3874.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)&#39;" href="../3874.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/17" />
<meta name="twitter:url" content="https://forums.whonix.org/t/whonix-website-security-rating-b-mozilla-observatory-content-security-policy-csp/3874/17" />
<meta property="og:title" content="Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)" />
<meta name="twitter:title" content="Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)" />
<meta property="og:description" content="CSPs now deployed:" />
<meta name="twitter:description" content="CSPs now deployed:" />
<meta property="article:published_time" content="2018-07-16T02:08:16+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../3874.html">Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/website/6.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #0E76BD'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Website</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/torjunkie'><span itemprop='name'>torjunkie</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-22T05:38:03Z' class='post-time'>
                May 22, 2017,  5:38am
              </time>
              <meta itemprop='dateModified' content='2017-05-22T05:38:03Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>As <a href="../../../../external.html?link=http://kkkkkkkkkk63ava6.onion/wiki/Whonix:Privacy_policy">http://kkkkkkkkkk63ava6.onion/wiki/Whonix:Privacy_policy</a> is locked from editing, please add to the “Technical Information” table -&gt;</p>
<blockquote>
<p>HTTP Headers &amp; Content Security</p>
</blockquote>
<p>Then (in red):</p>
<blockquote>
<p>D Rating. <a href="../../../../external.html?link=https://securityheaders.io/?followRedirects=on&amp;hide=on&amp;q=whonix.org">https://securityheaders.io/?followRedirects=on&amp;hide=on&amp;q=whonix.org</a> Content Security Policy is not enacted, X-Content-Type-Options are vulnerable to MIME-sniffing, and Referrer Policy is not set.</p>
</blockquote>
<p>Also suggest adding to the table -&gt;</p>
<blockquote>
<p>Server Security</p>
</blockquote>
<p>Then (in yellow or red):</p>
<blockquote>
<p>The server header is advertising the software being run on the server. <a href="../../../../external.html?link=https://securityheaders.io/?followRedirects=on&amp;hide=on&amp;q=whonix.org">https://securityheaders.io/?followRedirects=on&amp;hide=on&amp;q=whonix.org</a></p>
</blockquote>
<p>Maybe change HSTS to yellow also due to Mozilla Observatory not liking the strict transport security settings (but not specifying why).</p>
<p>Transparency with users and all that. Right now the table makes it look like everything is fine and dandy, when it isn’t.</p>
<p>Also, a privacy policy should really be available in English. Shall I run that German stuff on the same page through Bing translator and fix up the quirky English result?</p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-22T13:08:38Z' class='post-time'>
                May 22, 2017,  1:08pm
              </time>
              <meta itemprop='dateModified' content='2017-05-22T13:08:38Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="3" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>The server header is advertising the software being run on the server. <a href="../../../../external.html?link=https://securityheaders.io/?followRedirects=on&amp;hide=on&amp;q=whonix.org">https://securityheaders.io/?followRedirects=on&amp;hide=on&amp;q=whonix.org</a></p>
</blockquote>
</aside>
<p>That’s the same thing as Content-Security-Policy.</p>
<aside class="quote" data-post="3" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Maybe change HSTS to yellow also due to Mozilla Observatory not liking the strict transport security settings (but not specifying why).</p>
</blockquote>
</aside>
<p>I don’t see where they are. But even if they did, with all due respect for Mozilla, we shouldn’t take it without sensible justification.</p>
<aside class="quote" data-post="3" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Transparency with users and all that. Right now the table makes it look like everything is fine and dandy, when it isn’t.</p>
</blockquote>
</aside>
<p>Yes.</p>
<aside class="quote" data-post="3" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Also, a privacy policy should really be available in English.</p>
</blockquote>
</aside>
<p>No, it’s only there for legal purposes.</p>
<aside class="quote" data-post="3" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Shall I run that German stuff on the same page through Bing translator and fix up the quirky English result?</p>
</blockquote>
</aside>
<p>No. It’s legal text. To be effective, it needs to be in German language. Until something or someone has been found to take responsibility to set up a better legal framework for Whonix. The editing of <a href="../../../../external.html?link=https://www.whonix.org/wiki/Datenschutz">https://www.whonix.org/wiki/Datenschutz</a> is blocked, because we cannot accept changes to the legal text. (Similar to editing the text of licenses such as GPL - very bad idea.)</p>
<p>The technical information part however is volunteer, not required for legal reasons. Therefore I have split it into a separate template <a href="../../../../external.html?link=https://www.whonix.org/wiki/Template:Whonix.org_security">https://www.whonix.org/wiki/Template:Whonix.org_security</a> in case you wish to edit it further.</p>
<hr>
<p>Also addded:</p>
<p>Certificate Authority (CA) Pinning<br>
<a href="../../../../external.html?link=https://phabricator.whonix.org/T66" class="onebox" target="_blank">https://phabricator.whonix.org/T66</a></p>
<p>HTTP Public Key Pinning<br>
<a href="../../../../external.html?link=https://phabricator.whonix.org/T84" class="onebox" target="_blank">https://phabricator.whonix.org/T84</a></p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Hexagon'><span itemprop='name'>Hexagon</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-22T20:50:14Z' class='post-time'>
                May 22, 2017,  8:50pm
              </time>
              <meta itemprop='dateModified' content='2017-05-22T20:56:47Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="1" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>It also doesn’t like the Strict Transport Security setting, for whatever reason:</p>
<p>Strict-Transport-Security</p>
<p>HTTP Strict Transport Security is an excellent feature to support on your site and strengthens your implementation of TLS. <strong>That said, the HSTS header must not be returned over a HTTP connection, only HTTPS</strong>.</p>
</blockquote>
</aside>
<p>You have entered just <a href="../../../../external.html?link=http://whonix.org/" rel="nofollow noopener">whonix.org</a> to be scanned which is equal to <a href="../../../../external.html?link=http://whonix.org/" rel="nofollow noopener">http://whonix.org</a> and the HTTP response does indeed include a HSTS header but I wouldn’t consider this to be a big problem because browsers should just ignore it (<a href="../../../../external.html?link=https://tools.ietf.org/html/rfc6797#section-8.1" rel="nofollow noopener">RFC 6797, sect. 8.1</a>) on the first request and accept it after the redirect to HTTPS. If you scan <a href="../../../../external.html?link=https://whonix.org/" rel="nofollow noopener">https://whonix.org</a> it doesn’t complain about the HSTS header:<br>
<a href="../../../../external.html?link=https://securityheaders.io/?q=https%3A%2F%2Fwhonix.org%2F&amp;hide=on&amp;followRedirects=on" rel="nofollow noopener">https://securityheaders.io/?q=https%3A%2F%2Fwhonix.org%2F&amp;hide=on&amp;followRedirects=on</a></p>
<p>Edit:<br>
The “Onebox” fearure seems to be unable to handle &amp;-signs correctly, they show up encoded as HTML-entity <code>&amp;amp;</code> in the URL. Here is the correct link: <a href="../../../../external.html?link=https://securityheaders.io/?q=https%3A%2F%2Fwhonix.org%2F&amp;hide=on&amp;followRedirects=on" rel="nofollow noopener">https://securityheaders.io/?q=https%3A%2F%2Fwhonix.org%2F&amp;hide=on&amp;followRedirects=on</a></p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-22T21:24:00Z' class='post-time'>
                May 22, 2017,  9:24pm
              </time>
              <meta itemprop='dateModified' content='2017-05-22T21:24:00Z'>
          <span itemprop='position'>#6</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Hexagon:</p>
<blockquote>
<p>You have entered just <a href="../../../../external.html?link=http://whonix.org/">whonix.org</a> to be scanned which is equal to<br>
<a href="../../../../external.html?link=http://whonix.org/">http://whonix.org</a> and the HTTP response does indeed include a HSTS<br>
header but I wouldn’t consider this to be a big problem because […]</p>
</blockquote>
<p>I would consider that a feature.</p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Hexagon'><span itemprop='name'>Hexagon</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-22T21:48:44Z' class='post-time'>
                May 22, 2017,  9:48pm
              </time>
              <meta itemprop='dateModified' content='2017-05-22T21:48:44Z'>
          <span itemprop='position'>#7</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>If it was a feature that browsers would support you could inject this header in the HTTP traffic to execute a denial of service attack on websites that don’t have (full) HTTPS support, which is probably the reason why browsers are supposed to ignore it.<br>
It also wouldn’t have any real advantage over being redirected to HTTPS and then getting an HSTS header which you can trust.<br>
But adding it doesn’t really harm as long as HTTPS is supported and/or browsers keep ignoring it .</p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/torjunkie'><span itemprop='name'>torjunkie</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-22T23:38:48Z' class='post-time'>
                May 22, 2017, 11:38pm
              </time>
              <meta itemprop='dateModified' content='2017-05-22T23:38:48Z'>
          <span itemprop='position'>#8</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Good to know, thanks. All the website server stuff is a complete mystery to us mere mortals <img src="../../../images/emoji/twitter/winkae52.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
<p>Since you seem knowledgeable, how hard is it to turn these red table items into green i.e. for website maintainer? -&gt;</p>
<p><a href="../../../../external.html?link=http://kkkkkkkkkk63ava6.onion/wiki/Datenschutz#Technical_Information" class="onebox" target="_blank">http://kkkkkkkkkk63ava6.onion/wiki/Datenschutz#Technical_Information</a></p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Hexagon'><span itemprop='name'>Hexagon</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-23T03:47:21Z' class='post-time'>
                May 23, 2017,  3:47am
              </time>
              <meta itemprop='dateModified' content='2017-05-23T03:47:21Z'>
          <span itemprop='position'>#9</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>CSP:</p>
<ul>
<li>Generating the headers should be quite easy, depending on the granularity. I’d suggest creating one for each application (wiki, blog, forum, phabricator) starting with a restrictive report-only version and when no more reports come in enforcing it.</li>
<li>Making the headers more effective (i.e. not using unsafe options) is a bit harder as this would require some code changes. Currently you are using some inline-JS and inline-CSS which would be ideally moved to a file or at least get a hash or nonce.</li>
<li>And you are using some style-Attributes which are can’t get a hash or nonce and thus can be used only with unsafe-inline, these should be replaced by css classes if possible</li>
<li>The CSP header might has to be modified if an application changes</li>
</ul>
<p>I haven’t used PK or CA pinning yet, so the following is just as far as i know.</p>
<p>PK pinning:</p>
<ul>
<li>Requires two certificates using different public keys in case one has to be revoked</li>
<li>It’s dangerous! Start with short time periods and test both certificates</li>
<li>If you get a new public key you have to update your header soon enough to include it during a transitional period</li>
<li>After testing you shouldn’t have to touch it until you plan to get a new key pair</li>
</ul>
<p>CA pinning:</p>
<ul>
<li>Requires two certificates from different CAs in case one has to be revoked</li>
<li>Less dangerous, but still start with short time periods and test both certificates</li>
<li>If you change your CA or they get a new public key you have to update your header soon enough to include it during a transitional period</li>
<li>After testing you shouldn’t have to touch it until you change your CA or your CA gets a new key pair to sign certificates</li>
</ul>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-23T13:10:00Z' class='post-time'>
                May 23, 2017,  1:10pm
              </time>
              <meta itemprop='dateModified' content='2017-05-23T13:10:00Z'>
          <span itemprop='position'>#10</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="8" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Since you seem knowledgeable, how hard is it to turn these red table items into green i.e. for website maintainer? -&gt;</p>
</blockquote>
</aside>
<p>Sorry, I don’t understand your question. Could you please provide more details? Maybe you mean this?</p>
<pre><code>{{Yes}}
</code></pre>
<p>Or.</p>
<pre><code>{{No}}
</code></pre>
<ul>
<li><a href="../../../../external.html?link=https://www.whonix.org/wiki/Template:Yes">https://www.whonix.org/wiki/Template:Yes</a></li>
<li><a href="../../../../external.html?link=https://www.whonix.org/wiki/Template:No">https://www.whonix.org/wiki/Template:No</a></li>
</ul>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-23T13:15:25Z' class='post-time'>
                May 23, 2017,  1:15pm
              </time>
              <meta itemprop='dateModified' content='2017-05-23T13:15:25Z'>
          <span itemprop='position'>#11</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Generally, a CSP would be great!</p>
<aside class="quote" data-post="9" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/h/848f3c/40.png" class="avatar"> Hexagon:</div>
<blockquote>
<p>Making the headers more effective (i.e. not using unsafe options) is a bit harder as this would require some code changes. Currently you are using some inline-JS and inline-CSS which would be ideally moved to a file or at least get a hash or nonce.</p>
</blockquote>
</aside>
<aside class="quote" data-post="9" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/h/848f3c/40.png" class="avatar"> Hexagon:</div>
<blockquote>
<p>And you are using some style-Attributes which are can’t get a hash or nonce and thus can be used only with unsafe-inline, these should be replaced by css classes if possible</p>
</blockquote>
</aside>
<p>We don’t develop any web apps. We are using Libre Software. Mediawiki (wiki), wordpress (blog), phabricator (issue tracker) and discourse (forum). We don’t have resources to make changes on the code level. But if you wish, please feel very free to report any such issues against these projects. Because then these fixes would flow down as we update these web apps.</p>
<aside class="quote" data-post="9" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/h/848f3c/40.png" class="avatar"> Hexagon:</div>
<blockquote>
<p>The CSP header might has to be modified if an application changes</p>
</blockquote>
</aside>
<p>Which makes this require constant maintenance.</p>
<p>Perhaps mediawiki, wordpress, phabricator and/or discourse are providing boiler plate CSPs we just can copy/paste and are free to use? If not, could you make a feature request against these projects please?</p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Hexagon'><span itemprop='name'>Hexagon</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-23T14:12:17Z' class='post-time'>
                May 23, 2017,  2:12pm
              </time>
              <meta itemprop='dateModified' content='2017-05-23T14:12:17Z'>
          <span itemprop='position'>#12</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>For MediaWiki it’s an open ticket: <a href="../../../../external.html?link=https://phabricator.wikimedia.org/T135963" rel="nofollow noopener">https://phabricator.wikimedia.org/T135963</a></p>
<p>For Phabricator it’s an open ticket: <a href="../../../../external.html?link=https://secure.phabricator.com/T4340" rel="nofollow noopener">https://secure.phabricator.com/T4340</a></p>
<p>For discourse I could only find a from post: <a href="../../../../external.html?link=https://meta.discourse.org/t/how-to-configure-content-security-policy/53308" rel="nofollow noopener">https://meta.discourse.org/t/how-to-configure-content-security-policy/53308</a></p>
<p>For wordpress there is an old (6 years) plugin which allows automatic creation of the CSP header: <a href="../../../../external.html?link=https://people-mozilla.org/~bsterne/content-security-policy/wordpress.html" rel="nofollow noopener">https://people-mozilla.org/~bsterne/content-security-policy/wordpress.html</a><br>
and a newer one which seems to be manual: <a href="../../../../external.html?link=https://de.wordpress.org/plugins/wp-content-security-policy/" rel="nofollow noopener">https://de.wordpress.org/plugins/wp-content-security-policy/</a></p>
<p>I could make some CSPs which allows the use unsafe-inline code if required until those apps are compatible. This would at least prevent an attacker from embedding external sources.</p>
<aside class="quote" data-post="11" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Which makes this require constant maintenance.</p>
</blockquote>
</aside>
<p>You could setup a small script which logs policy violations to fix them as they occur (<a href="../../../../external.html?link=https://mathiasbynens.be/notes/csp-reports" rel="nofollow noopener">example</a>).</p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Hexagon'><span itemprop='name'>Hexagon</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-23T21:13:13Z' class='post-time'>
                May 23, 2017,  9:13pm
              </time>
              <meta itemprop='dateModified' content='2017-05-23T21:24:39Z'>
          <span itemprop='position'>#13</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="12" data-topic="3874">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/h/848f3c/40.png" class="avatar"> Hexagon:</div>
<blockquote>
<p>I could make some CSPs which allows the use unsafe-inline code</p>
</blockquote>
</aside>
<p>CSP for <code>*.whonix.org/*</code> (in case you want to manage just one CSP for everything):</p>
<pre><code>default-src 'none';
script-src  'self' 'unsafe-inline' 'unsafe-eval';
style-src   'self' 'unsafe-inline';
img-src     * data:;
font-src    'self';
connect-src 'self'
</code></pre>
<p>Other CSPs I have created during my tests:</p>
<p>CSP for <code>forums.whonix.org/*</code> (the Onebox feature embeds external images from various locations):</p>
<pre><code>default-src 'none';
script-src  'self' 'unsafe-inline' 'unsafe-eval';
style-src   'self' 'unsafe-inline';
img-src     *;
font-src    'self';
connect-src 'self'
</code></pre>
<p>CSP for <code>phabricator.whonix.org/*</code>:</p>
<pre><code>default-src 'none';
script-src  'self' 'unsafe-inline';
style-src   'self' 'unsafe-inline';
img-src     data: 'self';
font-src    'self';
connect-src 'self'
</code></pre>
<p>CSP for <code>www.whonix.org/blog/*</code> (profile images from the forum are embedded using HTTP):</p>
<pre><code>default-src 'none';
script-src  'self' 'unsafe-inline';
style-src   'self' 'unsafe-inline';
img-src     data: https://forums.whonix.org https://forums.whonix.org 'self'
</code></pre>
<p>CSP for <code>www.whonix.org/wiki/*</code> (one image was requested from wikimedia):</p>
<pre><code>default-src 'none';
script-src  'self' 'unsafe-inline' 'unsafe-eval';
style-src   'self' 'unsafe-inline';
img-src     https://upload.wikimedia.org 'self';
font-src    'self'
</code></pre>
<p>CSP for <code>https://www.whonix.org/</code> (has an inline onclick event to hide the donation message):</p>
<pre><code>default-src 'none';
script-src  'unsafe-inline';
style-src   'self' 'unsafe-inline';
img-src     'self'
</code></pre>
<p>CSP for <code>https://www.whonix.org/download/</code>:</p>
<pre><code>default-src 'none';
style-src   'self';
img-src     'self'
</code></pre>
<p>CSP for <code>www.whonix.org/cgi-bin/mailman/*</code> (has an inline script):</p>
<pre><code>default-src 'none';
script-src  'unsafe-inline';
img-src     'self'
</code></pre>
<p>CSP for <code>www.whonix.org/pipermail/*</code> (has an inline style):</p>
<pre><code>default-src 'none';
style-src   'unsafe-inline';
img-src     'self'
</code></pre>
<p>Note: I’d recommend setting up an endpoint for CSP violation reports for debugging purposes in case something needs more permissions.</p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/fortasse'><span itemprop='name'>fortasse</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-23T22:18:04Z' class='post-time'>
                May 23, 2017, 10:18pm
              </time>
              <meta itemprop='dateModified' content='2017-05-23T22:18:04Z'>
          <span itemprop='position'>#14</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>It’s worth noting that <code>unsafe-inline</code> and <code>unsafe-eval</code> essentially make the CSP worthless - this still allows XSS to fire, since an XSS payload would be “inline”. I don’t have the time, knowledge, or ability to go through the myriad of software this website runs to “fix” their inline scripts.</p>
<p>If/when upstream projects (phabricator, mediawiki) do away with inline scripts, I would be definitely willing to take another look at this.</p>
<p>I have to say thanks for your hard work in making the policies, as well as your concern about our security posture. I feel like, for the time being, we have a sane balance between securing ourselves (HSTS, x-xss-protection) while avoiding potentially DoSing ourselves by setting things up wrong (HPKP, to a lesser extent CSP).</p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Hexagon'><span itemprop='name'>Hexagon</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-05-24T10:18:27Z' class='post-time'>
                May 24, 2017, 10:18am
              </time>
              <meta itemprop='dateModified' content='2017-05-24T10:18:27Z'>
          <span itemprop='position'>#15</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Yes, those CSPs won’t effectively stop an XSS attack, but still limit what an attacker can do and make it harder to do something useful if an XSS injection succeeds, for example interactive communication (<a href="../../../../external.html?link=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/connect-src" rel="nofollow noopener">connect-src</a>) with remote servers is still prevented by the CSP.</p>
<p>The first CSP I proposed is safe enough to not DoS yourself. Even if a future application requires more permissions (for example embedding a flash object) most features will still work as expected and should remain usable, also you get a report as soon as it happens and a fix would be pretty easy (just add the missing permission, reload, done).</p>
<p>You could try the CSP in report-only mode for a month or so and see if it would block anything that shouldn’t be blocked or change the <code>default-src</code> to <code>'self'</code> or even <code>*.whonix.org</code> instead of <code>'none'</code> which would permit applications to do anything as long as its on the same host or hosted on a Whonix subdomain (unless a more specific directive is given) if you fear DoSsing yourself.</p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/mig5'><span itemprop='name'>mig5</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-07-09T07:31:15Z' class='post-time'>
                July 9, 2018,  7:31am
              </time>
              <meta itemprop='dateModified' content='2018-07-09T07:31:15Z'>
          <span itemprop='position'>#16</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Hi <a class="mention" href="../../../../external.html?link=https://forums.whonix.org/u/hexagon">@Hexagon</a>,</p>
<p>I’m currently looking at the CSP headers (new sysadmin).</p>
<p>Your examples are really useful and I’ll be using those as a basis with which to achieve it.</p>
<p>I agree with <a class="mention" href="../../../../external.html?link=https://forums.whonix.org/u/fortasse">@fortasse</a>’s reservations, but I also agree with you that having a CSP with unsafe-inline is better than none at all for other reasons.</p>
<p>I was just wondering what was the purpose behind unsafe-eval? Did you find cases on Discourse or the Wiki where that was actually required?</p>
<p>In the time since this ticket, Phabricator actually implemented a CSP, and since we upgraded Phabricator recently, we have pulled that in. <a href="../../../../external.html?link=https://phabricator.wikimedia.org/T135963">https://phabricator.wikimedia.org/T135963</a></p>
<p>It looks like MediaWiki <a href="../../../../external.html?link=https://phabricator.wikimedia.org/T135963">merged in code for it recently too</a> (March 2018), albeit they think it may break many gadgets/extensions so we’ll have to tread carefully.</p>
<p>Discourse is a ways off, they don’t consider it a priority/have no resources for it. <a href="../../../../external.html?link=https://meta.discourse.org/t/how-to-configure-content-security-policy/53308">Same link as you found</a>.</p>
<p>I’ll be looking at adding individual CSP headers to the various other areas (ignoring /blog since that’s been sunset in favour of Discourse) soon.</p>
<p>Currently fighting with my own site’s CSP when under .onion, despite the .onion host being whitelisted! Grrr…</p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="4" />
           <span class='post-likes'>4 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/mig5'><span itemprop='name'>mig5</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-07-16T02:08:16Z' class='post-time'>
                July 16, 2018,  2:08am
              </time>
              <meta itemprop='dateModified' content='2018-07-16T02:08:16Z'>
          <span itemprop='position'>#17</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>CSPs now deployed:</p>
<aside class="quote quote-modified" data-post="1" data-topic="5494">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/mig5/40/1647_1.png" class="avatar">
    <a href="../../content-security-policy-now-deployed-on-whonix-websites/5494.html">Content-Security-Policy now deployed on Whonix websites</a> <a class="badge-wrapper  bullet" href="../../../c/website/6.html"><span class="badge-category-bg" style="background-color: #0E76BD;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Issues and improvements with the Whonix website. (website devs) (user documentation devs)">Website</span></a>
  </div>
  <blockquote>
    Good news! We’ve implemented Content-Security-Policy headers on various areas of the  Whonix infrastructure. 
This includes the main site, the wiki, this forum, and a few other places. 
We also implemented Referrer-Policy and some other headers in recent weeks. 
We now get an A+ rating on the main page at <a href="../../../../external.html?link=https://securityheaders.com/">https://securityheaders.com</a> \o/ 
 <a class="lightbox" href="../../../uploads/default/original/2X/f/fa5ca0696e7ba3c5d8c704d65419aa34e389b984.png" data-download-href="//forums.whonix.org/uploads/default/fa5ca0696e7ba3c5d8c704d65419aa34e389b984" title="whonix-securityheaders-rating-july2018.png">[whonix-securityheaders-rating-july2018]</a>
Some things to note: 


We deliberately are not allowing loading images from third party sites on the forum and also i…
  </blockquote>
</aside>

        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="4" />
           <span class='post-likes'>4 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/torjunkie'><span itemprop='name'>torjunkie</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-07-16T10:47:25Z' class='post-time'>
                July 16, 2018, 10:47am
              </time>
              <meta itemprop='dateModified' content='2018-07-16T11:02:45Z'>
          <span itemprop='position'>#18</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Whatever you are doing is working as the server is running much better than the old days. Seems upgrades etc are beneficial, as .onion is not super flaky anymore.</p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="3" />
           <span class='post-likes'>3 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
              split this topic 
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-17T08:01:55Z' class='post-time'>
                January 17, 2020,  8:01am
              </time>
              <meta itemprop='dateModified' content='2020-01-17T08:01:55Z'>
          <span itemprop='position'>#19</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>4 posts were split to a new topic: <a href="../../fix-extra-white-space-on-all-pdf-embedded-links/8781.html">fix extra white space on all PDF embedded links</a></p>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/TNT_BOM_BOM'><span itemprop='name'>TNT_BOM_BOM</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-05-02T14:47:54Z' class='post-time'>
                May 2, 2021,  2:47pm
              </time>
              <meta itemprop='dateModified' content='2021-05-02T14:47:54Z'>
          <span itemprop='position'>#20</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Until now whonix considered B, And according to these sites:</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://www.hardenize.com/favicon/favicon-32x32.png" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://www.hardenize.com/report/whonix.org/1619966056#www_csp" target="_blank" rel="noopener nofollow ugc">hardenize.com</a>
  </header>
  <article class="onebox-body">
    <img src="#" class="thumbnail" width="16" height="16">

<h3><a href="../../../../external.html?link=https://www.hardenize.com/report/whonix.org/1619966056#www_csp" target="_blank" rel="noopener nofollow ugc">Hardenize Report: whonix.org</a></h3>

<p>Hardenize continuously monitors security and configuration of your domain name, email servers, and web site.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p><a href="../../../../external.html?link=https://observatory.mozilla.org/analyze/whonix.org" class="onebox" target="_blank" rel="noopener nofollow ugc">https://observatory.mozilla.org/analyze/whonix.org</a></p>
<p>Issue is:</p>
<blockquote>
<p>script-src ‘self’   https://*.whonix.org <strong>‘unsafe-inline’  'unsafe-eval’</strong></p>
</blockquote>
<blockquote>
<p>style-src ‘self’   https://*.whonix.org  <strong>'unsafe-inline’</strong></p>
</blockquote>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-05-02T15:27:57Z' class='post-time'>
                May 2, 2021,  3:27pm
              </time>
              <meta itemprop='dateModified' content='2021-05-02T15:27:57Z'>
          <span itemprop='position'>#21</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>CSP issue. Not reasonable to work on this. Reasoning here:</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://www.whonix.org/wiki/Website_Tests" target="_blank" rel="noopener" title="03:47PM - 28 April 2021">Whonix – 28 Apr 21</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:110/84;"><img src="../../../../external.html?link=https://www.whonix.org/w/images/0/0d/Websitetest.jpg" class="thumbnail" width="110" height="84"></div>

<h3><a href="../../../../external.html?link=https://www.whonix.org/wiki/Website_Tests" target="_blank" rel="noopener">Website Tests</a></h3>

<p>Testing the Whonix ™ server with test websites such as hardenize.com / securityheaders.com / Mozilla Observatory / SSL Labs / hstspreload.org.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Applicable chapters:</p>
<ul>
<li><a href="../../../../external.html?link=https://www.whonix.org/wiki/Website_Tests#Introduction">Introduction</a></li>
<li><a href="../../../../external.html?link=https://www.whonix.org/wiki/Website_Tests#Content-Security-Policy_CSP">Content-Security-Policy CSP</a></li>
<li><a href="../../../../external.html?link=https://www.whonix.org/wiki/Website_Tests#Comparison_with_Others">Comparison with Others</a></li>
</ul>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../content-security-policy-now-deployed-on-whonix-websites/5494/4.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../content-security-policy-now-deployed-on-whonix-websites/5494/4.html'>
                      <span itemprop='name'>Content-Security-Policy now deployed on Whonix websites</span>
                    </a>
                    <meta itemprop='position' content='5'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3874.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-05T21:06:53Z' class='post-time'>
                August 5, 2022,  9:06pm
              </time>
              <meta itemprop='dateModified' content='2022-08-05T21:06:53Z'>
          <span itemprop='position'>#22</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>CSP simplification.</p>
<p>Reason for simplification: Website breaks in corner cases and the more complex CSP also does not provide higher security. It’s just more complex. <a href="../../../../external.html?link=https://www.kicksecure.com/wiki/Website_Tests" class="inline-onebox">Website and Server Tests</a> scores are unchanged.</p>
<p>Old:</p>
<blockquote>
<p>content-security-policy: default-src ‘none’; connect-src ‘self’; script-src ‘self’ https://<em>.whonix.org ‘unsafe-inline’ ‘unsafe-eval’; style-src ‘self’ https://</em>.whonix.org ‘unsafe-inline’; img-src ‘self’ data: https://<em>.whonix.org; font-src ‘self’ https://</em>.whonix.org;</p>
</blockquote>
<p>New:</p>
<blockquote>
<p>content-security-policy: default-src ‘self’ ‘unsafe-inline’ ‘unsafe-eval’;</p>
</blockquote>
        </div>

        <meta itemprop='headline' content='Whonix website security rating - &quot;B&quot; (Mozilla Observatory) - Content Security Policy (CSP)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

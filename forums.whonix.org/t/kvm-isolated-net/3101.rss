<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>KVM | isolated net</title>
    <link>http://forums.whonix.org/t/kvm-isolated-net/3101</link>
    <description>Hi again.

Host KVM hypervisor.

    virsh domiflist Whonix-Gateway
    vnet0 default
    vnet1 isolnet
    virsh domiflist Whonix-Workstation
    vnet2 isolnet 

If in the HOST:
` iptables -t nat -A PREROUTING ! -i lo -p tcp -j REDIRECT --to-port 1023`
`not sent packet to vnet2 -- vnet1 (eth0 -- eth1) | tcpdump -i virbr1 (not tcp packet)`
Why not isolate the network stack on the host from the guest ? In this 
so-called isolated network. How to solve this problem.... VBox 
everything works without problems.</description>
    <language>en</language>
    <lastBuildDate>Fri, 28 Oct 2016 13:08:11 +0000</lastBuildDate>
    <category>KVM</category>
    <atom:link href="http://forums.whonix.org/t/kvm-isolated-net/3101.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>KVM | isolated net</title>
        <dc:creator><![CDATA[Virsh]]></dc:creator>
        <description><![CDATA[
            <p>The problem is not the implementation of whonix. The problem, why not<br>
isolate the network stack between the host and the guest. traffic<br>
between VM (WG-WK) does not have IP stack in the host to get.</p>
          <p><a href="http://forums.whonix.org/t/kvm-isolated-net/3101/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-isolated-net/3101/9</link>
        <pubDate>Fri, 28 Oct 2016 13:08:11 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3101-9</guid>
        <source url="http://forums.whonix.org/t/kvm-isolated-net/3101.rss">KVM | isolated net</source>
      </item>
      <item>
        <title>KVM | isolated net</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Torification of host traffic using Non-Qubes-Whonix is unsupported.</p>
<ul>
<li><a href="https://www.whonix.org/wiki/Non-Qubes-Whonix">https://www.whonix.org/wiki/Non-Qubes-Whonix</a></li>
<li><a href="https://www.whonix.org/wiki/Unsupported">https://www.whonix.org/wiki/Unsupported</a></li>
</ul>
<hr>
<p>We have something related that may help to develop this.</p>
<p>For Whonix VirtualBox we have instructions on how to ssh into Whonix-Workstation from the host through Whonix-Gateway, i.e. host -&gt; Whonix-Gateway -&gt; Whonix-Workstation.</p>
<p><a href="https://www.whonix.org/wiki/File_Transfer#SSH_into_Whonix-Workstation">https://www.whonix.org/wiki/File_Transfer#SSH_into_Whonix-Workstation</a></p>
<p>I don’t think we have this documented for Whonix KVM.</p>
<p>As per Free Support Principle, I suggest to create a non-Whonix, plain Debian KVM VM first. Then figure out how to connect from the host to a port inside that Debian VM. Then have second plain Debian (non-Whonix) VM connected through an isolated network (similar to the Whonix configuration) to the first Debian VM. Once that all was figured out, you may be capable to add Whonix into the mix. Adding Whonix into the mix from start would make all of this a lot more difficult since you would have multiple sources of issues (not just figuring out how to do this in the first place but also how to do this while not having Whonix stream isolation and Whonix firewall getting into the way).</p>
<ul>
<li><a href="https://www.whonix.org/wiki/Free_Support_Principle">https://www.whonix.org/wiki/Free_Support_Principle</a></li>
</ul>
          <p><a href="http://forums.whonix.org/t/kvm-isolated-net/3101/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-isolated-net/3101/8</link>
        <pubDate>Fri, 28 Oct 2016 12:25:48 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3101-8</guid>
        <source url="http://forums.whonix.org/t/kvm-isolated-net/3101.rss">KVM | isolated net</source>
      </item>
      <item>
        <title>KVM | isolated net</title>
        <dc:creator><![CDATA[Virsh]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="6" data-topic="3101" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Do you want an open port in Whonix-Gateway that you can reach from the host?</p>
</blockquote>
</aside>
<h2>No. 1. I need ( host and W-G) routed all tcp traffic ssh (redsocks). I managed to do that.<br>
2. If<br>
<code>iptables -t nat -A PREROUTING ! -i lo -p tcp -j REDIRECT --to-port 1023</code><br>
<code>tcpdump -i virbr1 (not tcp packet)</code><br>
virbr1 – routed traffic on 1023 port / Workstation no internet =) no sent packets vnet2 – vnet1<br>
VBox work fine</h2>
<p>SSH-W-G-Work-station<br>
WG - Workstation ( no connect )</p>
          <p><a href="http://forums.whonix.org/t/kvm-isolated-net/3101/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-isolated-net/3101/7</link>
        <pubDate>Fri, 28 Oct 2016 12:13:06 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3101-7</guid>
        <source url="http://forums.whonix.org/t/kvm-isolated-net/3101.rss">KVM | isolated net</source>
      </item>
      <item>
        <title>KVM | isolated net</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Do you want an open port in Whonix-Gateway that you can reach from the host?</p>
          <p><a href="http://forums.whonix.org/t/kvm-isolated-net/3101/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-isolated-net/3101/6</link>
        <pubDate>Fri, 28 Oct 2016 12:00:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3101-6</guid>
        <source url="http://forums.whonix.org/t/kvm-isolated-net/3101.rss">KVM | isolated net</source>
      </item>
      <item>
        <title>KVM | isolated net</title>
        <dc:creator><![CDATA[Virsh]]></dc:creator>
        <description><![CDATA[
            <p>The problem is that if I need to send traffic from the host and whonix gateway in the proxy.<br>
The network just doesn’t work. Whonix-workstation don’t sent packet (http) to whonix-gateway.</p>
          <p><a href="http://forums.whonix.org/t/kvm-isolated-net/3101/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-isolated-net/3101/5</link>
        <pubDate>Fri, 28 Oct 2016 07:28:34 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3101-5</guid>
        <source url="http://forums.whonix.org/t/kvm-isolated-net/3101.rss">KVM | isolated net</source>
      </item>
      <item>
        <title>KVM | isolated net</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>I could be missing something but I don’t see what the problem is.</p>
<p>The way libvirt networking works is it creates different network types using the host’s iptables/ebtables. What you are seeing is an isolated virtual bridge that only connects VMs assigned to it together.</p>
          <p><a href="http://forums.whonix.org/t/kvm-isolated-net/3101/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-isolated-net/3101/4</link>
        <pubDate>Fri, 28 Oct 2016 03:05:39 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3101-4</guid>
        <source url="http://forums.whonix.org/t/kvm-isolated-net/3101.rss">KVM | isolated net</source>
      </item>
      <item>
        <title>KVM | isolated net</title>
        <dc:creator><![CDATA[Virsh]]></dc:creator>
        <description><![CDATA[
            <p>Thank the reply!<br>
Yes I create isolnet network from xml file (download whonix) .<br>
ifconfig virbr1<br>
virbr1    Link encap:Ethernet  HWaddr<br>
UP BROADCAST MULTICAST  MTU:1500  Metric:1<br>
RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br>
TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br>
collisions:0 txqueuelen:0<br>
RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)<br>
virbr1 no ip address/ no default getway<br>
But as you can see not working is the isolation of the network stack. What can be the reason?</p>
          <p><a href="http://forums.whonix.org/t/kvm-isolated-net/3101/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-isolated-net/3101/3</link>
        <pubDate>Thu, 27 Oct 2016 16:11:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3101-3</guid>
        <source url="http://forums.whonix.org/t/kvm-isolated-net/3101.rss">KVM | isolated net</source>
      </item>
      <item>
        <title>KVM | isolated net</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Whonix KVM uses a “very private” isolated network that cannot communicate with the host. Note that the internal network is called “Whonix” not isolnet.</p>
<p><a href="https://libvirt.org/formatnetwork.html#examplesPrivate" class="onebox" target="_blank">https://libvirt.org/formatnetwork.html#examplesPrivate</a></p>
<blockquote>
<p>A valid network definition can contain no IPv4 or IPv6 addresses. Such a definition can be used for a “very private” or “very isolated” network since it will not be possible to communicate with the virtualization host via this network. However, this virtual network interface can be used for communication between virtual guest systems. This works for IPv4 and (Since 1.0.1) IPv6. However, the new ipv6=‘yes’ must be added for guest-to-guest IPv6 communication.</p>
</blockquote>
          <p><a href="http://forums.whonix.org/t/kvm-isolated-net/3101/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-isolated-net/3101/2</link>
        <pubDate>Thu, 27 Oct 2016 15:45:08 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3101-2</guid>
        <source url="http://forums.whonix.org/t/kvm-isolated-net/3101.rss">KVM | isolated net</source>
      </item>
      <item>
        <title>KVM | isolated net</title>
        <dc:creator><![CDATA[Virsh]]></dc:creator>
        <description><![CDATA[
            <p>Hi again.</p>
<p>Host KVM hypervisor.</p>
<pre><code>virsh domiflist Whonix-Gateway
vnet0 default
vnet1 isolnet
virsh domiflist Whonix-Workstation
vnet2 isolnet 
</code></pre>
<p>If in the HOST:<br>
<code>iptables -t nat -A PREROUTING ! -i lo -p tcp -j REDIRECT --to-port 1023</code><br>
<code>not sent packet to vnet2 -- vnet1 (eth0 -- eth1) | tcpdump -i virbr1 (not tcp packet)</code><br>
Why not isolate the network stack on the host from the guest ? In this<br>
so-called isolated network. How to solve this problem… VBox<br>
everything works without problems.</p>
          <p><a href="http://forums.whonix.org/t/kvm-isolated-net/3101/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-isolated-net/3101/1</link>
        <pubDate>Thu, 27 Oct 2016 14:38:35 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3101-1</guid>
        <source url="http://forums.whonix.org/t/kvm-isolated-net/3101.rss">KVM | isolated net</source>
      </item>
  </channel>
</rss>

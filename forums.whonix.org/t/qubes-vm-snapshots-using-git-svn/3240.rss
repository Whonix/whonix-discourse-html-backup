<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Qubes VM snapshots using git / SVN</title>
    <link>http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240</link>
    <description>Quote https://www.whonix.org/wiki/Qubes/Disposable_VM

&gt; Qubes does not have a built-in snapshot capability like VirtualBox that 
can completely revert all changes back to a particular VM state.

Probably not useful for most users since it is getting geeky but I hope I am wrong. However, may be interesting for advanced users...

I am using git to be able to revert back more than to the previous (not last) state of a template. Someone added a while ago [here](https://www.whonix.org/wiki/Security_Guide#VM_Snapshots) a suggestion to SVN (when you click `expand`) since that as the contributor added works better than git for binary files such as VM images.

Git works but it is awfully slow on huge (any Qubes) VM images. But perhaps someone wants to discover / document git / SVN. Would also be interesting to find out if (much more modern and imo usable) git can be tweaked to become efficient on binary files. (We don&#39;t have to share these images. Just looking for a hack to record / roll back to past template states.

(That is useful when [a Qubes upgrade bug breaks booting the template](https://github.com/QubesOS/qubes-issues/issues/2484) or during development to test in-place upgrades.)</description>
    <language>en</language>
    <lastBuildDate>Wed, 07 Dec 2016 04:54:52 +0000</lastBuildDate>
    <category>Qubes-Whonix</category>
    <atom:link href="http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Qubes VM snapshots using git / SVN</title>
        <dc:creator><![CDATA[adw]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="5" data-topic="3240">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/r/e19adc/40.png" class="avatar"> rustybird:</div>
<blockquote>
<p>Did they happen recently though?</p>
</blockquote>
</aside>
<p>Not extremely recently, no.</p>
<aside class="quote" data-post="5" data-topic="3240">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/r/e19adc/40.png" class="avatar"> rustybird:</div>
<blockquote>
<p>The installer really does its best to hide the automatic btrfs setup option. (Ironically, it was more visible in R3.0, when it wasn’t quite ready IMHO.) But once you’ve bypassed that weird installer bug, you only have to select “btrfs” and then “Click here to create them automatically”, that’s it!</p>
</blockquote>
</aside>
<p>That’s good! But since I usually like to <a href="https://www.qubes-os.org/doc/custom-install/" rel="nofollow noopener">customize my installation</a> a bit, I’ll have to learn how to set it up from the command-line.</p>
<aside class="quote" data-post="5" data-topic="3240">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/r/e19adc/40.png" class="avatar"> rustybird:</div>
<blockquote>
<p>Hmm… how do you prevent bad backups (with silently corrupted data) from gradually replacing all the good backups?</p>
</blockquote>
</aside>
<p>I can’t. That’s why I keep every backup. If a file becomes silently corrupted, I still have the last good version (in the latest backup in which it exists).</p>
          <p><a href="http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240/6</link>
        <pubDate>Wed, 07 Dec 2016 04:54:52 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3240-6</guid>
        <source url="http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240.rss">Qubes VM snapshots using git / SVN</source>
      </item>
      <item>
        <title>Qubes VM snapshots using git / SVN</title>
        <dc:creator><![CDATA[rustybird]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="4" data-topic="3240">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/adw/40/686_1.png" class="avatar"> adw:</div>
<blockquote>
<p>I’ve heard a lot of horror stories of people losing data on Btrfs due to instability.</p>
</blockquote>
</aside>
<p>Did they happen recently though? I ran into a known issue on R3.0, where the filesystem became readonly after too many snapshots. This was fixable simply by booting a newer kernel once (and deleting some old snapshots so it wouldn’t happen again right away on the old kernel). But since R3.1 it’s been smooth sailing.</p>
<p>Maybe I’ve just been lucky. I’ve used btrfs exclusively, starting - before switching to Qubes - when it was still marked “experimental”, and never lost any data, AFAIK.</p>
<aside class="quote" data-post="4" data-topic="3240">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/adw/40/686_1.png" class="avatar"> adw:</div>
<blockquote>
<p>I have no experience with it, so I’m reticent to try to manually set it up myself on a system I’m going to depend upon for daily use.</p>
</blockquote>
</aside>
<p>The installer really does its best to hide the automatic btrfs setup option. (Ironically, it was more visible in R3.0, when it wasn’t quite ready IMHO.) But once you’ve bypassed that weird installer bug, you only have to select “btrfs” and then “Click here to create them automatically”, that’s it!</p>
<aside class="quote" data-post="4" data-topic="3240">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/adw/40/686_1.png" class="avatar"> adw:</div>
<blockquote>
<p>(For example, I’ve learned to work around the lack of built-in data integrity checking in other file systems by keeping frequent full versioned backups.)</p>
</blockquote>
</aside>
<p>Hmm… how do you prevent bad backups (with silently corrupted data) from gradually replacing all the good backups?</p>
          <p><a href="http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240/5</link>
        <pubDate>Tue, 06 Dec 2016 13:35:08 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3240-5</guid>
        <source url="http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240.rss">Qubes VM snapshots using git / SVN</source>
      </item>
      <item>
        <title>Qubes VM snapshots using git / SVN</title>
        <dc:creator><![CDATA[adw]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="3" data-topic="3240">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/r/e19adc/40.png" class="avatar"> rustybird:</div>
<blockquote>
<p>The Qubes btrfs experience (instant free clones and whole filesystem snapshots, as well as block checksums protecting against silent data corruption) is so awesome that I’m always kind of surprised not everyone is setting up their system this way… Unless you’re very tight on disk space (it has tended to behave weirdly if there’s not enough free space at all times) I can’t recommend it enough.</p>
</blockquote>
</aside>
<p>Speaking personally, there are a few reasons I haven’t made the jump to Btrfs yet:</p>
<ul>
<li>I’ve heard a lot of horror stories of people losing data on Btrfs due to instability.</li>
<li>I have no experience with it, so I’m reticent to try to manually set it up myself on a system I’m going to depend upon for daily use.</li>
<li>The features of Btrfs, while undeniably valuable, are still more in the “nice to have” category for me, whereas stability and reliability are in the “essential” category for me. (For example, I’ve learned to work around the lack of built-in data integrity checking in other file systems by keeping frequent full versioned backups.)</li>
</ul>
<p>I would be pleased to learn that one or all of these is no longer a problem and that Btrfs is ready for users like me. In that case, I hope it gains full support in the Qubes installer (perhaps even as the default option).</p>
          <p><a href="http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240/4</link>
        <pubDate>Tue, 06 Dec 2016 01:35:06 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3240-4</guid>
        <source url="http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240.rss">Qubes VM snapshots using git / SVN</source>
      </item>
      <item>
        <title>Qubes VM snapshots using git / SVN</title>
        <dc:creator><![CDATA[rustybird]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="2" data-topic="3240">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/e/8dc957/40.png" class="avatar"> entr0py:</div>
<blockquote>
<p>I remember reading that <a class="mention" href="http://forums.whonix.org/u/tasket">@tasket</a> has implemented something like this using btrfs or zfs. Maybe not version control - but just free clones.</p>
</blockquote>
</aside>
<p>The Qubes btrfs experience (instant free clones and whole filesystem snapshots, as well as block checksums protecting against silent data corruption) is so awesome that I’m always kind of surprised not everyone is setting up their system this way… Unless you’re very tight on disk space (it has tended to behave weirdly if there’s not enough free space at all times) I can’t recommend it enough.</p>
<p>You should be aware though that lately the Qubes installer has had this bug - you have to “unlock” the proper btrfs option first: <a href="https://github.com/QubesOS/qubes-issues/issues/2294#issuecomment-247438318" rel="nofollow noopener">https://github.com/QubesOS/qubes-issues/issues/2294#issuecomment-247438318</a></p>
          <p><a href="http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240/3</link>
        <pubDate>Mon, 05 Dec 2016 21:04:40 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3240-3</guid>
        <source url="http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240.rss">Qubes VM snapshots using git / SVN</source>
      </item>
      <item>
        <title>Qubes VM snapshots using git / SVN</title>
        <dc:creator><![CDATA[entr0py]]></dc:creator>
        <description><![CDATA[
            <p>This functionality would be very useful (and very geeky as you say).</p>
<p>However, I am not interested in pursuing until Qubes 4.0 since slowness &amp; disk space issues outweigh benefits to me currently. With COW filesystem (lvm-thin) in Qubes 4.0, snapshots would be awesome! I remember reading that <a class="mention" href="http://forums.whonix.org/u/tasket">@tasket</a> has implemented something like this using btrfs or zfs. Maybe not version control - but just free clones.</p>
          <p><a href="http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240/2</link>
        <pubDate>Mon, 05 Dec 2016 20:21:02 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3240-2</guid>
        <source url="http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240.rss">Qubes VM snapshots using git / SVN</source>
      </item>
      <item>
        <title>Qubes VM snapshots using git / SVN</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Quote <a href="https://www.whonix.org/wiki/Qubes/Disposable_VM">https://www.whonix.org/wiki/Qubes/Disposable_VM</a></p>
<blockquote>
<p>Qubes does not have a built-in snapshot capability like VirtualBox that<br>
can completely revert all changes back to a particular VM state.</p>
</blockquote>
<p>Probably not useful for most users since it is getting geeky but I hope I am wrong. However, may be interesting for advanced users…</p>
<p>I am using git to be able to revert back more than to the previous (not last) state of a template. Someone added a while ago <a href="https://www.whonix.org/wiki/Security_Guide#VM_Snapshots">here</a> a suggestion to SVN (when you click <code>expand</code>) since that as the contributor added works better than git for binary files such as VM images.</p>
<p>Git works but it is awfully slow on huge (any Qubes) VM images. But perhaps someone wants to discover / document git / SVN. Would also be interesting to find out if (much more modern and imo usable) git can be tweaked to become efficient on binary files. (We don’t have to share these images. Just looking for a hack to record / roll back to past template states.</p>
<p>(That is useful when <a href="https://github.com/QubesOS/qubes-issues/issues/2484">a Qubes upgrade bug breaks booting the template</a> or during development to test in-place upgrades.)</p>
          <p><a href="http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240/1</link>
        <pubDate>Mon, 05 Dec 2016 16:42:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3240-1</guid>
        <source url="http://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn/3240.rss">Qubes VM snapshots using git / SVN</source>
      </item>
  </channel>
</rss>

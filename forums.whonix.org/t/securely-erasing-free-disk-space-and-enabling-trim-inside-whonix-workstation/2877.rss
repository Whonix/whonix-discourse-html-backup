<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Securely erasing free disk space and enabling trim inside whonix workstation</title>
    <link>http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877</link>
    <description>I ran [photorec](http://www.cgsecurity.org/wiki/PhotoRec) file recovery software inside whonix workstation and I was suprised with the amount of files it could retrieve. 

Wanted to counter this by installing [scrub](https://github.com/chaos/scrub) and running it with `scrub -p fillzero -X dump` and `scrub -p dod -X dump` to no avail. I could still retrieve roughly the same amount of files then when I first ran photorec before &#39;scrubbing&#39; it. 

Now I think it&#39;s because it&#39;s an ssd drive but I never knew that scrubbing on an ssd drive didn&#39;t have any effect at all, is this normal? 

This leads me to believe that my only option to securely erase files in the free space of the ssd drive is to trim it. Only problem is I need to enable trim inside whonix workstation.

I have read the following article which states that there are certain prerequisites for enabling trim inside virtualbox. Such as the use of the VDI disk format. Unfortunately the default disk format of whonix is .vmdk.
https://superuser.com/questions/646559/virtualbox-and-ssds-trim-command-support

Is there a way to enable trim inside whonix workstation so it can securely erase the free space on the disk?</description>
    <language>en</language>
    <lastBuildDate>Tue, 23 Aug 2016 14:19:25 +0000</lastBuildDate>
    <category>Support</category>
    <atom:link href="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Securely erasing free disk space and enabling trim inside whonix workstation</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="6" data-topic="2877">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/u/a87d85/40.png" class="avatar"> Usernamer:</div>
<blockquote>
<p>Can I build the whonix release in .vdi?</p>
</blockquote>
</aside>
<p>Using the Whonix build script, yes.</p>
<p>For redistributable / downloadable images this will not be possible due to VirtualBox limitations. ( <a href="https://www.whonix.org/wiki/Dev/Virtualization_Platform#VirtualBox">https://www.whonix.org/wiki/Dev/Virtualization_Platform#VirtualBox</a> )</p>
<p>During Whonix build, first a vdi is created. That you could use. Later, when an ova (for redistribution purposes only) is created, unfortunately (!!!) VirtualBox creates an ova that includes a vmdk. And that is really awful. However, the ova format is much more practical for redistribution purposes.</p>
<p>For downloaded builds, it is possible (but not convenient) to convert the vmdk to vdi before starting to use Whonix.</p>
<p>Overview of the build process is in this very chapter:<br>
<a href="https://www.whonix.org/wiki/Dev/Source_Code_Intro#Introduction">https://www.whonix.org/wiki/Dev/Source_Code_Intro#Introduction</a></p>
<aside class="quote" data-post="6" data-topic="2877">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/u/a87d85/40.png" class="avatar"> Usernamer:</div>
<blockquote>
<p>It would be nice to have the complete whonix build process automated</p>
</blockquote>
</aside>
<p>Already is.</p>
<aside class="quote" data-post="6" data-topic="2877">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/u/a87d85/40.png" class="avatar"> Usernamer:</div>
<blockquote>
<p>easily editable with packer and ansible</p>
</blockquote>
</aside>
<p>That seems like quite some work.</p>
<aside class="quote" data-post="6" data-topic="2877">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/u/a87d85/40.png" class="avatar"> Usernamer:</div>
<blockquote>
<p>I could help with this, it’s a nice way to learn about all the individual whonix features and give back at the same time.</p>
</blockquote>
</aside>
<p>Please have a look how it is done currently. The Whonix build script can build VirtualBox, KVM and physical isolation builds. Also cli-only builds. Very configurable. Can also add custom scripts and whatnot. If you like to discuss this, please open a new thread in the Whonix development sub forum. Then let’s if you see any benefits of modifying this. Some stuff such as TravisCI automated builds would be desirable and help would be appreciated!</p>
<p><a href="https://www.whonix.org/wiki/Dev/Build_Documentation">https://www.whonix.org/wiki/Dev/Build_Documentation</a></p>
          <p><a href="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/8</link>
        <pubDate>Tue, 23 Aug 2016 14:19:25 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2877-8</guid>
        <source url="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877.rss">Securely erasing free disk space and enabling trim inside whonix workstation</source>
      </item>
      <item>
        <title>Securely erasing free disk space and enabling trim inside whonix workstation</title>
        <dc:creator><![CDATA[Usernamer]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="4" data-topic="2877">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Interesting. Though I don’t know thedetails about VBox’s storage implementation, we know that non emulated storage has dangerous consequences in KVM:</p>
</blockquote>
</aside>
<p>I am using the virtualbox version but did not know this, thanks.</p>
<aside class="quote" data-post="4" data-topic="2877">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>We also know that wear leveling techniques are mostly rubbish that won’t securely destroy sensitive data:<br>
<a href="https://archive.is/hxDac" rel="nofollow noopener">https://archive.is/hxDac</a></p>
</blockquote>
</aside>
<p>Yeah I have found out, it’s pretty bad. Good that I have tested this myself, now I know for sure.</p>
<aside class="quote" data-post="4" data-topic="2877">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Linux disables TRIM for encrypted installs by default because of several security consequences (reminder to add this on wiki)</p>
</blockquote>
</aside>
<p>That’s true, but you can manually enable it. I’m not concerned about the security consequences because I think it will be still hard to break the encryption even with a smaller surface to inspect.</p>
<aside class="quote" data-post="4" data-topic="2877">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Is this true for a fresh image?</p>
</blockquote>
</aside>
<p>I will have to find out, I’ll report back.</p>
<aside class="quote" data-post="4" data-topic="2877">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>What files can you recover? host files you deleted? guest files you deleted?</p>
</blockquote>
</aside>
<p>20gb of system files so I didn’t look at everything. But I did discover my own deleted btc wallets with private/public keys out of coincidence because of the sheer size of the dataset. This was surprising, I want to find out if I can restore the wallet with the info in the file. I use electrum.</p>
<p>I don’t think I discovered host files, but I don’t know, haven’t looked into it that much.</p>
<aside class="quote" data-post="4" data-topic="2877">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Do you get the same results when rolling back to a clean snapshot?</p>
</blockquote>
</aside>
<p>I’ll also have to test and report back.</p>
          <p><a href="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/7</link>
        <pubDate>Tue, 23 Aug 2016 11:32:03 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2877-7</guid>
        <source url="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877.rss">Securely erasing free disk space and enabling trim inside whonix workstation</source>
      </item>
      <item>
        <title>Securely erasing free disk space and enabling trim inside whonix workstation</title>
        <dc:creator><![CDATA[Usernamer]]></dc:creator>
        <description><![CDATA[
            <p>I understand this, I have also encrypted the host but I am curious about trim in Whonix on a ssd drive specifically. As far as I have discovered the only thing that’s not making this possible is because the disk is released in .vmdk format and not in .vdi.</p>
<p>Can I build the whonix release in .vdi? How did you automate the installation of all the whonix features? Shell scripts? It would be nice to have the complete whonix build process automated and easily editable with <a href="https://www.packer.io/" rel="nofollow noopener">packer</a> and <a href="https://www.ansible.com/" rel="nofollow noopener">ansible</a>. I could help with this, it’s a nice way to learn about all the individual whonix features and give back at the same time.</p>
<p>Besides this I guess for now the only way to securely delete the data inside whonix is to start fresh. Snapshots is a good idea for this.</p>
          <p><a href="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/6</link>
        <pubDate>Tue, 23 Aug 2016 11:18:55 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2877-6</guid>
        <source url="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877.rss">Securely erasing free disk space and enabling trim inside whonix workstation</source>
      </item>
      <item>
        <title>Securely erasing free disk space and enabling trim inside whonix workstation</title>
        <dc:creator><![CDATA[Usernamer]]></dc:creator>
        <description><![CDATA[
            <p>I know, but my problem is about the vmdk disk file format in which whonix is released.</p>
          <p><a href="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/5</link>
        <pubDate>Tue, 23 Aug 2016 11:11:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2877-5</guid>
        <source url="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877.rss">Securely erasing free disk space and enabling trim inside whonix workstation</source>
      </item>
      <item>
        <title>Securely erasing free disk space and enabling trim inside whonix workstation</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p><a class="mention" href="http://forums.whonix.org/u/usernamer">@Usernamer</a></p>
<p>Interesting. Though I don’t know thedetails about VBox’s storage implementation, we know that non emulated storage has dangerous consequences in KVM:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/KVM#LVM_Storage" target="_blank" rel="nofollow noopener">Whonix</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/218;"><img src="https://www.whonix.org/w/images/b/be/234234234236kvm.png" class="thumbnail"></div>

<h3><a href="https://www.whonix.org/wiki/KVM#LVM_Storage" target="_blank" rel="nofollow noopener">KVM</a></h3>

<p>Using Whonix with KVM instead of VirtualBox</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>We also know that wear leveling techniques are mostly rubbish that won’t securely destroy sensitive data:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.google.com/s2/favicons?domain=www.infosecisland.com" class="site-icon" width="16" height="16">
      <a href="https://archive.is/hxDac" target="_blank" title="10:11PM - 10 June 2014" rel="nofollow noopener">archive.is – 10 Jun 14</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:666/500;"><img src="https://archive.is/hxDac/7f4dd13934799d220951fcfc0925fd806e33350a/scr.png" class="thumbnail"></div>

<h3><a href="https://archive.is/hxDac" target="_blank" rel="nofollow noopener">Data Remains on USB and SSDs After Secure Erase</a></h3>

<p>archived 10 Jun 2014 22:11:35 UTC</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Linux disables TRIM for encrypted installs by default because of several security consequences (reminder to add this on wiki)</p>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="https://askubuntu.com/questions/115823/trim-on-an-encrypted-ssd/115850#115850" target="_blank" rel="nofollow noopener">askubuntu.com</a>
  </header>
  <article class="onebox-body">
      <a href="https://askubuntu.com/users/6969/lekensteyn" target="_blank" rel="nofollow noopener">
    <img alt="Lekensteyn" src="https://www.gravatar.com/avatar/285b1f0f4caadc088a38c40aea22feba?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="128" height="128">
  </a>
<h4>
  <a href="https://askubuntu.com/questions/115823/trim-on-an-encrypted-ssd/115850#115850" target="_blank" rel="nofollow noopener">TRIM on an encrypted SSD</a>
</h4>

<div class="tags">
  <strong>encryption, ssd, trim</strong>
</div>

<div class="date">
  
  answered by
  <a href="https://askubuntu.com/users/6969/lekensteyn" target="_blank" rel="nofollow noopener">
    Lekensteyn
  </a>
  on <a href="https://askubuntu.com/questions/115823/trim-on-an-encrypted-ssd/115850#115850" target="_blank" rel="nofollow noopener">09:50AM - 25 Mar 12</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>“WARNING: There are several security consequences, please read at least <a href="http://asalor.blogspot.com/2011/08/trim-dm-crypt-problems.html">http://asalor.blogspot.com/2011/08/trim-dm-crypt-problems.html</a> before you enable it.”</p>
<hr>
<p>As to whether data on the encrypted host (on SSD) can leak into a virtual disk or vice versa - I don’t know. This is a good question and if you stick around and run some tests we can answer this.</p>
<p>The virtual disk should be able to control the low level view of blocks available to the guest.</p>
<blockquote>
<p>I ran photorec file recovery software inside whonix workstation and I was suprised with the amount of files it could retrieve.</p>
</blockquote>
<ul>
<li>Is this true for a fresh image?</li>
<li>What files can you recover? host files you deleted? guest files you deleted?</li>
<li>Do you get the same results when rolling back to a clean snapshot?</li>
</ul>
<p>What host are you using? If you are on Linux is it encrypted? Are you willing to test on a Linux system?</p>
          <p><a href="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/4</link>
        <pubDate>Mon, 22 Aug 2016 13:51:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2877-4</guid>
        <source url="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877.rss">Securely erasing free disk space and enabling trim inside whonix workstation</source>
      </item>
      <item>
        <title>Securely erasing free disk space and enabling trim inside whonix workstation</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p><a href="https://www.whonix.org/wiki/Warning#Whonix_is_not_amnesic">https://www.whonix.org/wiki/Warning#Whonix_is_not_amnesic</a></p>
<p><a href="https://www.whonix.org/wiki/FAQ#Is_there_a_substitute_for_Whonix.27s_lack_of_an_Amnesic_feature_.2F_Live_CD.2FDVD.3F_Forensics.3F">https://www.whonix.org/wiki/FAQ#Is_there_a_substitute_for_Whonix.27s_lack_of_an_Amnesic_feature_.2F_Live_CD.2FDVD.3F_Forensics.3F</a></p>
          <p><a href="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/3</link>
        <pubDate>Mon, 22 Aug 2016 12:25:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2877-3</guid>
        <source url="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877.rss">Securely erasing free disk space and enabling trim inside whonix workstation</source>
      </item>
      <item>
        <title>Securely erasing free disk space and enabling trim inside whonix workstation</title>
        <dc:creator><![CDATA[Ego]]></dc:creator>
        <description><![CDATA[
            <p>Good day,</p>
<p>Usually, the same which would apply to a Debian based VM applies to Whonix in this case.</p>
<p>Have a nice day,</p>
<p>Ego</p>
          <p><a href="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/2</link>
        <pubDate>Mon, 22 Aug 2016 11:02:34 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2877-2</guid>
        <source url="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877.rss">Securely erasing free disk space and enabling trim inside whonix workstation</source>
      </item>
      <item>
        <title>Securely erasing free disk space and enabling trim inside whonix workstation</title>
        <dc:creator><![CDATA[Usernamer]]></dc:creator>
        <description><![CDATA[
            <p>I ran <a href="http://www.cgsecurity.org/wiki/PhotoRec" rel="nofollow noopener">photorec</a> file recovery software inside whonix workstation and I was suprised with the amount of files it could retrieve.</p>
<p>Wanted to counter this by installing <a href="https://github.com/chaos/scrub" rel="nofollow noopener">scrub</a> and running it with <code>scrub -p fillzero -X dump</code> and <code>scrub -p dod -X dump</code> to no avail. I could still retrieve roughly the same amount of files then when I first ran photorec before ‘scrubbing’ it.</p>
<p>Now I think it’s because it’s an ssd drive but I never knew that scrubbing on an ssd drive didn’t have any effect at all, is this normal?</p>
<p>This leads me to believe that my only option to securely erase files in the free space of the ssd drive is to trim it. Only problem is I need to enable trim inside whonix workstation.</p>
<p>I have read the following article which states that there are certain prerequisites for enabling trim inside virtualbox. Such as the use of the VDI disk format. Unfortunately the default disk format of whonix is .vmdk.<br>
</p><aside class="onebox stackexchange">
  <header class="source">
      <a href="https://superuser.com/questions/646559/virtualbox-and-ssds-trim-command-support" target="_blank" rel="nofollow noopener">superuser.com</a>
  </header>
  <article class="onebox-body">
      <a href="https://superuser.com/users/26302/qlf00n" target="_blank" rel="nofollow noopener">
    <img alt="qlf00n" src="https://i.stack.imgur.com/cnf0K.jpg?s=128&amp;g=1" class="thumbnail onebox-avatar" width="128" height="128">
  </a>
<h4>
  <a href="https://superuser.com/questions/646559/virtualbox-and-ssds-trim-command-support" target="_blank" rel="nofollow noopener">VirtualBox and SSD's TRIM command support</a>
</h4>

<div class="tags">
  <strong>virtualbox, virtual-machine, ssd, trim</strong>
</div>

<div class="date">
  asked by
  
  <a href="https://superuser.com/users/26302/qlf00n" target="_blank" rel="nofollow noopener">
    qlf00n
  </a>
  on <a href="https://superuser.com/questions/646559/virtualbox-and-ssds-trim-command-support" target="_blank" rel="nofollow noopener">02:28PM - 17 Sep 13</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<p></p>
<p>Is there a way to enable trim inside whonix workstation so it can securely erase the free space on the disk?</p>
          <p><a href="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877/1</link>
        <pubDate>Mon, 22 Aug 2016 06:42:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2877-1</guid>
        <source url="http://forums.whonix.org/t/securely-erasing-free-disk-space-and-enabling-trim-inside-whonix-workstation/2877.rss">Securely erasing free disk space and enabling trim inside whonix workstation</source>
      </item>
  </channel>
</rss>

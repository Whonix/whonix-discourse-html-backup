<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Connecting another virtual machine to the same NAT subnet of the Whonix gateway (Whonix External) - KVM - Whonix Forum</title>
    <meta name="description" content="Hello. Can I connect another virtual machine to the same NAT subnet of the Whonix Gateway (Whonix External)? 
I have a proxy client on the host that Whonix Gateway connects to through socks5, and then it is already trans&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="90524658.html?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Connecting another virtual machine to the same NAT subnet of the Whonix gateway (Whonix External)&#39;" href="9052.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/connecting-another-virtual-machine-to-the-same-nat-subnet-of-the-whonix-gateway-whonix-external/9052?page=2" />
<meta name="twitter:url" content="https://forums.whonix.org/t/connecting-another-virtual-machine-to-the-same-nat-subnet-of-the-whonix-gateway-whonix-external/9052?page=2" />
<meta property="og:title" content="Connecting another virtual machine to the same NAT subnet of the Whonix gateway (Whonix External)" />
<meta name="twitter:title" content="Connecting another virtual machine to the same NAT subnet of the Whonix gateway (Whonix External)" />
<meta property="og:description" content="If in ProxyVM for eth1, specify:  address 10.152.152.8 netmask 255.255.192.0  And for Whonix Gateway for eth0  address 10.152.152.9 netmask 255.255.192.0 gateway 10.152.152.8  The Whonix gateway is running, and the Whonix workstation is losing contact with the Whonix gateway. Therefore, the calculation of the interface parameters in the downstream direction is incorrect.  When changing the IP address for the Whonix gateway (eth0 interface) and (eth1) ProxyVM to a different value. I was able to ..." />
<meta name="twitter:description" content="If in ProxyVM for eth1, specify:  address 10.152.152.8 netmask 255.255.192.0  And for Whonix Gateway for eth0  address 10.152.152.9 netmask 255.255.192.0 gateway 10.152.152.8  The Whonix gateway is running, and the Whonix workstation is losing contact with the Whonix gateway. Therefore, the calculation of the interface parameters in the downstream direction is incorrect.  When changing the IP address for the Whonix gateway (eth0 interface) and (eth1) ProxyVM to a different value. I was able to ..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="12 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="7 ‚ù§" />
<meta property="article:published_time" content="2020-03-05T18:36:16+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="9052.html">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="9052.html">Connecting another virtual machine to the same NAT subnet of the Whonix gateway (Whonix External)</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/kvm/11.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #9EB83B'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>KVM</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/kelman'><span itemprop='name'>kelman</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9052.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-05T18:36:16Z' class='post-time'>
                March 5, 2020,  6:36pm
              </time>
              <meta itemprop='dateModified' content='2020-03-05T18:58:36Z'>
          <span itemprop='position'>#21</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-username="Patrick" data-post="12" data-topic="9052">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<blockquote>
<p>What IP address and NetMask should I assign for the virbr2 interface? Which is used as eth1 for ProxyVM and eth0 for Whonix Gatewa</p>
</blockquote>
<p>Not sure. Haven‚Äôt thought much about that yet.</p>
<p>In theory, but not good idea:</p>
<ul>
<li>Gateway internal IP is 10.152.152.10 / netmask 255.255.192.0</li>
<li>Workstation internal IP is 10.152.152.11 / netmask 255.255.192.0</li>
</ul>
<p>I guess since multiple <a href="../../../external.html?link=https://www.whonix.org/wiki/Multiple_Whonix-Workstations" rel="nofollow noopener">workstations</a> are counted upwards <code>10.152.152.11</code> , <code>10.152.152.12</code> etc in documentation it might make sense to count gateway after Whonix-Gateway downwards. Maybe <code>10.152.152.09</code> .</p>
<p>On the other hand it might make much more sense (less likely to have leaks) to use a different netmask.</p>
<p>Whonix-Gateway as per Whonix default:</p>
<p>eth0<br>
address 10.0.2.15<br>
netmask 255.255.255.0<br>
gateway 10.0.2.2</p>
<p>eth1<br>
address 10.152.152.10<br>
netmask 255.255.192.0</p>
<p>As you can see, eth0 and eth1 are using a different netmask.</p>
<p>Therefore Whonix-Gateway eth0 settings should be changed. Set to use any different address/netmask that works. Probably not using a <code>gateway</code> setting in file <code>/etc/network/interfaces.d/30_non-qubes-whonix</code> . (Whonix-Gateway would be ‚Äúmore similar to a workstation‚Äù.)</p>
<p>Proxy-Gateway eth0 should use (what Whonix-Gateway is now using for eth0):</p>
<p>eth0<br>
address 10.0.2.15<br>
netmask 255.255.255.0<br>
gateway 10.0.2.2</p>
<p>Proxy-Gateway eth1 could use anything that works (but probably using netmask 255.255.192.0 / 255.255.255.0) to be able to communicate with to Whonix-Gateway eth1.</p>
</blockquote>
</aside>
<p>If in ProxyVM for eth1, specify:</p>
<pre><code>address 10.152.152.8
netmask 255.255.192.0
</code></pre>
<p>And for Whonix Gateway for eth0</p>
<pre><code>address 10.152.152.9
netmask 255.255.192.0
gateway 10.152.152.8
</code></pre>
<p>The Whonix gateway is running, and the Whonix workstation is losing contact with the Whonix gateway. Therefore, the calculation of the interface parameters in the downstream direction is incorrect.</p>
<p>When changing the IP address for the Whonix gateway (eth0 interface) and (eth1) ProxyVM to a different value. I was able to establish a connection on a Whonix workstation.</p>
<p>My interfaces settings for ProxyVm:</p>
<pre><code>auto lo
iface lo inet loopback

allow-hotplug eth0
iface eth0 inet static
        address 10.0.2.15/24
        netmask 255.255.255.0
        gateway 10.0.2.2

allow-hotplug eth1
iface eth1 inet static
        address 10.10.10.10
        netmask 255.255.255.0
</code></pre>
<p>And for Whonix Gateway these are:</p>
<pre><code>auto lo
iface lo inet loopback

auto eth0
iface eth0 inet static
        address 10.10.10.11
        netmask 255.255.255.0
        gateway 10.10.10.10

auto eth1
iface eth1 inet static
       address 10.152.152.10
       netmask 255.255.192.0
</code></pre>
<p>In this configure, I have a stable connection. Can I leave it like that? I also changed NetMask to 255.255.255.0, as <a class="mention" href="../../../external.html?link=https://forums.whonix.org/u/patrick">@Patrick</a> said it is better to use a different mask to have less leaks.</p>
        </div>

        <meta itemprop='headline' content='Connecting another virtual machine to the same NAT subnet of the Whonix gateway (Whonix External)'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9052.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-06T19:58:25Z' class='post-time'>
                March 6, 2020,  7:58pm
              </time>
              <meta itemprop='dateModified' content='2020-03-06T19:58:25Z'>
          <span itemprop='position'>#22</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="kelman" data-post="20" data-topic="9052">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/k/3ec8ea/40.png" class="avatar"> kelman:</div>
<blockquote>
<p>Perhaps we are talking about different things. For me, NAT by default is the network that is automatically created when installing libvirt qemu-kvm bridge-utils.</p>
</blockquote>
</aside>
<p>Exactly what I mean.</p>
        </div>

        <meta itemprop='headline' content='Connecting another virtual machine to the same NAT subnet of the Whonix gateway (Whonix External)'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="9052.html">‚Üê previous page</a></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

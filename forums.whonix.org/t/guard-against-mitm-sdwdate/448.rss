<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Guard against MITM sdwdate</title>
    <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448</link>
    <description>[b]Facts:[/b]

-sdwdate is as safe as the trust put into centralized TLS CA authorities. 
-This is by no means a sdwdate specific problem but an outcome of a broken CA model that has haunted the internet for years.

-Viable solutions suggested by the cryptographer community is decentralized WoT notary system like the Perspectives Project which track SSL cert usage over time independently and verify its authenticity thru consensus.

-The Perspectives Project is a product of the academic community at Carnegie mellon university and an inspiration to the convergence.io experiment run briefly by m0xie for trustworthy CA drop in replacements.

-Perspectives consists of a server and a Firefox addon as a client which is problematic for our implementation purposes for directing its usage by sdwdate for certificate verification of the servers it communicates with.

-No matter there is a clever workaround of using a python clientside script that listens on localhost to perform queries on behalf of other programs to the community run Perspectives notary servers.
The idea was conceived as a workaround for browsers that had not yet been supported by Perspectives.
http://perspectives-project.org/2011/07/08/perproxy-ubuntu-chrome/
https://github.com/von/PerProxy

[b]Recommendation:[/b]
Adoption of this measure potentially strengthens sdwdate against TLS MITM attacks considerably. Its an important topic also best discussed with projects that have a shared interest in such time sync systems.</description>
    <language>en</language>
    <lastBuildDate>Wed, 10 Sep 2014 01:19:40 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Posted it on git to keep things from being buried here.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/39">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/39</link>
        <pubDate>Wed, 10 Sep 2014 01:19:40 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-39</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <blockquote>It would be useful to understand why Tails' tordate is fingerprintable - because when Tails starts while the clock is too much off, it sets system clock to what tordate thinks, then restarts Tor and re-downloads the consensus.</blockquote>
<p>Right this is a signalling pattern that is being fingerprinted.</p>
<p>Tor’s failed connection attempt because time on the guest is virtually frozen at that moment during a suspend because a guest by design cannot know anything about host power events.</p>
<p>The solution:</p>
<p>Have some way, for example Systemd, or something similar if Debian stable doesn’t have it yet, constantly monitor the Tor process’ connection, and if it detects any drops, it would block Tor from reconnection attempts until sdwdate fetches a fresh valid consensus and sets the time appropiately.</p>
<p>The drop in our usecase, will be caused by suspending or shutting down the machine.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/38">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/38</link>
        <pubDate>Wed, 10 Sep 2014 00:58:44 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-38</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <blockquote>1) Are you still up to do the older Tails-only specific proposal https://www.whonix.org/forum/index.php/topic,470.msg3880.html#msg3880?
2) Would it be possible be make this new one (anondate + HS route) a Tails-only specific proposal? Would you be up for this as well?
3) Can we prepare a post for tor-talk to ask as Whonix-agnostic-as-possible "extract time from Hidden Service Descriptors" question about if https://github.com/Whonix/Whonix/issues/318 could work as imagined and if it would be sane?
4) Can we prepare a question for tor-talk to ask as Whonix-agnostic-as-possible how (not) bad it would be to use an up to ~18 hours old Tor consensus.?</blockquote>
<ol>
<li>No I have improved it considerably after that time.</li>
<li>Sure. This is my plan to have something better that we can both benefit from. I am up for writing a proposal here first which you can vet and I post. I am almost done addressing the few quirks you brought up.</li>
<li>Yes its important this is discussed with them too. I will write something/clean up what I wrote there and ask them.</li>
<li>Yes that too.</li>
</ol>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/37">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/37</link>
        <pubDate>Wed, 10 Sep 2014 00:36:23 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-37</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Off-topic:<br>
I would like to make the scope of one thread as narrow as possible to prevent muddling up too many points and forgetting about something. Opened two topics related to NTP.</p>
<ul>
<li><a href="https://www.whonix.org/forum/index.php/topic,511.0.html">https://www.whonix.org/forum/index.php/topic,511.0.html</a></li>
<li><a href="https://www.whonix.org/forum/index.php/topic,512.0.html">https://www.whonix.org/forum/index.php/topic,512.0.html</a></li>
</ul>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/36">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/36</link>
        <pubDate>Tue, 09 Sep 2014 20:49:51 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-36</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Please keep working on this. But it seems there is quite a lot more to do.</p>
<aside class="quote" data-post="34" data-topic="448">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>It should be safe to go down the anondate + HS route.</p>
</blockquote>
</aside>
<p>We need some more opinions about how (not) bad it would be to use an up to ~18 hours old Tor consensus. And more.</p>
<p>Roadmap:</p>
<ol>
<li>Are you still up to do the older Tails-only specific proposal <a href="https://www.whonix.org/forum/index.php/topic,470.msg3880.html#msg3880">https://www.whonix.org/forum/index.php/topic,470.msg3880.html#msg3880</a>?</li>
<li>Would it be possible be make this new one (anondate + HS route) a Tails-only specific proposal? Would you be up for this as well?</li>
<li>Can we prepare a post for tor-talk to ask as Whonix-agnostic-as-possible “extract time from Hidden Service Descriptors” question about if <a href="https://github.com/Whonix/Whonix/issues/318">https://github.com/Whonix/Whonix/issues/318</a> could work as imagined and if it would be sane?</li>
<li>Can we prepare a question for tor-talk to ask as Whonix-agnostic-as-possible how (not) bad it would be to use an up to ~18 hours old Tor consensus.?</li>
</ol>
<blockquote>It wasn't an unusual reaction that could be fingerprinted after all.</blockquote>
It would be useful to understand why Tails' tordate is fingerprintable - because when Tails starts while the clock is too much off, it sets system clock to what tordate thinks, then restarts Tor and re-downloads the consensus.
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/35">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/35</link>
        <pubDate>Tue, 09 Sep 2014 18:08:20 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-35</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <blockquote> Does Tor download consensus data regularly after first use?
 yes
 arma: Does using verified consensus mean that replay attacks are not possible?
 your clock has to be somewhat right. in that case yes.
 ok ty</blockquote>
<p>It should be safe to go down the anondate + HS route. It wasn’t an unusual reaction that could be fingerprinted after all.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/34">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/34</link>
        <pubDate>Tue, 09 Sep 2014 11:54:16 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-34</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>This needs research, but it may turn out that Tor clients regularly download consensus data from the Directory authorities.</p>
<p>That would make it an okay approach: set an acceptable time for Tor to connect from verified consensus, then adjust it to me more accurate using HS Descriptors.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/33">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/33</link>
        <pubDate>Tue, 09 Sep 2014 11:46:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-33</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p><span class="bbcode-b">Edit:</span> corrected page number</p>
<p>We should discourage users from running NTP on the host because at best it <a href="http://caia.swin.edu.au/talks/CAIA-TALK-080728A.pdf" data-bbcode="true">leaks the host’s time itself through timestamps</a> (page 3) and at worst its a vehicle for remotely exploiting the client’s code and skewing time which could deny Tor service.</p>
<blockquote>We should probably combine consensus with the more accurate Hidden descriptors and use them instead of CA SSL, on both gateway and workstation.</blockquote>
<p>I will backtrack from that position once more:</p>
<p>-when not using kvmclock on the gateway and the gateway clock incorrect after suspend, the only viable option is to fetch a verified consensus in the clear and set from that because Tor logically wouldn’t be able to connect in this situation.</p>
<p>-By setting sdwate to use only verified consensus we make it safe to fetch the data in the clear meaning that not even replay attacks are possible from the ISP. (SSL and Directory Authority keys make it impossible as you brought up).</p>
<p>-The only problem with this approach is the fingeprintable nature of it, because sdwdate would need to do this on a regular basis if the user suspends their machine.</p>
<hr>
<ul>
<li>Because its better and safer to disable NTP on the host, setting the gateway to use kvmclock instead and avoiding sdwdate on the gateway should improve things in a way.</li>
</ul>
<p>tl;dr</p>
<p>A secure but fingerprinted technique to start Tor because we aren’t using kvmclock vs. using kvmclock and disabling NTP - which isn’t so bad because of the potential cons of keeping it running.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/32">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/32</link>
        <pubDate>Tue, 09 Sep 2014 11:39:36 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-32</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>We should probably combine consensus with the more accurate Hidden descriptors and use them instead of CA SSL, on both gateway and workstation.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/31">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/31</link>
        <pubDate>Tue, 09 Sep 2014 01:59:19 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-31</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <blockquote>So if Tor when not using a bridge and/or python-stem [as a torified application] uses SSL to download the consensus, replay attacks aren't possible. And since Tor doesn't use CA's, downloading it multiple times seems not justified. What do you think?</blockquote>
<p>Yes that is the logical conclusion.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/30">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/30</link>
        <pubDate>Tue, 09 Sep 2014 01:50:16 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-30</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>I was likely wrong about something.</p>
<p>You wrote:</p>
<blockquote>Multiple fetches over different exits are a good idea as a way to guard against malicious exit IPs and to have a consensus on what the consensus should look like.</blockquote>
<p>Tails design:</p>
<blockquote>If not using a bridge: Tails starts without a cached consensus, so its Tor client starts by connecting directly to a directory authority (and not to a directory mirror / entry guard), so feeding you an old consensus requires the attacker either to break SSL, or to control the directory authority your Tor client connects to.</blockquote>
<p>So if Tor when not using a bridge and/or python-stem [as a torified application] uses SSL to download the consensus, replay attacks aren’t possible. And since Tor doesn’t use CA’s, downloading it multiple times seems not justified. What do you think?</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/29">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/29</link>
        <pubDate>Mon, 08 Sep 2014 23:43:15 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-29</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Sounds good. I’ll do it later when I have the idea on the best approach for this figured out. Its not quite there yet, but keep an eye on this.</p>
<p>After how much the TAILS devs contributed to us as you mention, I would like to give back something to them.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/28">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/28</link>
        <pubDate>Mon, 08 Sep 2014 23:11:55 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-28</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <blockquote>Actually you know what I think that anondate makes sense only on the workstation.</blockquote>
No sdwdate on workstation -&gt; using anondate -&gt; end up with a Whonix specific web fingerprintint (Tor Browser / javascript leaks it).
<blockquote>the gateway doesn't need sdwdate/anondate.
<p>No danger in using the Host’s time. If we decide to allow it to read the host’s wall clock, then no gateway restart will even be needed because time is always synced and not allowed to drift.</p>
</blockquote><br>
No sdwdate on the gateway and using host time -&gt; host time could be forged -&gt; could end up using an up to ~7 days old consensus
<p>[hr]</p>
<p>Please move Whonix host time discussion into a separate thread or things get muddled up here.</p>
<p>[hr]</p>
<p>Either I am confused or somehow still not convinced this is a good idea. Maybe we’ll figure out.</p>
<p>But what about this… It can be done in parallel to this discussion…<br>
Whonix sdwdate and Tails htpdate are not much different in this regard.<br>
Neither are Whonix anondate or Tails tordate.<br>
So could you wipe any reference to Whonix and/or VMs from your proposal? Completely forget about Whonix for a moment? Think like a Tails dev? Then propose this to Tails developers?<br>
Before doing some grave design change as this, it would be useful to read their opinion so or so.<br>
And with a Tails specific proposal for improvement, they may think this through as well, so we’re not overlooking something.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/27">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/27</link>
        <pubDate>Mon, 08 Sep 2014 13:06:54 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-27</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <blockquote>[quote]
<pre><code>Also this does not take into account "security discussion" from Tails Time synching design:
https://tails.boum.org/contribute/design/Time_syncing/#index1h2

In essence, without sdwdate, both bridge/non-bridge users could be tricked into using an up to ~7 days old Tor consensus.[/quote]
</code></pre>
<p>We are not using anondate on the gateway so I would say this attack is not really relevant to Whonix specifically. A malicious bridge is a problem for any Tor user. This changes the discussion from : setting time on the workstation in a secure manner, to: How do we protect against a malicious bridge?</p>
<p>An interesting problem but another one entirely</p>
</blockquote>
<p>Actually this is very interesting problem. if anything, whonix is in a unique position to provide more protection against a malicious bridge than any one level anonymity platform can. Now I would modify the proposal to include anondate on Whonix gateway, not as a way to set time, but as a sanity check for consensus data fetched from a bridge. it would fetch its data over Tor of course.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/26">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/26</link>
        <pubDate>Mon, 08 Sep 2014 12:51:12 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-26</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <blockquote>Also this does not take into account "security discussion" from Tails Time synching design:
https://tails.boum.org/contribute/design/Time_syncing/#index1h2
<p>In essence, without sdwdate, both bridge/non-bridge users could be tricked into using an up to ~7 days old Tor consensus.</p>
</blockquote>
<p>We are not using anondate on the gateway so I would say this attack is not really relevant to Whonix specifically. A malicious bridge is a problem for any Tor user. This changes the discussion from : setting time on the workstation in a secure manner, to: How do we protect against a malicious bridge?</p>
<p>An interesting problem but another one entirely</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/25">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/25</link>
        <pubDate>Mon, 08 Sep 2014 12:44:55 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-25</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <blockquote>Off-topic: I am interested to move discussions to the next level. Many comments are just questions, that aren't clear in the original proposal. Or something is missing the the original proposal, that can be fixed. So I was wondering, if one (me) could make some comments, and then you improve the original proposal. If these comments are covered and no dissent, the previous discussion can be deleted.</blockquote>
<p>Thank you for being open-minded about this and willing to hear more. The only reason I’ve reopened this discussion is I’m confident that there is something new on this. I will re-post the last conclusion i reached and start speaking from that position:</p>
<blockquote>Actually you know what I think that anondate makes sense only on the workstation. the gateway doesn't need sdwdate/anondate. Sorry for the confusion, I'm sharing my thoughts as they develop. There are two main points being discussed.
<pre><code>anondate (can be safely used as the only trusted source) making it a great backstop in the event there is something on the workstation leaking timestamps and also on the host doing that as well. The security pitfalls of using it in the previous design, are avoided by rethinking how and on which vm its used on.

The gateway isn't leaking anything by using only the host's time to bootstrap off of as recommended. No danger in using the Host's time. If we decide to allow it to read the host's wall clock, then no gateway restart will even be needed because time is always synced and not allowed to drift. anondate or any form of timesyncing would not be needed on the gateway anymore. And the only place where it being used (the workstation) will have a trusted source with fresh data being fetched at all times with none of the fingerprinting or stale data attack implications that sending requests in the clear entailed: like the gateway design problems you pointed out before.&lt;/blockquote&gt;
</code></pre>
<hr>
<blockquote>user &lt;-&gt; Tor network &lt;-&gt; Tor exit &lt;-&gt; ISP of Tor exit &lt;-&gt; ISP of destination server &lt;-&gt; destination server</blockquote>
<blockquote>If you keep changing Tor exit's, you make a mitm only less likely for a fraction of that route. Marking the by:</blockquote>
<p>Alright so in the situation that anondate is depended on for use in just the workstation, the damage the attacker can do by feeding outdated consensus is limited to getting a false time. It would not affect or deny service to the gateway in any form.</p>
<p>As in the current model of the sdwdate, getting a consensus on the consensus data (pardon the pun) curbs the damage an attacker does, because a certain time interval is not used unless, say, some number of requests X out of Y total to a Directory Authority agrees.</p>
<p>Come to think of it, these traffic requests by anondate are actually not distinguishable any more from any Tor client out there.</p>
<p>The fact that the gateway is using accurate host time, means that no problems with connections to the Hidden Service server will happen.</p>
<blockquote>By the way, don't trash sdwdate too fast. When we implement a host operating system or Whonix host additions (https://github.com/Whonix/Whonix/issues/39), we're back at the question on how to safely replace unauthenticated NTP. Not sure how much this changes your proposal.</blockquote>
<p>I’m sorry if I had given you that impression. It is not my intention to trash it and given the amount of effort you’ve taken in designing and maintaining it, I should have made that more clear in my comments. I am examining the current Whonix design in light of recent developments (for example disabled Timestamps) and what they allow us to improve.</p>
<blockquote>Set clock from verified Tor consensus only or also from unverified Tor consensus?
<p>When only using verified Tor consensus, there is only a limited amount of replay attacks a mitm could do. Because only a limited amount of Tor consensus that have ever been signed.</p>
</blockquote>
<p>Verified only, there is no reason to do otherwise.</p>
<blockquote>How many different verified Tor consensus documents has a mitm at it's disposal? It's renewed every few hours and replaying is possible for months. And each consensus contains different date/time. I am wondering what would happen if a mitm in position of the directory authority's ISP would make a different replay attack (sending a different version of Tor consensus) for each and every request. If that could be used to single out users somehow.</blockquote>
<p>We can use a sample size of 5-10, or something similar to the number of requests sdwdate makes at the moment. They may differ but there is a certain widely agreed upon range at any given time. We can calibrate against this range and set it somewhere in the middle of the average of all values fetched. The solution to avoiding bad ISPs is to diversify connection to Directory Authorities through different circuits/exit nodes.</p>
<p>For your Whonix Host implementation, its best to ship it with NTP disabled and no time syncing mechanism. No before you dismiss it, here’s why:</p>
<ul>
<li>
<p>Computer BIOSs keep track of time across reboots by having their own internal clock. That allows all computers to keep track of time across reboots instead of resetting them.</p>
</li>
<li>
<p>A timesyncing mechanism is not really needed. All we care about is that the host time is set roughly accurate enough (manually if needed) to enable Tor to connect.</p>
</li>
<li>
<p>A time syncing mechanism on the host entails a risk of remote attack if its using anything.</p>
</li>
<li>
<p>anondate on the host is not needed and would probably have more cons than pros: allowing a local ISP-level adversary to influence time.</p>
</li>
<li>
<p>Consider this situation: Whonix Host is being used to communicate with the clearnet and a user runs software with some obscure protocol that leaks time on the Host and in the workstation. here’s what happens if we have Whonix vms setup in a (Whonix host no timesync &amp; NTP disabled, gateway uses kvmclock, workstation uses anondate):</p>
</li>
</ul>
<ol>
<li>
<p>The gateway can connect to Tor with no problems. It doesn’t leak anything and so it doesn’t need a timesyncing mechanism.</p>
</li>
<li>
<p>Anondate on the workstation prevents a user from shooting themselves in the foot when running software in the manner discussed above as the Guest’s time is set differently than the host’s</p>
</li>
<li>
<p>From Whonix Host perspective: No denial of service attack on Tor due to an outdated consensus fed, no preplay attacks either. No remote exploit of any timesyncing client whether secure or not.</p>
</li>
</ol>
</blockquote>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/24">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/24</link>
        <pubDate>Mon, 08 Sep 2014 12:40:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-24</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Also this does not take into account “security discussion” from Tails Time synching design:<br>
<a href="https://tails.boum.org/contribute/design/Time_syncing/#index1h2" class="onebox" target="_blank">https://tails.boum.org/contribute/design/Time_syncing/#index1h2</a></p>
<p>In essence, without sdwdate, both bridge/non-bridge users could be tricked into using an up to ~7 days old Tor consensus.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/23">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/23</link>
        <pubDate>Mon, 08 Sep 2014 12:35:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-23</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>By the way, don’t trash sdwdate too fast. When we implement a host operating system or Whonix host additions (<a href="https://github.com/Whonix/Whonix/issues/39">https://github.com/Whonix/Whonix/issues/39</a>), we’re back at the question on how to safely replace unauthenticated NTP. Not sure how much this changes your proposal.</p>
<p>[hr]</p>
<p>Set clock from verified Tor consensus only or also from unverified Tor consensus?</p>
<p>When only using verified Tor consensus, there is only a limited amount of replay attacks a mitm could do. Because only a limited amount of Tor consensus that have ever been signed.</p>
<p>How many different verified Tor consensus documents has a mitm at it’s disposal? It’s renewed every few hours and replaying is possible for months. And each consensus contains different date/time. I am wondering what would happen if a mitm in position of the directory authority’s ISP would make a different replay attack (sending a different version of Tor consensus) for each and every request. If that could be used to single out users somehow.</p>
<p>Using unverified Tor consensus would make this worse. An adversary could come up with an unlimited amount of Tor consensus date/time combinations.</p>
<p>[hr]</p>
<blockquote>- Let's assume that the host's clock falls within the accurate range that allows Tor to connect. And also that (Linux) users are following best protocol; by disabling timestamps on the host and not running anything on there. Because really if they are not doing this they are defeating a large part of the protection a hypervisor is about.</blockquote>
Missing here: users also do run non-torified applications such as browsers with javascript on the host, which leaks the clock.
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/22">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/22</link>
        <pubDate>Mon, 08 Sep 2014 11:28:21 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-22</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Off-topic: I am interested to move discussions to the next level. Many comments are just questions, that aren’t clear in the original proposal. Or something is missing the the original proposal, that can be fixed. So I was wondering, if one (me) could make some comments, and then you improve the original proposal. If these comments are covered and no dissent, the previous discussion can be deleted.</p>
<p>On-topic:</p>
<p>I haven’t fully through through it yet.</p>
<blockquote>-Fetching consensus data is one over Tor, ideally this can be done multiple times over different exits and the results compared as to stop an exit's ISP from doing the attack described above.</blockquote>
<p>I think there is a false assumption about mitm’s here.</p>
<pre><code class="lang-auto"></code></pre>
<p>If you keep changing Tor exit’s, you make a mitm only less likely for a fraction of that route. Marking the by:<br>
|</p>
<pre><code class="lang-auto"></code></pre>
<p>So.</p>
<pre><code class="lang-auto"></code></pre>
<p>I am not sure you were aware of this at time of writing or if that would change the proposal?</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/21">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/21</link>
        <pubDate>Mon, 08 Sep 2014 11:08:08 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-21</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>N.B. that its not necessary for people to really change their use habits. If they run stuff on the host they will be ok for the most part, because nothing running on the gateway will give away the timestamps.</p>
<p>Once the gateway connects, then the workstation can use anondate to set a different time in case something on there leaks time to the web, in addition to another program on the host doing that too.</p>
<p>According to Nick OpenSSL 1.0.1f has timestamps disabled.</p>
<p>Situation A: typical user</p>
<p>-Host leaky, gateway not, Workstation leaky = user safe.<br>
Workstation can have time set safely. gateway does not betray time when restarting.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/20">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/20</link>
        <pubDate>Sun, 07 Sep 2014 21:58:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-20</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>I’ve given this approach some more thought since you explained it. I have some ideas on how we can get over the ISP level adversary and fingerprinting issue. It will involve changing use-advice in the guide and thats about it. Figuring out how to distill a more finegrained time reading that’s close as possible to the real time is subject of another post.</p>
<ul>
<li>At first it looks like a chicken-egg problem: It would be better to fetch consensus data over Tor to prevent the fingerprinting issues and the possibility of being fed outdated data. But Tor can’t connect without a correct time to enable this.</li>
</ul>
<p>-For normal non-virtualized hosts running Tor, if the clock is too much off there is no connection established even though this is attempted. Tor waits for the user to manually correct the time on the host for a connection to be successful.</p>
<p>-Doing a system suspend is the cause for the guest clock to be very inaccurate if it was in a saved/running state.</p>
<ul>
<li>Our current settings isolate guest time from the host’s forcing it to rely on timesync as the sole source of time accuracy.</li>
</ul>
<p>BUT</p>
<ul>
<li>
<p>Whenever a guest is started or restarted it bases its time on the host’s.</p>
</li>
<li>
<p>Let’s assume that the host’s clock falls within the accurate range that allows Tor to connect. And also that (Linux) users are following best protocol; by disabling timestamps on the host and not running anything on there. Because really if they are not doing this they are defeating a large part of the protection a hypervisor is about.</p>
</li>
<li>
<p>No time is leaked from the host to compare with, but at the same time host time is accurate enough to use to bootstrap with by Tor.</p>
</li>
</ul>
<hr>
<p>Conclusion:</p>
<p>-Fetching consensus data is one over Tor, ideally this can be done multiple times over different exits and the results compared as to stop an exit’s ISP from doing the attack described above.</p>
<ul>
<li>
<p>Users will be advised to make sure their host time is roughly accurate and close enough to the actual which they can check out of band for example a wallclock.</p>
</li>
<li>
<p>If time is off and Tor can’t connect, the user will be advised to reboot the gw, so the host’s time be used but the occurence of this will be rare and not fingerprintable provided the action described below is taken.</p>
</li>
<li>
<p>Users will be advised to poweroff the guest to avoid drifts as this is corrected on subsequent starts. inconvenient? somewhat but not a deal breaker. Guests start darn fast on modern hardware, more so if the gateway is not running the DE because its configured with less ram. These steps are only needed for the gateway.</p>
</li>
<li>
<p>We can rely solely on anondate to fetch a fresh consensus soley for the purpose of making the guest clock differ from the host’s (provided that we figure out ways on get a more realistic reading from this data).</p>
</li>
<li>
<p>This remedy is not necessary for the workstation because as long as the the Gateway can connect to Tor, anondate would be able to fetch its consensus via this Tor connection. There is no other Tor instance that needs the time accurate for bootstrapping in there. A user can keep his session running without rebooting or shutting down his workstation.</p>
</li>
</ul>
<hr>
<p><span class="bbcode-b"><br>
I think the whole necessity for securely setting time goes away if the Host’s clock is kept private, which it can be.</span>The bootstrapping issues are fixed with restarting the gateway. But the point of this proposal is to keep secure time syncing mechanism available.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/19">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/19</link>
        <pubDate>Sun, 07 Sep 2014 21:46:06 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-19</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Yes. For getting the exact same web fingerprint, we’d need to run all javascript (if that still were the default setting in Tor Browser).</p>
<p>So we indeed rather accept the fingerprinting issues and care about making it as secure as possible. (I’d still accept a patch making this an option, but given the obscure nature of this issue, I doubt anyone will be ever interested.)</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/18">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/18</link>
        <pubDate>Fri, 05 Sep 2014 23:51:13 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-18</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Come to think of it, defeating fingerprinting using SeleniumHQ, even if it was easy, brings in the entire browser codebase as part of the trusted code base. Not good, its a cure worse than the disease in this situation.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/17">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/17</link>
        <pubDate>Fri, 05 Sep 2014 19:34:07 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-17</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="15" data-topic="448">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>[quote](Topic diverted from “Guard against MITM sdwdate” to “Guard against fingerprinting sdwdate”.)</p>
</blockquote>
</aside>
<p>My worry was that sdwdate traffic be easily singled out by them , leaving it more probable that  exploits could be employed against it on a mass scale.[/quote]<br>
Yes, a valid point.<br>
Unfortunately difficult (not impossible) to fix as per my answer <a href="https://www.whonix.org/forum/index.php/topic,470.msg3795.html#msg3795">https://www.whonix.org/forum/index.php/topic,470.msg3795.html#msg3795</a>.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/16">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/16</link>
        <pubDate>Fri, 05 Sep 2014 13:45:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-16</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
      <item>
        <title>Guard against MITM sdwdate</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <blockquote>(Topic diverted from "Guard against MITM sdwdate" to "Guard against fingerprinting sdwdate".)</blockquote>
<p>My worry was that sdwdate traffic be easily singled out by them , leaving it more probable that  exploits could be employed against it on a mass scale.</p>
          <p><a href="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/guard-against-mitm-sdwdate/448/15</link>
        <pubDate>Fri, 05 Sep 2014 13:28:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-448-15</guid>
        <source url="http://forums.whonix.org/t/guard-against-mitm-sdwdate/448.rss">Guard against MITM sdwdate</source>
      </item>
  </channel>
</rss>

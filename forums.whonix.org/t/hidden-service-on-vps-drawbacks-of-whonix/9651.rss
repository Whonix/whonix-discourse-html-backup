<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Hidden Service on VPS: Drawbacks of Whonix</title>
    <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651</link>
    <description>Hello, i have some considerations regarding the use of Whonix on a anonymous hosted VPS to run a hidden service.

**Purpose:**
- Host a webserver as hidden service on a Linux KVM-based VPS [1] with limited applications e.g. nginx, mysql.
- Hidden services are properly configured according to [2]
- Outgoing connections are properly configured in the application proxy settings [3]

**Questions:**
Would you still suggest to setup the hidden service in Whonix according to Whonix: /wiki/Onion_Services?

Disadvantages:
- Using Whonix in terms of hosting hidden services seems not to be very common (found very few information user information about this)
- Compatibility to some applications or technology is possibly not tested e.g. container technology
- On KVM-based VPS nested virtualizaion is necessary to get Whonix Gateway and Whonix Workstation running [4]. This consumes a lot of computing ressources and could mean more attack surface [5].

Advantages:
- Stream isolation by Isolating Proxy (Whonix Gateway) with additional Transparent Proxy as fallback 
- Strongest protection from IP/DNS leaks

My evaluation: Setup without Whonix due to low general use, uncertain compatibility, high resource consumption is currently more beneficial if you configure the anonymous third party VPS securely and use only limited open source applications. Successful attacks against the hidden service will not lead to your location as it is anonymous third party hosted.

Are my assumptions correct? What is your opinion?

Is there another way to host Whonix on a KVM-based VPS without the need of nested virtualization?

Thank you.

[1] https://www.whonix.org/wiki/Hosting_Location_Hidden_Services#Anonymous_Third_Party_Hosts
[2] https://2019.www.torproject.org/docs/tor-onion-service.html.en
[3] https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO#Classicalcommonway:usetheapplicationsproxysettings
[4] https://www.whonix.org/wiki/KVM#Landing
[5] https://www.whonix.org/wiki/Nested_Virtualization#Security_Considerations</description>
    <language>en</language>
    <lastBuildDate>Mon, 02 May 2022 16:11:11 +0000</lastBuildDate>
    <category>Support</category>
    <atom:link href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[PrettyGoodPrivacy]]></dc:creator>
        <description><![CDATA[
            <p>Thank you very much. I appreciate your answers.</p>
<p>With the last question I meant whether it would not be better to do without Whonix when hosting hidden services anonymously on a third party server due to the complexity and undocumented areas.</p>
<p>Your answers and the new wiki chapter confirm that Whonix should not be left out, because the loss of relevant security measures is significant also in this use case.</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/18">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/18</link>
        <pubDate>Mon, 02 May 2022 16:11:11 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-18</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="PrettyGoodPrivacy" data-post="16" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/p/e5b9ba/40.png" class="avatar"> PrettyGoodPrivacy:</div>
<blockquote>
<p>But for an anonymous hosted VPS or dedicated server doesn’t this diminish the relevance of the above fully?</p>
</blockquote>
</aside>
<p>No. Users usually don’t want the VPS to be found so it cannot be attacked, DOS’ed, its onion service private key being stolen, taken offline or impersonanted.</p>
<aside class="quote no-group" data-username="PrettyGoodPrivacy" data-post="16" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/p/e5b9ba/40.png" class="avatar"> PrettyGoodPrivacy:</div>
<blockquote>
<p>What are the relevant advantages of using Whonix if you use an anonymous hosted VPS anyway?</p>
</blockquote>
</aside>
<p>Added to the wiki just now:<br>
<a href="https://www.whonix.org/wiki/Onion_Services#Why_use_Whonix_%E2%84%A2_for_Hosting_Onion_Services">Why use Whonix ™ for Hosting Onion Services</a></p>
<aside class="quote no-group" data-username="PrettyGoodPrivacy" data-post="16" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/p/e5b9ba/40.png" class="avatar"> PrettyGoodPrivacy:</div>
<blockquote>
<p>Is such an approach even possible with Whonix without further ado?</p>
</blockquote>
</aside>
<p>If you do it over Tor, it’s always more cumbersome than over clearnet.</p>
<aside class="quote no-group" data-username="PrettyGoodPrivacy" data-post="16" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/p/e5b9ba/40.png" class="avatar"> PrettyGoodPrivacy:</div>
<blockquote>
<p>I.e. a VPS or dedicated server with Whonix, where Whonix-Workstation acts as a web server.</p>
</blockquote>
</aside>
<p>VPS might be an issue. The V implies it’s virtual. That would either be nested virtualization, which is probably slow.</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.kicksecure.com/wiki/Nested_Virtualization">
  <header class="source">
      <img src="https://www.kicksecure.com/w/images/4/45/Kicksecure-home-favicon.ico" class="site-icon" width="32" height="32">

      <a href="https://www.kicksecure.com/wiki/Nested_Virtualization" target="_blank" rel="noopener" title="08:05AM - 27 January 2022">Kicksecure – 27 Jan 22</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:625/500;"><img src="https://www.kicksecure.com/w/images/c/c0/Mastomys-332686640.jpg" class="thumbnail" width="625" height="500"></div>

<h3><a href="https://www.kicksecure.com/wiki/Nested_Virtualization" target="_blank" rel="noopener">Nested Virtualization</a></h3>

  <p>It is possible to run Virtual Machines (VMs) inside other VMs. That is called Nested Virtualization.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Or somehow integrating with VPS. […]</p>
<aside class="quote no-group" data-username="PrettyGoodPrivacy" data-post="16" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/p/e5b9ba/40.png" class="avatar"> PrettyGoodPrivacy:</div>
<blockquote>
<p>Connections between web server and application server and between application server and database server carried out over virtual LAN of hosting provider.</p>
</blockquote>
</aside>
<p>[…]</p>
<p>Undocumented at present.</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.whonix.org/wiki/Undocumented">
  <header class="source">
      <img src="https://www.whonix.org/w/images/a/a4/Whonix-home-favicon.ico" class="site-icon" width="32" height="32">

      <a href="https://www.whonix.org/wiki/Undocumented" target="_blank" rel="noopener" title="02:19PM - 09 January 2022">Whonix – 9 Jan 22</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:640/426;"><img src="https://www.whonix.org/w/images/0/0a/Unsupported.jpg" class="thumbnail" width="640" height="426"></div>

<h3><a href="https://www.whonix.org/wiki/Undocumented" target="_blank" rel="noopener">Undocumented, Untested or Unsupported Features</a></h3>

  <p>This feature is either undocumented, untested, or unsupported. Options: Become a Contributor / Apply Free Support Principle / Purchase Premium Support.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-username="PrettyGoodPrivacy" data-post="16" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/p/e5b9ba/40.png" class="avatar"> PrettyGoodPrivacy:</div>
<blockquote>
<p>Taking all this into account, could it not reduce the complexity in such an approach (multiple anonymous third party VPS instances for layered architecture) to setup without Whonix without losing relevant security and anonymity measures or am i missing something?</p>
</blockquote>
</aside>
<p>Don’t know what you’re asking here.</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/17">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/17</link>
        <pubDate>Mon, 02 May 2022 14:14:05 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-17</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[PrettyGoodPrivacy]]></dc:creator>
        <description><![CDATA[
            <p>Hello everyone,</p>
<p>These days I am very concerned about the following questions and it seems to fit this topic, so I am not creating a new thread.</p>
<p>Of course always this advantage takes effect:</p>
<aside class="quote no-group" data-username="Patrick" data-post="2" data-topic="10624">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"><a href="//forums.whonix.org/t/what-is-best-practices-for-hosting-tor-onion-hidden-service/10624/2">What is best Practices for Hosting Tor Onion Hidden Service?</a>
</div>
<blockquote>
<p>Biggest advantage is that server software running inside Whonix-Workstation cannot find out its real, external IP address. Therefore the server software cannot leak it.</p>
</blockquote>
</aside>
<p>But for an anonymous hosted VPS or dedicated server doesn’t this diminish the relevance of the above fully?</p>
<blockquote>
<p>Also, there is no concern about server security and successful attacks against Tor onion services will not lead to your location or IP address.<br>
<a href="https://www.whonix.org/wiki/Hosting_Location_Hidden_Services" class="inline-onebox" rel="noopener nofollow ugc">Hosting Location Hidden Services - Whonix</a></p>
</blockquote>
<p>What are the relevant advantages of using Whonix if you use an anonymous hosted VPS anyway?</p>
<p>Another point which I would like to bring into the discussion: Today’s architectures follow a layered approach with separated servers for web, application and database.</p>
<p>Is such an approach even possible with Whonix without further ado? I.e. a VPS or dedicated server with Whonix, where Whonix-Workstation acts as a web server. Behind it a non-Whonix application server VPS and behind that a non-Whonix database server VPS. Connections between web server and application server and between application server and database server carried out over virtual LAN of hosting provider.</p>
<p>Taking all this into account, could it not reduce the complexity in such an approach (multiple anonymous third party VPS instances for layered architecture) to setup without Whonix without losing relevant security and anonymity measures or am i missing something?</p>
<p>Thank you very much.</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/16">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/16</link>
        <pubDate>Sun, 01 May 2022 23:13:22 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-16</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p><strong><a href="https://www.whonix.org/wiki/Onion_Services#OnionBalance">https://www.whonix.org/wiki/Onion_Services#OnionBalance</a></strong></p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/15</link>
        <pubDate>Sun, 01 May 2022 17:27:51 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-15</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Yes.</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/14</link>
        <pubDate>Tue, 16 Jun 2020 16:09:14 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-14</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[lovewhonix]]></dc:creator>
        <description><![CDATA[
            <p>Thanks for your response and explanations. It makes things clear for me.</p>
<p>Regarding my last post do you also agree currently to choose approach 1) ?</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/13</link>
        <pubDate>Mon, 15 Jun 2020 19:43:59 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-13</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="lovewhonix" data-post="5" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>Do you have any experiences on systeem requirements with this approach?</p>
</blockquote>
</aside>
<p>The more the better. Depends on how much traffic you expect.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="5" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>Would you recommend to setup the reverse proxy as a separate virtual machine in front of the Whonix Gateway as a or do you think it is not necessary?</p>
</blockquote>
</aside>
<p>It belongs in the WS not on the GW or between the two.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="5" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>I know the Whonix Gateway acts somehow as reverse proxy but has no web application firewall capabilties. How would you handle this?</p>
</blockquote>
</aside>
<p>The GW handles Tor connections without leaks and that’s it. Onion services provide Layer 2/3 DDoS protection by design but Layer 7 protection depends on how you configure the reverse proxy.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="5" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>Are there any limitations working with docker on the Whonix Workstation?</p>
</blockquote>
</aside>
<p>No, but don’t depends on it for security and make sure you have a way to verify the container app contents before execution. Unlike signed debs, containers have little trust mechanisms to link code to author.</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/12</link>
        <pubDate>Mon, 15 Jun 2020 16:58:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-12</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[lovewhonix]]></dc:creator>
        <description><![CDATA[
            <p>Thanks for your response and referencing to the topic “High Traffic Onion Service Scalability Performance”. We should follow this up in a different topic.</p>
<p>I investigated regarding the initial questions.</p>
<p>There are currenty two ways of hosting hidden services with Whonix on a VPS:</p>
<p><strong>1) Setup on KVM</strong></p>
<ul>
<li>setup one vps or dedicated server</li>
<li>create virtual machines for Whonix-Workstation and Whonix-Gateway.</li>
<li>in case of using a kvm-based vps nested virtualization will be present.</li>
</ul>
<p>Drawbacks of this approach are high requirements regarding computing ressources.  Also nested virualization could mean more attack surface which can me avoided by choosing a dedicated server: <a href="https://www.whonix.org/wiki/Nested_Virtualization#Security_Considerations" rel="nofollow noopener">https://www.whonix.org/wiki/Nested_Virtualization#Security_Considerations</a></p>
<p><strong>2) Setup on Hardware</strong></p>
<ul>
<li>setup two VPS or dedicated servers with Debain. One for Whonix-Workstation and the other one for Whonix-Gateway.</li>
<li>follow instructions on <a href="https://www.whonix.org/wiki/Dev/Build_Documentation/Physical_Isolation" rel="nofollow noopener">https://www.whonix.org/wiki/Dev/Build_Documentation/Physical_Isolation</a> for How To Install Whonix-Gateway ™ on Hardware (RECOMMENDED) and Install Whonix-Workstation ™ on hardware (NOT RECOMMENDED)</li>
<li>connect VPS / dedicates servers through virtual LAN</li>
<li>consider <a href="https://www.whonix.org/wiki/Connections_between_Whonix-Gateway_and_Whonix-Workstation" rel="nofollow noopener">https://www.whonix.org/wiki/Connections_between_Whonix-Gateway_and_Whonix-Workstation</a>
</li>
<li>turn off Workstation internet connectivity</li>
</ul>
<p>Some hosting providers provide these features.</p>
<p>For me it seems that this approach is not common and includes not recommended steps also encryption between Whonix-Workstation and Whonix-Gateway has to be considered as virtual LAN is operated by hosting provider.</p>
<p>Conclusion: Currently approach 1) is preferred in terms of security and complexity and compatibility aspects.</p>
<p>Do you agree?</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/11</link>
        <pubDate>Mon, 15 Jun 2020 16:15:33 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-11</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="lovewhonix" data-post="9" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>And if I got it right cloudflare uses WAF directly inside nginx but it is not clear if they run it on a different server in front of the application servers. But excuse me but I haven’t had time to watch the complete video. I will catch it up as soon as possible.</p>
<p>Is this correct?</p>
</blockquote>
</aside>
<p>My original inclusion might be incorrect. Cloudflare saying “we run the LUA WAF directly inside nginx” doesn’t preclude that cloudflare WAF server in the middle of (one or multiple) load balance as well as an application server(s).</p>
<aside class="quote no-group quote-modified" data-username="lovewhonix" data-post="9" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<aside class="quote no-group" data-username="Patrick" data-post="8" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Traffic that reaches from Whonix-Workstation on Whonix-Gateway is unencrypted (unless let’s say end-to-end encrypted by browser http <em><strong>s</strong></em> ).</p>
</blockquote>
</aside>
<p>Incoming requests/traffic to the hosted Onion Service is encrypted until it reaches the Onion Service at Whonix-Gateway. Whonix-Gateway forwards the requests to Whonix-Workstation unencrypted in every case. Also if https is in place end-to-end means from users’ browser to Whonix-Gateway (Onion Service) encrypted. From Whonix-Gateway to Whonix-Workstation (nginx/waf+application) unencrypted.</p>
<p>Are my assumptions correct?</p>
</blockquote>
</aside>
<p>onions are encrypted Tor to Tor. See:</p>
<ul>
<li><a href="https://www.whonix.org/wiki/Onion_Services#Notes_about_End-to-end_Security_of_Onion_Services"> Notes about End-to-end Security of Onion Services</a></li>
</ul>
<p>http<strong>s</strong> is usually between user’s browser (clearnet browser, host TBB, Tor Browser inside Whonix-Workstation, doesn’t matter) and (SSL terminator) web server. I.e. I guess the most common case is for Tor (including Whonix-Gateway) not being able to read the cleartext.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="9" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>From Whonix-Gateway to Whonix-Workstation (nginx/waf+application) unencrypted.</p>
</blockquote>
</aside>
<p>I don’t think a WAF could check much for end-to-end http<strong>s</strong> encrypted traffic on Whonix-Gateway due to TLS encryption. Dunno if WAF’s can be used to detect something malicious inside the encrypted TLS. In theory, perhaps, in practice, dunno. However, a serious analyis of cleartext requires a SSL terminator. (Using SSL and TLS loosely. I know SSL is outdated but still popular term for discussion.)</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="9" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>Very interesting and complex architectural topics which of course need more investigation.</p>
</blockquote>
</aside>
<p>Added to wiki just today:<br>
<a href="https://www.whonix.org/wiki/Onion_Services#High_Traffic_Onion_Service_Scalability_Performance">https://www.whonix.org/wiki/Onion_Services#High_Traffic_Onion_Service_Scalability_Performance</a> Quote</p>
<blockquote>
<p>High Traffic Onion Service Scalability Performance</p>
</blockquote>
<blockquote>
<p>Although mostly focused on non-anonymous onion services, the tor-dev mailing list discussion <a href="https://lists.torproject.org/pipermail/tor-dev/2020-June/014347.html">onionbalance useful on same server / for high-spec non-location hidden servers?</a> <a href="https://web.archive.org/web/https://lists.torproject.org/pipermail/tor-dev/2020-June/014347.html">[archive]</a> contains interesting information on scalability and performance of high traffic onion services. The <a href="https://lists.torproject.org/pipermail/tor-dev/">tor-dev mailing list</a> <a href="https://web.archive.org/web/https://lists.torproject.org/pipermail/tor-dev/">[archive]</a> (<a href="https://lists.torproject.org/cgi-bin/mailman/listinfo/tor-dev">sign-up</a> <a href="https://web.archive.org/web/https://lists.torproject.org/cgi-bin/mailman/listinfo/tor-dev">[archive]</a>) is considered a useful resource for technical information since they are receptive to genuine inquiries.</p>
</blockquote>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/10</link>
        <pubDate>Thu, 04 Jun 2020 11:26:19 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-10</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[lovewhonix]]></dc:creator>
        <description><![CDATA[
            <p>Thanks for your very detailed response on these non-trivial topics. Even if some topics were slightly off-topic and not directly Whonix-related I am glad that we can discuss them as they are very interesting.</p>
<aside class="quote no-group" data-username="Patrick" data-post="8" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>“Effectively” a “reverse proxy” but “actually” implemented inside nginx process.</p>
</blockquote>
</aside>
<p>I think I got it now. nginx+modsecurity can be used anywhere. In practice I see it is often used within multi-tier-architectures as separate server in front of the application server. In this case it acts as reverse proxy and is the “first line of defense”. A successfull attack does not compromise the application server.</p>
<p>And if I got it right cloudflare uses WAF directly inside nginx but it is not clear if they run it on a different server in front of the application servers. But excuse me but I haven’t had time to watch the complete video. I will catch it up as soon as possible.</p>
<p>Is this correct?</p>
<aside class="quote no-group" data-username="Patrick" data-post="8" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Traffic that reaches from Whonix-Workstation on Whonix-Gateway is unencrypted (unless let’s say end-to-end encrypted by browser http <em><strong>s</strong></em> ).</p>
</blockquote>
</aside>
<p>Incoming requests/traffic to the hosted Onion Service is encrypted until it reaches the Onion Service at Whonix-Gateway. Whonix-Gateway forwards the requests to Whonix-Workstation unencrypted in every case. Also if https is in place end-to-end means from users’ browser to Whonix-Gateway (Onion Service) encrypted. From Whonix-Gateway to Whonix-Workstation (nginx/waf+application) unencrypted.</p>
<p>Are my assumptions correct?</p>
<aside class="quote no-group quote-modified" data-username="Patrick" data-post="8" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Maybe you’re overthinking this. Suggested steps to learn this: […]</p>
</blockquote>
</aside>
<p>Thanks I will perform these steps to get a better practical understanding.</p>
<aside class="quote no-group" data-username="Patrick" data-post="8" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Whonix does what it does. It stays out of the way whenever possible. We don’t have documentation yet on how to setup a high traffic, high risk, complex php webapp onion service including load balancing using onionbalance, WAF, and whatnot. These are enterprise level features as far as I know. Anyone capable of setting up such complex setups (loadbalancing, caching, WAF) on clearnet, I guess would also be able to set it up on Whonix too.</p>
</blockquote>
</aside>
<p>Very interesting and complex architectural topics which of course need more investigation.</p>
<p>Thank you.</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/9</link>
        <pubDate>Thu, 04 Jun 2020 11:04:34 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-9</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="lovewhonix" data-post="7" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>I thought the nginx WAF acts as reverse proxy as it redirects requets to the application server.</p>
</blockquote>
</aside>
<p>“Effectively” a “reverse proxy” but “actually” implemented inside nginx process.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="7" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>Is traffic not unencrypted from Whonix-Gateway where the hidden service is hosted?</p>
</blockquote>
</aside>
<p>Only Tor traffic (encrypted by Tor) leaving Whonix-Gateway by default.</p>
<p>Traffic that reaches from Whonix-Workstation on Whonix-Gateway is unencrypted (unless let’s say end-to-end encrypted by browser http<em><strong>s</strong></em>). Might be possible to run a separate WAF process on Whonix-Gateway too. Intercepting traffic before forwarding to Tor <code>HiddenServicePort</code> but that’s undocumented. But I don’t think installing a WAF inside Whonix-Gateway is a good idea. Whonix’s usual approach is installing applications / servers “elsewhere”, i.e. inside Whonix-Workstation.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="7" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>Approaches without Whonix (restricted to one VPS)</p>
</blockquote>
</aside>
<p>Slightly off-topic.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="7" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>b) Container (on one VM)<br>
Internet - reverse Proxy/WAF (Container) - application (Container) - database (Container)</p>
</blockquote>
</aside>
<p>Not even cloudflare claiming to do that according to video I linked above.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="7" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<ol start="2">
<li>Approach with Whonix</li>
</ol>
<p>a) Traditional<br>
Internet - Whonix-Gateway (VM) - WAF (VM) - Whonix-Workstation (VM) - database (VM)</p>
</blockquote>
</aside>
<p>I wouldn’t call this traditional. I don’t remember anyone putting a VM between gateway VM and workstation VM.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="7" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>b) Container<br>
Internet - Whonix-Gateway (VM) - Whonix-Workstation (VM) consisting of application container and database container</p>
</blockquote>
</aside>
<p>I don’t see why this wouldn’t be possible but I also don’t remember people posting their setups.</p>
<p>What we documented on <a href="https://www.whonix.org/wiki/Onion_Services">https://www.whonix.org/wiki/Onion_Services</a> is rather only the essential knowledge. We don’t document stacked VMs, WAF’s, etc. (yet). And I am not sure we should. We’re not a “most secure server configuration” project (yet). These are certainly interesting subjects.</p>
<p>Also <a href="https://www.whonix.org/wiki/Free_Support_Principle">Free_Support_Principle</a> applies regarding to “most secure server configuration”.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="7" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>Again: Where to place the WAF here? Maybe as a container on the Whonix-Workstation (VM) in front of the application container or as container on the Whonix-Gateway?</p>
</blockquote>
</aside>
<p>Maybe you’re overthinking this. Suggested steps to learn this:</p>
<ul>
<li>Step 1: setup any clearnet server (don’t need to actually do this - just require this knowledge)</li>
<li>Step 2: setup “more secure” clearnet server including WAF inside a single VM</li>
<li>Step 3: setup a “simple” onion web server according to <a href="https://www.whonix.org/wiki/Onion_Services">https://www.whonix.org/wiki/Onion_Services</a>
</li>
<li>Step 4: replicate the setup from step 1 inside Whonix-Workstation. The only Whonix specific thing is making the server which is supposed to connect to the internet talk to Tor, i.e. use Tor onion service.</li>
</ul>
<p>In other words, you could setup nginx according to <a href="https://www.whonix.org/wiki/Onion_Services">https://www.whonix.org/wiki/Onion_Services</a>. Once that’s functional, follow any instructions on how to setup nginx-modsecurity.</p>
<p>I don’t have any handy that I could recommend but for example <a href="https://www.nginx.com/blog/compiling-and-installing-modsecurity-for-open-source-nginx/">https://www.nginx.com/blog/compiling-and-installing-modsecurity-for-open-source-nginx/</a> doesn’t even mention “reverse proxy”. You make the nginx-modsecurity module work (not saying that is trivial - but Whonix won’t be in the way), then enable it.</p>
<p>Quote</p>
<blockquote>
<p>Add the <code>modsecurity</code> and <code>modsecurity_rules_file</code> directives to the NGINX configuration to enable ModSecurity:</p>
</blockquote>
<pre><code class="lang-auto">server {
    # ...
    modsecurity on;
    modsecurity_rules_file /etc/nginx/modsec/main.conf;
}
</code></pre>
<p>None of that requires reverse proxy.</p>
<p>Either way, Whonix wouldn’t be in the way.</p>
<p>Though, stacking of VMs and reverse proxy inside stacked VMs is undocumented. But again, Whonix certainly doesn’t implement purposely technical hurdles to prevent that. It’s non-trivial but such setups are also non-trivial for clearnet.</p>
<p>Whonix does what it does. It stays out of the way whenever possible. We don’t have documentation yet on how to setup a high traffic, high risk, complex php webapp onion service including load balancing using onionbalance, WAF, and whatnot. These are enterprise level features as far as I know. Anyone capable of setting up such complex setups (loadbalancing, caching, WAF) on clearnet, I guess would also be able to set it up on Whonix too.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="7" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>What do you mean with stacking VMs?</p>
</blockquote>
</aside>
<p>standard setup: Whonix-Workstation VM -&gt; Whonix-Gateway VM</p>
<p>“stacking” example: standard setup: Whonix-Workstation -&gt; WAF VM -&gt; Whonix-Gateway VM -&gt; VPN VM</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/8</link>
        <pubDate>Wed, 03 Jun 2020 13:26:58 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-8</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[lovewhonix]]></dc:creator>
        <description><![CDATA[
            <p>Nginx modsecurity was in my mind. Why are you stating that I do not need a reverse proxy? I thought the nginx WAF acts as reverse proxy as it redirects requets to the application server. Or am I missing something?</p>
<p>I got your point that the WAF should not be placed before the Whonix Gateway (NOT: Whonix-Workstation -&gt; Whonix-Gateway -&gt; WAF) because the Tor traffic is encrypted but why it should be placed inside the Whonix-Workstation instead of the Wonix-Gateway*? Is traffic not unencrypted from Whonix-Gateway where the hidden service is hosted?<br>
<a href="https://www.whonix.org/wiki/Onion_Services" rel="nofollow noopener">https://www.whonix.org/wiki/Onion_Services</a></p>
<p>Are following approaches for hosting hidden services on one VPS consistent and state of the art in terms of security?</p>
<ol>
<li>Approaches without Whonix (restricted to one VPS)</li>
</ol>
<p>a) Traditional<br>
Internet - reverse proxy/WAF (VM) - application (VM) - database (VM)</p>
<p>b) Container (on one VM)<br>
Internet - reverse Proxy/WAF (Container) - application (Container) - database (Container)</p>
<ol start="2">
<li>Approach with Whonix</li>
</ol>
<p>a) Traditional<br>
Internet - Whonix-Gateway (VM) -  WAF (VM) - Whonix-Workstation (VM) - database (VM)<br>
OR<br>
*Internet - Whonix Gateway+WAF (VM) - Whonix-Workstation (VM) - database (VM) or even better to place WAF inside Whonix-Workstation but why?</p>
<p>b) Container<br>
Internet - Whonix-Gateway (VM) - Whonix-Workstation (VM) consisting of application container and database container<br>
Again: Where to place the WAF here? Maybe as a container on the Whonix-Workstation (VM) in front of the application container or as container on the Whonix-Gateway?</p>
<p>What do you mean with stacking VMs?</p>
<p>Thank you for the discussion.</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/7</link>
        <pubDate>Wed, 03 Jun 2020 10:25:40 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-7</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="lovewhonix" data-post="5" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>Are there any limitations working with docker on the Whonix Workstation?</p>
</blockquote>
</aside>
<p>No known issues.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="5" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>I know the Whonix Gateway acts somehow as reverse proxy but has no web application firewall capabilties. How would you handle this?</p>
</blockquote>
</aside>
<p>A WAF cannot be in the following places (which are actually all the same place):</p>
<ul>
<li>on the host</li>
<li>“behind” Whonix-Gateway</li>
<li>Whonix-Workstation -&gt; Whonix-Gateway -&gt; host [here]</li>
</ul>
<p>That is because at that point it’s just encrypted Tor traffic and the WAF has no way to analyze it.</p>
<p>Realistically the WAF should be installed on the same place where the (web) server is running, i.e. inside Whonix-Workstation. Which WAF did you had in mind? A local or remote WAF? Open Source or SaaS? I see no reason why nginx with nginx modsecurity wouldn’t work. Then you don’t even need a reverse proxy. <a href="https://www.youtube.com/watch?v=nlt4XKhucS4">Even cloudflare claims they’re using the WAF directly inside nginx</a>.</p>
<p>You might want to go super secure by running the WAF in a separate VM. I.e. if the WAF itself gets exploited, doesn’t necessarily exploit the web server too. Stacking VMs is <a href="https://www.whonix.org/wiki/Unsupported">unsupported</a>. More within reach of enterprise level security. Non-trivial stuff that I haven’t seen easily doable/documented yet, specifically not within Tor ecosystem.</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/6</link>
        <pubDate>Wed, 03 Jun 2020 09:16:01 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-6</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[lovewhonix]]></dc:creator>
        <description><![CDATA[
            <p>Hello, Thanks for your answer. You are convincing me using Whonix also in server environments. I have some additional questions.</p>
<p>Regarding the interconnection of two vps on the local network: Some hosting providers offer this but of course it is not guaranteed that it works exactly as desired. Especially turning off internet connection would be an individual request. I guess the current way to go will be nested virtualization.</p>
<p>I assume the vps memory requirements - of course taking the webserver requirements into account - should generally not be lower than 8GB of RAM.<br>
<code>https://www.whonix.org/wiki/System_Requirements</code><br>
<code>https://www.linuxnix.com/kvm-virtualization-how-to-check-my-hardware-support-kvm/</code><br>
Do you have any experiences on systeem requirements with this approach?</p>
<p>For webserver setup state of the art is using a reverse proxy with web application firewall. Would you recommend to setup the reverse proxy as a separate virtual machine in front of the Whonix Gateway as a or do you think it is not necessary? I know the Whonix Gateway acts somehow as reverse proxy but has no web application firewall capabilties. How would you handle this?</p>
<p>Are there any limitations working with docker on the Whonix Workstation?</p>
<p>Thank you.</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/5</link>
        <pubDate>Wed, 03 Jun 2020 08:05:42 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-5</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>lovewhonix via Whonix Forum:</p>
<blockquote>
<p>There are only a few threads and documentations compared to the client usage.</p>
</blockquote>
<p>Documentation on clearnet for all use cases of clearnet is also more<br>
client then server. Much more people are clients than server. What would<br>
you expect.</p>
<blockquote>
<p>And if a successful attack against the hidden service will not lead to your location as it is anonymous third party hosted you should be secure enough.</p>
</blockquote>
<p>How many times you want to re-setup the onion service if discovered?<br>
There’s probably not too many service providers to choose from. Also<br>
connecting to a compromised onion service (ssh) has risks. See:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Remote_Administration" target="_blank" title="08:17AM - 24 May 2020">Whonix – 24 May 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:640/320;"><img src="https://www.whonix.org/w/images/a/ad/Remoteadmin.png" class="thumbnail" width="640" height="320"></div>

<h3><a href="https://www.whonix.org/wiki/Remote_Administration" target="_blank">Remote Administration - Whonix</a></h3>

<p>Remote Administration</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Also to be avoided.</p>
<blockquote>
<p>I am thinking of an alternative to use Whonix without nested virtualization on a VPS.</p>
<ol>
<li>Rent a VPS with Debian and install Whonix Gateway [1]</li>
<li>Rent a VPS with Debian and install Whonix Workstation [2].</li>
</ol>
</blockquote>
<p>Connecting them might be hard be hard.</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Connections_between_Whonix-Gateway_and_Whonix-Workstation" target="_blank" title="07:33PM - 30 March 2020">Whonix – 30 Mar 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:640/452;"><img src="https://www.whonix.org/w/images/9/95/Binary-503583640.jpg" class="thumbnail" width="640" height="452"></div>

<h3><a href="https://www.whonix.org/wiki/Connections_between_Whonix-Gateway_and_Whonix-Workstation" target="_blank">Connections between Whonix-Gateway ™ and Whonix-Workstation ™</a></h3>

<p>Authenticated / Encrypted Connections between Whonix-Gateway ™ and Whonix-Workstation ™, ARP spoofing defense, SSH, OpenVPN, Using additional (isolated) network interfaces</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<blockquote>
<ol start="3">
<li>Interconnect both VPS on local network of hosting provider. Turn off Workstation internet connectivity.</li>
</ol>
</blockquote>
<p>Dunno. I never did that. Easy as that?</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/4</link>
        <pubDate>Tue, 02 Jun 2020 16:28:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-4</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[lovewhonix]]></dc:creator>
        <description><![CDATA[
            <p>First of all thanks for your answer. I did not necessarily want to argue against using Whonix in this use case.</p>
<p>It really seems that the use case for servers is not very common. There are only a few threads and documentations compared to the client usage. And if a successful attack against the hidden service will not lead to your location as it is anonymous third party hosted you should be secure enough. But I agree it is all about risk assessment. I will rethink of using it in this use case.</p>
<p>I am thinking of an alternative to use Whonix without nested virtualization on a VPS.</p>
<ol>
<li>Rent a VPS with Debian and install Whonix Gateway [1]</li>
<li>Rent a VPS with Debian and install Whonix Workstation [2]. The visibility of hardware serials to Whonix Workstation are not critical as the VPS is anonymous third party hosted.</li>
<li>Interconnect both VPS on local network of hosting provider. Turn off Workstation internet connectivity.</li>
</ol>
<p>What do you think about it? Or do I miss some important points?</p>
<p>[1] How To Install Whonix-Gateway ™ on Hardware (RECOMMENDED)<br>
[2] Install Whonix-Workstation ™ on hardware (NOT RECOMMENDED)<br>
</p><aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Dev/Build_Documentation/Physical_Isolation" target="_blank" rel="nofollow noopener" title="03:35PM - 12 May 2020">Whonix – 12 May 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:128/94;"><img src="https://www.whonix.org/w/images/9/98/Digital-art-191226640.jpg" class="thumbnail" width="128" height="94"></div>

<h3><a href="https://www.whonix.org/wiki/Dev/Build_Documentation/Physical_Isolation" target="_blank" rel="nofollow noopener">Build Documentation: Physical Isolation</a></h3>

<p>Security by Isolation. Using Whonix ™ with Physical Isolation on Bare Metal for Better Security.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/3</link>
        <pubDate>Tue, 02 Jun 2020 15:07:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-3</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="lovewhonix" data-post="1" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>My evaluation: Setup without Whonix due to low general use, uncertain compatibility, high resource consumption is currently more beneficial if you configure the anonymous third party VPS securely and use only limited open source applications. Successful attacks against the hidden service will not lead to your location as it is anonymous third party hosted.</p>
</blockquote>
</aside>
<p>Seems you are going out of your way to make an argument for others not to use Whonix for one of it’s most critical usecases.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="1" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>Are my assumptions correct? What is your opinion?</p>
</blockquote>
</aside>
<p>If making leak free Tor services were easier in any other way we wouldn’t have bothered with creating Whonix. You can forego Whonix protection at your own peril.<br>
A slower perf service vs being vanned or shot depending on where you live - choose wisely.</p>
<aside class="quote no-group" data-username="lovewhonix" data-post="1" data-topic="9651">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/l/a5b964/40.png" class="avatar"> lovewhonix:</div>
<blockquote>
<p>Is there another way to host Whonix on a KVM-based VPS without the need of nested virtualization?</p>
</blockquote>
</aside>
<p>Unlikely since almost every host provider will be using a hypervisor underneath the OS They rent to you to squeeze out as much use and profit from their servers as possible.</p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/2</link>
        <pubDate>Tue, 02 Jun 2020 13:22:44 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-2</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
      <item>
        <title>Hidden Service on VPS: Drawbacks of Whonix</title>
        <dc:creator><![CDATA[lovewhonix]]></dc:creator>
        <description><![CDATA[
            <p>Hello, i have some considerations regarding the use of Whonix on a anonymous hosted VPS to run a hidden service.</p>
<p><strong>Purpose:</strong></p>
<ul>
<li>Host a webserver as hidden service on a Linux KVM-based VPS [1] with limited applications e.g. nginx, mysql.</li>
<li>Hidden services are properly configured according to [2]</li>
<li>Outgoing connections are properly configured in the application proxy settings [3]</li>
</ul>
<p><strong>Questions:</strong><br>
Would you still suggest to setup the hidden service in Whonix according to Whonix: /wiki/Onion_Services?</p>
<p>Disadvantages:</p>
<ul>
<li>Using Whonix in terms of hosting hidden services seems not to be very common (found very few information user information about this)</li>
<li>Compatibility to some applications or technology is possibly not tested e.g. container technology</li>
<li>On KVM-based VPS nested virtualizaion is necessary to get Whonix Gateway and Whonix Workstation running [4]. This consumes a lot of computing ressources and could mean more attack surface [5].</li>
</ul>
<p>Advantages:</p>
<ul>
<li>Stream isolation by Isolating Proxy (Whonix Gateway) with additional Transparent Proxy as fallback</li>
<li>Strongest protection from IP/DNS leaks</li>
</ul>
<p>My evaluation: Setup without Whonix due to low general use, uncertain compatibility, high resource consumption is currently more beneficial if you configure the anonymous third party VPS securely and use only limited open source applications. Successful attacks against the hidden service will not lead to your location as it is anonymous third party hosted.</p>
<p>Are my assumptions correct? What is your opinion?</p>
<p>Is there another way to host Whonix on a KVM-based VPS without the need of nested virtualization?</p>
<p>Thank you.</p>
<p>[1] <a href="https://www.whonix.org/wiki/Hosting_Location_Hidden_Services#Anonymous_Third_Party_Hosts" rel="nofollow noopener">https://www.whonix.org/wiki/Hosting_Location_Hidden_Services#Anonymous_Third_Party_Hosts</a><br>
[2] <a href="https://2019.www.torproject.org/docs/tor-onion-service.html.en" rel="nofollow noopener">https://2019.www.torproject.org/docs/tor-onion-service.html.en</a><br>
[3] <a href="https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO#Classicalcommonway:usetheapplicationsproxysettings" rel="nofollow noopener">https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO#Classicalcommonway:usetheapplicationsproxysettings</a><br>
[4] <a href="https://www.whonix.org/wiki/KVM#Landing" rel="nofollow noopener">https://www.whonix.org/wiki/KVM#Landing</a><br>
[5] <a href="https://www.whonix.org/wiki/Nested_Virtualization#Security_Considerations" rel="nofollow noopener">https://www.whonix.org/wiki/Nested_Virtualization#Security_Considerations</a></p>
          <p><a href="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651/1</link>
        <pubDate>Mon, 01 Jun 2020 22:56:22 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9651-1</guid>
        <source url="http://forums.whonix.org/t/hidden-service-on-vps-drawbacks-of-whonix/9651.rss">Hidden Service on VPS: Drawbacks of Whonix</source>
      </item>
  </channel>
</rss>

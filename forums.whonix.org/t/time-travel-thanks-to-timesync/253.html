<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Time Travel thanks to timesync - Development - Whonix Forum</title>
    <meta name="description" content="Last time I found a bug I waited too long, and I promised to report it early on the next time. Today the timesync made the exact opposite of what it is supposed to do. 

 bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: Running sdw&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="253.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Time Travel thanks to timesync&#39;" href="253.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/time-travel-thanks-to-timesync/253" />
<meta name="twitter:url" content="https://forums.whonix.org/t/time-travel-thanks-to-timesync/253" />
<meta property="og:title" content="Time Travel thanks to timesync" />
<meta name="twitter:title" content="Time Travel thanks to timesync" />
<meta property="og:description" content="Last time I found a bug I waited too long, and I promised to report it early on the next time. Today the timesync made the exact opposite of what it is supposed to do.  bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: Running sdwdate... bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: sdwdate_preparation: Setting CURL to curl.whonix-orig. bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: dispatching pre (SDW_MODE: daemon): /usr/lib/whonix/timesync_pre --autostart --mode $SDW_MODE bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: dispatching..." />
<meta name="twitter:description" content="Last time I found a bug I waited too long, and I promised to report it early on the next time. Today the timesync made the exact opposite of what it is supposed to do.  bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: Running sdwdate... bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: sdwdate_preparation: Setting CURL to curl.whonix-orig. bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: dispatching pre (SDW_MODE: daemon): /usr/lib/whonix/timesync_pre --autostart --mode $SDW_MODE bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: dispatching..." />
<meta property="article:published_time" content="2014-04-27T23:10:22+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="253.html">Time Travel thanks to timesync</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/whodam'><span itemprop='name'>whodam</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="253.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-27T23:10:22Z' class='post-time'>
                April 27, 2014, 11:10pm
              </time>
              <meta itemprop='dateModified' content='2014-04-27T23:10:22Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Last time I found a bug I waited too long, and I promised to report it early on the next time. Today the timesync made the exact opposite of what it is supposed to do.</p>
<p><code>bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: Running sdwdate...
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: sdwdate_preparation: Setting CURL to curl.whonix-orig.
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: dispatching pre (SDW_MODE: daemon): /usr/lib/whonix/timesync_pre --autostart --mode $SDW_MODE
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: dispatching prerequisite (SDW_MODE: daemon) (CURL: curl.whonix-orig) (LD_PRELOAD: ): /usr/lib/whonix/timesync_prerequisite
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: DISPATCH_PREREQUISITE returned 0, continuing...
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: getUrlDateDiff: https://www.privacyinternational.org
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: dispatching SDWDATE_CURL_DISPATCH_PRE[SDWDATE_POOL_PAL] (SDW_MODE: daemon) (CURL: curl.whonix-orig): /usr/lib/whonix/msgcollector --icon /usr/share/whonix/icons/timesync.ico --identifier timesync --prog$
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: dispatching SDWDATE_CURL_DISPATCH_POST[SDWDATE_POOL_PAL]: /usr/lib/whonix/msgcollector --icon /usr/share/whonix/icons/timesync.ico --identifier timesync --progressbaridx timesync --progressx 30
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: https://www.privacyinternational.org (took 3s) =&gt; diff = 1 second(s)
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: getUrlDateDiff: https://thepiratebay.org
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: dispatching SDWDATE_CURL_DISPATCH_PRE[SDWDATE_POOL_NEUTRAL] (SDW_MODE: daemon) (CURL: curl.whonix-orig): /usr/lib/whonix/msgcollector --icon /usr/share/whonix/icons/timesync.ico --identifier timesync --$
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: dispatching SDWDATE_CURL_DISPATCH_POST[SDWDATE_POOL_NEUTRAL]: /usr/lib/whonix/msgcollector --icon /usr/share/whonix/icons/timesync.ico --identifier timesync --progressbaridx timesync --progressx 60
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: https://thepiratebay.org (took 3s) =&gt; diff = 25115 second(s)
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: getUrlDateDiff: https://encrypted.google.com
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: dispatching SDWDATE_CURL_DISPATCH_PRE[SDWDATE_POOL_FOE] (SDW_MODE: daemon) (CURL: curl.whonix-orig): /usr/lib/whonix/msgcollector --icon /usr/share/whonix/icons/timesync.ico --identifier timesync --prog$
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: dispatching SDWDATE_CURL_DISPATCH_POST[SDWDATE_POOL_FOE]: /usr/lib/whonix/msgcollector --icon /usr/share/whonix/icons/timesync.ico --identifier timesync --progressbaridx timesync --progressx 80
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: https://encrypted.google.com (took 3s) =&gt; diff = 2 second(s)
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: Median diff: 8372 second(s)
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: Setting time to 1398630421...
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: dispatching post_success (SDW_MODE: daemon): /usr/lib/whonix/timesync_post_success --autostart --mode $SDW_MODE
bb9f72df-5e84-4dfb-bfaf-8e2cf4e2dce0: Sleeping for 33 minutes.</code></p>
<p>You can see of the three server the script asked, 2 of them agreed with the time of my machine roughly, but the pirate bay server is way off. And while the log says Median diff it actually calculates the average and it is applying this changed immediatly.</p>
<p>The average is: 8372 seconds, while the median would have been 2.</p>
<p>I heard you have a python developer now? <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"> maybe rewriting this script into python would be a first good step. The error handling of Shell Scripts alone should be reason enough to avoid it for security critical applications like this one. And it would also help to make it more readable. Even with grepping I didnt find the method which should do the median calculation.</p>
<p>Is there a clean way to deactivate the automatic timesync? I currenty just return to skip the timesync. And is there a particular reason why whonix is not using ntp?</p>
        </div>

        <meta itemprop='headline' content='Time Travel thanks to timesync'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="253.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-28T11:48:19Z' class='post-time'>
                April 28, 2014, 11:48am
              </time>
              <meta itemprop='dateModified' content='2014-04-28T11:48:19Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“whodam, post:1, topic:253”]You can see of the three server the script asked, 2 of them agreed with the time of my machine roughly, but the pirate bay server is way off. And while the log says Median diff it actually calculates the average and it is applying this changed immediatly.</p>
<p>The average is: 8372 seconds, while the median would have been 2.[/quote]<br>
Current calculation (and my understanding of median as a non-native English speaker) is:<br>
(1 + 25115 + 2) / 3 = ~8372</p>
<p>How would you calculate the median?</p>
<p>I am curious about suggestions on how to improve the algorithm.</p>
<p>Jason is working on a a thing we call “sneaky clock adjuster” for now (will probably get renamed before release). It gradually adjusts the clock, so results that are that wrong as in your unfortunate case won’t result in such an instant and big time travel [because sdwdate hopefully gets a better idea next time it runs]. Will most likely be included in Whonix 9. More info:<br>
<aside class="onebox githubissue">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/Whonix/issues/169" target="_blank">github.com/Whonix/Whonix</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue">
	  <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/Whonix/issues/169" target="_blank">Slow Clock Adjuster (sclockadj)</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2014-04-09" data-time="01:22:28" data-timezone="UTC">01:22AM - 09 Apr 14 UTC</span>
      </div>

        <div class="date">
          closed <span class="discourse-local-date" data-format="ll" data-date="2014-08-03" data-time="17:21:05" data-timezone="UTC">05:21PM - 03 Aug 14 UTC</span>
        </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>
    </div>
  </div>
</div>

<div class="github-row">
  <p class="github-content">When sdwdate runs, it moves the clock too much into past or future. This seems to confuse Tor which subsequently stops...</p>
</div>

<div class="labels">
    <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">bug</span>
    <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">enhancement</span>
    <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">security</span>
    <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">usability</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<blockquote>I heard you have a python developer now? :) maybe rewriting this script into python would be a first good step.</blockquote>
Well, it's a volunteer python developer. I can request things on a polite "could you do that please" base, not on a employee "you ought to rewrite sdwdate until xxx" base.  ;) This person is currently interested to work on gateway notice as well as on whonixcheck/timesync messages. Rewriting sdwdate would require a magnitude more time and skill. I don't know if this person is willing to take the time I am also not sure this is a good use of time.
<blockquote>The error handling of Shell Scripts alone should be reason enough to avoid it for security critical applications like this one.</blockquote>
What's wrong with the error handling?
<p>I also understand how security would improve by using python. Attack surface currently is <code>curl</code> (in function sdwdate_download), the parsing code (in function sdwdate_parse_date) and <code>date</code> (in function sdwdate_convert_to_unixtime).</p>
<blockquote>Even with grepping I didnt find the method which should do the median calculation.</blockquote>
In function sdwdate_build_median.
<blockquote>Is there a clean way to deactivate the automatic timesync?</blockquote>
Yes. We didn't have instructions for this, but I just finished writing some:
https://www.whonix.org/wiki/Advanced_Security_Guide#Deactivate_Automatic_TimeSync
<blockquote>I currenty just return to skip the timesync.</blockquote>
That doesn't work. The interaction between sdwdate and timesync is currently poorly documented. And timesync is a poor name. Sdwdate is the real thing. Timesync is a monitor and GUI for sdwdate. Canceling timesync when started on boot as monitor (and GUI), won't terminate sdwdate. There is room for improvement and it's getting better as Whonix is split into multiple packages. (Started here: https://github.com/Whonix/sdwdate)
<blockquote>And is there a particular reason why whonix is not using ntp?</blockquote>
Yes. It doesn't work over Tor and it's not secure and impossible to be made secure as a distro redistributor [without patching ntp]. More info:
- https://www.whonix.org/wiki/Dev/TimeSync#NTP_authentication_.28autokey.29_is_insecure
- https://www.whonix.org/wiki/Dev/TimeSync
        </div>

        <meta itemprop='headline' content='Time Travel thanks to timesync'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/troubadour'><span itemprop='name'>troubadour</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="253.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-28T16:19:16Z' class='post-time'>
                April 28, 2014,  4:19pm
              </time>
              <meta itemprop='dateModified' content='2014-04-28T16:19:16Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>Well, it's a volunteer python developer. I can request things on a polite "could you do that please" base, not on a employee "you ought to rewrite sdwdate until xxx" base.  ;) This person is currently interested to work on gateway notice as well as on whonixcheck/timesync messages. Rewriting sdwdate would require a magnitude more time and skill. I don't know if this person is willing to take the time I am also not sure this is a good use of time.</blockquote>
<p>Of course, I’m open to any suggestions, it is just a matter of time, and of testing my limits in python coding. Remember that I am a defector from Windows  :), and my programming experience comes from Pascal (Delphi) and .net (VB and C sharp.), where I have been used to strict variable declarations and strong type checking. Python seems reachable. When it comes to shell scripting, despite having the ABS guide handy, I am still at a loss. It’s a completely open way of coding that is still clashing with my habits.</p>
<p>Chiefly for the reason just mentioned, rewriting sdwdate in python is not in the pipeline, and it looks like an intricate piece. Let’s try to concentrate on msgcollector for the user interface.</p>
<blockquote>I also understand how security would improve by using python. Attack surface currently is `curl` (in function sdwdate_download), the parsing code (in function sdwdate_parse_date) and `date` (in function sdwdate_convert_to_unixtime).</blockquote>
<p>The AppArmor profile for curl has been ready for a while (it cannot be simpler), but I did not really test it yet. Coming soon. ‘date’ should not be a big problem.</p>
        </div>

        <meta itemprop='headline' content='Time Travel thanks to timesync'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/whodam'><span itemprop='name'>whodam</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="253.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-28T16:49:00Z' class='post-time'>
                April 28, 2014,  4:49pm
              </time>
              <meta itemprop='dateModified' content='2014-04-28T16:49:00Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>In whatever language you are speaking normally it is probably called Median as well, what you calculate is the Average.</p>
<p>The median is defined as the element which splits a group of elements into two halfs of the same size, where in one half all elements are bigger or equal to the medien and in the other half are all elements which are smaller or equal to the median.  Or in algorithmic terms, the set is sorted and you take the middle element. This helps to remove outlier. In statistics it is also equal to the 50-percentile.</p>
<p>Calculating the mediean in a set: [4, 8012, 9, 2,78] =&gt; sort =&gt; [2,4,9,78,8012] =&gt; middle element =&gt; 9, in contrast to the idea of the previous poster, this also works if the difference is big.</p>
<blockquote>[quote]The error handling of Shell Scripts alone should be reason enough to avoid it for security critical applications like this one.[/quote]
What's wrong with the error handling?</blockquote>
<p>You make me really worry about the security aspect of Whonix if you ask things like that. Simply speaking: Shell script has no error handling worth calling it error handling.</p>
<p>[URL=http://cacm.acm.org/blogs/blog-cacm/173827-those-who-say-code-does-not-matter/fulltext]Programming Language does matter[/URL]</p>
<p>After Heartbleed we should be aware of that. In this case it is an algorithmic mistake though, and I still do not know how this should be in any way more safe than NTP. If a single server can change my time. At least take thepiratebay out of the loop, their time-base is wrong.</p>
<blockquote>Yes. It doesn't work over Tor and it's not secure and impossible to be made secure as a distro redistributor [without patching ntp]. More info:
- https://www.whonix.org/wiki/Dev/TimeSync#NTP_authentication_.28autokey.29_is_insecure
- https://www.whonix.org/wiki/Dev/TimeSync</blockquote>
yeah thats what I feared that it is using UDP for latency reasons. However the security aspect is quite void after this bug. Thats exactly what I want to point out. Any of the time provider can currently change the clock of a clean installation of whonix. by any time he wants. How can ntp be ANY worse? There I can at least chose my providers.
<p>I trust a tool like ntp much more than your script. thanks for your help in deactivating. The bug should seriously be fixed soon… jumping time is very bad for tor.</p>
<p>I am really puzzled how you look very paranoid on shared folders but do not care much about your coding (language, algorithms, coding standards) - I cannot help you though, debian always makes me cranky when working with their core, and yes that is BASH too… which is probably the reason why it makes me mad. Its actually really sad, I do not know any good introduction to best practices to make software secure. Maybe someone around has a secret tip.</p>
<p><a class="mention" href="../../../external.html?link=https://forums.whonix.org/u/troubadour">@troubadour</a> statically typed languages have certainly their advantages. My actual fear is, why is sdw-date such a big heap of code anyway. Timesychronisation ought to be very very simple.</p>
<blockquote>It's a completely open way of coding that is still clashing with my habits.</blockquote>
<p>Don’t lose that habit.</p>
        </div>

        <meta itemprop='headline' content='Time Travel thanks to timesync'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="253.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-28T20:26:12Z' class='post-time'>
                April 28, 2014,  8:26pm
              </time>
              <meta itemprop='dateModified' content='2014-04-28T20:26:12Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="3" data-topic="253">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/t/d9b06d/40.png" class="avatar"> troubadour:</div>
<blockquote>
<p>The AppArmor profile for curl has been ready for a while (it cannot be simpler), but I did not really test it yet. Coming soon. ‘date’ should not be a big problem.</p>
</blockquote>
</aside>
<p>Having a AppArmor profile for curl/date is since. However, for sdwdate, I don’t think it’s needed. The sdwdate AppArmor profit restricts sdwdate. As far I understand, when it executes curl, that curl instance inherits from the sdwdate profile. So under the assumption, that sdwdate was compromised and AppArmor was safe, then sdwdate could not read any data in /home/user/something.</p>
        </div>

        <meta itemprop='headline' content='Time Travel thanks to timesync'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/troubadour'><span itemprop='name'>troubadour</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="253.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-28T21:09:05Z' class='post-time'>
                April 28, 2014,  9:09pm
              </time>
              <meta itemprop='dateModified' content='2014-04-28T21:09:05Z'>
          <span itemprop='position'>#6</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="4" data-topic="253">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/w/7bcc69/40.png" class="avatar"> whodam:</div>
<blockquote>
<p>In whatever language you are speaking normally it is probably called Median as well, what you calculate is the Average.</p>
</blockquote>
</aside>
<p>What you calculate exactly is the mean.</p>
<p>Quote from <a href="../../../external.html?link=https://www.whonix.org/wiki/Dev/TimeSync#External_Clock" rel="nofollow noopener">https://www.whonix.org/wiki/Dev/TimeSync#External_Clock</a></p>
<blockquote>It might make sense to add an external clock, such as a GPS, or even better an atomic clock. (Can we get an atomic USB clock?) This clock should be added to the host and/or Whonix-Gateway and/or Whonix-Workstation?
<p>Open question: would the GPS/atomic clock be too accurate and would that make Whonix more fingerprintable?</p>
</blockquote><br>
I do not know if a cheap (~$20) GPS receiver is so accurate that it would make Whonix more fingerprintable, but from a quick look, it seems a feasible solution.
<p>The gpsd daemon will read any GPS data format on an USB port, and most of the receivers speak NMEA, which is a standard. There are some python clients for gpsd around.  It should be possible to integrate timesync in there. May be a lead to follow, as an option anyhow.</p>
        </div>

        <meta itemprop='headline' content='Time Travel thanks to timesync'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="253.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-28T21:16:24Z' class='post-time'>
                April 28, 2014,  9:16pm
              </time>
              <meta itemprop='dateModified' content='2014-04-28T21:16:24Z'>
          <span itemprop='position'>#7</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“whodam, post:4, topic:253”]In whatever language you are speaking normally it is probably called Median as well, what you calculate is the Average.</p>
<p>The median is defined as the element which splits a group of elements into two halfs of the same size, where in one half all elements are bigger or equal to the medien and in the other half are all elements which are smaller or equal to the median.  Or in algorithmic terms, the set is sorted and you take the middle element. This helps to remove outlier. In statistics it is also equal to the 50-percentile.</p>
<p>Calculating the mediean in a set: [4, 8012, 9, 2,78] =&gt; sort =&gt; [2,4,9,78,8012] =&gt; middle element =&gt; 9, in contrast to the idea of the previous poster, this also works if the difference is big.[/quote]<br>
I see. Would you recommend that for sdwdate?</p>
<blockquote>[quote]The error handling of Shell Scripts alone should be reason enough to avoid it for security critical applications like this one.[/quote]
What's wrong with the error handling?
<p>You make me really worry about the security aspect of Whonix if you ask things like that. Simply speaking: Shell script has no error handling worth calling it error handling.</p>
<p>[URL=http://cacm.acm.org/blogs/blog-cacm/173827-those-who-say-code-does-not-matter/fulltext]Programming Language does matter[/URL]</p>
<p>After Heartbleed we should be aware of that. In this case it is an algorithmic mistake though,</p>
</blockquote><br>
Other question around. What kind of error should it handle that it does not handle?
<p>I saw many of these claims, but never really something solid to back it up. The blog post you linked is speaking about the heartbleed bug. They used C. A lower level programming language. C is hard. Bash is a scripting language. Much simpler. The difficult parts of sdwdate are delegated to existing code (curl, bash).</p>
<blockquote>and I still do not know how this should be in any way more safe than NTP.</blockquote>
NTP doesn't work over Tor (unless you add create a tcp tunnel capable of transporting udp beforehand), so it's out of question anyway. And with NTP, any man-in-the-middle can tamper with time requests, unless using authentication [which isn't safe, reference linked above], which isn't possible for a distro. sdwdate on the other hand uses 3 randomly selected servers [from pre-defined configurable lists] from three pools and builds the average. 
<blockquote>If a single server can change my time.</blockquote>
This is indeed bad, but no one has come up with better suggestions yet. I've been saying this for so long. Reported bugs against Debian (http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=%23687166), Ubuntu (https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1039420) and OpenBSD (http://thread.gmane.org/gmane.os.openbsd.bugs/18754). The only distros that are doing at least something about it are Tails (using tails_htp), Whonix (using sdwdate, which implements tails_htp in bash but uses the same algorithm). [And ChomeOS, that is using tlsdate?]
<blockquote>At least take thepiratebay out of the loop, their time-base is wrong.</blockquote>
Maybe. Updates take a while. When they are not fixing that.
<blockquote>There I can at least chose my providers.</blockquote>
You can change your providers in sdwdate as well. See /etc/sdwdate.d/30_sdwdate_default.  It says:
"## Please use "/etc/sdwdate.d/50_sdwdate_user" for your custom
 ## configuration, which will override the defaults found here."
See SDWDATE_POOL_PAL, SDWDATE_POOL_NEUTRAL and SDWDATE_POOL_FOE for examples. Then add whatever servers your prefer to /etc/sdwdate.d/50_sdwdate_user. 
<blockquote>I trust a tool like ntp much more than your script.</blockquote>
Unfortunately, it won't work over Tor.
<blockquote>The bug should seriously be fixed soon...</blockquote>
If you have any suggestions for the algorithm...
<blockquote>I am really puzzled how you look very paranoid on shared folders but do not care much about your coding (language, algorithms, coding standards)</blockquote>
No one could explain to me how bash worsens anything here. In a previous post I said what I believe what the attack surface is. I repeat and try to expand it a bit.
Attack surface currently is `curl` (in function sdwdate_download), the parsing code (in function sdwdate_parse_date) and `date` (in function sdwdate_convert_to_unixtime).
<p>Curl is written in C. Okay, that is bad. But is there a more secure/hardened downloader? When it was written in python, some python library would be used (or python core?). But python itself would interpret the code and python itself is written in C. How would that be any better? Has the python download code had more audits than curl?</p>
<p>As for the parsing code… The following: FIRST_WORD="${LINE%%:*}" - uses untrusted input from the server. The server could prepare a line that abuses a remote code execution bug in bash’s C code if there is such a bug. How would python’s C code be any better for this job? And even if it is better, we could simply call python from bash to do this calculation. For bash I don’t see many CVE’s and none related to such string manipulation code.</p>
<blockquote>debian always makes me cranky when working with their core, and yes that is BASH too... which is probably the reason why it makes me mad.</blockquote>
If you can tell me how for example /var/lib/dpkg/info/nano.postinst can worsens security just because it's written in bash... I never saw any serious argument about this either. What particular parts of Debian are written in bash and therefore worsening security?
<blockquote>My actual fear is, why is sdw-date such a big heap of code anyway.</blockquote>
I also don't agree with "lots of code = automatically lots of security issues".
<p>sdwdate (the script) has 1112 lines of code in total. Up to line 429 [Whonix 8] it is just “irrelevant” for security. That’s almost 50%. There are variable defaults, reading config folder, parsing local command line options. How could the be exploited? Local exploit perhaps. But one is position to run such as local exploit wouldn’t require it anymore.</p>
<p>ntpdate.c alone has alone 2000 lines of C code. That’s just one code file among many files. And the ntp source code folder is much bigger. I would think that it is simpler to audit sdwdate than to review ntp.</p>
<p>The comparison sdwdate / ntpdate isn’t fair for many reasons. (Sdwdate fetches time from http headers while ntp does a lot more.) Also because sdwdate re-uses existing code for difficult tasks (delegates download to curl). Isn’t that what security is about? Re-using existing code to minimize the code base?</p>
        </div>

        <meta itemprop='headline' content='Time Travel thanks to timesync'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="253.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-29T10:12:11Z' class='post-time'>
                April 29, 2014, 10:12am
              </time>
              <meta itemprop='dateModified' content='2014-04-29T10:12:11Z'>
          <span itemprop='position'>#8</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“troubadour, post:6, topic:253”]Quote from <a href="../../../external.html?link=https://www.whonix.org/wiki/Dev/TimeSync#External_Clock">https://www.whonix.org/wiki/Dev/TimeSync#External_Clock</a></p>
<aside class="quote">
<blockquote>
<p>It might make sense to add an external clock, such as a GPS, or even better an atomic clock. (Can we get an atomic USB clock?) This clock should be added to the host and/or Whonix-Gateway and/or Whonix-Workstation?</p>
<p>Open question: would the GPS/atomic clock be too accurate and would that make Whonix more fingerprintable?</p>
</blockquote>
</aside>
<p>I do not know if a cheap (~$20) GPS receiver is so accurate that it would make Whonix more fingerprintable, but from a quick look, it seems a feasible solution.</p>
<p>The gpsd daemon will read any GPS data format on an USB port, and most of the receivers speak NMEA, which is a standard. There are some python clients for gpsd around.  It should be possible to integrate timesync in there. May be a lead to follow, as an option anyhow.[/quote]<br>
GPS seems not that secure, since it depends on only one authoritative source.</p>
<p>What about an atomic clock? And before the amusement starts. This isn’t a joke. It’s not radioactive. I found one:<br>
<a href="../../../external.html?link=http://physicsworld.com/cws/article/news/2011/may/11/atomic-clock-is-smallest-on-the-market" class="onebox" target="_blank">http://physicsworld.com/cws/article/news/2011/may/11/atomic-clock-is-smallest-on-the-market</a><br>
<a href="../../../external.html?link=http://www.microsemi.com/products/timing-synchronization-systems/embedded-timing-solutions/components/sa-45s-chip-scale-atomic-clock" class="onebox" target="_blank">http://www.microsemi.com/products/timing-synchronization-systems/embedded-timing-solutions/components/sa-45s-chip-scale-atomic-clock</a></p>
<p>I haven’t found a price quote. A consumer class device, perhaps with USB would be required. That’s open for research if such a thing exists.</p>
<p>To which systems (hosts, gateway, workstation) do we feed it? Seems like this will only become a solution for advanced users. Install it only on the host, then disable sdwdate in all Whonix VMs, then just rely <a href="../../../external.html?link=https://github.com/Whonix/Whonix/blob/Whonix8/whonix_shared/etc/init.d/bootclockrandomization" data-bbcode="true">bootclockrandomization</a> in Whonix VMs (in Whonix 9 enabled for Whonix-Gateway and Whonix-Workstation by default) to unlink host, gateway and workstation? That should perfectly solve pretty much all network time sync needs?</p>
        </div>

        <meta itemprop='headline' content='Time Travel thanks to timesync'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/whodam'><span itemprop='name'>whodam</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="253.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-05-02T22:14:03Z' class='post-time'>
                May 2, 2014, 10:14pm
              </time>
              <meta itemprop='dateModified' content='2014-05-02T22:14:03Z'>
          <span itemprop='position'>#9</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="7" data-topic="253">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I see. Would you recommend that for sdwdate?</p>
</blockquote>
</aside>
<p>To be honest, I am not exactly sure what the intention of sdwdate was, I am not even quite sure what protocol it uses,  but if you want to make it more fault tolerant it certainly would help. The median works a bit like a majority vote algorithm this helps to reduce the influence of any single time provider.</p>
<blockquote>I saw many of these claims, but never really something solid to back it up. The blog post you linked is speaking about the heartbleed bug. They used C. A lower level programming language. C is hard. Bash is a scripting language. Much simpler. The difficult parts of sdwdate are delegated to existing code (curl, bash).</blockquote>
<p>I disagree on the simplicity of Bash, it has a lot of special cases and exceptions to common rules. The handling of variables, when to put quotes or not, it bases on shell programs and has very little logic in itself. It is a language which makes it very simple to make something wrong. It is what it is, it is intended to automate processes you would do by hand. It works together very well with anything you would do in the Shell as well. It has been created to automate tasks and not for algorithms or complex programs. All you can do is checking return values, if you forget to handle it at one point that’s it, if the program will end gracefully will depend if the state is still somewhere where you expect it to be otherwise it will do something you did not expect (I recommend you to use at least set -eo pipefail ). In contrast ruby or python will throw or raise an exception which will go up to the top level if you forget to handle it. Of course you can cheat there too, but you will do it actively.</p>
<p>This is only one small example where modern programming languages protect you from yourself. I do not want to go beyond that.</p>
<p>This is an abstract discussion - and has less and less to do with the Problem at hand. I wanted to share my insight, in the end you will have to make the experience yourself. We all are the sum of our experiences. You will come to your own conclusions, I am not a genius that’s why I need languages which protect me and my costumers.</p>
<blockquote>[quote]The bug should seriously be fixed soon...[/quote]
If you have any suggestions for the algorithm...</blockquote>
<p>Any form of majority vote will help, the median is certainly a good choice here.  It depends how elaborate you wanna get. currently you ask 3 servers, so 1 of them can give wrong information with the median still being useful. If you sample from 5 it will even work if 2 servers will show the wrong time. Of course you could expand on this one, if some server is consistently disagreeing with other servers he could be temporarily be removed from the rotation. For a short term solution a median of 3 server will solve 99% of real world problems.</p>
        </div>

        <meta itemprop='headline' content='Time Travel thanks to timesync'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/troubadour'><span itemprop='name'>troubadour</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="253.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-05-03T11:50:33Z' class='post-time'>
                May 3, 2014, 11:50am
              </time>
              <meta itemprop='dateModified' content='2014-05-03T11:50:33Z'>
          <span itemprop='position'>#10</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“whodam, post:9, topic:253”][quote]<br>
Any form of majority vote will help, the median is certainly a good choice here.  It depends how elaborate you wanna get. currently you ask 3 servers, so 1 of them can give wrong information with the median still being useful. If you sample from 5 it will even work if 2 servers will show the wrong time. Of course you could expand on this one, if some server is consistently disagreeing with other servers he could be temporarily be removed from the rotation. For a short term solution a median of 3 server will solve 99% of real world problems.<br>
[/quote][/quote]</p>
<p>My vote.  <img src="../../images/emoji/twitter/winkae52.png?v=5" title=":wink:" class="emoji" alt=":wink:"><br>
The mean is a calculation used for “normal” distribution, that is when the samples are expected to deviate marginally from a given value. In our case, even if you take samples from, say, 10 servers, the value returned by thepiratebay would not be smoothed out by the mean. It is taken out de facto by using the median.</p>
        </div>

        <meta itemprop='headline' content='Time Travel thanks to timesync'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="253.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-05-03T13:51:30Z' class='post-time'>
                May 3, 2014,  1:51pm
              </time>
              <meta itemprop='dateModified' content='2014-05-03T13:51:30Z'>
          <span itemprop='position'>#11</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Using the average really is a bad idea. Fixed to median (<a href="../../../external.html?link=https://github.com/Whonix/sdwdate/commit/4826248285919a5a92e866c16ad85a9e1e92a5e9">https://github.com/Whonix/sdwdate/commit/4826248285919a5a92e866c16ad85a9e1e92a5e9</a>). Will appear in Whonix 9.</p>
        </div>

        <meta itemprop='headline' content='Time Travel thanks to timesync'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

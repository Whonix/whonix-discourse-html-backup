<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Tor &gt; SSH, dynamic port forwarding error: &quot;listen: Operation not permitted&quot;</title>
    <link>http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246</link>
    <description>    $ ssh -NgD 4444 root@111.222.333.444
    listen: Operation not permitted
    listen: Operation not permitted
    channel_setup_fwd_listener_tcpip: cannot listen to port: 4444
    Could not request local forwarding.

Using info from https://trac.torproject.org/projects/tor/ticket/16917:

    $ nano ~/.ssh/config
    Host foo
    User Yourusername
    HostName 111.222.333.444
    DynamicForward 4444
    ProxyCommand sudo socat - SOCKS4A:localhost:%h:%p,socksport=9050

Had to use `sudo` with ProxyCommand, without it I get:

    $ ssh foo
    socat[31863] E connect(5, AF=2 127.0.0.1:9050, 16): Operation not permitted

Even with sudo there are still some errors:
```
$ ssh foo -v
debug1: Local connections to LOCALHOST:4444 forwarded to remote address socks:0
debug1: Local forwarding listening on ::1 port 4444.
listen: Operation not permitted
debug1: Local forwarding listening on 127.0.0.1 port 4444.
debug1: channel 0: new [port listener]
debug1: channel 1: new [client-session]
debug1: Requesting no-more-sessions@openssh.com
debug1: Entering interactive session.
```

But at least it works.
In Chromium `Change proxy settings...` 
SOCKS Proxy: 127.0.0.1
Port: 4444
and wtfismyip.com shows my SSH server&#39;s IP address.

Getting some interesting messages, but the port is still being forwarded.
```
~# debug1: Connection to port 4444 forwarding to socks port 0 requested.
debug1: channel 2: new [dynamic-tcpip]
debug1: getpeername failed: Transport endpoint is not connected
debug1: Connection to port 4444 forwarding to socks port 0 requested.
debug1: channel 3: new [dynamic-tcpip]
debug1: getpeername failed: Transport endpoint is not connected
debug1: Connection to port 4444 forwarding to socks port 0 requested.
debug1: channel 4: new [dynamic-tcpip]
debug1: getpeername failed: Transport endpoint is not connected
debug1: channel 2: free: direct-tcpip: listening port 4444 for wtfismyip.com port 443, connect from 127.0.0.1 port 65535 to 127.0.0.1 port 4444, nchannels 5
debug1: channel 3: free: direct-tcpip: listening port 4444 for clients2.google.com port 443, connect from 127.0.0.1 port 65535 to 127.0.0.1 port 4444, nchannels 4
debug1: channel 4: free: direct-tcpip: listening port 4444 for clients4.google.com port 443, connect from 127.0.0.1 port 65535 to 127.0.0.1 port 4444, nchannels 3
~# debug1: Connection to port 4444 forwarding to socks port 0 requested.
debug1: channel 2: new [dynamic-tcpip]
debug1: getpeername failed: Transport endpoint is not connected
```
Is there a better (safer) way to setup dynamic port forwarding?</description>
    <language>en</language>
    <lastBuildDate>Thu, 17 Mar 2016 20:48:11 +0000</lastBuildDate>
    <category>Support</category>
    <atom:link href="http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Tor &gt; SSH, dynamic port forwarding error: &quot;listen: Operation not permitted&quot;</title>
        <dc:creator><![CDATA[bobbx]]></dc:creator>
        <description><![CDATA[
            <p>Thank you.<br>
Confirming that the following works:</p>
<pre><code class="lang-auto">ssh.anondist-orig -NgD 8888 myusername@111.222.333.444
</code></pre>
          <p><a href="http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246/4</link>
        <pubDate>Thu, 17 Mar 2016 20:48:11 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2246-4</guid>
        <source url="http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246.rss">Tor &gt; SSH, dynamic port forwarding error: &quot;listen: Operation not permitted&quot;</source>
      </item>
      <item>
        <title>Tor &gt; SSH, dynamic port forwarding error: &quot;listen: Operation not permitted&quot;</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p><code>default socksification of ssh, wget, curl, etc. is confusing for local connections</code>:<br>
<a href="https://phabricator.whonix.org/T73" class="onebox" target="_blank">https://phabricator.whonix.org/T73</a></p>
          <p><a href="http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246/3</link>
        <pubDate>Thu, 17 Mar 2016 15:44:49 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2246-3</guid>
        <source url="http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246.rss">Tor &gt; SSH, dynamic port forwarding error: &quot;listen: Operation not permitted&quot;</source>
      </item>
      <item>
        <title>Tor &gt; SSH, dynamic port forwarding error: &quot;listen: Operation not permitted&quot;</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Likely cause:<br>
Stream isolation gets into the way with local connections.</p>
<p>Potential help:<br>
Disable stream isolation for ssh.</p>
<p>More info:<br>
</p><aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Stream_Isolation" target="_blank" rel="nofollow noopener">Whonix</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:386/500;"><img src="https://www.whonix.org/w/images/e/eb/Streamisolationme.jpg" class="thumbnail"></div>

<h3><a href="https://www.whonix.org/wiki/Stream_Isolation" target="_blank" rel="nofollow noopener">Stream Isolation</a></h3>

<p>Prevent Identity Correlation through Circuit Sharing by using Tor Stream Isolation</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<p></p>
          <p><a href="http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246/2</link>
        <pubDate>Thu, 17 Mar 2016 15:41:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2246-2</guid>
        <source url="http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246.rss">Tor &gt; SSH, dynamic port forwarding error: &quot;listen: Operation not permitted&quot;</source>
      </item>
      <item>
        <title>Tor &gt; SSH, dynamic port forwarding error: &quot;listen: Operation not permitted&quot;</title>
        <dc:creator><![CDATA[bobbx]]></dc:creator>
        <description><![CDATA[
            <pre><code>$ ssh -NgD 4444 root@111.222.333.444
listen: Operation not permitted
listen: Operation not permitted
channel_setup_fwd_listener_tcpip: cannot listen to port: 4444
Could not request local forwarding.
</code></pre>
<p>Using info from <a href="https://trac.torproject.org/projects/tor/ticket/16917:" rel="nofollow noopener">https://trac.torproject.org/projects/tor/ticket/16917:</a></p>
<pre><code>$ nano ~/.ssh/config
Host foo
User Yourusername
HostName 111.222.333.444
DynamicForward 4444
ProxyCommand sudo socat - SOCKS4A:localhost:%h:%p,socksport=9050
</code></pre>
<p>Had to use <code>sudo</code> with ProxyCommand, without it I get:</p>
<pre><code>$ ssh foo
socat[31863] E connect(5, AF=2 127.0.0.1:9050, 16): Operation not permitted
</code></pre>
<p>Even with sudo there are still some errors:</p>
<pre><code class="lang-auto">$ ssh foo -v
debug1: Local connections to LOCALHOST:4444 forwarded to remote address socks:0
debug1: Local forwarding listening on ::1 port 4444.
listen: Operation not permitted
debug1: Local forwarding listening on 127.0.0.1 port 4444.
debug1: channel 0: new [port listener]
debug1: channel 1: new [client-session]
debug1: Requesting no-more-sessions@openssh.com
debug1: Entering interactive session.
</code></pre>
<p>But at least it works.<br>
In Chromium <code>Change proxy settings...</code><br>
SOCKS Proxy: 127.0.0.1<br>
Port: 4444<br>
and <a href="http://wtfismyip.com" rel="nofollow noopener">wtfismyip.com</a> shows my SSH serverâ€™s IP address.</p>
<p>Getting some interesting messages, but the port is still being forwarded.</p>
<pre><code class="lang-auto">~# debug1: Connection to port 4444 forwarding to socks port 0 requested.
debug1: channel 2: new [dynamic-tcpip]
debug1: getpeername failed: Transport endpoint is not connected
debug1: Connection to port 4444 forwarding to socks port 0 requested.
debug1: channel 3: new [dynamic-tcpip]
debug1: getpeername failed: Transport endpoint is not connected
debug1: Connection to port 4444 forwarding to socks port 0 requested.
debug1: channel 4: new [dynamic-tcpip]
debug1: getpeername failed: Transport endpoint is not connected
debug1: channel 2: free: direct-tcpip: listening port 4444 for wtfismyip.com port 443, connect from 127.0.0.1 port 65535 to 127.0.0.1 port 4444, nchannels 5
debug1: channel 3: free: direct-tcpip: listening port 4444 for clients2.google.com port 443, connect from 127.0.0.1 port 65535 to 127.0.0.1 port 4444, nchannels 4
debug1: channel 4: free: direct-tcpip: listening port 4444 for clients4.google.com port 443, connect from 127.0.0.1 port 65535 to 127.0.0.1 port 4444, nchannels 3
~# debug1: Connection to port 4444 forwarding to socks port 0 requested.
debug1: channel 2: new [dynamic-tcpip]
debug1: getpeername failed: Transport endpoint is not connected
</code></pre>
<p>Is there a better (safer) way to setup dynamic port forwarding?</p>
          <p><a href="http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246/1</link>
        <pubDate>Thu, 17 Mar 2016 01:52:41 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2246-1</guid>
        <source url="http://forums.whonix.org/t/tor-ssh-dynamic-port-forwarding-error-listen-operation-not-permitted/2246.rss">Tor &gt; SSH, dynamic port forwarding error: &quot;listen: Operation not permitted&quot;</source>
      </item>
  </channel>
</rss>

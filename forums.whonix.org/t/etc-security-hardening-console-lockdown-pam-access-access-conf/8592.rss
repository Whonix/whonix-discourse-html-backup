<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
    <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592</link>
    <description>Is there something in `/etc/security/` folder that we could harden?</description>
    <language>en</language>
    <lastBuildDate>Mon, 03 Aug 2020 12:14:02 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Thanks. Good catch. Fixed.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/security-misc/commit/7e267ab49850362c02374a15fdba2409a5487a0f" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/security-misc/commit/7e267ab49850362c02374a15fdba2409a5487a0f" target="_blank">fix, allow group `sudo` and `console` to use consoles</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-08-03" data-time="12:12:19" data-timezone="UTC">12:12PM - 03 Aug 20 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 3 additions and 3 deletions">
        <a href="https://github.com/Whonix/security-misc/commit/7e267ab49850362c02374a15fdba2409a5487a0f" target="_blank">
          <span class="added">+3</span>
          <span class="removed">-3</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">fix /etc/security/access-security-misc.conf syntax error
Thanks to @81a989 for the bug report!
https://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/31</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/32">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/32</link>
        <pubDate>Mon, 03 Aug 2020 12:14:02 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-32</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[81a989]]></dc:creator>
        <description><![CDATA[
            <p><a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a>, there are syntax errors in the file. Groups should be surrounded with “(group)” instead of as “group”. It works as is unless any users with the same name as the groups are created. See access.conf to verify. I fixed it for you.</p>
<p>line 30: +:(console):console tty1 tty2 tty3 tty4 tty5 tty6 tty7 pts/0 pts/1 pts/2 pts/3 pts/4 pts/5 pts/6 pts/7 pts/8 pts/9 hvc0 hvc1 hvc2 hvc3 hvc4 hvc5 hvc6 hvc7 hvc8 hvc9 ttyS0 ttyS1 ttyS2 ttyS3 ttyS4 ttyS5 ttyS6 ttyS7 ttyS8 ttyS9</p>
<p>line 34: +:(sudo):console tty1 tty2 tty3 tty4 tty5 tty6 tty7 pts/0 pts/1 pts/2 pts/3 pts/4 pts/5 pts/6 pts/7 pts/8 pts/9 hvc0 hvc1 hvc2 hvc3 hvc4 hvc5 hvc6 hvc7 hvc8 hvc9 ttyS0 ttyS1 ttyS2 ttyS3 ttyS4 ttyS5 ttyS6 ttyS7 ttyS8 ttyS9</p>
<p>line 38: -:ALL EXCEPT (console-unrestricted):ALL</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/31">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/31</link>
        <pubDate>Sat, 01 Aug 2020 15:14:38 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-31</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="29" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p><a href="https://github.com/Whonix/security-misc/pull/74">debian: .preinst, add user to groups automatically</a></p>
</blockquote>
</aside>
<blockquote>
<p>Why don’t we allow group members of group <code>sudo</code> to use console by editing <a href="https://github.com/Whonix/security-misc/blob/master/etc/security/access-security-misc.conf"> <code>/etc/security/access-security-misc.conf</code> </a>? Group members of group <code>sudo</code> could run <code>sudo addgroup user console</code> anyhow. Therefore no security advantage by not doing that.</p>
</blockquote>
<p>Did that:</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/security-misc/commit/a7f2a2a3b6b408a0545f55b8fed9cc17fbd8f843" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/security-misc/commit/a7f2a2a3b6b408a0545f55b8fed9cc17fbd8f843" target="_blank">console lockdown: allow members of group `sudo` to use console</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-04-02" data-time="10:04:45" data-timezone="UTC">10:04AM - 02 Apr 20 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 4 additions and 0 deletions">
        <a href="https://github.com/Whonix/security-misc/commit/a7f2a2a3b6b408a0545f55b8fed9cc17fbd8f843" target="_blank">
          <span class="added">+4</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">https://forums.whonix.org/t/etc-security-hardening/8592
https://github.com/Whonix/security-misc/pull/74#issuecomment-607748407
https://www.whonix.org/wiki/Dev/Strong_Linux_User_Account_Isolation#Console_Lockdown</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Review for full file welcome:</p>
<p><a href="https://github.com/Whonix/security-misc/blob/master/etc/security/access-security-misc.conf">https://github.com/Whonix/security-misc/blob/master/etc/security/access-security-misc.conf</a></p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/30">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/30</link>
        <pubDate>Thu, 02 Apr 2020 10:06:24 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-30</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox githubpullrequest">
  <header class="source">
      <a href="https://github.com/Whonix/security-misc/pull/74" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/security-misc/pull/74" target="_blank">debian: .preinst, add user to groups automatically</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> ← <code>h0tw4t3r:patch-1</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-03-30" data-time="15:23:34" data-timezone="UTC">03:23PM - 30 Mar 20 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/h0tw4t3r" target="_blank">
          <img alt="h0tw4t3r" src="https://avatars0.githubusercontent.com/u/35642018?v=4" class="onebox-avatar-inline" width="20" height="20">
          h0tw4t3r
        </a>
      </div>

      <div class="lines" title="2 commits changed 3 files with 52 additions and 3 deletions">
        <a href="https://github.com/Whonix/security-misc/pull/74/files" target="_blank">
          <span class="added">+52</span>
          <span class="removed">-3</span>
        </a>
      </div>
    </div>

  </div>
</div>
  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/29">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/29</link>
        <pubDate>Thu, 02 Apr 2020 09:53:38 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-29</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/security-misc/commit/814f613a2fac12b892dfb6dcf53ee628e340c7b2" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/security-misc/commit/814f613a2fac12b892dfb6dcf53ee628e340c7b2" target="_blank">When using systemd-nspawn (chroot) then `login` requires console 'console' to be permitted.</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-03-31" data-time="11:08:25" data-timezone="UTC">11:08AM - 31 Mar 20 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 2 additions and 1 deletions">
        <a href="https://github.com/Whonix/security-misc/commit/814f613a2fac12b892dfb6dcf53ee628e340c7b2" target="_blank">
          <span class="added">+2</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>

  </div>
</div>




  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/28">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/28</link>
        <pubDate>Tue, 31 Mar 2020 11:12:28 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-28</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/security-misc/commit/729fa26eca292d60bcbeaba05d8878ff6112876e" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/security-misc/commit/729fa26eca292d60bcbeaba05d8878ff6112876e" target="_blank">use pam_acccess only for /etc/pam.d/login</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-12" data-time="14:00:08" data-timezone="UTC">02:00PM - 12 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 4 files with 25 additions and 50 deletions">
        <a href="https://github.com/Whonix/security-misc/commit/729fa26eca292d60bcbeaba05d8878ff6112876e" target="_blank">
          <span class="added">+25</span>
          <span class="removed">-50</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">remove "Allow members of group 'ssh' to login."
remove "+:ssh:ALL EXCEPT LOCAL"</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<blockquote>
<p>use pam_acccess only for /etc/pam.d/login<br>
remove <code>Allow members of group 'ssh' to login.</code><br>
remove <code>+:ssh:ALL EXCEPT LOCAL</code></p>
</blockquote>
<p>The SSH restrictions earlier was just a byproduct of not knowing how to implement this better, i.e like how it is implemented now. Now this is effectively only used for <code>/etc/pam.d/login</code>.</p>
<p>Does pam_access line</p>
<pre><code>+:ssh:ALL EXCEPT LOCAL
</code></pre>
<p>make sense for <code>/etc/pam.d/ssh</code> or should pam_access be used for any other services in <code>/etc/pam.d</code> folder too?</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/27">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/27</link>
        <pubDate>Thu, 12 Dec 2019 14:03:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-27</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox stackexchange">
  <header class="source">
      <a href="https://serverfault.com/questions/134471/success-n-control-syntax-in-pam-conf-pam-d-files" target="_blank">serverfault.com</a>
  </header>
  <article class="onebox-body">
      <a href="https://serverfault.com/users/5592/jamie" target="_blank">
    <img alt="Jamie" src="https://www.gravatar.com/avatar/d3ecad86d72c5ca5e3ccbcc46a0ad66a?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="https://serverfault.com/questions/134471/success-n-control-syntax-in-pam-conf-pam-d-files" target="_blank">"success=n" control syntax in pam.conf / pam.d/* files </a>
</h4>

<div class="tags">
  <strong>linux, pam</strong>
</div>

<div class="date">
  asked by
  
  <a href="https://serverfault.com/users/5592/jamie" target="_blank">
    Jamie
  </a>
  on <a href="https://serverfault.com/questions/134471/success-n-control-syntax-in-pam-conf-pam-d-files" target="_blank">03:38PM - 21 Apr 10 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/26">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/26</link>
        <pubDate>Thu, 12 Dec 2019 13:45:33 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-26</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Found a potential solution. Using pam_exec, environment variable <code>PAM_SERVICE</code>, exit codes (depending on if <code>PAM_SERVICE</code> is set to <code>login</code>) and then using the /etc/pam.d feature “<code>jumping over the next N modules in the stack</code>”.</p>
<aside class="quote no-group" data-post="21" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Maybe this would work:</p>
<pre><code class="lang-auto">Conflicts: sudo
</code></pre>
</blockquote>
</aside>
<p>That probably means just that when users run <code>sudo pam-auth-update</code> that they cannot enable two conflicting pam modules at the same time.</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/25">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/25</link>
        <pubDate>Wed, 11 Dec 2019 20:43:11 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-25</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[madaidan]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="23" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/p/898d66/40.png" class="avatar"> Patrick_mobile:</div>
<blockquote>
<p>It’s just a symptom. Would be happening with other applications too.</p>
</blockquote>
</aside>
<p>Then it should be added to the base abstraction.</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/24">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/24</link>
        <pubDate>Wed, 11 Dec 2019 17:35:55 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-24</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick_mobile]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="21" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Why is whonixcheck trying to access it?</p>
</blockquote>
</aside>
<p>It’s not. But it uses sudo. And then pam calls it.</p>
<aside class="quote no-group" data-post="21" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Why not just add it to the whonixcheck profile?</p>
</blockquote>
</aside>
<p>It’s just a symptom. Would be happening with other applications too.</p>
<aside class="quote no-group" data-post="22" data-topic="8592" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Ah, the issue isn’t /etc/pam.d/sudo but /etc/pam.d/common-account (which sudo has an include rule for).</p>
</blockquote>
</aside>
<p>Exactly.</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/23">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/23</link>
        <pubDate>Tue, 10 Dec 2019 21:00:34 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-23</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[madaidan]]></dc:creator>
        <description><![CDATA[
            <p>Ah, the issue isn’t /etc/pam.d/sudo but /etc/pam.d/common-account (which sudo has an include rule for).</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/22">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/22</link>
        <pubDate>Tue, 10 Dec 2019 20:29:40 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-22</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[madaidan]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="19" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Need to add /etc/security/access-security-misc.conf to apparmor abstractions/base?</p>
</blockquote>
</aside>
<p>Why is whonixcheck trying to access it? Why not just add it to the whonixcheck profile?</p>
<aside class="quote no-group" data-post="20" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>/etc/pam.d/sudo should probably not use pam_access. But due to how /usr/share/pam-configs works, I don’t see how it could apply to /etc/pam.d/login only. Would require writing to /etc/pam.d/login directly which is bad.</p>
</blockquote>
</aside>
<p>Maybe this would work:</p>
<pre><code>Conflicts: sudo</code></pre>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/21">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/21</link>
        <pubDate>Tue, 10 Dec 2019 20:17:56 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-21</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>This is also broken:</p>
<aside class="onebox githubblob">
  <header class="source">
      <a href="https://github.com/Whonix/sdwdate-gui/blob/master/etc/qubes-rpc/whonix.NewStatus" target="_blank">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="https://github.com/Whonix/sdwdate-gui/blob/master/etc/qubes-rpc/whonix.NewStatus" target="_blank">Whonix/sdwdate-gui/blob/master/etc/qubes-rpc/whonix.NewStatus</a></h4>
<pre><code class="lang-newstatus">#!/bin/bash

## Copyright (C) 2018 - 2019 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions

sudo \
   -u sdwdate-gui \
   bash \
     -c \
     'echo "'$1'" | tee /run/sdwdate-gui/anon-status &gt;/dev/null'
</code></pre>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<blockquote>
<p>Dec 10 16:42:49 host sudo[7369]: pam_access(sudo:account): access denied for user <code>user' from </code>’<br>
Dec 10 16:42:49 host sudo[7369]:     user : PAM account management error: Permission denied ; TTY=unknown ; PWD=/home/user ; USER=sdwdate-gui ; COMMAND=/usr/bin/bash -c echo “disp3655” | tee /run/sdwdate-gui/anon-status &gt;/dev/null</p>
</blockquote>
<p>/etc/pam.d/sudo should probably not use pam_access. But due to how /usr/share/pam-configs works, I don’t see how it could apply to /etc/pam.d/login only. Would require writing to /etc/pam.d/login directly which is bad.</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/20">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/20</link>
        <pubDate>Tue, 10 Dec 2019 19:53:43 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-20</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <blockquote>
<p>Dec 10 17:18:56 host audit[7643]: AVC apparmor=“DENIED” operation=“open” profile="/usr/bin/whonixcheck" name="/etc/security/access-security-misc.conf" pid=7643 comm=“sudo” requested_mask=“r” denied_mask=“r” fsuid=0 ouid=0<br>
Dec 10 17:18:56 host audit[7643]: SYSCALL arch=c000003e syscall=257 success=no exit=-13 a0=ffffff9c a1=5686851ff273 a2=0 a3=0 items=1 ppid=7642 pid=7643 auid=4294967295 uid=1000 gid=1000 euid=0 suid=0 fsuid=0 egid=1000 sgid=1000 fsgid=1000 tty=(none) ses=4294967295 comm=“sudo” exe="/usr/bin/sudo" subj==/usr/bin/whonixcheck (enforce) key=(null)<br>
Dec 10 17:18:56 host audit: CWD cwd="/"<br>
Dec 10 17:18:56 host audit: PATH item=0 name="/etc/security/access-security-misc.conf" inode=140805 dev=ca:03 mode=0100644 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0000000000000000 cap_fi=0000000000000000 cap_fe=0 cap_fver=0<br>
Dec 10 17:18:56 host audit: PROCTITLE proctitle=7375646F002D2D6E6F6E2D696E746572616374697665002D750077686F6E6978636865636B002F7573722F6C69622F77686F6E6978636865636B2F77686F6E6978636865636B002D2D6461656D6F6E002D2D677569002D2D636C69<br>
Dec 10 17:18:56 host sudo[7643]: pam_access(sudo:account): failed to open accessfile=[/etc/security/access-security-misc.conf]: Permission denied<br>
Dec 10 17:18:56 host sudo[7643]: pam_access(sudo:account): failed to parse the module arguments</p>
</blockquote>
<p>Need to add /etc/security/access-security-misc.conf to apparmor abstractions/base?</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/19">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/19</link>
        <pubDate>Tue, 10 Dec 2019 19:48:34 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-19</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>new description:</p>
<blockquote>
<ul>
<li>Console Lockdown.<br>
Allow members of group ‘console’ to use console and members of group ‘ssh’<br>
to receive incoming SSH connections. Everyone else except members of group<br>
‘console-unrestricted’ are restricted from using console using ancient,<br>
unpopular login methods such as using /bin/login over networks, which might<br>
be exploitable. (CVE-2001-0797) Using pam_access.<br>
Not enabled by default in this package since this package does not know which<br>
users shall be added to group ‘console’ and/or ‘ssh’ and would break console,<br>
X Window System and ssh login since files in<br>
/usr/share/pam-configs/console-lockdown-security-misc result in modifications<br>
of /etc/pam.d/common-account file which not only applies to /etc/pam.d/login<br>
but also all other services such as /etc/pam.d/ssh.</li>
</ul>
</blockquote>
<aside class="quote no-group quote-modified" data-post="7" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>One part is easily solvable:</p>
<blockquote>
<p>Not enabled by default in this package since this package does not know which<br>
users shall be added to group ‘console’</p>
</blockquote>
<p>pam console-lockdown could be enabled in package anon-base-files for Whonix / Kicksecure.</p>
</blockquote>
</aside>
<p>This is done.</p>
<p><a href="https://github.com/Whonix/anon-base-files/blob/master/debian/anon-base-files.postinst">anon-base-files <code>/debian/anon-base-files.postinst</code></a>:</p>
<pre><code>           user_to_be_created=user

           ## security-misc: Console Lockdown.
           ## Make sure this group exists. Might not exist if security-misc is not (yet) installed.
           addgroup --system console
           addgroup --system ssh
</code></pre>
<hr>
<pre><code>           ## security-misc: Console Lockdown.
           addgroup "$user_to_be_created" console
           addgroup "$user_to_be_created" ssh

           ## By package security-misc.
           pam-auth-update --enable console-lockdown-security-misc

           ## In Qubes and for existing installations Console Lockdown is
           ## is handled by whonix-legacy package.
</code></pre>
<p>But as you see it adds user <code>user</code> to both groups, <code>console</code> and <code>ssh</code>. This is non-perfect. Will elaborate under [1].</p>
<aside class="quote no-group quote-modified" data-post="7" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>But the following part is not easily solved.</p>
<blockquote>
<p>would break ssh login since files<br>
in /usr/share/pam-configs/console-lockdown result in modifications of<br>
/etc/pam.d/common-account file which not only applies to /etc/pam.d/login but<br>
also all other services such as /etc/pam.d/ssh.</p>
</blockquote>
</blockquote>
</aside>
<p><a href="https://github.com/Whonix/security-misc/blob/master/debian/security-misc.preinst">security-misc <code>/debian/security-misc.preinst</code></a> how has code to refuse installation if no user is a member of group <code>console</code> or <code>console-unrestricted</code>. Additinoally, if the <code>ssh.service</code> is activated (user has OpenSSH server package <code>openssh-server</code> instlled) it refuses installation if no user is a member of group <code>ssh</code>.</p>
<p>Therefore security-misc could enable console lockdown by default and probably will after some testing.</p>
<p>[1] I don’t think it’s possible to have a perfect solution for console lockdown. It needs basic information - are you going to use SSH or not? Breaking SSH servers of new or existing installations is not an option.</p>
<p>Instead, I’ve invented a new tool <a href="https://github.com/Whonix/security-misc/blob/master/usr/bin/hardening-enable"><code>/usr/bin/hardening-enable</code></a> which I describe here in more detail:</p>
<aside class="quote quote-modified" data-post="1" data-topic="8609">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="https://forums.whonix.org/t/security-hardening-tool-usr-bin-hardening-enable-by-security-misc/8609">Security Hardening Tool - /usr/bin/hardening-enable by security-misc</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/development"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    <a href="https://github.com/Whonix/security-misc/blob/master/usr/bin/hardening-enable">/usr/bin/hardening-enable</a> 
It can be used to easily opt-in everything advanced. For now it has these features: 

/usr/bin/hardening-enable --ssh


[Hide Hardware Info] 
Enabling enable hide-hardware-info.service by running ‘systemctl enable hide-hardware-info.service’… 
Success. 
[NOEXEC] 
Enabling noexec by creating file /etc/noexec … 
Success. 
[LKRG - Linux Kernel Runtime Guard] 
LKRG hardening by creating /etc/sysctl.d/40-security-misc-autogenerated.conf … 
Success. 


Or. 
/usr/bin/hardenin…
  </blockquote>
</aside>

<p>Maybe this configuration question SSH vs no-SSH could be asked during first boot.</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/18">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/18</link>
        <pubDate>Sun, 08 Dec 2019 16:59:36 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-18</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="15" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p><a href="https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling">unix.stackexchange.com</a></p>
<p><a href="https://unix.stackexchange.com/users/6960/lancebaynes"> <img src="https://www.gravatar.com/avatar/9592e22cc02163b23f9ffac2b8eb101e?s=128&amp;d=identicon&amp;r=PG" alt="LanceBaynes" width="60" height="60"> </a></p>
<h4><a href="https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling">How to restrict an SSH user to only allow SSH-tunneling?</a></h4>
<p><strong>linux, ssh, account-restrictions</strong></p>
<p>asked by <a href="https://unix.stackexchange.com/users/6960/lancebaynes"> LanceBaynes </a> on <a href="https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling">08:47AM - 03 Jun 11 UTC</a></p>
<p>Whitelisting the sshd allowed addresses can work by adding a special internal IP that uses Tor’s mapadddress to refer to some onion address generated for SSH access later on.</p>
<p><img src="https://www.golinuxcloud.com/wp-content/uploads/2018/10/favicon.png" alt="" width="16" height="16"> <a href="https://www.golinuxcloud.com/restrict-allow-ssh-certain-users-groups-rhel/">GoLinuxCloud – 3 May 19</a></p>
<p><img src="https://www.golinuxcloud.com/wp-content/uploads/2019/05/ssh-1.jpg" alt=""></p>
<h3><a href="https://www.golinuxcloud.com/restrict-allow-ssh-certain-users-groups-rhel/">How to restrict or allow ssh only from certain users, groups or hosts in Linux</a></h3>
<p>How to allow SSH for root login only from specific host or IP address? How to configure and restrict SSH to permit login only for certain users and/or groups?</p>
</blockquote>
</aside>
<p>That might be further SSH related hardening. Please open a new forum thread or phabricator ticket for this. The purpose of this thread is to find optional hardening and we’re bound to the features / syntax of these files:</p>
<ul>
<li><a href="https://linux.die.net/man/8/pam_access">https://linux.die.net/man/8/pam_access</a></li>
<li><a href="https://linux.die.net/man/5/access.conf">https://linux.die.net/man/5/access.conf</a></li>
</ul>
<p>Which is limited.</p>
<aside class="quote no-group" data-post="16" data-topic="8592" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>We can use</p>
<pre><code class="lang-auto">+:ssh:ALL EXCEPT LOCAL
</code></pre>
<p>Which should allow the <code>ssh</code> group to login anywhere except local things which should only be the network.</p>
</blockquote>
</aside>
<p>Did that.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/security-misc/commit/c1800b13fe33a1c129dcb30c51dbead7f894b818" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/security-misc/commit/c1800b13fe33a1c129dcb30c51dbead7f894b818" target="_blank">separate group "ssh" for incoming ssh console permission</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-07" data-time="16:26:39" data-timezone="UTC">04:26PM - 07 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 4 additions and 0 deletions">
        <a href="https://github.com/Whonix/security-misc/commit/c1800b13fe33a1c129dcb30c51dbead7f894b818" target="_blank">
          <span class="added">+4</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">Thanks to @madaidan
https://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/16</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/security-misc/commit/1464f01d191ee4e01ed2ec94f4faf8d17ec62b03" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/security-misc/commit/1464f01d191ee4e01ed2ec94f4faf8d17ec62b03" target="_blank">description</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-08" data-time="06:30:42" data-timezone="UTC">06:30AM - 08 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 8 additions and 6 deletions">
        <a href="https://github.com/Whonix/security-misc/commit/1464f01d191ee4e01ed2ec94f4faf8d17ec62b03" target="_blank">
          <span class="added">+8</span>
          <span class="removed">-6</span>
        </a>
      </div>
    </div>

  </div>
</div>




  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/17">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/17</link>
        <pubDate>Sun, 08 Dec 2019 06:42:51 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-17</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[madaidan]]></dc:creator>
        <description><![CDATA[
            <p>We can use</p>
<pre><code>+:ssh:ALL EXCEPT LOCAL
</code></pre>
<p>Which should allow the <code>ssh</code> group to login anywhere except local things which should only be the network.</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/16">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/16</link>
        <pubDate>Sat, 07 Dec 2019 15:16:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-16</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox stackexchange">
  <header class="source">
      <a href="https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling" target="_blank">unix.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="https://unix.stackexchange.com/users/6960/lancebaynes" target="_blank">
    <img alt="LanceBaynes" src="https://www.gravatar.com/avatar/9592e22cc02163b23f9ffac2b8eb101e?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling" target="_blank">How to restrict an SSH user to only allow SSH-tunneling?</a>
</h4>

<div class="tags">
  <strong>linux, ssh, account-restrictions</strong>
</div>

<div class="date">
  asked by
  
  <a href="https://unix.stackexchange.com/users/6960/lancebaynes" target="_blank">
    LanceBaynes
  </a>
  on <a href="https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling" target="_blank">08:47AM - 03 Jun 11 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<hr>
<p>Whitelisting the sshd allowed addresses can work by adding a special internal IP that uses Tor’s mapadddress to refer to some onion address generated for SSH access later on.</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.golinuxcloud.com/wp-content/uploads/2018/10/favicon.png" class="site-icon" width="16" height="16">
      <a href="https://www.golinuxcloud.com/restrict-allow-ssh-certain-users-groups-rhel/" target="_blank" title="12:32PM - 03 May 2019">GoLinuxCloud – 3 May 19</a>
  </header>
  <article class="onebox-body">
    <img src="https://www.golinuxcloud.com/wp-content/uploads/2019/05/ssh-1.jpg" class="thumbnail" width="" height="">

<h3><a href="https://www.golinuxcloud.com/restrict-allow-ssh-certain-users-groups-rhel/" target="_blank">How to restrict or allow ssh only from certain users, groups or hosts in Linux</a></h3>

<p>How to allow SSH for root login only from specific host or IP address? How to configure and restrict SSH to permit login only for certain users and/or groups?</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/15</link>
        <pubDate>Sat, 07 Dec 2019 15:11:13 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-15</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[madaidan]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="13" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Network namespaces?</p>
</blockquote>
</aside>
<p>I don’t see how they could be used for this.</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/14</link>
        <pubDate>Sat, 07 Dec 2019 15:06:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-14</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="10" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>That looks too permissive. access.conf allows you to specify logins from IP addresses. Maybe there’s a way to allow the user to login over the network rather than allowing them to login from everything.</p>
</blockquote>
</aside>
<p>Network namespaces?</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/13</link>
        <pubDate>Sat, 07 Dec 2019 15:01:18 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-13</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick_mobile]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="11" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>What if you add “user” to ssh while also hardening/tightening the rights of the ssh group?</p>
</blockquote>
</aside>
<aside class="quote no-group" data-post="10" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>That looks too permissive. access.conf allows you to specify logins from IP addresses. Maybe there’s a way to allow the user to login over the network rather than allowing them to login from everything.</p>
</blockquote>
</aside>
<p>I didn’t figure out how that would be possible.</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/12</link>
        <pubDate>Sat, 07 Dec 2019 14:58:03 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-12</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p><a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a></p>
<p>What if you add “user” to ssh while also hardening/tightening the rights of the ssh group? This way you don’t break expected behavior for sysadmins while also improving security. Perhaps prevent any non Torrified connection for the ssh group for Kicksecure too.</p>
<p>Perhaps one day automate creation of HS3 services with ssh initiation?</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/11</link>
        <pubDate>Sat, 07 Dec 2019 14:52:38 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-11</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[madaidan]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="9" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Would require adding.</p>
<pre><code class="lang-auto">+:ssh:ALL
</code></pre>
</blockquote>
</aside>
<p>That looks too permissive. access.conf allows you to specify logins from IP addresses. Maybe there’s a way to allow the user to login over the network rather than allowing them to login from everything.</p>
<aside class="quote no-group" data-post="9" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Users of Linux distributions where console-lockdown gets enabled by default (Whonix, Kicksecure) trying to set up an incoming SSH connection could have a hard time. They’d need to add <code>sudo addgroup user ssh</code> .</p>
<p>Therefore should user <code>user</code> (and later user <code>admin</code> ) be a member of group <code>ssh</code> by default? Imagine someone in not too far future installing Kicksecure on a VPS (using ISO installer using VPS web interface). Can’t ssh, because no default user is a member of group <code>ssh</code> .</p>
<p>Those not intending to use incoming ssh should remove themselves from group <code>ssh</code> . It’s not as hardened by default but otherwise huge usability mess. What do you think?</p>
</blockquote>
</aside>
<p>I don’t think they should be part of the <code>ssh</code> group by default as the majority of Whonix users probably won’t be using SSH but it should be documented in the wiki.</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/10</link>
        <pubDate>Sat, 07 Dec 2019 13:49:42 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-10</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Would require adding.</p>
<pre><code>+:ssh:ALL
</code></pre>
<p>Users of Linux distributions where console-lockdown gets enabled by default (Whonix, Kicksecure) trying to set up an incoming SSH connection could have a hard time. They’d need to add <code>sudo addgroup user ssh</code>.</p>
<p>Therefore should user <code>user</code> (and later user <code>admin</code>) be a member of group <code>ssh</code> by default? Imagine someone in not too far future installing Kicksecure on a VPS (using ISO installer using VPS web interface). Can’t ssh, because no default user is a member of group <code>ssh</code>.</p>
<p>Those not intending to use incoming ssh should remove themselves from group <code>ssh</code>. It’s not as hardened by default but otherwise huge usability mess. What do you think?</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/9</link>
        <pubDate>Sat, 07 Dec 2019 13:39:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-9</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
      <item>
        <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf</title>
        <dc:creator><![CDATA[madaidan]]></dc:creator>
        <description><![CDATA[
            <p>Why not create an ssh group and allow those users to login via ssh?</p>
          <p><a href="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/8</link>
        <pubDate>Sat, 07 Dec 2019 13:00:25 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8592-8</guid>
        <source url="http://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592.rss">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</source>
      </item>
  </channel>
</rss>

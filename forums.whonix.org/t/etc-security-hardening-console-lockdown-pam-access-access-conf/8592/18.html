<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf - #18 by Patrick - Development - Whonix Forum</title>
    <meta name="description" content="Is there something in /etc/security/ folder that we could harden?">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../8592.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;/etc/security Hardening? - Console Lockdown - pam_access - access.conf&#39;" href="../8592.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/18" />
<meta name="twitter:url" content="https://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/18" />
<meta property="og:title" content="/etc/security Hardening? - Console Lockdown - pam_access - access.conf" />
<meta name="twitter:title" content="/etc/security Hardening? - Console Lockdown - pam_access - access.conf" />
<meta property="og:description" content="new description:    Console Lockdown.  Allow members of group ‘console’ to use console and members of group ‘ssh’  to receive incoming SSH connections. Everyone else except members of group  ‘console-unrestricted’ are restricted from using console using ancient,  unpopular login methods such as using /bin/login over networks, which might  be exploitable. (CVE-2001-0797) Using pam_access.  Not enabled by default in this package since this package does not know which  users shall be added to group..." />
<meta name="twitter:description" content="new description:    Console Lockdown.  Allow members of group ‘console’ to use console and members of group ‘ssh’  to receive incoming SSH connections. Everyone else except members of group  ‘console-unrestricted’ are restricted from using console using ancient,  unpopular login methods such as using /bin/login over networks, which might  be exploitable. (CVE-2001-0797) Using pam_access.  Not enabled by default in this package since this package does not know which  users shall be added to group..." />
<meta property="article:published_time" content="2019-12-08T16:59:36+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../8592.html">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../../tag/component_security.html' class='discourse-tag' rel="tag">component_security</a>, 
            <a href='../../../tag/status_closed_issue_implemented.html' class='discourse-tag' rel="tag">status_closed_issue_implemented</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T15:01:18Z' class='post-time'>
                December 7, 2019,  3:01pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T15:01:18Z'>
          <span itemprop='position'>#13</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="10" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>That looks too permissive. access.conf allows you to specify logins from IP addresses. Maybe there’s a way to allow the user to login over the network rather than allowing them to login from everything.</p>
</blockquote>
</aside>
<p>Network namespaces?</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>
          <meta itemprop='keywords' content='component_security, status_closed_issue_implemented'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T15:06:17Z' class='post-time'>
                December 7, 2019,  3:06pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T15:06:17Z'>
          <span itemprop='position'>#14</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="13" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Network namespaces?</p>
</blockquote>
</aside>
<p>I don’t see how they could be used for this.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T15:11:13Z' class='post-time'>
                December 7, 2019,  3:11pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T15:11:13Z'>
          <span itemprop='position'>#15</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../../external.html?link=https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling" target="_blank">unix.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://unix.stackexchange.com/users/6960/lancebaynes" target="_blank">
    <img alt="LanceBaynes" src="../../../../external.html?link=https://www.gravatar.com/avatar/9592e22cc02163b23f9ffac2b8eb101e?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="../../../../external.html?link=https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling" target="_blank">How to restrict an SSH user to only allow SSH-tunneling?</a>
</h4>

<div class="tags">
  <strong>linux, ssh, account-restrictions</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../../external.html?link=https://unix.stackexchange.com/users/6960/lancebaynes" target="_blank">
    LanceBaynes
  </a>
  on <a href="../../../../external.html?link=https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling" target="_blank">08:47AM - 03 Jun 11 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<hr>
<p>Whitelisting the sshd allowed addresses can work by adding a special internal IP that uses Tor’s mapadddress to refer to some onion address generated for SSH access later on.</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://www.golinuxcloud.com/wp-content/uploads/2018/10/favicon.png" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://www.golinuxcloud.com/restrict-allow-ssh-certain-users-groups-rhel/" target="_blank" title="12:32PM - 03 May 2019">GoLinuxCloud – 3 May 19</a>
  </header>
  <article class="onebox-body">
    <img src="../../../../external.html?link=https://www.golinuxcloud.com/wp-content/uploads/2019/05/ssh-1.jpg" class="thumbnail" width="" height="">

<h3><a href="../../../../external.html?link=https://www.golinuxcloud.com/restrict-allow-ssh-certain-users-groups-rhel/" target="_blank">How to restrict or allow ssh only from certain users, groups or hosts in Linux</a></h3>

<p>How to allow SSH for root login only from specific host or IP address? How to configure and restrict SSH to permit login only for certain users and/or groups?</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T15:16:00Z' class='post-time'>
                December 7, 2019,  3:16pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T15:16:00Z'>
          <span itemprop='position'>#16</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>We can use</p>
<pre><code>+:ssh:ALL EXCEPT LOCAL
</code></pre>
<p>Which should allow the <code>ssh</code> group to login anywhere except local things which should only be the network.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-08T06:42:51Z' class='post-time'>
                December 8, 2019,  6:42am
              </time>
              <meta itemprop='dateModified' content='2019-12-08T06:42:51Z'>
          <span itemprop='position'>#17</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="15" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p><a href="../../../../external.html?link=https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling">unix.stackexchange.com</a></p>
<p><a href="../../../../external.html?link=https://unix.stackexchange.com/users/6960/lancebaynes"> <img src="../../../../external.html?link=https://www.gravatar.com/avatar/9592e22cc02163b23f9ffac2b8eb101e?s=128&amp;d=identicon&amp;r=PG" alt="LanceBaynes" width="60" height="60"> </a></p>
<h4><a href="../../../../external.html?link=https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling">How to restrict an SSH user to only allow SSH-tunneling?</a></h4>
<p><strong>linux, ssh, account-restrictions</strong></p>
<p>asked by <a href="../../../../external.html?link=https://unix.stackexchange.com/users/6960/lancebaynes"> LanceBaynes </a> on <a href="../../../../external.html?link=https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling">08:47AM - 03 Jun 11 UTC</a></p>
<p>Whitelisting the sshd allowed addresses can work by adding a special internal IP that uses Tor’s mapadddress to refer to some onion address generated for SSH access later on.</p>
<p><img src="../../../../external.html?link=https://www.golinuxcloud.com/wp-content/uploads/2018/10/favicon.png" alt width="16" height="16"> <a href="../../../../external.html?link=https://www.golinuxcloud.com/restrict-allow-ssh-certain-users-groups-rhel/">GoLinuxCloud – 3 May 19</a></p>
<p><img src="../../../../external.html?link=https://www.golinuxcloud.com/wp-content/uploads/2019/05/ssh-1.jpg" alt></p>
<h3><a href="../../../../external.html?link=https://www.golinuxcloud.com/restrict-allow-ssh-certain-users-groups-rhel/">How to restrict or allow ssh only from certain users, groups or hosts in Linux</a></h3>
<p>How to allow SSH for root login only from specific host or IP address? How to configure and restrict SSH to permit login only for certain users and/or groups?</p>
</blockquote>
</aside>
<p>That might be further SSH related hardening. Please open a new forum thread or phabricator ticket for this. The purpose of this thread is to find optional hardening and we’re bound to the features / syntax of these files:</p>
<ul>
<li><a href="../../../../external.html?link=https://linux.die.net/man/8/pam_access">https://linux.die.net/man/8/pam_access</a></li>
<li><a href="../../../../external.html?link=https://linux.die.net/man/5/access.conf">https://linux.die.net/man/5/access.conf</a></li>
</ul>
<p>Which is limited.</p>
<aside class="quote no-group" data-post="16" data-topic="8592" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>We can use</p>
<pre><code class="lang-auto">+:ssh:ALL EXCEPT LOCAL
</code></pre>
<p>Which should allow the <code>ssh</code> group to login anywhere except local things which should only be the network.</p>
</blockquote>
</aside>
<p>Did that.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/c1800b13fe33a1c129dcb30c51dbead7f894b818" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/c1800b13fe33a1c129dcb30c51dbead7f894b818" target="_blank">separate group "ssh" for incoming ssh console permission</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-07" data-time="16:26:39" data-timezone="UTC">04:26PM - 07 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 4 additions and 0 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/c1800b13fe33a1c129dcb30c51dbead7f894b818" target="_blank">
          <span class="added">+4</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">Thanks to @madaidan
https://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/16</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/1464f01d191ee4e01ed2ec94f4faf8d17ec62b03" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/1464f01d191ee4e01ed2ec94f4faf8d17ec62b03" target="_blank">description</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-08" data-time="06:30:42" data-timezone="UTC">06:30AM - 08 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 8 additions and 6 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/1464f01d191ee4e01ed2ec94f4faf8d17ec62b03" target="_blank">
          <span class="added">+8</span>
          <span class="removed">-6</span>
        </a>
      </div>
    </div>

  </div>
</div>




  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-08T16:59:36Z' class='post-time'>
                December 8, 2019,  4:59pm
              </time>
              <meta itemprop='dateModified' content='2019-12-08T16:59:36Z'>
          <span itemprop='position'>#18</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>new description:</p>
<blockquote>
<ul>
<li>Console Lockdown.<br>
Allow members of group ‘console’ to use console and members of group ‘ssh’<br>
to receive incoming SSH connections. Everyone else except members of group<br>
‘console-unrestricted’ are restricted from using console using ancient,<br>
unpopular login methods such as using /bin/login over networks, which might<br>
be exploitable. (CVE-2001-0797) Using pam_access.<br>
Not enabled by default in this package since this package does not know which<br>
users shall be added to group ‘console’ and/or ‘ssh’ and would break console,<br>
X Window System and ssh login since files in<br>
/usr/share/pam-configs/console-lockdown-security-misc result in modifications<br>
of /etc/pam.d/common-account file which not only applies to /etc/pam.d/login<br>
but also all other services such as /etc/pam.d/ssh.</li>
</ul>
</blockquote>
<aside class="quote no-group quote-modified" data-post="7" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>One part is easily solvable:</p>
<blockquote>
<p>Not enabled by default in this package since this package does not know which<br>
users shall be added to group ‘console’</p>
</blockquote>
<p>pam console-lockdown could be enabled in package anon-base-files for Whonix / Kicksecure.</p>
</blockquote>
</aside>
<p>This is done.</p>
<p><a href="../../../../external.html?link=https://github.com/Whonix/anon-base-files/blob/master/debian/anon-base-files.postinst">anon-base-files <code>/debian/anon-base-files.postinst</code></a>:</p>
<pre><code>           user_to_be_created=user

           ## security-misc: Console Lockdown.
           ## Make sure this group exists. Might not exist if security-misc is not (yet) installed.
           addgroup --system console
           addgroup --system ssh
</code></pre>
<hr>
<pre><code>           ## security-misc: Console Lockdown.
           addgroup "$user_to_be_created" console
           addgroup "$user_to_be_created" ssh

           ## By package security-misc.
           pam-auth-update --enable console-lockdown-security-misc

           ## In Qubes and for existing installations Console Lockdown is
           ## is handled by whonix-legacy package.
</code></pre>
<p>But as you see it adds user <code>user</code> to both groups, <code>console</code> and <code>ssh</code>. This is non-perfect. Will elaborate under [1].</p>
<aside class="quote no-group quote-modified" data-post="7" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>But the following part is not easily solved.</p>
<blockquote>
<p>would break ssh login since files<br>
in /usr/share/pam-configs/console-lockdown result in modifications of<br>
/etc/pam.d/common-account file which not only applies to /etc/pam.d/login but<br>
also all other services such as /etc/pam.d/ssh.</p>
</blockquote>
</blockquote>
</aside>
<p><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/debian/security-misc.preinst">security-misc <code>/debian/security-misc.preinst</code></a> how has code to refuse installation if no user is a member of group <code>console</code> or <code>console-unrestricted</code>. Additinoally, if the <code>ssh.service</code> is activated (user has OpenSSH server package <code>openssh-server</code> instlled) it refuses installation if no user is a member of group <code>ssh</code>.</p>
<p>Therefore security-misc could enable console lockdown by default and probably will after some testing.</p>
<p>[1] I don’t think it’s possible to have a perfect solution for console lockdown. It needs basic information - are you going to use SSH or not? Breaking SSH servers of new or existing installations is not an option.</p>
<p>Instead, I’ve invented a new tool <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/usr/bin/hardening-enable"><code>/usr/bin/hardening-enable</code></a> which I describe here in more detail:</p>
<aside class="quote quote-modified" data-post="1" data-topic="8609">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="../../security-hardening-tool-usr-bin-hardening-enable-by-security-misc/8609.html">Security Hardening Tool - /usr/bin/hardening-enable by security-misc</a> <a class="badge-wrapper  bullet" href="../../../c/development/8.html"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/usr/bin/hardening-enable">/usr/bin/hardening-enable</a> 
It can be used to easily opt-in everything advanced. For now it has these features: 

/usr/bin/hardening-enable --ssh


[Hide Hardware Info] 
Enabling enable hide-hardware-info.service by running ‘systemctl enable hide-hardware-info.service’… 
Success. 
[NOEXEC] 
Enabling noexec by creating file /etc/noexec … 
Success. 
[LKRG - Linux Kernel Runtime Guard] 
LKRG hardening by creating /etc/sysctl.d/40-security-misc-autogenerated.conf … 
Success. 


Or. 
/usr/bin/hardenin…
  </blockquote>
</aside>

<p>Maybe this configuration question SSH vs no-SSH could be asked during first boot.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-10T19:48:34Z' class='post-time'>
                December 10, 2019,  7:48pm
              </time>
              <meta itemprop='dateModified' content='2019-12-10T19:48:34Z'>
          <span itemprop='position'>#19</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>
<p>Dec 10 17:18:56 host audit[7643]: AVC apparmor=“DENIED” operation=“open” profile="/usr/bin/whonixcheck" name="/etc/security/access-security-misc.conf" pid=7643 comm=“sudo” requested_mask=“r” denied_mask=“r” fsuid=0 ouid=0<br>
Dec 10 17:18:56 host audit[7643]: SYSCALL arch=c000003e syscall=257 success=no exit=-13 a0=ffffff9c a1=5686851ff273 a2=0 a3=0 items=1 ppid=7642 pid=7643 auid=4294967295 uid=1000 gid=1000 euid=0 suid=0 fsuid=0 egid=1000 sgid=1000 fsgid=1000 tty=(none) ses=4294967295 comm=“sudo” exe="/usr/bin/sudo" subj==/usr/bin/whonixcheck (enforce) key=(null)<br>
Dec 10 17:18:56 host audit: CWD cwd="/"<br>
Dec 10 17:18:56 host audit: PATH item=0 name="/etc/security/access-security-misc.conf" inode=140805 dev=ca:03 mode=0100644 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0000000000000000 cap_fi=0000000000000000 cap_fe=0 cap_fver=0<br>
Dec 10 17:18:56 host audit: PROCTITLE proctitle=7375646F002D2D6E6F6E2D696E746572616374697665002D750077686F6E6978636865636B002F7573722F6C69622F77686F6E6978636865636B2F77686F6E6978636865636B002D2D6461656D6F6E002D2D677569002D2D636C69<br>
Dec 10 17:18:56 host sudo[7643]: pam_access(sudo:account): failed to open accessfile=[/etc/security/access-security-misc.conf]: Permission denied<br>
Dec 10 17:18:56 host sudo[7643]: pam_access(sudo:account): failed to parse the module arguments</p>
</blockquote>
<p>Need to add /etc/security/access-security-misc.conf to apparmor abstractions/base?</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-10T19:53:43Z' class='post-time'>
                December 10, 2019,  7:53pm
              </time>
              <meta itemprop='dateModified' content='2019-12-10T19:53:43Z'>
          <span itemprop='position'>#20</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>This is also broken:</p>
<aside class="onebox githubblob">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/sdwdate-gui/blob/master/etc/qubes-rpc/whonix.NewStatus" target="_blank">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="../../../../external.html?link=https://github.com/Whonix/sdwdate-gui/blob/master/etc/qubes-rpc/whonix.NewStatus" target="_blank">Whonix/sdwdate-gui/blob/master/etc/qubes-rpc/whonix.NewStatus</a></h4>
<pre><code class="lang-newstatus">#!/bin/bash

## Copyright (C) 2018 - 2019 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions

sudo \
   -u sdwdate-gui \
   bash \
     -c \
     'echo "'$1'" | tee /run/sdwdate-gui/anon-status &gt;/dev/null'
</code></pre>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<blockquote>
<p>Dec 10 16:42:49 host sudo[7369]: pam_access(sudo:account): access denied for user <code>user' from </code>’<br>
Dec 10 16:42:49 host sudo[7369]:     user : PAM account management error: Permission denied ; TTY=unknown ; PWD=/home/user ; USER=sdwdate-gui ; COMMAND=/usr/bin/bash -c echo “disp3655” | tee /run/sdwdate-gui/anon-status &gt;/dev/null</p>
</blockquote>
<p>/etc/pam.d/sudo should probably not use pam_access. But due to how /usr/share/pam-configs works, I don’t see how it could apply to /etc/pam.d/login only. Would require writing to /etc/pam.d/login directly which is bad.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-10T20:17:56Z' class='post-time'>
                December 10, 2019,  8:17pm
              </time>
              <meta itemprop='dateModified' content='2019-12-10T20:17:56Z'>
          <span itemprop='position'>#21</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="19" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Need to add /etc/security/access-security-misc.conf to apparmor abstractions/base?</p>
</blockquote>
</aside>
<p>Why is whonixcheck trying to access it? Why not just add it to the whonixcheck profile?</p>
<aside class="quote no-group" data-post="20" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>/etc/pam.d/sudo should probably not use pam_access. But due to how /usr/share/pam-configs works, I don’t see how it could apply to /etc/pam.d/login only. Would require writing to /etc/pam.d/login directly which is bad.</p>
</blockquote>
</aside>
<p>Maybe this would work:</p>
<pre><code>Conflicts: sudo</code></pre>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-10T20:29:40Z' class='post-time'>
                December 10, 2019,  8:29pm
              </time>
              <meta itemprop='dateModified' content='2019-12-10T20:29:40Z'>
          <span itemprop='position'>#22</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Ah, the issue isn’t /etc/pam.d/sudo but /etc/pam.d/common-account (which sudo has an include rule for).</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-10T21:00:34Z' class='post-time'>
                December 10, 2019,  9:00pm
              </time>
              <meta itemprop='dateModified' content='2019-12-10T21:00:34Z'>
          <span itemprop='position'>#23</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="21" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Why is whonixcheck trying to access it?</p>
</blockquote>
</aside>
<p>It’s not. But it uses sudo. And then pam calls it.</p>
<aside class="quote no-group" data-post="21" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Why not just add it to the whonixcheck profile?</p>
</blockquote>
</aside>
<p>It’s just a symptom. Would be happening with other applications too.</p>
<aside class="quote no-group" data-post="22" data-topic="8592" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Ah, the issue isn’t /etc/pam.d/sudo but /etc/pam.d/common-account (which sudo has an include rule for).</p>
</blockquote>
</aside>
<p>Exactly.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-11T17:35:55Z' class='post-time'>
                December 11, 2019,  5:35pm
              </time>
              <meta itemprop='dateModified' content='2019-12-11T17:35:55Z'>
          <span itemprop='position'>#24</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="23" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/p/898d66/40.png" class="avatar"> Patrick_mobile:</div>
<blockquote>
<p>It’s just a symptom. Would be happening with other applications too.</p>
</blockquote>
</aside>
<p>Then it should be added to the base abstraction.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-11T20:43:11Z' class='post-time'>
                December 11, 2019,  8:43pm
              </time>
              <meta itemprop='dateModified' content='2019-12-11T20:43:11Z'>
          <span itemprop='position'>#25</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Found a potential solution. Using pam_exec, environment variable <code>PAM_SERVICE</code>, exit codes (depending on if <code>PAM_SERVICE</code> is set to <code>login</code>) and then using the /etc/pam.d feature “<code>jumping over the next N modules in the stack</code>”.</p>
<aside class="quote no-group" data-post="21" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Maybe this would work:</p>
<pre><code class="lang-auto">Conflicts: sudo
</code></pre>
</blockquote>
</aside>
<p>That probably means just that when users run <code>sudo pam-auth-update</code> that they cannot enable two conflicting pam modules at the same time.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-12T13:45:33Z' class='post-time'>
                December 12, 2019,  1:45pm
              </time>
              <meta itemprop='dateModified' content='2019-12-12T13:45:33Z'>
          <span itemprop='position'>#26</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../../external.html?link=https://serverfault.com/questions/134471/success-n-control-syntax-in-pam-conf-pam-d-files" target="_blank">serverfault.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://serverfault.com/users/5592/jamie" target="_blank">
    <img alt="Jamie" src="../../../../external.html?link=https://www.gravatar.com/avatar/d3ecad86d72c5ca5e3ccbcc46a0ad66a?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="../../../../external.html?link=https://serverfault.com/questions/134471/success-n-control-syntax-in-pam-conf-pam-d-files" target="_blank">"success=n" control syntax in pam.conf / pam.d/* files </a>
</h4>

<div class="tags">
  <strong>linux, pam</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../../external.html?link=https://serverfault.com/users/5592/jamie" target="_blank">
    Jamie
  </a>
  on <a href="../../../../external.html?link=https://serverfault.com/questions/134471/success-n-control-syntax-in-pam-conf-pam-d-files" target="_blank">03:38PM - 21 Apr 10 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-12T14:03:27Z' class='post-time'>
                December 12, 2019,  2:03pm
              </time>
              <meta itemprop='dateModified' content='2019-12-12T14:03:27Z'>
          <span itemprop='position'>#27</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/729fa26eca292d60bcbeaba05d8878ff6112876e" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/729fa26eca292d60bcbeaba05d8878ff6112876e" target="_blank">use pam_acccess only for /etc/pam.d/login</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-12" data-time="14:00:08" data-timezone="UTC">02:00PM - 12 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 4 files with 25 additions and 50 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/729fa26eca292d60bcbeaba05d8878ff6112876e" target="_blank">
          <span class="added">+25</span>
          <span class="removed">-50</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">remove "Allow members of group 'ssh' to login."
remove "+:ssh:ALL EXCEPT LOCAL"</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<blockquote>
<p>use pam_acccess only for /etc/pam.d/login<br>
remove <code>Allow members of group 'ssh' to login.</code><br>
remove <code>+:ssh:ALL EXCEPT LOCAL</code></p>
</blockquote>
<p>The SSH restrictions earlier was just a byproduct of not knowing how to implement this better, i.e like how it is implemented now. Now this is effectively only used for <code>/etc/pam.d/login</code>.</p>
<p>Does pam_access line</p>
<pre><code>+:ssh:ALL EXCEPT LOCAL
</code></pre>
<p>make sense for <code>/etc/pam.d/ssh</code> or should pam_access be used for any other services in <code>/etc/pam.d</code> folder too?</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-31T11:12:28Z' class='post-time'>
                March 31, 2020, 11:12am
              </time>
              <meta itemprop='dateModified' content='2020-03-31T11:12:28Z'>
          <span itemprop='position'>#28</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/814f613a2fac12b892dfb6dcf53ee628e340c7b2" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/814f613a2fac12b892dfb6dcf53ee628e340c7b2" target="_blank">When using systemd-nspawn (chroot) then `login` requires console 'console' to be permitted.</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-03-31" data-time="11:08:25" data-timezone="UTC">11:08AM - 31 Mar 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 2 additions and 1 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/814f613a2fac12b892dfb6dcf53ee628e340c7b2" target="_blank">
          <span class="added">+2</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>

  </div>
</div>




  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-04-02T09:53:38Z' class='post-time'>
                April 2, 2020,  9:53am
              </time>
              <meta itemprop='dateModified' content='2020-04-02T09:53:38Z'>
          <span itemprop='position'>#29</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/pull/74" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/pull/74" target="_blank">debian: .preinst, add user to groups automatically</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> ← <code>h0tw4t3r:patch-1</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-03-30" data-time="15:23:34" data-timezone="UTC">03:23PM - 30 Mar 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/h0tw4t3r" target="_blank">
          <img alt="h0tw4t3r" src="../../../../external.html?link=https://avatars0.githubusercontent.com/u/35642018?v=4" class="onebox-avatar-inline" width="20" height="20">
          h0tw4t3r
        </a>
      </div>

      <div class="lines" title="2 commits changed 3 files with 52 additions and 3 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/pull/74/files" target="_blank">
          <span class="added">+52</span>
          <span class="removed">-3</span>
        </a>
      </div>
    </div>

  </div>
</div>
  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-04-02T10:06:24Z' class='post-time'>
                April 2, 2020, 10:06am
              </time>
              <meta itemprop='dateModified' content='2020-04-02T10:06:24Z'>
          <span itemprop='position'>#30</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="29" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/pull/74">debian: .preinst, add user to groups automatically</a></p>
</blockquote>
</aside>
<blockquote>
<p>Why don’t we allow group members of group <code>sudo</code> to use console by editing <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/etc/security/access-security-misc.conf"> <code>/etc/security/access-security-misc.conf</code> </a>? Group members of group <code>sudo</code> could run <code>sudo addgroup user console</code> anyhow. Therefore no security advantage by not doing that.</p>
</blockquote>
<p>Did that:</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/a7f2a2a3b6b408a0545f55b8fed9cc17fbd8f843" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/a7f2a2a3b6b408a0545f55b8fed9cc17fbd8f843" target="_blank">console lockdown: allow members of group `sudo` to use console</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-04-02" data-time="10:04:45" data-timezone="UTC">10:04AM - 02 Apr 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 4 additions and 0 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/a7f2a2a3b6b408a0545f55b8fed9cc17fbd8f843" target="_blank">
          <span class="added">+4</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">https://forums.whonix.org/t/etc-security-hardening/8592
https://github.com/Whonix/security-misc/pull/74#issuecomment-607748407
https://www.whonix.org/wiki/Dev/Strong_Linux_User_Account_Isolation#Console_Lockdown</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Review for full file welcome:</p>
<p><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/etc/security/access-security-misc.conf">https://github.com/Whonix/security-misc/blob/master/etc/security/access-security-misc.conf</a></p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/81a989'><span itemprop='name'>81a989</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-08-01T15:14:38Z' class='post-time'>
                August 1, 2020,  3:14pm
              </time>
              <meta itemprop='dateModified' content='2020-08-01T15:14:38Z'>
          <span itemprop='position'>#31</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><a class="mention" href="../../../../external.html?link=https://forums.whonix.org/u/patrick">@Patrick</a>, there are syntax errors in the file. Groups should be surrounded with “(group)” instead of as “group”. It works as is unless any users with the same name as the groups are created. See access.conf to verify. I fixed it for you.</p>
<p>line 30: +:(console):console tty1 tty2 tty3 tty4 tty5 tty6 tty7 pts/0 pts/1 pts/2 pts/3 pts/4 pts/5 pts/6 pts/7 pts/8 pts/9 hvc0 hvc1 hvc2 hvc3 hvc4 hvc5 hvc6 hvc7 hvc8 hvc9 ttyS0 ttyS1 ttyS2 ttyS3 ttyS4 ttyS5 ttyS6 ttyS7 ttyS8 ttyS9</p>
<p>line 34: +:(sudo):console tty1 tty2 tty3 tty4 tty5 tty6 tty7 pts/0 pts/1 pts/2 pts/3 pts/4 pts/5 pts/6 pts/7 pts/8 pts/9 hvc0 hvc1 hvc2 hvc3 hvc4 hvc5 hvc6 hvc7 hvc8 hvc9 ttyS0 ttyS1 ttyS2 ttyS3 ttyS4 ttyS5 ttyS6 ttyS7 ttyS8 ttyS9</p>
<p>line 38: -:ALL EXCEPT (console-unrestricted):ALL</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-08-03T12:14:02Z' class='post-time'>
                August 3, 2020, 12:14pm
              </time>
              <meta itemprop='dateModified' content='2020-08-03T12:14:02Z'>
          <span itemprop='position'>#32</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Thanks. Good catch. Fixed.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/7e267ab49850362c02374a15fdba2409a5487a0f" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/7e267ab49850362c02374a15fdba2409a5487a0f" target="_blank">fix, allow group `sudo` and `console` to use consoles</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-08-03" data-time="12:12:19" data-timezone="UTC">12:12PM - 03 Aug 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 3 additions and 3 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/7e267ab49850362c02374a15fdba2409a5487a0f" target="_blank">
          <span class="added">+3</span>
          <span class="removed">-3</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">fix /etc/security/access-security-misc.conf syntax error
Thanks to @81a989 for the bug report!
https://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/31</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

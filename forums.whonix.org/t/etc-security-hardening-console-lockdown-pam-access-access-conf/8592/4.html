<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>/etc/security Hardening? - Console Lockdown - pam_access - access.conf - #4 by Patrick - Development - Whonix Forum</title>
    <meta name="description" content="Is there something in /etc/security/ folder that we could harden?">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../8592.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;/etc/security Hardening? - Console Lockdown - pam_access - access.conf&#39;" href="../8592.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/4" />
<meta name="twitter:url" content="https://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/4" />
<meta property="og:title" content="/etc/security Hardening? - Console Lockdown - pam_access - access.conf" />
<meta name="twitter:title" content="/etc/security Hardening? - Console Lockdown - pam_access - access.conf" />
<meta property="og:description" content="pam_access  Quote https://linux.die.net/man/8/pam_access   By default rules for access management are taken from config file /etc/security/access.conf if you don’t specify another file.     grep -r -i pam_access /etc/pam.d  (commented out by Debian default)   /etc/pam.d/login:# account  required       pam_access.so    pam_securetty    grep -r -i pam_securetty /etc/pam.d   /etc/pam.d/login:auth [success=ok new_authtok_reqd=ok ignore=ignore user_unknown=bad default=die] pam_securetty.so   Quote ht..." />
<meta name="twitter:description" content="pam_access  Quote https://linux.die.net/man/8/pam_access   By default rules for access management are taken from config file /etc/security/access.conf if you don’t specify another file.     grep -r -i pam_access /etc/pam.d  (commented out by Debian default)   /etc/pam.d/login:# account  required       pam_access.so    pam_securetty    grep -r -i pam_securetty /etc/pam.d   /etc/pam.d/login:auth [success=ok new_authtok_reqd=ok ignore=ignore user_unknown=bad default=die] pam_securetty.so   Quote ht..." />
<meta property="article:published_time" content="2019-12-06T15:08:52+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="next" href="../85924658.html?page=2">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../8592.html">/etc/security Hardening? - Console Lockdown - pam_access - access.conf</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../../tag/component_security.html' class='discourse-tag' rel="tag">component_security</a>, 
            <a href='../../../tag/status_closed_issue_implemented.html' class='discourse-tag' rel="tag">status_closed_issue_implemented</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-05T16:27:23Z' class='post-time'>
                December 5, 2019,  4:27pm
              </time>
              <meta itemprop='dateModified' content='2020-05-15T17:37:35Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Is there something in <code>/etc/security/</code> folder that we could harden?</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>
          <meta itemprop='keywords' content='component_security, status_closed_issue_implemented'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../whonix-virtualbox-15-0-0-8-7-testers-wanted-vanguards-tcp-isn-leak-protection-extensive-hardening/8914.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../whonix-virtualbox-15-0-0-8-7-testers-wanted-vanguards-tcp-isn-leak-protection-extensive-hardening/8914.html'>
                      <span itemprop='name'>Whonix VirtualBox 15.0.0.8.7 - Testers Wanted! - vanguards; TCP ISN Leak Protection; Extensive Hardening! 🔥</span>
                    </a>
                    <meta itemprop='position' content='1'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../whonix-kvm-kicksecure-15-0-0-8-7-released-a-qunatum-leap-forward/8921.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../whonix-kvm-kicksecure-15-0-0-8-7-released-a-qunatum-leap-forward/8921.html'>
                      <span itemprop='name'>Whonix KVM / Kicksecure 15.0.0.8.7 Released! - A Qunatum Leap Forward</span>
                    </a>
                    <meta itemprop='position' content='2'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../whonix-virtualbox-15-0-0-8-9-point-release-vanguards-tcp-isn-leak-protection-extensive-hardening/8994.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../whonix-virtualbox-15-0-0-8-9-point-release-vanguards-tcp-isn-leak-protection-extensive-hardening/8994.html'>
                      <span itemprop='name'>Whonix VirtualBox 15.0.0.8.9 - Point Release! - vanguards; TCP ISN Leak Protection; Extensive Hardening! 🔥</span>
                    </a>
                    <meta itemprop='position' content='3'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-05T18:42:30Z' class='post-time'>
                December 5, 2019,  6:42pm
              </time>
              <meta itemprop='dateModified' content='2019-12-05T18:42:30Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>We can set process limits in limits.conf to prevent things like fork bombs but that may be too restrictive as it won’t allow a legitimate user to start too many processes.</p>
<p>Apart from that, I don’t know of anything else than can be hardened.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-06T14:28:09Z' class='post-time'>
                December 6, 2019,  2:28pm
              </time>
              <meta itemprop='dateModified' content='2019-12-06T14:28:09Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>With the upcoming user / admin split limits might make sense. Could we<br>
say user “user” can use “95%” (or something as high as possible) of<br>
resources but keep “5%” available on demand for user “admin” / root to<br>
give them the ability to shut down locked up user “user” accounts?</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-06T15:08:52Z' class='post-time'>
                December 6, 2019,  3:08pm
              </time>
              <meta itemprop='dateModified' content='2019-12-06T15:08:52Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><strong>pam_access</strong></p>
<p>Quote <a href="../../../../external.html?link=https://linux.die.net/man/8/pam_access">https://linux.die.net/man/8/pam_access</a></p>
<blockquote>
<p>By default rules for access management are taken from config file <code>/etc/security/access.conf</code> if you don’t specify another file.</p>
</blockquote>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../../external.html?link=https://serverfault.com/questions/417423/what-service-reads-etc-security-access-conf" target="_blank">serverfault.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://serverfault.com/users/49013/tom" target="_blank">
    <img alt="Tom" src="../../../../external.html?link=https://www.gravatar.com/avatar/a011eb06daeb1bd1225b941dd06ee622?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="../../../../external.html?link=https://serverfault.com/questions/417423/what-service-reads-etc-security-access-conf" target="_blank">What service reads /etc/security/access.conf?</a>
</h4>

<div class="tags">
  <strong>linux, centos, cron, login</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../../external.html?link=https://serverfault.com/users/49013/tom" target="_blank">
    Tom
  </a>
  on <a href="../../../../external.html?link=https://serverfault.com/questions/417423/what-service-reads-etc-security-access-conf" target="_blank">03:59PM - 14 Aug 12 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<pre><code>grep -r -i pam_access /etc/pam.d
</code></pre>
<p>(commented out by Debian default)</p>
<blockquote>
<p>/etc/pam.d/login:# account  required       pam_access.so</p>
</blockquote>
<hr>
<p><strong>pam_securetty</strong></p>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../../external.html?link=https://unix.stackexchange.com/questions/555923/which-services-read-the-etc-securetty-configuration-file" target="_blank">unix.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://unix.stackexchange.com/users/49297/adrelanos" target="_blank">
    <img alt="adrelanos" src="../../../../external.html?link=https://www.gravatar.com/avatar/83f6805262f0dcc117814487c5b2d1c4?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="../../../../external.html?link=https://unix.stackexchange.com/questions/555923/which-services-read-the-etc-securetty-configuration-file" target="_blank">Which services read the /etc/securetty configuration file?</a>
</h4>

<div class="tags">
  <strong>securetty</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../../external.html?link=https://unix.stackexchange.com/users/49297/adrelanos" target="_blank">
    adrelanos
  </a>
  on <a href="../../../../external.html?link=https://unix.stackexchange.com/questions/555923/which-services-read-the-etc-securetty-configuration-file" target="_blank">02:45PM - 06 Dec 19 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<pre><code>grep -r -i pam_securetty /etc/pam.d
</code></pre>
<blockquote>
<p>/etc/pam.d/login:auth [success=ok new_authtok_reqd=ok ignore=ignore user_unknown=bad default=die] pam_securetty.so</p>
</blockquote>
<p>Quote <a href="../../../../external.html?link=https://linux.die.net/man/8/pam_securetty">https://linux.die.net/man/8/pam_securetty</a> (<strong>bold</strong> is mine)</p>
<blockquote>
<p>[…] This module has <strong>no effect on non-root users</strong> and […]</p>
</blockquote>
<hr>
<p>In <a href="../../restrict-root-access/7658.html" class="inline-onebox">Restrict root access</a> if I remember right it was discussed that <code>/etc/securetty</code> contains lots of very unpopular, obscure login options and it is better to restrict that for better security hardening. But <code>/etc/securetty</code> is for <code>root</code> only.</p>
<p>Can we use pam_access to restrict non-root users from using obscure login options too? <a href="../../../../external.html?link=https://linux.die.net/man/5/access.conf">https://linux.die.net/man/5/access.conf</a> says it can be used tl block non-local login. But <code>pam_access</code> would only be used for <code>/etc/pam.d/login</code> anyhow? <code>/etc/pam.d/ssh</code> (“remote login?”) is separate. Therefore <code>/etc/pam.d/login</code> “remote login” could be ancient, unpopular, obscure login options.</p>
<p>There was a <code>/bin/login</code> remote overflow vulnerability in past:</p>
<ul>
<li><a href="../../../../external.html?link=https://www.giac.org/paper/gcih/293/buffer-overflow-bin-login/103062">https://www.giac.org/paper/gcih/293/buffer-overflow-bin-login/103062</a></li>
<li><a href="../../../../external.html?link=https://www.exploit-db.com/exploits/89">https://www.exploit-db.com/exploits/89</a></li>
</ul>
<p>Need to make sure that we don’t break <a href="../../../../external.html?link=https://www.whonix.org/wiki/Recovery#Serial_Console">serial console</a>.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-06T16:43:22Z' class='post-time'>
                December 6, 2019,  4:43pm
              </time>
              <meta itemprop='dateModified' content='2019-12-06T16:43:22Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="3" data-topic="8592" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>With the upcoming user / admin split limits might make sense. Could we say user “user” can use “95%” (or something as high as possible) of resources but keep “5%” available on demand for user “admin” / root to give them the ability to shut down locked up user “user” accounts?</p>
</blockquote>
</aside>
<p>It doesn’t accept percentages,</p>
<p>Cgroups may be a better option for that. Systemd uses cgroups and user sessions are run under a systemd slice by default AFAIK so we can just edit that <a href="../../../../external.html?link=https://www.freedesktop.org/software/systemd/man/systemd.resource-control.html">https://www.freedesktop.org/software/systemd/man/systemd.resource-control.html</a></p>
<aside class="quote no-group" data-post="4" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Can we use pam_access to restrict non-root users from using obscure login options too?</p>
</blockquote>
</aside>
<p>Yes. Quickly looking over it, it seems we can use</p>
<pre><code>+:user:tty1 tty2 tty3 tty4 tty5 tty6
+:root:tty1 tty2 tty3 tty4 tty5 tty6
-:ALL:ALL
</code></pre>
<p>Which would allow the <code>user</code> and <code>root</code> users to login form tty[1-6] and deny all other login options for every user (not just <code>user</code> and <code>root</code>).</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
              split this topic 
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T12:09:22Z' class='post-time'>
                December 7, 2019, 12:09pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T12:09:22Z'>
          <span itemprop='position'>#6</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>2 posts were split to a new topic: <a href="../../pam-namspace-namespace-conf-to-give-user-own-private-tmp/8600.html">pam_namspace / namespace.conf to gie user own private /tmp</a></p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T12:35:16Z' class='post-time'>
                December 7, 2019, 12:35pm
              </time>
              <meta itemprop='dateModified' content='2019-12-08T16:42:42Z'>
          <span itemprop='position'>#7</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>It’s implemented.</p>
<ul>
<li><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/usr/share/pam-configs/console-lockdown-security-misc">https://github.com/Whonix/security-misc/blob/master/usr/share/pam-configs/console-lockdown-security-misc</a></li>
<li><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/etc/security/access-security-misc.conf">https://github.com/Whonix/security-misc/blob/master/etc/security/access-security-misc.conf</a></li>
<li><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/usr/lib/security-misc/pam_tally2-info">https://github.com/Whonix/security-misc/blob/master/usr/lib/security-misc/pam_tally2-info</a></li>
</ul>
<p>Why use <code>accessfile=/etc/security/access-security-misc.conf</code> and not <code>/etc/security/access.conf</code>? To avoid need for config-package-dev displace.</p>
<p>Why invent <code>/usr/share/pam-configs/console-lockdown</code>? Because pam_access is not used by Debian default pam config. No setting in <code>/etc/security/access.conf</code> has any effect without adding it to <code>/etc/pam.d</code>.</p>
<p>But I cannot enable it by default. Why? See description:</p>
<blockquote>
<p>Console Lockdown.<br>
Allow members of group ‘console’ to use console. Everyone else except<br>
members of group ‘console-unrestricted’ are restricted from using console<br>
using ancient, unpopular login methods such as using /bin/login over networks,<br>
which might be exploitable. (CVE-2001-0797) Using pam_access.<br>
Not enabled by default in this package since this package does not know which<br>
users shall be added to group ‘console’ and would break ssh login since files<br>
in /usr/share/pam-configs/console-lockdown result in modifications of<br>
/etc/pam.d/common-account file which not only applies to /etc/pam.d/login but<br>
also all other services such as /etc/pam.d/ssh.</p>
</blockquote>
<p>One part is easily solvable:</p>
<blockquote>
<p>Not enabled by default in this package since this package does not know which<br>
users shall be added to group ‘console’</p>
</blockquote>
<p>pam console-lockdown could be enabled in package anon-base-files for Whonix / Kicksecure.</p>
<p>But the following part is not easily solved.</p>
<blockquote>
<p>would break ssh login since files<br>
in /usr/share/pam-configs/console-lockdown result in modifications of<br>
/etc/pam.d/common-account file which not only applies to /etc/pam.d/login but<br>
also all other services such as /etc/pam.d/ssh.</p>
</blockquote>
<p>The following line</p>
<pre><code>account  required        pam_access.so accessfile=/etc/security/access-security-misc.conf debug
</code></pre>
<p>needs to end up in <code>/etc/pam.d/login</code> only. Not in file <code>/etc/pam.d/common-account</code>. There is no API to modify <code>/etc/pam.d/login</code> with a package.</p>
<p>I am wondering if line <code>account  required        pam_access.so accessfile=/etc/security/access-security-misc.conf debug</code> could declare "but only for <code>/etc/pam.d/login</code>" or if <code>/etc/security/access-security-misc.conf</code> could declare “don’t break SSH”.</p>
<p>Any idea?</p>
<p>Instead of blocking all except recent (non-ancient) consoles…</p>
<blockquote>
<p>+:console:tty1 tty2 tty3 tty4 tty5 tty6 tty7 pts/0 pts/1 pts/2 pts/3 pts/4 pts/5 pts/6 pts/7 pts/8 pts/9 hvc0 hvc1 hvc2 hvc3 hvc4 hvc5 hvc6 hvc7 hvc8 hvc9</p>
</blockquote>
<p>could change that to</p>
<blockquote>
<p>+:console:ALL</p>
</blockquote>
<p>which would not block ancient consoles, would not break SSH but at least prevent users not in group <code>console</code> from attempting any login.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T13:00:25Z' class='post-time'>
                December 7, 2019,  1:00pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T13:00:25Z'>
          <span itemprop='position'>#8</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Why not create an ssh group and allow those users to login via ssh?</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T13:39:45Z' class='post-time'>
                December 7, 2019,  1:39pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T13:39:45Z'>
          <span itemprop='position'>#9</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Would require adding.</p>
<pre><code>+:ssh:ALL
</code></pre>
<p>Users of Linux distributions where console-lockdown gets enabled by default (Whonix, Kicksecure) trying to set up an incoming SSH connection could have a hard time. They’d need to add <code>sudo addgroup user ssh</code>.</p>
<p>Therefore should user <code>user</code> (and later user <code>admin</code>) be a member of group <code>ssh</code> by default? Imagine someone in not too far future installing Kicksecure on a VPS (using ISO installer using VPS web interface). Can’t ssh, because no default user is a member of group <code>ssh</code>.</p>
<p>Those not intending to use incoming ssh should remove themselves from group <code>ssh</code>. It’s not as hardened by default but otherwise huge usability mess. What do you think?</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T13:49:42Z' class='post-time'>
                December 7, 2019,  1:49pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T13:49:42Z'>
          <span itemprop='position'>#10</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="9" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Would require adding.</p>
<pre><code class="lang-auto">+:ssh:ALL
</code></pre>
</blockquote>
</aside>
<p>That looks too permissive. access.conf allows you to specify logins from IP addresses. Maybe there’s a way to allow the user to login over the network rather than allowing them to login from everything.</p>
<aside class="quote no-group" data-post="9" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Users of Linux distributions where console-lockdown gets enabled by default (Whonix, Kicksecure) trying to set up an incoming SSH connection could have a hard time. They’d need to add <code>sudo addgroup user ssh</code> .</p>
<p>Therefore should user <code>user</code> (and later user <code>admin</code> ) be a member of group <code>ssh</code> by default? Imagine someone in not too far future installing Kicksecure on a VPS (using ISO installer using VPS web interface). Can’t ssh, because no default user is a member of group <code>ssh</code> .</p>
<p>Those not intending to use incoming ssh should remove themselves from group <code>ssh</code> . It’s not as hardened by default but otherwise huge usability mess. What do you think?</p>
</blockquote>
</aside>
<p>I don’t think they should be part of the <code>ssh</code> group by default as the majority of Whonix users probably won’t be using SSH but it should be documented in the wiki.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T14:52:38Z' class='post-time'>
                December 7, 2019,  2:52pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T14:52:38Z'>
          <span itemprop='position'>#11</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><a class="mention" href="../../../../external.html?link=https://forums.whonix.org/u/patrick">@Patrick</a></p>
<p>What if you add “user” to ssh while also hardening/tightening the rights of the ssh group? This way you don’t break expected behavior for sysadmins while also improving security. Perhaps prevent any non Torrified connection for the ssh group for Kicksecure too.</p>
<p>Perhaps one day automate creation of HS3 services with ssh initiation?</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T14:58:03Z' class='post-time'>
                December 7, 2019,  2:58pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T14:58:03Z'>
          <span itemprop='position'>#12</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="11" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>What if you add “user” to ssh while also hardening/tightening the rights of the ssh group?</p>
</blockquote>
</aside>
<aside class="quote no-group" data-post="10" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>That looks too permissive. access.conf allows you to specify logins from IP addresses. Maybe there’s a way to allow the user to login over the network rather than allowing them to login from everything.</p>
</blockquote>
</aside>
<p>I didn’t figure out how that would be possible.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T15:01:18Z' class='post-time'>
                December 7, 2019,  3:01pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T15:01:18Z'>
          <span itemprop='position'>#13</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="10" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>That looks too permissive. access.conf allows you to specify logins from IP addresses. Maybe there’s a way to allow the user to login over the network rather than allowing them to login from everything.</p>
</blockquote>
</aside>
<p>Network namespaces?</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T15:06:17Z' class='post-time'>
                December 7, 2019,  3:06pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T15:06:17Z'>
          <span itemprop='position'>#14</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="13" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Network namespaces?</p>
</blockquote>
</aside>
<p>I don’t see how they could be used for this.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T15:11:13Z' class='post-time'>
                December 7, 2019,  3:11pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T15:11:13Z'>
          <span itemprop='position'>#15</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../../external.html?link=https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling" target="_blank">unix.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://unix.stackexchange.com/users/6960/lancebaynes" target="_blank">
    <img alt="LanceBaynes" src="../../../../external.html?link=https://www.gravatar.com/avatar/9592e22cc02163b23f9ffac2b8eb101e?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="../../../../external.html?link=https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling" target="_blank">How to restrict an SSH user to only allow SSH-tunneling?</a>
</h4>

<div class="tags">
  <strong>linux, ssh, account-restrictions</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../../external.html?link=https://unix.stackexchange.com/users/6960/lancebaynes" target="_blank">
    LanceBaynes
  </a>
  on <a href="../../../../external.html?link=https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling" target="_blank">08:47AM - 03 Jun 11 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<hr>
<p>Whitelisting the sshd allowed addresses can work by adding a special internal IP that uses Tor’s mapadddress to refer to some onion address generated for SSH access later on.</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://www.golinuxcloud.com/wp-content/uploads/2018/10/favicon.png" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://www.golinuxcloud.com/restrict-allow-ssh-certain-users-groups-rhel/" target="_blank" title="12:32PM - 03 May 2019">GoLinuxCloud – 3 May 19</a>
  </header>
  <article class="onebox-body">
    <img src="../../../../external.html?link=https://www.golinuxcloud.com/wp-content/uploads/2019/05/ssh-1.jpg" class="thumbnail" width="" height="">

<h3><a href="../../../../external.html?link=https://www.golinuxcloud.com/restrict-allow-ssh-certain-users-groups-rhel/" target="_blank">How to restrict or allow ssh only from certain users, groups or hosts in Linux</a></h3>

<p>How to allow SSH for root login only from specific host or IP address? How to configure and restrict SSH to permit login only for certain users and/or groups?</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-07T15:16:00Z' class='post-time'>
                December 7, 2019,  3:16pm
              </time>
              <meta itemprop='dateModified' content='2019-12-07T15:16:00Z'>
          <span itemprop='position'>#16</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>We can use</p>
<pre><code>+:ssh:ALL EXCEPT LOCAL
</code></pre>
<p>Which should allow the <code>ssh</code> group to login anywhere except local things which should only be the network.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-08T06:42:51Z' class='post-time'>
                December 8, 2019,  6:42am
              </time>
              <meta itemprop='dateModified' content='2019-12-08T06:42:51Z'>
          <span itemprop='position'>#17</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="15" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p><a href="../../../../external.html?link=https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling">unix.stackexchange.com</a></p>
<p><a href="../../../../external.html?link=https://unix.stackexchange.com/users/6960/lancebaynes"> <img src="../../../../external.html?link=https://www.gravatar.com/avatar/9592e22cc02163b23f9ffac2b8eb101e?s=128&amp;d=identicon&amp;r=PG" alt="LanceBaynes" width="60" height="60"> </a></p>
<h4><a href="../../../../external.html?link=https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling">How to restrict an SSH user to only allow SSH-tunneling?</a></h4>
<p><strong>linux, ssh, account-restrictions</strong></p>
<p>asked by <a href="../../../../external.html?link=https://unix.stackexchange.com/users/6960/lancebaynes"> LanceBaynes </a> on <a href="../../../../external.html?link=https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling">08:47AM - 03 Jun 11 UTC</a></p>
<p>Whitelisting the sshd allowed addresses can work by adding a special internal IP that uses Tor’s mapadddress to refer to some onion address generated for SSH access later on.</p>
<p><img src="../../../../external.html?link=https://www.golinuxcloud.com/wp-content/uploads/2018/10/favicon.png" alt width="16" height="16"> <a href="../../../../external.html?link=https://www.golinuxcloud.com/restrict-allow-ssh-certain-users-groups-rhel/">GoLinuxCloud – 3 May 19</a></p>
<p><img src="../../../../external.html?link=https://www.golinuxcloud.com/wp-content/uploads/2019/05/ssh-1.jpg" alt></p>
<h3><a href="../../../../external.html?link=https://www.golinuxcloud.com/restrict-allow-ssh-certain-users-groups-rhel/">How to restrict or allow ssh only from certain users, groups or hosts in Linux</a></h3>
<p>How to allow SSH for root login only from specific host or IP address? How to configure and restrict SSH to permit login only for certain users and/or groups?</p>
</blockquote>
</aside>
<p>That might be further SSH related hardening. Please open a new forum thread or phabricator ticket for this. The purpose of this thread is to find optional hardening and we’re bound to the features / syntax of these files:</p>
<ul>
<li><a href="../../../../external.html?link=https://linux.die.net/man/8/pam_access">https://linux.die.net/man/8/pam_access</a></li>
<li><a href="../../../../external.html?link=https://linux.die.net/man/5/access.conf">https://linux.die.net/man/5/access.conf</a></li>
</ul>
<p>Which is limited.</p>
<aside class="quote no-group" data-post="16" data-topic="8592" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>We can use</p>
<pre><code class="lang-auto">+:ssh:ALL EXCEPT LOCAL
</code></pre>
<p>Which should allow the <code>ssh</code> group to login anywhere except local things which should only be the network.</p>
</blockquote>
</aside>
<p>Did that.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/c1800b13fe33a1c129dcb30c51dbead7f894b818" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/c1800b13fe33a1c129dcb30c51dbead7f894b818" target="_blank">separate group "ssh" for incoming ssh console permission</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-07" data-time="16:26:39" data-timezone="UTC">04:26PM - 07 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 4 additions and 0 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/c1800b13fe33a1c129dcb30c51dbead7f894b818" target="_blank">
          <span class="added">+4</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">Thanks to @madaidan
https://forums.whonix.org/t/etc-security-hardening-console-lockdown-pam-access-access-conf/8592/16</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/1464f01d191ee4e01ed2ec94f4faf8d17ec62b03" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/1464f01d191ee4e01ed2ec94f4faf8d17ec62b03" target="_blank">description</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-08" data-time="06:30:42" data-timezone="UTC">06:30AM - 08 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 8 additions and 6 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/1464f01d191ee4e01ed2ec94f4faf8d17ec62b03" target="_blank">
          <span class="added">+8</span>
          <span class="removed">-6</span>
        </a>
      </div>
    </div>

  </div>
</div>




  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-08T16:59:36Z' class='post-time'>
                December 8, 2019,  4:59pm
              </time>
              <meta itemprop='dateModified' content='2019-12-08T16:59:36Z'>
          <span itemprop='position'>#18</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>new description:</p>
<blockquote>
<ul>
<li>Console Lockdown.<br>
Allow members of group ‘console’ to use console and members of group ‘ssh’<br>
to receive incoming SSH connections. Everyone else except members of group<br>
‘console-unrestricted’ are restricted from using console using ancient,<br>
unpopular login methods such as using /bin/login over networks, which might<br>
be exploitable. (CVE-2001-0797) Using pam_access.<br>
Not enabled by default in this package since this package does not know which<br>
users shall be added to group ‘console’ and/or ‘ssh’ and would break console,<br>
X Window System and ssh login since files in<br>
/usr/share/pam-configs/console-lockdown-security-misc result in modifications<br>
of /etc/pam.d/common-account file which not only applies to /etc/pam.d/login<br>
but also all other services such as /etc/pam.d/ssh.</li>
</ul>
</blockquote>
<aside class="quote no-group quote-modified" data-post="7" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>One part is easily solvable:</p>
<blockquote>
<p>Not enabled by default in this package since this package does not know which<br>
users shall be added to group ‘console’</p>
</blockquote>
<p>pam console-lockdown could be enabled in package anon-base-files for Whonix / Kicksecure.</p>
</blockquote>
</aside>
<p>This is done.</p>
<p><a href="../../../../external.html?link=https://github.com/Whonix/anon-base-files/blob/master/debian/anon-base-files.postinst">anon-base-files <code>/debian/anon-base-files.postinst</code></a>:</p>
<pre><code>           user_to_be_created=user

           ## security-misc: Console Lockdown.
           ## Make sure this group exists. Might not exist if security-misc is not (yet) installed.
           addgroup --system console
           addgroup --system ssh
</code></pre>
<hr>
<pre><code>           ## security-misc: Console Lockdown.
           addgroup "$user_to_be_created" console
           addgroup "$user_to_be_created" ssh

           ## By package security-misc.
           pam-auth-update --enable console-lockdown-security-misc

           ## In Qubes and for existing installations Console Lockdown is
           ## is handled by whonix-legacy package.
</code></pre>
<p>But as you see it adds user <code>user</code> to both groups, <code>console</code> and <code>ssh</code>. This is non-perfect. Will elaborate under [1].</p>
<aside class="quote no-group quote-modified" data-post="7" data-topic="8592">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>But the following part is not easily solved.</p>
<blockquote>
<p>would break ssh login since files<br>
in /usr/share/pam-configs/console-lockdown result in modifications of<br>
/etc/pam.d/common-account file which not only applies to /etc/pam.d/login but<br>
also all other services such as /etc/pam.d/ssh.</p>
</blockquote>
</blockquote>
</aside>
<p><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/debian/security-misc.preinst">security-misc <code>/debian/security-misc.preinst</code></a> how has code to refuse installation if no user is a member of group <code>console</code> or <code>console-unrestricted</code>. Additinoally, if the <code>ssh.service</code> is activated (user has OpenSSH server package <code>openssh-server</code> instlled) it refuses installation if no user is a member of group <code>ssh</code>.</p>
<p>Therefore security-misc could enable console lockdown by default and probably will after some testing.</p>
<p>[1] I don’t think it’s possible to have a perfect solution for console lockdown. It needs basic information - are you going to use SSH or not? Breaking SSH servers of new or existing installations is not an option.</p>
<p>Instead, I’ve invented a new tool <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/usr/bin/hardening-enable"><code>/usr/bin/hardening-enable</code></a> which I describe here in more detail:</p>
<aside class="quote quote-modified" data-post="1" data-topic="8609">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="../../security-hardening-tool-usr-bin-hardening-enable-by-security-misc/8609.html">Security Hardening Tool - /usr/bin/hardening-enable by security-misc</a> <a class="badge-wrapper  bullet" href="../../../c/development/8.html"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/usr/bin/hardening-enable">/usr/bin/hardening-enable</a> 
It can be used to easily opt-in everything advanced. For now it has these features: 

/usr/bin/hardening-enable --ssh


[Hide Hardware Info] 
Enabling enable hide-hardware-info.service by running ‘systemctl enable hide-hardware-info.service’… 
Success. 
[NOEXEC] 
Enabling noexec by creating file /etc/noexec … 
Success. 
[LKRG - Linux Kernel Runtime Guard] 
LKRG hardening by creating /etc/sysctl.d/40-security-misc-autogenerated.conf … 
Success. 


Or. 
/usr/bin/hardenin…
  </blockquote>
</aside>

<p>Maybe this configuration question SSH vs no-SSH could be asked during first boot.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-10T19:48:34Z' class='post-time'>
                December 10, 2019,  7:48pm
              </time>
              <meta itemprop='dateModified' content='2019-12-10T19:48:34Z'>
          <span itemprop='position'>#19</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>
<p>Dec 10 17:18:56 host audit[7643]: AVC apparmor=“DENIED” operation=“open” profile="/usr/bin/whonixcheck" name="/etc/security/access-security-misc.conf" pid=7643 comm=“sudo” requested_mask=“r” denied_mask=“r” fsuid=0 ouid=0<br>
Dec 10 17:18:56 host audit[7643]: SYSCALL arch=c000003e syscall=257 success=no exit=-13 a0=ffffff9c a1=5686851ff273 a2=0 a3=0 items=1 ppid=7642 pid=7643 auid=4294967295 uid=1000 gid=1000 euid=0 suid=0 fsuid=0 egid=1000 sgid=1000 fsgid=1000 tty=(none) ses=4294967295 comm=“sudo” exe="/usr/bin/sudo" subj==/usr/bin/whonixcheck (enforce) key=(null)<br>
Dec 10 17:18:56 host audit: CWD cwd="/"<br>
Dec 10 17:18:56 host audit: PATH item=0 name="/etc/security/access-security-misc.conf" inode=140805 dev=ca:03 mode=0100644 ouid=0 ogid=0 rdev=00:00 nametype=NORMAL cap_fp=0000000000000000 cap_fi=0000000000000000 cap_fe=0 cap_fver=0<br>
Dec 10 17:18:56 host audit: PROCTITLE proctitle=7375646F002D2D6E6F6E2D696E746572616374697665002D750077686F6E6978636865636B002F7573722F6C69622F77686F6E6978636865636B2F77686F6E6978636865636B002D2D6461656D6F6E002D2D677569002D2D636C69<br>
Dec 10 17:18:56 host sudo[7643]: pam_access(sudo:account): failed to open accessfile=[/etc/security/access-security-misc.conf]: Permission denied<br>
Dec 10 17:18:56 host sudo[7643]: pam_access(sudo:account): failed to parse the module arguments</p>
</blockquote>
<p>Need to add /etc/security/access-security-misc.conf to apparmor abstractions/base?</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8592.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-10T19:53:43Z' class='post-time'>
                December 10, 2019,  7:53pm
              </time>
              <meta itemprop='dateModified' content='2019-12-10T19:53:43Z'>
          <span itemprop='position'>#20</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>This is also broken:</p>
<aside class="onebox githubblob">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/sdwdate-gui/blob/master/etc/qubes-rpc/whonix.NewStatus" target="_blank">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="../../../../external.html?link=https://github.com/Whonix/sdwdate-gui/blob/master/etc/qubes-rpc/whonix.NewStatus" target="_blank">Whonix/sdwdate-gui/blob/master/etc/qubes-rpc/whonix.NewStatus</a></h4>
<pre><code class="lang-newstatus">#!/bin/bash

## Copyright (C) 2018 - 2019 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions

sudo \
   -u sdwdate-gui \
   bash \
     -c \
     'echo "'$1'" | tee /run/sdwdate-gui/anon-status &gt;/dev/null'
</code></pre>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<blockquote>
<p>Dec 10 16:42:49 host sudo[7369]: pam_access(sudo:account): access denied for user <code>user' from </code>’<br>
Dec 10 16:42:49 host sudo[7369]:     user : PAM account management error: Permission denied ; TTY=unknown ; PWD=/home/user ; USER=sdwdate-gui ; COMMAND=/usr/bin/bash -c echo “disp3655” | tee /run/sdwdate-gui/anon-status &gt;/dev/null</p>
</blockquote>
<p>/etc/pam.d/sudo should probably not use pam_access. But due to how /usr/share/pam-configs works, I don’t see how it could apply to /etc/pam.d/login only. Would require writing to /etc/pam.d/login directly which is bad.</p>
        </div>

        <meta itemprop='headline' content='/etc/security Hardening? - Console Lockdown - pam_access - access.conf'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><b><a rel="next" itemprop="url" href="../85924658.html?page=2">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
    <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124</link>
    <description>I want to run two hidden services but isolated from each other and, unless there is a better way to do it, I would like to have each hidden service with one independent Tor instance (if one Tor instance get overloaded for example, I have more chances the other service is not affected). Outside of Whonix this would be easy to achieve for example through KVM or Docker but because running Tor over Tor is a bad idea, how can achieve this on Whonix? Thanks</description>
    <language>en</language>
    <lastBuildDate>Thu, 18 Aug 2022 00:01:17 +0000</lastBuildDate>
    <category>Support</category>
    <atom:link href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[Abeing1935]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="14" data-topic="14124">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Would be good if the wiki documentation could be improved.</p>
</blockquote>
</aside>
<p>You can copy paste my previous posts in the wiki, if there is something missing let me know and I will do it</p>
<p>About Vanrguards would it be enough to specify different ControlPort and execute different vanguards processes? Like <code>vanguards --control_port ControlPort2</code></p>
<aside class="quote no-group" data-username="Patrick" data-post="14" data-topic="14124">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Do you know which port Tor would choose and/or how to find that out? <code>auto</code> seems to be a Tor feature to accommodate Tor Browser but in the context of this forum thread I didn’t see how it’s useful.</p>
</blockquote>
</aside>
<p>According to Tor’s doc:</p>
<pre><code class="lang-auto">Tor opens a SOCKS proxy on port 9050 by default -- even if you don't configure one below. Set "SOCKSPort 0" if you plan to run Tor only as a relay, and not make any local application connections yourself.
</code></pre>
<p>I did not verify it but I think it could assign to the next free port in case the default one is in use but not sure, also it would be useful only if the user wants to use tor as socks proxy but it would be interesting to have it on the docs for other people</p>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/15</link>
        <pubDate>Thu, 18 Aug 2022 00:01:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-15</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Thanks for the report!</p>
<p>Would be good if the wiki documentation could be improved.</p>
<p>Next improvement that should be added when using multiple Tor daemons (specifically important when hosting Tor onion services): <a href="https://www.whonix.org/wiki/Vanguards" class="inline-onebox">Vanguards - Whonix</a></p>
<aside class="quote no-group" data-username="Abeing1935" data-post="13" data-topic="14124">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/a/8797f3/40.png" class="avatar"> Abeing1935:</div>
<blockquote>
<p>I have one question about your example in the wiki, why did you specify SocksPort 0 instead of SocksPort auto?</p>
</blockquote>
</aside>
<p><code>auto</code> seems not very useful and is random as far as I understand? Do you know which port Tor would choose and/or how to find that out? <code>auto</code> seems to be a Tor feature to accommodate Tor Browser but in the context of this forum thread I didn’t see how it’s useful.</p>
<p>So I’d shift the burden of proof back to you and justify why <code>auto</code> is useful. <img src="//forums.whonix.org/images/emoji/twitter/wink.png?v=12" title=":wink:" class="emoji" alt=":wink:"></p>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/14</link>
        <pubDate>Sun, 07 Aug 2022 12:57:39 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-14</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[Abeing1935]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="12" data-topic="14124">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Probably a firewall settings change required that I just now added to the wiki.</p>
</blockquote>
</aside>
<p>Yes! I can confirm that once I apply the firewall settings you have added to the wiki, the tor connection is fully established and the hidden service can be accessed through the browser. Also it is using the independent tor instance, I have verified that once I stop the extra tor instance but not the main tor instance the hidden service is not accessible anymore</p>
<aside class="quote no-group" data-username="Patrick" data-post="12" data-topic="14124">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Why is it different? Why not use the same steps as for Debian, that is using <code>tor-instance-create</code> as already in the wiki?</p>
</blockquote>
</aside>
<p>I just wanted to make sure that I understood how tor-create-instance is working. So I have “extracted” the relevant information from the source code of the script: <a href="https://sources.debian.org/src/tor/0.4.7.8-1/debian/tor-instance-create/" class="inline-onebox" rel="noopener nofollow ugc">File: tor-instance-create | Debian Sources</a> Also I have verified that everything is working using the way I have posted for whonix or using the tool tor-instance-create on Whonix, both ways are working once the firewall settings are modified</p>
<p>I have one question about your example in the wiki, why did you specify SocksPort 0 instead of SocksPort auto?</p>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/13</link>
        <pubDate>Thu, 04 Aug 2022 23:59:55 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-13</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Connectivity issues:<br>
Probably a firewall settings change required that I just now added to the wiki.</p>
<aside class="quote no-group" data-username="Abeing1935" data-post="10" data-topic="14124">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/a/8797f3/40.png" class="avatar"> Abeing1935:</div>
<blockquote>
<ol>
<li>We will create a new user who will run and own related config files to the tor’s instance</li>
</ol>
<pre><code class="lang-auto">adduser --quiet --system --disabled-password --home "/var/lib/tor-instances/extradaemon1" --no-create-home --shell /bin/false --group --force-badname "_tor-extradaemon1"
install -Z -d -m 02700 -o "_tor-extradaemon1" -g "_tor-extradaemon1" "/var/lib/tor-instances/extradaemon1" # Set SELinux security context, permission mode and ownership to the created user and group to the homedirectory
install -d "/etc/tor/instances/extradaemon1" # Honestly I don't know what it is doing this command
</code></pre>
</blockquote>
</aside>
<p>Why is it different? Why not use the same steps as for Debian, that is using <code>tor-instance-create</code> as already in the wiki?</p>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/12</link>
        <pubDate>Thu, 04 Aug 2022 15:42:14 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-12</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[Abeing1935]]></dc:creator>
        <description><![CDATA[
            <p>On Debian several tor instances are working fine, but not on Whonix</p>
<p>Here you have logs from extra tor daemon on Whonix Gateway:</p>
<pre><code class="lang-auto">sudo systemctl status --no-block --no-pager "tor@extradaemon1.service"
● tor@extradaemon1.service - Anonymizing overlay network for TCP (instance extradaemon1)
     Loaded: loaded (/lib/systemd/system/tor@.service; enabled; vendor preset: enabled)
     Active: active (running) since Wed 2022-08-03 20:49:04 UTC; 1h 28min ago
    Process: 59565 ExecStartPre=/usr/bin/install -Z -m 02755 -o _tor-extradaemon1 -g _tor-extradaemon1 -d /run/tor-instances/extradaemon1 (code=exited, status=0/SUCCESS)
    Process: 59566 ExecStartPre=/bin/sed -e s/@@NAME@@/extradaemon1/g; w /run/tor-instances/extradaemon1.defaults /usr/share/tor/tor-service-defaults-torrc-instances (code=exited, status=0/SUCCESS)
    Process: 59568 ExecStartPre=/usr/bin/tor --defaults-torrc /run/tor-instances/extradaemon1.defaults -f /etc/tor/instances/extradaemon1/torrc --verify-config (code=exited, status=0/SUCCESS)
   Main PID: 59569 (tor)
      Tasks: 1 (limit: 2604)
     Memory: 14.3M
        CPU: 4.093s
     CGroup: /system.slice/system-tor.slice/tor@extradaemon1.service
             └─59569 /usr/bin/tor --defaults-torrc /run/tor-instances/extradaemon1.defaults -f /etc/tor/instances/extradaemon1/torrc

Aug 03 21:45:08 host Tor-extradaemon1[59569]:  64 connections died in state connect()ing with SSL state (No SSL object)
Aug 03 21:47:54 host Tor-extradaemon1[59569]: Problem bootstrapping. Stuck at 5% (conn): Connecting to a relay. (No route to host; NOROUTE; count 66; recommendation warn; host XXX at YYY:443)
Aug 03 21:47:54 host Tor-extradaemon1[59569]: 65 connections have failed:
Aug 03 21:47:54 host Tor-extradaemon1[59569]:  65 connections died in state connect()ing with SSL state (No SSL object)
Aug 03 21:57:25 host Tor-extradaemon1[59569]: Problem bootstrapping. Stuck at 5% (conn): Connecting to a relay. (No route to host; NOROUTE; count 67; recommendation warn; host XXX at YYY:443)
Aug 03 21:57:25 host Tor-extradaemon1[59569]: 66 connections have failed:
Aug 03 21:57:25 host Tor-extradaemon1[59569]:  66 connections died in state connect()ing with SSL state (No SSL object)
Aug 03 22:09:04 host Tor-extradaemon1[59569]: Problem bootstrapping. Stuck at 5% (conn): Connecting to a relay. (No route to host; NOROUTE; count 68; recommendation warn; host XXX at YYY:9001)
Aug 03 22:09:04 host Tor-extradaemon1[59569]: 67 connections have failed:
Aug 03 22:09:04 host Tor-extradaemon1[59569]:  67 connections died in state connect()ing with SSL state (No SSL object)
</code></pre>
<p><a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a> any idea what could be failing?</p>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/11</link>
        <pubDate>Wed, 03 Aug 2022 22:27:56 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-11</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[Abeing1935]]></dc:creator>
        <description><![CDATA[
            <h2>
<a name="how-to-run-several-tor-instances-on-whonix-1" class="anchor" href="http://forums.whonix.org#how-to-run-several-tor-instances-on-whonix-1"></a>How to run several tor instances on Whonix</h2>
<p>I am going to use extradaemon1 as the name for my extra tor instance, but it should be replaced with the  you want for your extra tor instance</p>
<ol>
<li>We will create a new user who will run and own related config files to the tor’s instance</li>
</ol>
<pre><code class="lang-auto">adduser --quiet --system --disabled-password --home "/var/lib/tor-instances/extradaemon1" --no-create-home --shell /bin/false --group --force-badname "_tor-extradaemon1"
install -Z -d -m 02700 -o "_tor-extradaemon1" -g "_tor-extradaemon1" "/var/lib/tor-instances/extradaemon1" # Set SELinux security context, permission mode and ownership to the created user and group to the homedirectory
install -d "/etc/tor/instances/extradaemon1" # Honestly I don't know what it is doing this command
</code></pre>
<ol start="2">
<li>Once we have created our user, homedirectory and assigned the right permissions; we must create our torrc file for the new instance and enable the service</li>
</ol>
<ul>
<li>In case you do not know how to run a hidden service on Whonix, you must check this documentation first: <a href="https://www.whonix.org/wiki/Onion_Services#Hidden_Webserver" class="inline-onebox" rel="noopener nofollow ugc">Onion Services - Whonix</a>
</li>
</ul>
<pre><code class="lang-auto">sudoedit /etc/tor/instances/extradaemon1/torrc
</code></pre>
<p>Paste the following content. Example.</p>
<pre><code class="lang-auto">SocksPort 0

HiddenServiceDir /var/lib/tor-instances/extradaemon1/hidden_service/
HiddenServicePort 80 10.152.152.11:80
HiddenServiceVersion 3
</code></pre>
<p>Save and exit.</p>
<p>We create symlinks for auto-launch of the new instance</p>
<pre><code class="lang-auto">sudo systemctl enable "tor@extradaemon1.service"
</code></pre>
<p>We start the new tor instance:</p>
<pre><code class="lang-auto">sudo systemctl start "tor@extradaemon1.service"
</code></pre>
<p>And we can check if the new instance is running without any issue:</p>
<pre><code class="lang-auto">sudo systemctl status --no-block --no-pager "tor@extradaemon1.service"
</code></pre>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/10</link>
        <pubDate>Wed, 03 Aug 2022 22:21:25 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-10</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[Abeing1935]]></dc:creator>
        <description><![CDATA[
            <h2>
<a name="how-to-use-tor-instance-create-on-debian-1" class="anchor" href="http://forums.whonix.org#how-to-use-tor-instance-create-on-debian-1"></a>How to use tor-instance-create on Debian</h2>
<ol>
<li>
<p>First of all, we need to have installed tor on Debian. For that we will follow official tor documentation: <a href="https://community.torproject.org/relay/setup/bridge/debian-ubuntu/" class="inline-onebox" rel="noopener nofollow ugc">Tor Project | Debian / Ubuntu</a></p>
</li>
<li>
<p>Once we have installed tor, it will install automatically the tool tor-instance-create</p>
</li>
<li>
<p>For each new Tor’s instance it will create a new UNIX user with a home directory and a mostly empty tor configuration file.</p>
</li>
</ol>
<p>How to use tor-instance-create?</p>
<pre><code class="lang-auto">tor-instance-create &lt;name&gt;
# torrc for new instance is in /etc/tor/instances/&lt;name&gt;/torrc
systemctl enable tor@&lt;name&gt; # create symlinks for auto-launch of the new instance
systemctl start tor@&lt;name&gt;

Optional, in case you want to disable the default tor service:
systemctl mask tor@default
</code></pre>
<p>For example:</p>
<pre><code class="lang-auto">tor-instance-create tor2
systemctl enable tor@tor2
systemctl start tor@tor2
</code></pre>
<p>If we check processes that are running through ps aux we will find this:</p>
<pre><code class="lang-auto">/usr/bin/tor --defaults-torrc /run/tor-instances/tor2.defaults -f /etc/tor/instances/tor2/torrc
</code></pre>
<p>If we check our /etc/passwd file we will find that a new user has been created:<br>
_tor-tor2:x:108:114::/var/lib/tor-instances/tor2:/bin/false # It will create new user based in the name we have decided: _tor- with the data directory in /var/lib/tor-instances/</p>
<p>Each new tor instance will have a new torrc file in /etc/tor/instances//torrc with the following contents:</p>
<pre><code class="lang-auto"># This is the tor configuration file for tor instance &lt;name&gt;.
#
# To start/reload/etc this instance, run "systemctl start tor@&lt;name&gt;" (or reload, or..).
# This instance will run as user _tor-&lt;name&gt;; its data directory is /var/lib/tor-instances/&lt;name&gt;.
#
# Append to the list of socks interfaces configured via
# /usr/share/tor/tor-service-defaults-torrc-instances
# which is unix:/run/tor-instances/&lt;name&gt;/socks

+SocksPort auto
</code></pre>
<p>And the default /usr/share/tor/tor-service-defaults-torrc-instances contents is the following:</p>
<pre><code class="lang-auto">DataDirectory /var/lib/tor-instances/@@NAME@@
PidFile /run/tor-instances/@@NAME@@/tor.pid
RunAsDaemon 0
User _tor-@@NAME@@
SyslogIdentityTag @@NAME@@

ControlSocket /run/tor-instances/@@NAME@@/control GroupWritable RelaxDirModeCheck
SocksPort unix:/run/tor-instances/@@NAME@@/socks WorldWritable

CookieAuthentication 1
CookieAuthFileGroupReadable 1
CookieAuthFile /run/tor-instances/@@NAME@@/control.authcookie

Log notice syslog
</code></pre>
<p>If we want to run several tor instances in the same servers it can be useful to enable logs for each torrc file:<br>
Log notice file /var/log/tor/-notices.log</p>
<ol start="4">
<li>In case we want to remove a tor’s instance, we need to stop the instance (in case it is running), delete the user and its directory</li>
</ol>
<pre><code class="lang-auto">systemctl start tor@&lt;name&gt;
userdel &lt;name&gt;
userdel -r &lt;name&gt;
</code></pre>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/9</link>
        <pubDate>Wed, 03 Aug 2022 22:18:54 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-9</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[Abeing1935]]></dc:creator>
        <description><![CDATA[
            <p>Although a bit later, better than never. I am posting documented guides to run several tor instances in Debian and Whonix</p>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/8</link>
        <pubDate>Wed, 03 Aug 2022 22:18:21 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-8</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[Abeing1935]]></dc:creator>
        <description><![CDATA[
            <p>Perfect! Thanks for your reply! I will document and test everything on Debian first, once I have everything ready will go with Whonix and will post here everything so you can review it. I will try to have everything ready during the upcoming week, I will update here once it is done</p>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/7</link>
        <pubDate>Sat, 09 Jul 2022 20:48:31 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-7</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>You can post links now.</p>
<ul>
<li>I can confirm that tor-instance-create is functional on Debian. Using this for <a href="http://whonix.org">whonix.org</a> server.</li>
<li>tor-instance-create doesn’t have lots of documentation even for Debian. Haven’t seen step-by-step tor-instance-create instructions for Debian.</li>
<li>tor-instance-create does not have tested step-by-step instructions for Whonix yet.</li>
</ul>
<p>Basic systemd knowledge is certainly helpful.</p>
<p>tor-instance-create for sure isn’t trivial to use since also use of systemd multi instance is required. Makes sense to learn more about systemd multi instance on search engines.</p>
<p>Please document under <a href="https://www.whonix.org/wiki/Tor#Multiple_Tor_Daemons">https://www.whonix.org/wiki/Tor#Multiple_Tor_Daemons</a>. Check out that link as it contains lots of suggestions how to use it.</p>
<aside class="quote no-group" data-username="Abeing1935" data-post="5" data-topic="14124">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/a/8797f3/40.png" class="avatar"> Abeing1935:</div>
<blockquote>
<p>including</p>
</blockquote>
</aside>
<p>This setup since only used by an advanced user, probably should use a single torrc file only and no <code>.d</code> drop-in / <code>%include</code> at least not until the basics have been worked out here.</p>
<aside class="quote no-group" data-username="Abeing1935" data-post="5" data-topic="14124">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/a/8797f3/40.png" class="avatar"> Abeing1935:</div>
<blockquote>
<p>So, when creating a new tor instance should I clone all current structure?</p>
</blockquote>
</aside>
<p>Since this is a feature inherited from the <code>tor</code> Debian package, could you please try this on Debian first to avoid the extra complexity by Whonix while learning this?</p>
<p>No, if you copy/paste all of Whonix’s features all such as SocksPort, DnsPort, TransPort it will probably fail since additional Tor daemons cannot open the same ports which are already opened by any other Tor instance.</p>
<p>Could you please tidy up documentation? Once cleaned up, working, we can look into what settings are perhaps useful to copy over from “<code>tor@default</code>” (Whonix config) to “<code>tor@extradaemon1</code>”.</p>
<p>Eventually, I might add how to make <code>tor@extradaemon1</code> even compatible with <a href="https://www.whonix.org/wiki/vanguards">vanguards</a> but basics need to be confirmed to be functional first.</p>
<aside class="quote no-group" data-username="Abeing1935" data-post="5" data-topic="14124">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/a/8797f3/40.png" class="avatar"> Abeing1935:</div>
<blockquote>
<p>Or could I end breaking something?</p>
</blockquote>
</aside>
<p>Just don’t make a Tor multi instance re-use the same folder or port that <code>tor@default</code> is already using.</p>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/6</link>
        <pubDate>Sat, 09 Jul 2022 18:04:23 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-6</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[Abeing1935]]></dc:creator>
        <description><![CDATA[
            <p>If tor-instance-create can be used in Whonix Gateway I can try and document it here</p>
<p>Where I am a bit lost it is how Whonix Gateway would handle new torrc files? Because right now I see that the default tor is running using /usr/share/tor/tor-service-defaults-torrc (specifying the data directory) and /etc/tor/torrc (which includes files from /etc/torrc.d/ and where /etc/torrc.d/95_whonix.conf ends including the /usr/local/etc/torrc.d/50_user.conf where we specify all needed settings for our hidden services</p>
<p>So, when creating a new tor instance should I clone all current structure? Like /usr/share/tor/tor-service-defaults-torrc2, /etc/tor/torrc2 etc ? Or could I end breaking something? <a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a></p>
<p>If the question is not enough clear please let me know</p>
<blockquote>
<p>Format the link with " ` " (single quote).</p>
</blockquote>
<p>Thanks for the tip! <a class="mention" href="http://forums.whonix.org/u/nyxnor">@nyxnor</a></p>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/5</link>
        <pubDate>Sat, 09 Jul 2022 17:26:43 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-5</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <blockquote>
<p>I understand that we cannot use those solutions in the GW.</p>
</blockquote>
<p>It is possible but not documented.</p>
<p>Imagine having multiple instances and trying to remember which one you should restart for the browser, which one for the package manager, which one for some application. I think this is    a usability issue, but I don’t speak for whonix devs.</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.whonix.org/wiki/Free_Support_Principle">
  <header class="source">
      <img src="https://www.whonix.org/w/images/a/a4/Whonix-home-favicon.ico" class="site-icon" width="32" height="32">

      <a href="https://www.whonix.org/wiki/Free_Support_Principle" target="_blank" rel="noopener nofollow ugc" title="04:49PM - 26 February 2022">Whonix – 26 Feb 22</a>
  </header>

  <article class="onebox-body">
    <img src="https://www.whonix.org/w/images/9/98/Support-487515640.jpg" class="thumbnail onebox-avatar" width="500" height="500">

<h3><a href="https://www.whonix.org/wiki/Free_Support_Principle" target="_blank" rel="noopener nofollow ugc">Support</a></h3>

  <p>Various Ways to get Help with Whonix ™. Free and Premium Support available.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
<p><a href="https://manpages.debian.org/bullseye/tor/tor-instance-create.8.en.html" class="onebox" target="_blank" rel="noopener nofollow ugc">https://manpages.debian.org/bullseye/tor/tor-instance-create.8.en.html</a><br>
<a href="https://sources.debian.org/src/tor/0.4.7.8-1/debian/tor-instance-create/" class="onebox" target="_blank" rel="noopener nofollow ugc">https://sources.debian.org/src/tor/0.4.7.8-1/debian/tor-instance-create/</a><br>
You also need to setup different systemd services to help you. e.g. tor@default.service, tor@server1.service, tor@server2.service, point them to different torrcs.</p>
<p>I haven’t done this on whonix, only plain debian, can’t assist more than this.</p>
<blockquote>
<p>stackoverflow DOT com/questions/14321214/how-to-run-multiple-tor-processes-at-once-with-different-exit-ips (it does not let me to include links)</p>
</blockquote>
<p>Format the link with " ` " (single quote).</p>
<p><code>stackoverflow.com/questions/14321214/how-to-run-multiple-tor-processes-at-once-with-different-exit-ips (it does not let me to include links)</code></p>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/4</link>
        <pubDate>Fri, 08 Jul 2022 23:56:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-4</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[Abeing1935]]></dc:creator>
        <description><![CDATA[
            <p>I already know how to host several hidden services on whonix. I know that I can run multiple whonix gateways but I want to know if it is possible to have just one Whonix Workstation with more than one tor instances and assign different services to each instance</p>
<p>During the past weeks there is an active ddos attack against Tor Network, even if you do not have a popular service you can ending in a rely which is overloaded with new open circuits and cannot handle more new open circuits. Vanguards help but does not solve the problem, the same with OnionBalance; if you have your frontend pointing to your service in the same GW they will get overloaded too</p>
<p>I just mentioned Tor over Tor because there are ready options in Docker or kvm, but unless I am missing something, I understand that we cannot use those solutions in the GW</p>
<p>In short, I just want to know if I can apply the following in Whonix Gateway:<br>
<a href="http://stackoverflow.com/questions/14321214/how-to-run-multiple-tor-processes-at-once-with-different-exit-ips" rel="noopener nofollow ugc">stackoverflow.com/questions/14321214/how-to-run-multiple-tor-processes-at-once-with-different-exit-ips</a></p>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/3</link>
        <pubDate>Fri, 08 Jul 2022 18:14:19 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-3</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>I really suggest you reading this whole <a href="http://www.whonix.org/wiki/Onion_Services" rel="noopener nofollow ugc">page for host onion services on whonix</a>, but if you know what you are doing, then go <a href="http://www.whonix.org/wiki/Onion_Services#Hidden_Webserver" rel="noopener nofollow ugc">directly to edit the configuration</a></p>
<p>And if you really want isolated tor instances, than run <a href="http://www.whonix.org/wiki/Multiple_Whonix-Gateway" rel="noopener nofollow ugc">multiple whonix gateways</a>. Also this is not related to overloaded instances, it is related to isolated daemons.</p>
<p>If you want to manage overloaded instances, use OnionBalance and Vanguard as documented on the page above, but onionbalance is just really if you have a popular site and can host the backed on different locations.</p>
<p>You probably gonna have a lot of questions, the wiki and past forum threads are your friends.</p>
<aside class="quote no-group" data-username="Abeing1935" data-post="1" data-topic="14124">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/a/8797f3/40.png" class="avatar"> Abeing1935:</div>
<blockquote>
<p>because running Tor over Tor is a bad idea, how can achieve this on Whonix?</p>
</blockquote>
</aside>
<p>Whonix does not route Tor over Tor because the workstation has a fake tor pkg and every connection is routed to the gateway, which has a functional tor.<br>
You are gonna host your sites on the gateway and access them through the workstation.</p>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/2</link>
        <pubDate>Fri, 08 Jul 2022 17:27:32 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-2</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
      <item>
        <title>What is the best way to have more than one Tor instance in Whonix Gateway?</title>
        <dc:creator><![CDATA[Abeing1935]]></dc:creator>
        <description><![CDATA[
            <p>I want to run two hidden services but isolated from each other and, unless there is a better way to do it, I would like to have each hidden service with one independent Tor instance (if one Tor instance get overloaded for example, I have more chances the other service is not affected). Outside of Whonix this would be easy to achieve for example through KVM or Docker but because running Tor over Tor is a bad idea, how can achieve this on Whonix? Thanks</p>
          <p><a href="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124/1</link>
        <pubDate>Fri, 08 Jul 2022 13:21:15 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-14124-1</guid>
        <source url="http://forums.whonix.org/t/what-is-the-best-way-to-have-more-than-one-tor-instance-in-whonix-gateway/14124.rss">What is the best way to have more than one Tor instance in Whonix Gateway?</source>
      </item>
  </channel>
</rss>

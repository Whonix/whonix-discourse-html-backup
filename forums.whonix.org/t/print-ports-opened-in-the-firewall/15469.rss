<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>print ports opened in the firewall.</title>
    <link>http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469</link>
    <description>For me todo later if accepted.

on the respective `/usr/bin/whonix-TYPE-firewall`
```sh
print_ports(){
  printf &#39;%s\n&#39; &quot;INTERNAL_OPEN_PORTS=\&quot;${INTERNAL_OPEN_PORTS[@]}\&quot;&quot;
  printf &#39;%s\n&#39; &quot;EXTERNAL_OPEN_PORTS=\&quot;${EXTERNAL_OPEN_PORTS[@]}\&quot;&quot;
}


end() {
   output_cmd &quot;OK: Whonix firewall loaded.&quot;
   print_ports
   exit 0
}
```

Good? Can be default? I think it is very useful.</description>
    <language>en</language>
    <lastBuildDate>Mon, 26 Sep 2022 19:34:16 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>print ports opened in the firewall.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>This was merged.</p>
          <p><a href="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/11</link>
        <pubDate>Mon, 26 Sep 2022 19:34:16 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15469-11</guid>
        <source url="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469.rss">print ports opened in the firewall.</source>
      </item>
      <item>
        <title>print ports opened in the firewall.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>My mistake. Now understand your question.</p>
<p>Nowhere. It’s not needed. If it’s not rejected, it’s permitted by default.</p>
<p>There isn’t “much” filtering in the output chain (function <code>ipv4_output</code>) when <code>firewall_mode=full</code>.</p>
<ul>
<li>Hard to find any actually…</li>
<li>UDP is blocked, which is more of a usability feature.
<ul>
<li><a href="https://www.whonix.org/wiki/Tor#UDP">https://www.whonix.org/wiki/Tor#UDP</a></li>
</ul>
</li>
<li>optional <code>outgoing_allow_ip_list</code>
</li>
</ul>
<p>The whole <code>ipv4_output</code> function looks overly lengthy and complicated due to <code>timesync-fail-closed</code> firewall mode and <code>TUNNEL_FIREWALL_ENABLE</code> mode. For a different topics,</p>
<ul>
<li>could consider to deprecate <code>TUNNEL_FIREWALL_ENABLE</code> mode (sorry Tor + VPN + Tor users).</li>
<li>Somehow implement <code>timesync-fail-closed</code> more elegantly.
<ul>
<li><a href="https://phabricator.whonix.org/T533" class="inline-onebox">⚓ T533 iptables block network access until sdwdate succeeded</a></li>
</ul>
</li>
<li><a href="https://phabricator.whonix.org/T509" class="inline-onebox">⚓ T509 Consider nftables / Berkeley Packet Filter (BPF) as a replacement for iptables</a></li>
</ul>
          <p><a href="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/10</link>
        <pubDate>Mon, 26 Sep 2022 15:39:58 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15469-10</guid>
        <source url="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469.rss">print ports opened in the firewall.</source>
      </item>
      <item>
        <title>print ports opened in the firewall.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Added some comments inline on github.</p>
          <p><a href="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/9</link>
        <pubDate>Mon, 26 Sep 2022 15:26:10 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15469-9</guid>
        <source url="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469.rss">print ports opened in the firewall.</source>
      </item>
      <item>
        <title>print ports opened in the firewall.</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="6" data-topic="15469">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<pre><code class="lang-auto">         $iptables_cmd -A OUTPUT -p tcp --dport "$socks_port_item" --dst "127.0.0.1" -j REJECT
            
</code></pre>
</blockquote>
</aside>
<p>and it is <code>rejecting</code></p>
          <p><a href="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/8</link>
        <pubDate>Mon, 26 Sep 2022 15:25:32 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15469-8</guid>
        <source url="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469.rss">print ports opened in the firewall.</source>
      </item>
      <item>
        <title>print ports opened in the firewall.</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>You sure?</p>
<pre><code class="lang-auto">   if [ "$firewall_mode" = "timesync-fail-closed" ]; then
                  local socks_port_item
                  for socks_port_item in $INTERNAL_OPEN_PORTS; do
            
</code></pre>
<p>It is only called if <code>firewall_mode=timesync-fail-closed</code></p>
          <p><a href="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/7</link>
        <pubDate>Mon, 26 Sep 2022 15:23:56 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15469-7</guid>
        <source url="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469.rss">print ports opened in the firewall.</source>
      </item>
      <item>
        <title>print ports opened in the firewall.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group quote-modified" data-username="nyxnor" data-post="4" data-topic="15469">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p>Can you point where are INTERNAL_OPEN_PORTS being opened in <code>whonix-workstation-firewall</code>, I didn’t find it.</p>
<p><a href="https://github.com/Whonix/whonix-firewall/blob/master/usr/bin/whonix-workstation-firewall" class="inline-onebox">whonix-firewall/whonix-workstation-firewall at master · Whonix/whonix-firewall · GitHub</a></p>
</blockquote>
</aside>
<aside class="onebox githubblob" data-onebox-src="https://github.com/Whonix/whonix-firewall/blob/master/usr/bin/whonix-workstation-firewall#L368">
  <header class="source">

      <a href="https://github.com/Whonix/whonix-firewall/blob/master/usr/bin/whonix-workstation-firewall#L368" target="_blank" rel="noopener">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/Whonix/whonix-firewall/blob/master/usr/bin/whonix-workstation-firewall#L368" target="_blank" rel="noopener">Whonix/whonix-firewall/blob/master/usr/bin/whonix-workstation-firewall#L368</a></h4>



    <pre class="onebox">      <code class="lang-">
        <ol class="start lines" start="358" style="counter-reset: li-counter 357 ;">
            <li>
            </li>
<li>   $iptables_cmd -A OUTPUT -m iprange --dst-range "127.0.0.1" -p tcp --dport "$qubes_updates_proxy_port" -j REJECT --reject-with icmp-admin-prohibited</li>
            <li>   $iptables_cmd -A OUTPUT -m iprange --dst-range "10.137.255.254" -p tcp --dport "$qubes_updates_proxy_port" -j REJECT --reject-with icmp-admin-prohibited</li>
            <li>}</li>
            <li>
            </li>
<li>ipv4_output() {</li>
            <li>   ## Prevent connections to Tor SocksPorts.</li>
            <li>   ## https://phabricator.whonix.org/T533#11025</li>
            <li>   if [ "$firewall_mode" = "timesync-fail-closed" ]; then</li>
            <li>      local socks_port_item</li>
            <li class="selected">      for socks_port_item in $INTERNAL_OPEN_PORTS; do</li>
            <li>         true "socks_port_item: $socks_port_item"</li>
            <li>         ## SOCKS_PORT_SDWDATE</li>
            <li>         if [ "$socks_port_item" = "9108" ]; then</li>
            <li>            ## Permit connections to SOCKS_PORT_SDWDATE 9108 even in</li>
            <li>            ## 'timesync-fail-closed' mode. Otherwise, sdwdate could never</li>
            <li>            ## succeed and firewall_mode could never change to 'full'.</li>
            <li>            continue</li>
            <li>         fi</li>
            <li>         $iptables_cmd -A OUTPUT -p tcp --dport "$socks_port_item" --dst "127.0.0.1" -j REJECT</li>
            <li>      done</li>
        </ol>
      </code>
    </pre>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/6</link>
        <pubDate>Mon, 26 Sep 2022 15:10:24 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15469-6</guid>
        <source url="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469.rss">print ports opened in the firewall.</source>
      </item>
      <item>
        <title>print ports opened in the firewall.</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox githubpullrequest" data-onebox-src="https://github.com/Whonix/whonix-firewall/pull/1">
  <header class="source">

      <a href="https://github.com/Whonix/whonix-firewall/pull/1" target="_blank" rel="noopener nofollow ugc">github.com/Whonix/whonix-firewall</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/whonix-firewall/pull/1" target="_blank" rel="noopener nofollow ugc">info messages to firewall</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> ← <code>nyxnor:master</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2022-09-26" data-time="14:32:36" data-timezone="UTC">02:32PM - 26 Sep 22 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/nyxnor" target="_blank" rel="noopener nofollow ugc">
          <img alt="nyxnor" src="https://avatars.githubusercontent.com/u/69700936?v=4" class="onebox-avatar-inline" width="20" height="20">
          nyxnor
        </a>
      </div>

      <div class="lines" title="2 commits changed 3 files with 89 additions and 5 deletions">
        <a href="https://github.com/Whonix/whonix-firewall/pull/1/files" target="_blank" rel="noopener nofollow ugc">
          <span class="added">+89</span>
          <span class="removed">-5</span>
        </a>
      </div>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">https://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/4

the ga<span class="show-more-container"><a href="https://github.com/Whonix/whonix-firewall/pull/1" target="_blank" rel="noopener nofollow ugc" class="show-more">…</a></span><span class="excerpt hidden">teway message is more complete
for the workstation, I didn't know what to put, so only EXTERNAL and INTERNAL ports were mentioned.

I didn't find where it is opening INTERNAL_OPEN_PORTS, so this message is not printed.</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/5</link>
        <pubDate>Mon, 26 Sep 2022 14:33:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15469-5</guid>
        <source url="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469.rss">print ports opened in the firewall.</source>
      </item>
      <item>
        <title>print ports opened in the firewall.</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>Can you point where are INTERNAL_OPEN_PORTS being opened in <code>whonix-workstation-firewall</code>, I didn’t find it.</p>
<aside class="onebox githubblob" data-onebox-src="https://github.com/Whonix/whonix-firewall/blob/master/usr/bin/whonix-workstation-firewall">
  <header class="source">

      <a href="https://github.com/Whonix/whonix-firewall/blob/master/usr/bin/whonix-workstation-firewall" target="_blank" rel="noopener nofollow ugc">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/Whonix/whonix-firewall/blob/master/usr/bin/whonix-workstation-firewall" target="_blank" rel="noopener nofollow ugc">Whonix/whonix-firewall/blob/master/usr/bin/whonix-workstation-firewall</a></h4>


      <pre><code class="lang-">#!/bin/bash

## Copyright (C) 2012 - 2022 ENCRYPTED SUPPORT LP &lt;adrelanos@whonix.org&gt;
## See the file COPYING for copying conditions.

#### meta start
#### project Whonix
#### category networking and firewall
#### description
## firewall script
#### meta end

## NOTE: If you make changes to this firewall, think about, if it would
##       make sense to add the changes to Whonix-Gateway script as well.
##       Some things like dropping invalid packages, should be shared.

## TODO:
## - Should allow unlimited TCP/UDP/IPv6 traffic on the virtual external interface (OnionCat / OpenVPN).

## source for some rules:
</code></pre>



  This file has been truncated. <a href="https://github.com/Whonix/whonix-firewall/blob/master/usr/bin/whonix-workstation-firewall" target="_blank" rel="noopener nofollow ugc">show original</a>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/4</link>
        <pubDate>Mon, 26 Sep 2022 13:58:31 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15469-4</guid>
        <source url="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469.rss">print ports opened in the firewall.</source>
      </item>
      <item>
        <title>print ports opened in the firewall.</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="2" data-topic="15469">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Or <code>--info</code> instead?</p>
</blockquote>
</aside>
<p>yes.</p>
<aside class="quote no-group quote-modified" data-username="Patrick" data-post="2" data-topic="15469">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Output of Whonix firewall is also integrated in sdwdate-log-viewer because of <a href="https://phabricator.whonix.org/T533" rel="noopener nofollow ugc"><img src="//forums.whonix.org/images/emoji/twitter/anchor.png?v=12" title=":anchor:" class="emoji" alt=":anchor:"> T533 iptables block network access until sdwdate succeeded</a> and that would be confusing.</p>
</blockquote>
</aside>
<p>got it</p>
<p>on my todo</p>
          <p><a href="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/3</link>
        <pubDate>Sat, 24 Sep 2022 09:58:13 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15469-3</guid>
        <source url="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469.rss">print ports opened in the firewall.</source>
      </item>
      <item>
        <title>print ports opened in the firewall.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Generally I am open the the idea. Seems useful.</p>
<blockquote>
<p>/usr/bin/whonix-TYPE-firewall --ports</p>
</blockquote>
<p>Or <code>--info</code> instead?</p>
<p>Worried user questions which will be caused by this if too verbose by default:</p>
<ul>
<li>Is it normal that INTERNAL_OPEN_PORTS xx is open?</li>
<li>Is my connection broken because there are no EXTERNAL_OPEN_PORTS, should I add some?</li>
</ul>
<p>Output of Whonix firewall is also integrated in sdwdate-log-viewer because of <a href="https://phabricator.whonix.org/T533" class="inline-onebox">⚓ T533 iptables block network access until sdwdate succeeded</a> and that would be confusing.</p>
          <p><a href="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/2</link>
        <pubDate>Sat, 24 Sep 2022 09:45:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15469-2</guid>
        <source url="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469.rss">print ports opened in the firewall.</source>
      </item>
      <item>
        <title>print ports opened in the firewall.</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>For me todo later if accepted.</p>
<p>on the respective <code>/usr/bin/whonix-TYPE-firewall</code></p>
<pre><code class="lang-auto">print_ports(){
  printf '%s\n' "INTERNAL_OPEN_PORTS=\"${INTERNAL_OPEN_PORTS[@]}\""
  printf '%s\n' "EXTERNAL_OPEN_PORTS=\"${EXTERNAL_OPEN_PORTS[@]}\""
}


end() {
   output_cmd "OK: Whonix firewall loaded."
   print_ports
   exit 0
}
</code></pre>
<p>Good? Can be default? I think it is very useful.</p>
          <p><a href="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469/1</link>
        <pubDate>Fri, 23 Sep 2022 22:11:20 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15469-1</guid>
        <source url="http://forums.whonix.org/t/print-ports-opened-in-the-firewall/15469.rss">print ports opened in the firewall.</source>
      </item>
  </channel>
</rss>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
    <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324</link>
    <description>Hello,

I am using whonix gateway to host some privatte hidden service. The traffic is not really intense but moderate. I am using whonix-gateway in virtualbox for my convinience because I am also using VBox for other VMs on same host.

Right now the problem is that whonix-gateway cracks out every 2 days or so. It does it again and again. I have to reboot my VM then the problem dissappears. Its not a VM crash or anything like that I can open VBox and see the shell. When I check top I see no RAM issues or swapping it just looks like usual.

But when it happens whole internet goes down basically. HTTP hidden nodes go down first. TCP goes next. If TCP connection was already established before its still working until next reconnection happens, then its also gone for good. Same time exit nodes stop working I get no internet in browser so its in both directions.

Do you have any idea what can be the problem? I cant even figure out where to look since the RAM doesnt look like an issue. Already pissed off poking it every 2 days to make it work again.

And second question. Since for some reason it happens do I have any option to setup second whonix in the same network? I need my service to be online ephemerally at least on any of onion domains. I could do workaround so there would be 2 whonixes that would host different onion domains and reboot daily by cron at a different times. I cannot do it on just one whonix because it takes 10 minutes for onion domains to get propagated after reboot. While it could work somehow on 2 whonix gateways without any downtime. So is it possible to change that 10.152.152.10 ip to something else? or its hardcoded to the bones?

Thanks, I appreciate any advice</description>
    <language>en</language>
    <lastBuildDate>Fri, 16 Oct 2020 17:10:46 +0000</lastBuildDate>
    <category>Support</category>
    <atom:link href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[offshorebats]]></dc:creator>
        <description><![CDATA[
            <p>Final conclusion on this:<br>
Some authority of XXX country tryna mess with tor.<br>
I have 3 whonixes right now and all of 3 gone offline suddenly. Everything gone mad, it said could not connect to entry guard, nothing helped even reboots of all 3 whonixes.</p>
<p>So I changed the setup. One whonix is on regular bridges now. Second one on obfs4 bridges. Third one direct. And the result is as follows:<br>
Bridged ones works perfectly now<br>
Direct one goes online randomly but mostly its offline.</p>
<p>So I suppose someone really doing some shady stuff with onion traffic at XXX location. I dont know how else to explain this. But it happened recently before it was fine thats why I was confused.</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/17">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/17</link>
        <pubDate>Fri, 16 Oct 2020 17:10:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-17</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>I don’t know that. Whonix is a downstream Linux distribution, a research and implementation project. We take existing components such as Tor and vanguards and then implement, bundle these according to their documentation. Therefore, I am the wrong person to ask.</p>
<p>The critical chapter is this one:<br>
<a href="https://www.whonix.org/wiki/Vanguards#Log_Analysis">https://www.whonix.org/wiki/Vanguards#Log_Analysis</a></p>
<p>And the critical quote is this one:</p>
<blockquote>
<p>Events that are detected by heuristics that still need tuning are at NOTICE level. They may be a bug, a false positive, or an actual attack. If in doubt, don’t panic. Please check the <a href="https://github.com/mikeperry-tor/vanguards/issues/">Github issues</a> <a href="https://web.archive.org/web/https://github.com/mikeperry-tor/vanguards/issues/">[archive]</a> to see if any known false positives are related to these lines, and if not, consider filing an issue. Please redact any relay fingerprints from the messages before posting.</p>
</blockquote>
<p>I doubt this issue is caused by anything Whonix does. The onion domain on <a href="http://whonix.org">whonix.org</a> server isn’t used for providing location privacy for the server, doesn’t require anonymity since it’s a public server reachable over clearnet. Has been experiencing similar reachability issues and vanguards warnings.</p>
<p>Then also if this was an attack on the Tor network (happened before with the Tor botnet attack) or against you specifically, what can I say…</p>
<p>Hosting a high availability (“99,99%” online), let alone a high traffic one, load balanced one, certainly is non-trivial. It’s not something we have yet researched and documented in Whonix documentation. Therefore until then <a href="https://www.whonix.org/wiki/Free_Support_Principle">https://www.whonix.org/wiki/Free_Support_Principle</a> is the only way to resolve this.</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/16">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/16</link>
        <pubDate>Wed, 07 Oct 2020 11:46:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-16</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[offshorebats]]></dc:creator>
        <description><![CDATA[
            <p>I read that but dont get what is happening specifically in my issue. Why it cant connect to entry guard? Is there a way I can expand the set of entry guards for my whonix-gateway without degrading anonymity?</p>
<p>How I can mitigate this issue with vanguards? I dont want to disable it as well. But it just blocks tor completely sometimes even outgoing gateway traffic.</p>
<p>From the tor entry guards wiki</p>
<blockquote>
<p>The safest decision is to persist with poor performance and wait for normal guard rotation.</p>
</blockquote>
<p>Thats sounds too pathetic. Any ways I can make it more stable without degrading the security and forcing guards rotation?</p>
<pre><code>If users feel compelled in their circumstances to proceed despite the anonymity risks, then it may be safer to first try:

One of the fallback primary entry guards.
A configured bridge.
Chaining other tunnels with Tor.
Creating a fresh Whonix-Gateway ™ (sys-whonix) and copying across the Tor state file.
</code></pre>
<p>Well I thought about this already, I will try setting up a private bridge but idk how it changes anything.</p>
<p>Ok I am lost right now, I see bridges getting broadcasted to bridge authority thats not what I want on my private relay. I was thinking of some private relay to mitigate the problem. need your reply before I start messing around.</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/15</link>
        <pubDate>Tue, 06 Oct 2020 18:44:39 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-15</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="offshorebats" data-post="13" data-topic="10324">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/a698b9/40.png" class="avatar"> offshorebats:</div>
<blockquote>
<p><code>vanguards</code></p>
</blockquote>
</aside>
<p>Please see this:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Vanguards" target="_blank" title="02:40PM - 30 June 2020">Whonix – 30 Jun 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:110/114;"><img src="https://www.whonix.org/w/images/f/fd/Vanguard.png" class="thumbnail" width="110" height="114"></div>

<h3><a href="https://www.whonix.org/wiki/Vanguards" target="_blank">Vanguards - Whonix</a></h3>

<p>Protects against Tor guard discovery and related traffic analysis attacks.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/14</link>
        <pubDate>Tue, 06 Oct 2020 14:33:40 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-14</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[offshorebats]]></dc:creator>
        <description><![CDATA[
            <p>I’m sorry to bother but still not works properly</p>
<p>So I did reinstall and everything, i setup load balancer it got better. Rightnow uptime about 100% because of my workarounds with load balancers and those cron VM resets, but I still want to make it work properly.</p>
<p>Uptime 100% because one of two whonix VMs are online at one particular moment. But whenever I login to load balancer I rarely see them both online. Only after restart it works for some time.</p>
<pre><code>Oct 06 13:18:58 host vanguards[737]: WARNING[Tue Oct 06 13:18:58 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 1705 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:18:58 host vanguards[737]: NOTICE[Tue Oct 06 13:18:58 2020]: We force-closed circuit 1705
Oct 06 13:18:59 host vanguards[737]: WARNING[Tue Oct 06 13:18:59 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 1730 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:18:59 host vanguards[737]: NOTICE[Tue Oct 06 13:18:59 2020]: We force-closed circuit 1730
Oct 06 13:19:00 host vanguards[737]: WARNING[Tue Oct 06 13:19:00 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 1738 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:19:00 host vanguards[737]: NOTICE[Tue Oct 06 13:19:00 2020]: We force-closed circuit 1738
Oct 06 13:19:00 host vanguards[737]: WARNING[Tue Oct 06 13:19:00 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 1736 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:19:00 host vanguards[737]: NOTICE[Tue Oct 06 13:19:00 2020]: We force-closed circuit 1736
Oct 06 13:19:01 host vanguards[737]: WARNING[Tue Oct 06 13:19:01 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 1735 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:19:01 host vanguards[737]: NOTICE[Tue Oct 06 13:19:01 2020]: We force-closed circuit 1735
Oct 06 13:30:09 host vanguards[737]: WARNING[Tue Oct 06 13:30:09 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 2089 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:30:09 host vanguards[737]: NOTICE[Tue Oct 06 13:30:09 2020]: We force-closed circuit 2089
Oct 06 13:30:09 host vanguards[737]: WARNING[Tue Oct 06 13:30:09 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 2088 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:30:09 host vanguards[737]: NOTICE[Tue Oct 06 13:30:09 2020]: We force-closed circuit 2088
Oct 06 13:30:12 host vanguards[737]: WARNING[Tue Oct 06 13:30:12 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 2117 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:30:12 host vanguards[737]: NOTICE[Tue Oct 06 13:30:12 2020]: We force-closed circuit 2117
Oct 06 13:30:12 host vanguards[737]: WARNING[Tue Oct 06 13:30:12 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 2119 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:30:12 host vanguards[737]: NOTICE[Tue Oct 06 13:30:12 2020]: We force-closed circuit 2119
Oct 06 13:41:32 host vanguards[737]: WARNING[Tue Oct 06 13:41:32 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 2503 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:41:32 host vanguards[737]: NOTICE[Tue Oct 06 13:41:32 2020]: We force-closed circuit 2503
Oct 06 13:52:56 host vanguards[737]: WARNING[Tue Oct 06 13:52:56 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 2722 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:52:56 host vanguards[737]: NOTICE[Tue Oct 06 13:52:56 2020]: We force-closed circuit 2722
Oct 06 13:53:52 host vanguards[737]: WARNING[Tue Oct 06 13:53:52 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 2753 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:53:52 host vanguards[737]: NOTICE[Tue Oct 06 13:53:52 2020]: We force-closed circuit 2753
Oct 06 13:53:53 host vanguards[737]: WARNING[Tue Oct 06 13:53:53 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 2778 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:53:53 host vanguards[737]: NOTICE[Tue Oct 06 13:53:53 2020]: We force-closed circuit 2778
Oct 06 13:53:56 host vanguards[737]: WARNING[Tue Oct 06 13:53:56 2020]: Possible Tor bug, or possible attack if very frequent: Got 1 dropped cell on circ 2788 (in state CIRCUIT_PADDING None; old state HS_CLIENT_INTRO HSCI_INTRO_SENT)
Oct 06 13:53:56 host vanguards[737]: NOTICE[Tue Oct 06 13:53:56 2020]: We force-closed circuit 2788
</code></pre>
<p>Right now was able to catch this log, tor says it cant reach entry guards or something. Second whonix VM works fine at this moment. So tried to attach nyx screenshot, but dont have permissions to post images. Anyways it shows same log and about several kb/s which is just tor negotiation traffic, it should be much more when working indeed. I wonder wtf, could it be some networking problems, or entry guards thinking I am DDOSing them (but its just tor app) or could it be 2 whonixes cant work from one ip (but it always worked before) or might be some attack and this is tor protection (tho there is no ddosing happening, but might be some other attack maybe)?</p>
<p>Just need to understand what does those logs mean. If entry guards block me indeed I can buy some VPS for socks so second whonix will have different ip (or setup bridge there).</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/13</link>
        <pubDate>Tue, 06 Oct 2020 14:01:28 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-13</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[offshorebats]]></dc:creator>
        <description><![CDATA[
            <p>Ok I had to replace that whonix-gateway with new one</p>
<p>It got worse and mad. I havent done no setup except hidden services. It was working for about 6 month fine, then those lags started happening, now its completely dead. Onion addresses just dont go online ever. Internet starting working in 30 mins after reboot. So looks like it just got too old and then died a natural death.<br>
I got even kernel panic when I was exporting onion keys.</p>
<p>Not the first time I see whonix-gateway got spoiled. Happens even locally but rare case. Then I just replace it with new version. Right now I setup live mode as default grub mode hope it helps new one live longer. No idea how debian can make such harm to itself by just working with traffic.</p>
<p>And still no issues on other VMs or any problems noticed on host.</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/12</link>
        <pubDate>Sun, 04 Oct 2020 16:59:36 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-12</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[offshorebats]]></dc:creator>
        <description><![CDATA[
            <p>You might be right about hardware issues. So I noticed reboot doesnt help when problem happens. After reboot it gets online, gateway is working but it works partially. For todays case no any onions got online even after an hour until I did reset of VM.</p>
<p>Might be some intel xeon virtualization issues on dedicated server, for some reason they are very cheap or hence any other hardware issues. Tho still it happens only with whonix vms</p>
<p>So only resetting a VM gives it a cleanse and a clear start. So I am fine with current workaround, I just reset em by cron daily now, also using bunch of load balancing software, so uptime is fine.</p>
<p>Thus doesnt looks like that its some common problem, might be anything in my case.</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/11</link>
        <pubDate>Thu, 01 Oct 2020 23:23:59 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-11</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>A post was split to a new topic: <a href="http://forums.whonix.org/t/multiple-whonix-gateway-whonix-workstation/10363">multiple Whonix-Gateway / Whonix-Workstation</a></p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/10</link>
        <pubDate>Thu, 01 Oct 2020 18:32:01 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-10</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p><code>str_replace</code> is a ton easier than <code>sed</code>.</p>
<aside class="quote no-group" data-username="offshorebats" data-post="8" data-topic="10324">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/a698b9/40.png" class="avatar"> offshorebats:</div>
<blockquote>
<p>You said 10.152.152.10 was not hardcoded but its was.</p>
</blockquote>
</aside>
<p>Depends on your definition of hardcoded. Many configuration files do not have any scripting / variables support such as Tor configuration or ifupdown.</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/9</link>
        <pubDate>Wed, 30 Sep 2020 09:49:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-9</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[offshorebats]]></dc:creator>
        <description><![CDATA[
            <p>You said 10.152.152.10 was not hardcoded but its was. A lot of files contains 10.152.152.10. Or you probably meant recompiling whonix myself but thats just redundant.</p>
<p>Anyways if anyone wanna change gateway ip to .11 its easy to do with simple sed approach</p>
<pre><code>grep -R "10.152.152.10" /etc | awk -F: '{ print $1 }' | sort | uniq | while read p; do echo sed -i \'s/10[.]152[.]152[.]10/10.152.152.11/g\' $p; done | bash
grep -R "10.152.152.10" /usr | awk -F: '{ print $1 }' | sort | uniq | while read p; do echo sed -i \'s/10[.]152[.]152[.]10/10.152.152.11/g\' $p; done | bash
</code></pre>
<p>And then after reboot it just works with new gateway ip.</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/8</link>
        <pubDate>Tue, 29 Sep 2020 20:56:51 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-8</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[offshorebats]]></dc:creator>
        <description><![CDATA[
            <p>I have lost that stacktrace for now, it got overwritten after reboot<br>
but I will get it next time in 24hrs or so</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/7</link>
        <pubDate>Sun, 27 Sep 2020 16:59:24 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-7</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="offshorebats" data-post="5" data-topic="10324">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/a698b9/40.png" class="avatar"> offshorebats:</div>
<blockquote>
<p>in journalctl Tor 0.4.2.7 died Caught signal 11 and some C++ stacktrace</p>
</blockquote>
</aside>
<p>Please report that stacktrace to Tor Project issue tracker so it can be fixed in Tor.</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/6</link>
        <pubDate>Sun, 27 Sep 2020 16:33:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-6</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[offshorebats]]></dc:creator>
        <description><![CDATA[
            <p>So logged into Whonix-Gateway VM in cracked out state via VBox RDP (Physical screen of a VM)</p>
<p>Date and Time - Correct<br>
Internet as root user on whonix gateway (curl ifconfig_me) - dns times out<br>
Internet as root user on whonix gateway (curl 1_1_1_1) - still times out</p>
<p>sudo -u clearnet curl ifconfig_me - not working<br>
sudo -u clearnet UWT_DEV_PASSTHROUGH=1 curl --tlsv1.2 --proto =hxxps -H ‘Host: check_torproject_org’ -k hxxxs:__116_202_120_81 - working shows html<br>
So clearnet is working, and tor has to work</p>
<p>RAM - 300mb free</p>
<p>Journalctl - nothing fishy there</p>
<p>added logging to tor<br>
then doing service tor restart<br>
now Vanguards say “Tor daemon connection failed: [No such file or directory]”<br>
in journalctl Tor 0.4.2.7 died Caught signal 11 and some C++ stacktrace</p>
<p>but that happened only after I did restart of tor service</p>
<p>so looks like its tor software problem tho, but I dont have any of those problems on other debians<br>
Tor Debug log I cant enable for first minute it bloated to 100mb file, I just dont have such space</p>
<p>I did debian pakage update but idk what else I can do only setup second whonix gateway and reboot em with cron daily on different times</p>
<p>so still a mystery right now. No doubt its related to tor version in whonix, but not clear if its tor bug or tor bug induced by some whonix environment<br>
because on vanilla debian I have never seen this kind of stuff ever</p>
<p>With 2 whonixes with 99% uptime and downtime on different times + onionballance might be some stable solution</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/5</link>
        <pubDate>Sun, 27 Sep 2020 16:22:32 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-5</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="offshorebats" data-post="3" data-topic="10324">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/a698b9/40.png" class="avatar"> offshorebats:</div>
<blockquote>
<p>Onion-balance is something about one onion domain getting down and protecting it, but for me whole gateway cracks out so I cant even browse websites (outward exit node connection).</p>
</blockquote>
</aside>
<p>Using multiple gateway’s / workstation’s should work too with onion-balance. If one gateway is overload (ddos) or down (power loss, software issues) another would take over.</p>
<aside class="quote no-group" data-username="offshorebats" data-post="3" data-topic="10324">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/a698b9/40.png" class="avatar"> offshorebats:</div>
<blockquote>
<p>Anyways what should I do to change 10.152.152.10 gateway ip</p>
</blockquote>
</aside>
<p>You can find out in which places <code>10.152.152.10</code> is written change by <a href="https://www.whonix.org/wiki/Dev/git#grep_Whonix_source_code"><code>grep</code>ing the Whonix source code</a>.</p>
<p>For example:</p>
<pre><code>mygrep -r 10.152.152.10
</code></pre>
<p>includes:</p>
<pre><code>packages/whonix-ws-network-conf/etc/network/interfaces.d/30_non-qubes-whonix:       gateway 10.152.152.10
</code></pre>
<p>which means package <code>whonix-ws-network-conf</code>  contains a file <code>/etc/network/interfaces.d/30_non-qubes-whonix</code> includes string <code>10.152.152.10</code>.</p>
<p>Package <code>whonix-developer-meta-files</code> you can ignore. Files in folder <code>/debian</code> you can ignore. Lots of other files are probably also not required. Might make sense to write a script to replace IPs. <code>str_replace</code> might be very useful.</p>
<pre><code>mygrep -rl 10.152.152.10 | grep --invert-match whonix-developer-meta-files | grep --invert-match /debian
</code></pre>
<p>Pointers only. I won’t be providing tested, step by step instructions.</p>
<aside class="quote no-group" data-username="offshorebats" data-post="3" data-topic="10324">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/a698b9/40.png" class="avatar"> offshorebats:</div>
<blockquote>
<p>But it wont work because my backend VM which hosts website and other services then should have 2 different interfaces with a same subnet. I am fairly concerned it wont work like that.</p>
</blockquote>
</aside>
<p>Complex indeed to set up with a single backend server indeed as long nobody invents step by step instructions how to set up onionshare with Whonix for a single backend.</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/4</link>
        <pubDate>Fri, 25 Sep 2020 13:40:50 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-4</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[offshorebats]]></dc:creator>
        <description><![CDATA[
            <p>Onion-balance is something about one onion domain getting down and protecting it, but for me whole gateway cracks out so I cant even browse websites (outward exit node connection). And its not getting back as well, it was down for 14 hours once then I rebooted whonix-gateway, so its some bug but not clear yet in whonix or tor software. I have experienced no DDOS yet tho.</p>
<p>Hardware issues cant be happening, there is no issues with other VMs, using that powerful dedicated server long time already, no any VM have crashed ever or anything else I noted. Also hardware failures happen randomly but this thing cracks out like a clockwork, basically 1-2 days and it needs reboot already and then again same thing.</p>
<p>So I read multiple Whonix-Gateway where it recommends separating the internal virtualbox network by renaming it from Whonix to Whonix1 on second VM</p>
<p>But it wont work because my backend VM which hosts website and other services then should have 2 different interfaces with a same subnet. I am fairly concerned it wont work like that.</p>
<p>Anyways what should I do to change 10.152.152.10 gateway ip to something else (I mean on second whonix-gateway VM)? Will it work if I just change it in /network/interfaces? Or I should edit some configs as well?</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/3</link>
        <pubDate>Thu, 24 Sep 2020 13:57:16 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-3</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="offshorebats" data-post="1" data-topic="10324">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/a698b9/40.png" class="avatar"> offshorebats:</div>
<blockquote>
<p>Do you have any idea what can be the problem?</p>
</blockquote>
</aside>
<p>No. To debug:</p>
<ol>
<li>
<p>Generally: how would one debug this if it was not a Whonix VM, but a Debian buster based VM? I suggest to research, debug this as per <a href="https://www.whonix.org/wiki/Free_Support_Principle">https://www.whonix.org/wiki/Free_Support_Principle</a>.</p>
</li>
<li>
<p>Still not Whonix specific…</p>
</li>
</ol>
<p><a href="https://www.whonix.org/wiki/Troubleshooting#Hardware_Issues">Hardware Issues</a>?</p>
<p><a href="https://www.whonix.org/wiki/VirtualBox/Troubleshooting#General_VirtualBox_Troubleshooting_Steps">General VirtualBox Troubleshooting Steps</a>?</p>
<p>But we have documentation how to watch logs… Which can be useful inside VM and on the host.</p>
<ul>
<li><a href="https://www.whonix.org/wiki/Troubleshooting#Watch_Systemd_Journal_Log_of_Current_Boot"> Watch Systemd Journal Log of Current Boot</a></li>
</ul>
<p>Also…</p>
<ul>
<li><a href="https://www.whonix.org/wiki/Troubleshooting#Enable_Persistent_Systemd_Journal_Log"> Enable Persistent Systemd Journal Log</a></li>
<li><a href="https://www.whonix.org/wiki/Troubleshooting#Check_Systemd_Journal_Log_of_Previous_Boot"> Check Systemd Journal Log of Previous Boot</a></li>
</ul>
<aside class="quote no-group" data-username="offshorebats" data-post="1" data-topic="10324">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/a698b9/40.png" class="avatar"> offshorebats:</div>
<blockquote>
<p>And second question.</p>
</blockquote>
</aside>
<p>Perhaps OnionBalance. Quote <a href="https://www.whonix.org/wiki/Onion_Services">https://www.whonix.org/wiki/Onion_Services</a></p>
<blockquote>
<p><a href="https://onionbalance.readthedocs.org">OnionBalance</a> <a href="https://web.archive.org/web/https://onionbalance.readthedocs.org">[archive]</a> can help to prevent de-anonymization of an onion service by protecting it from becoming unavailable through denial of service attacks (DDOS). OnionBalance is mentioned in the <a href="https://github.com/mikeperry-tor/vanguards/blob/master/README_SECURITY.md">security readme</a> <a href="https://web.archive.org/web/https://github.com/mikeperry-tor/vanguards/blob/master/README_SECURITY.md">[archive]</a> by vanguards author and Tor developer Mike Perry where he discusses attacks against onion services and defenses. <a href="https://onionbalance.readthedocs.io/en/latest/v3/tutorial-v3.html">OnionBalance</a> <a href="https://web.archive.org/web/https://onionbalance.readthedocs.io/en/latest/v3/tutorial-v3.html">[archive]</a> is now available for onion v3 services <a href="https://www.whonix.org/wiki/Onion_Services#cite_note-18">[18]</a>, see: <a href="https://blog.torproject.org/cooking-onions-reclaiming-onionbalance">Cooking with Onions: Reclaiming the Onionbalance</a> <a href="https://web.archive.org/web/https://blog.torproject.org/cooking-onions-reclaiming-onionbalance">[archive]</a>.</p>
</blockquote>
<p>We don’t have detail documentation for that. Might be unspecific to Whonix.</p>
<p>Related:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Multiple_Whonix-Workstation" target="_blank" title="11:12AM - 19 June 2020">Whonix – 19 Jun 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:95/63;"><img src="https://www.whonix.org/w/images/0/01/Petunia-14052640.jpg" class="thumbnail" width="95" height="63"></div>

<h3><a href="https://www.whonix.org/wiki/Multiple_Whonix-Workstation" target="_blank">Multiple Whonix-Workstation ™</a></h3>

<p>Compartmentalization. Better separation of different tasks and/or pseudonyms by using multiple Whonix-Workstation ™.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Multiple_Whonix-Gateway" target="_blank" title="11:10AM - 19 June 2020">Whonix – 19 Jun 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:95/56;"><img src="https://www.whonix.org/w/images/2/25/Multiplegateways131231.jpg" class="thumbnail" width="95" height="56"></div>

<h3><a href="https://www.whonix.org/wiki/Multiple_Whonix-Gateway" target="_blank">Multiple Whonix-Gateway ™</a></h3>

<p>Compartmentalization. Managing multiple Whonix-Gateway ™.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-username="offshorebats" data-post="1" data-topic="10324">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/a698b9/40.png" class="avatar"> offshorebats:</div>
<blockquote>
<p>or its hardcoded to the bones?</p>
</blockquote>
</aside>
<p>No.</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/2</link>
        <pubDate>Thu, 24 Sep 2020 10:45:13 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-2</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
      <item>
        <title>Issues with Whonix-Gateway cracking out after 1-2 days</title>
        <dc:creator><![CDATA[offshorebats]]></dc:creator>
        <description><![CDATA[
            <p>Hello,</p>
<p>I am using whonix gateway to host some privatte hidden service. The traffic is not really intense but moderate. I am using whonix-gateway in virtualbox for my convinience because I am also using VBox for other VMs on same host.</p>
<p>Right now the problem is that whonix-gateway cracks out every 2 days or so. It does it again and again. I have to reboot my VM then the problem dissappears. Its not a VM crash or anything like that I can open VBox and see the shell. When I check top I see no RAM issues or swapping it just looks like usual.</p>
<p>But when it happens whole internet goes down basically. HTTP hidden nodes go down first. TCP goes next. If TCP connection was already established before its still working until next reconnection happens, then its also gone for good. Same time exit nodes stop working I get no internet in browser so its in both directions.</p>
<p>Do you have any idea what can be the problem? I cant even figure out where to look since the RAM doesnt look like an issue. Already pissed off poking it every 2 days to make it work again.</p>
<p>And second question. Since for some reason it happens do I have any option to setup second whonix in the same network? I need my service to be online ephemerally at least on any of onion domains. I could do workaround so there would be 2 whonixes that would host different onion domains and reboot daily by cron at a different times. I cannot do it on just one whonix because it takes 10 minutes for onion domains to get propagated after reboot. While it could work somehow on 2 whonix gateways without any downtime. So is it possible to change that 10.152.152.10 ip to something else? or its hardcoded to the bones?</p>
<p>Thanks, I appreciate any advice</p>
          <p><a href="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324/1</link>
        <pubDate>Thu, 24 Sep 2020 07:14:15 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-10324-1</guid>
        <source url="http://forums.whonix.org/t/issues-with-whonix-gateway-cracking-out-after-1-2-days/10324.rss">Issues with Whonix-Gateway cracking out after 1-2 days</source>
      </item>
  </channel>
</rss>

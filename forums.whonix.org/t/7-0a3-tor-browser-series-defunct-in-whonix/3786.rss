<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
    <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786</link>
    <description>**1) Tor Browser 6.5.2 with Apparmor**

Runs like a dream. Including in a Whonix-WS DisposableVM.

**2) Tor Browser 7.0a3 without Apparmor on Whonix-Workstation**

Partially Works:

- Websites OK.
- Tor Project IP address check OK
- .onions work.

But: 

- Tor Button Missing in Action (doesn&#39;t appear), so can&#39;t change security slider.
- Can&#39;t interact with add-ons e.g preferences, updating fails with a HTTPS error.
- Seems to be running in low security slider (default) mode.
- Search engines dead, etc. 

That is, not useable.

**3) Tor Browser 7.0a3 without AppArmor on Whonix-Workstation and Whonix-Gateway**

Exactly as above, defunct and not safely useable.

**4) Tor Browser 7.0a3 running AppArmor on Whonix-Workstation and Whonix-Gateway**

Doesn&#39;t work at all:

- Whonix landing page doesn&#39;t even appear.
- Can&#39;t load any webpages at all.
- Apparmor goes crazy with:

&gt; apparmor=&quot;DENIED&quot; operation=&quot;open&quot; profile=&quot;/home/**/tor-browser*/Browser/firefox&quot; name=&quot;/proc/1923/net/route&quot; pid=[redacted] comm=[redacted crazy numbers and letters] requested_mask=&quot;r&quot; denied_mask=&quot;r&quot; fsuid=1000 ouid=0

x1

&gt; apparmor=&quot;DENIED&quot; operation=&quot;mknod&quot; profile=&quot;/home/**/tor-browser*/Browser/firefox&quot; name=&quot;/dev/shm/org.chromium.FzXY5G&quot; pid=[redacted] comm=[redacted crazy numbers and letters] requested_mask=&quot;c&quot; denied_mask=&quot;c&quot; fsuid=1000 ouid=1000

x a million messages.

**Conclusions**

Based on the scientific method from 1, 2, 3, and 4 above:

- Tor Browser AppArmor settings are a problem with the alpha series.
- ESR 52 (7.0a3 series) is currently incompatible with Whonix (no idea why).
- Logs aren&#39;t showing any errors for tests 2 &amp; 3 to provide more info.
- Users should stick to 6.5.2 for the time being, which also works fine in a DisposableVM &amp; works with AppArmor.
- Note that the ESR 52 nightly from 6th April worked in Whonix (I checked, see wiki edits thread). So, something changed between then and now to break Whonix completely. e10s? Others?

**General Comments**

Considering how many &quot;critical&quot; and &quot;high&quot; severity bugs were identified in this Tor Browser release, it might be time to try v0.0.6 of the sandboxed tor-browser again. Although, the upstream issue hasn&#39;t been fixed for Qubes as I understand it.

With Debian Stretch almost due for release perhaps Whonix 14 isn&#39;t far away too i.e. the updated port filter that was required for the sandbox?</description>
    <language>en</language>
    <lastBuildDate>Sat, 06 May 2017 02:42:25 +0000</lastBuildDate>
    <category>Support</category>
    <atom:link href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Sounds good. Should checksum the folder from now. Not super straight forward (no tool for that), but very much doable. (File modifications and new files should matter most for comparision. File permission changes only should be super rare to non-existing cases.)</p>
<p>Should also add a free disk space check and show a warning if there is little disk space.</p>
<p>And add a recommendation to delete old folders there are more than three of them.</p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/20">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/20</link>
        <pubDate>Sat, 06 May 2017 02:42:25 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-20</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[marmarek]]></dc:creator>
        <description><![CDATA[
            <p>How difficult is it to detect user customization? Like compare some hash<br>
with known unmodified version? If it’s easy, then simply delete if not<br>
modified. But still customized case needs to be handled somehow. What<br>
about keeping last 3 copies (or so)? If user wasn’t interested in older<br>
copies (and haven’t migrated settings to newer version), probably won’t<br>
be anytime later. Of course this need to be communicated to the user<br>
somehow - a README file in that directory?</p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/19">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/19</link>
        <pubDate>Fri, 05 May 2017 20:18:18 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-19</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Created a ticket for it.</p>
<p><code>old Tor Browser versions in /var/cache/tb-binary/.tb/ accumulate in Qubes-Whonix, users run into full up disk error issues</code><br>
<a href="https://phabricator.whonix.org/T671" class="onebox" target="_blank">https://phabricator.whonix.org/T671</a></p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/18">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/18</link>
        <pubDate>Fri, 05 May 2017 14:00:47 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-18</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="16" data-topic="3786">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Safe to delete old versions from Whonix-Workstation TemplateVM cache folder by hand?</p>
</blockquote>
</aside>
<p>Yes.</p>
<aside class="quote" data-post="16" data-topic="3786">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Auto solution:</p>
</blockquote>
</aside>
<p>I thought about this before. Old copies of Tor Browser accumulate over time. Not a big issue in case of Non-Qubes-Whonix. But Qubes-Whonix default TemplateVM root image size is small in comparison.</p>
<p>The user might have customized Tor Browser in Whonix-Workstation TemplateVM. By auto deleting the old folder, data could be lost. I don’t know how to solve this. //cc <a class="mention" href="http://forums.whonix.org/u/marmarek">@marmarek</a></p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/17">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/17</link>
        <pubDate>Fri, 05 May 2017 13:55:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-17</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p>OK - thanks. Definitely related to <a href="https://phabricator.whonix.org/T417">https://phabricator.whonix.org/T417</a></p>
<p>I can see 6 x “tor-browser-old” versions in the cache + current version in use. <em>.cache/tb/files</em> just shows sha256sums.txt and sha256sums.txt.asc</p>
<p>Re: the “usability impact” noted in that closed phabricator ticket, I think it is true that most users will keep:</p>
<blockquote>
<p>… use a single Qubes-Whonix-Workstation TemplateBased AppVM and sticking with it for a long time.</p>
</blockquote>
<p>So, the effectively means that after 5-6 tor browser updates using Whonix downloader, they will hit the (somewhat cryptic) extraction error I did.</p>
<p>Of course, I hit this due to playing with Qubes-Whonix versions lately to get ESR52 working. But still, it means some 30 weeks later or so (6 week release cycle for Tor Browsers [using the Whonix downloader method] x 5 updates), users will run out of room in their standard AppVM which is set to around 2GB.</p>
<p><strong>Manual solution:</strong></p>
<p>Safe to delete old versions from Whonix-Workstation TemplateVM cache folder by hand?</p>
<p><strong>Auto solution:</strong></p>
<p>Can tb-updater be configured to detect more than one “tor-browser.old.XXXX” version in <em>/var/cache/tb-binary/.tb</em> and auto-delete for the user?</p>
<p>That is, just keep one old version in the cache, so that should the user hit problems with the current release (for whatever reason), they can use the old one as a very short term interim solution?</p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/16">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/16</link>
        <pubDate>Mon, 01 May 2017 00:24:08 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-16</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Likely related to this mechanism:</p>
<ul>
<li><a href="https://www.whonix.org/wiki/Tor_Browser#tb-updater_in_Qubes_TemplateVM">https://www.whonix.org/wiki/Tor_Browser#tb-updater_in_Qubes_TemplateVM</a></li>
<li><a href="https://phabricator.whonix.org/T417">https://phabricator.whonix.org/T417</a></li>
<li><a href="https://github.com/Whonix/tb-updater/blob/master/usr/lib/tb-updater/first-boot-home-population">https://github.com/Whonix/tb-updater/blob/master/usr/lib/tb-updater/first-boot-home-population</a></li>
</ul>
<p>If that is the case then it would just be a disk space issue. Fresh<br>
unused copies from <code>/var/cache/tb-binary/.tb/</code> would be copied. That<br>
would not be a local data privacy issue.</p>
<p>Please run and post the output here:</p>
<pre><code>ls -la /var/cache/tb-binary/.tb/
</code></pre>
<p>And:</p>
<pre><code>ls -la /var/cache/tb-binary/.cache/tb/files/</code></pre>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/15</link>
        <pubDate>Sun, 30 Apr 2017 21:23:25 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-15</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p>Actually, I realized I had to increase the size of the private storage for the AppVM to extract that file (forgot I did that first).</p>
<p>I noticed that after deleting old tor-browser folders (emptying into trash), if the AppVM is restarted - bam - they’re back!</p>
<p>Weird, what gives? Clearly the .tb folder is under user/home, so while this is a persistent area in Qubes, it shouldn’t keep copies of stuff the user has explicitly deleted?</p>
<p>Same thing happens if you use the rm -rf command from the command line, they keep coming back, like Jason from Friday the 13th.</p>
<p>In fact, this is a security issue i.e. user AppVM gets hacked, and now the attacker has access to every old tor-browser version ever used, and presumably user data that lies around inside them in various files.</p>
<p>Also, when you create a new AppVM based on the TemplateVM, sure enough there’s multiple old versions of the tor-browser folder hanging around (test it for yourself). Shouldn’t this be clean to start with?</p>
<p>When you check the Workstation TemplateVM, the folders aren’t there (as expected), so this is not a template issue.</p>
<p>I’ve check the Qubes docs, and don’t see anything about it, except for checking from dom0 if your entire HDD/SDD is full, and how to deal with it (which mine is nowhere near being full).</p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/13</link>
        <pubDate>Sun, 30 Apr 2017 12:03:39 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-13</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Great!</p>
<p>If you like to test “even more alpha”, i.e. nightly versions, you are most welcome to, since probably no one else is doing it. The earlier we can notice any Whonix specific breakage, the better the chances to get it reported and fixed before that version gets the alpha or even stable.</p>
<aside class="quote" data-post="11" data-topic="3786">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>if Qubes-Whonix users get that message,</p>
</blockquote>
</aside>
<p>All Whonix users.</p>
<hr>
<p>For reference:</p>
<aside class="quote" data-post="1" data-topic="3824">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar">
    <a href="https://forums.whonix.org/t/tor-browser-7-0a3-apparmor/3824">Tor Browser 7.0a3 &amp; Apparmor</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/apparmor"><span class="badge-category-bg" style="background-color: #12A89D;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Discussion of Whonix AppArmor Profiles for better security. (devs)">AppArmor</span></a>
  </div>
  <blockquote>
    Tor Browser 7.0a3 works flawlessly now in Qubes-Whonix without Apparmor.  

But with Apparmor enabled, it is completely unusable. Logs consistently show two errors: 

apparmor="DENIED" operation="open"  profile="/home/**/tor-browser*/Browser/firefox"  name="/proc/1923/net/route" pid=[redacted] comm=[redacted crazy numbers and letters] requested_mask="r" denied_mask="r" fsuid=1000 ouid=0 

x1 

apparmor="DENIED" operation="mknod"  profile="/home/**/tor-browser*/Browser/firefox"  name="/dev/shm/or…
  </blockquote>
</aside>

          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/12</link>
        <pubDate>Sat, 29 Apr 2017 22:07:06 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-12</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p>OK - solved it. (you can mark this thread as “solved”)</p>
<p><strong>1)</strong> That extraction error above refers to a full anon-whonix AppVM that doesn’t have enough room to extract the tar file, as you pointed out. <img src="//forums.whonix.org/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Deleting a load of old-tor-browser directories under the .tb folder solves that problem (edit: correction - increasing the private storage size for the AppVM). We should note somewhere in the docs that if Qubes-Whonix users get that message, they need to delete old tor-browser folders, or the new Tor Browser file won’t extract.</p>
<p><strong>2)</strong> With Whonix Downloader, Tor Browser 7.0a3 works flawlessly in Qubes-Whonix. I must have stuffed up something before.</p>
<p>I could even run it in high security slider mode and play Youtube as well as basic online gaming etc. Everything works and didn’t crash once in this mode.</p>
<p>Great.</p>
<p><strong>3)</strong> With Apparmor profiles enforced, it is completely unusable, with the error messages I already outlined above. So, I’ll take those and dump them in the Apparmor Forum where they belong.</p>
<p>Cheers!</p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/11</link>
        <pubDate>Sat, 29 Apr 2017 17:34:31 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-11</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Disk full by chance? Can you check please <code>df -h</code>?</p>
<p>Could you manually verify the files please? All files are in this folder.</p>
<pre><code>~/.cache/tb/
</code></pre>
<p>Just as if you downloaded it yourself. And manually extract?</p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/10</link>
        <pubDate>Sat, 29 Apr 2017 16:49:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-10</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="8" data-topic="3786">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>And if you download from <a href="https://people.torproject.org/~gk/testbuilds/tbb-nightly/">https://people.torproject.org/~gk/testbuilds/tbb-nightly/</a>, please make sure to use tor-browser-linux64-debug.zip. (The 32 bit version won’t work since Qubes-Whonix is 64 bit.)</p>
</blockquote>
</aside>
<p>Ah - maybe that was the nightly was broken (not using the linux64-debug.zip).</p>
<p>Re: the standard “normal” 7.0a3, I think I manually installed it last time.</p>
<p>Anyway, this time I used Tor Browser Downloader by Whonix in a clean AppVM and downloads fine, sigs check out, and then when trying to extract it, this happened (twice):</p>
<blockquote>
<p>Error: Could not extract /home/user/.cache/tb/files/tor-browser-linux64-7.0a3_en-US.tar.xz!</p>
</blockquote>
<blockquote>
<p>(Debugging information:<br>
tar exit code: 1<br>
pv_exit code: 0<br>
tar_exit_code: 1<br>
pv_wrapper_exit_code: 0)</p>
</blockquote>
<blockquote>
<p>Please report this bug!</p>
</blockquote>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/9</link>
        <pubDate>Sat, 29 Apr 2017 15:51:36 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-9</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <blockquote>
<p><code>7.0a3 (based on Mozilla Firefox 52.1.0) (64-bit)</code></p>
</blockquote>
<p>^ Copied from <code>About Tor Browser</code>.</p>
<p>Works for me in Qubes-Whonix-Workstation 13 based anon-whonix. (No AppArmor enabled.)</p>
<p>(Downloaded and installed using <code>Tor Browser Downloader by Whonix</code>. (<code>update-torbrowser</code>)</p>
<p>Could you try please if that works for you?</p>
<p>Are you sure that version version is broken?</p>
<p>You have mentioned <a href="https://people.torproject.org/~gk/testbuilds/tbb-nightly/">https://people.torproject.org/~gk/testbuilds/tbb-nightly/</a> earlier. Perhaps that’s actually an older version that is broken?</p>
<p>And if you download from <a href="https://people.torproject.org/~gk/testbuilds/tbb-nightly/">https://people.torproject.org/~gk/testbuilds/tbb-nightly/</a>, please make sure to use <code>tor-browser-linux64-debug.zip</code>. (The <code>32</code> bit version won’t work since Qubes-Whonix is 64 bit.)</p>
<p>I’ve reread this thread 5 times now. Still not clear to me. Could you please reiterate briefly what is broken in Qubes-Whonix-Workstation 13 with no AppArmor vs Qubes Debian based VM?</p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/8</link>
        <pubDate>Sat, 29 Apr 2017 11:25:15 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-8</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p><strong>Test Platform:</strong></p>
<p>Qubes Debian-8 AppVM Test.</p>
<p><strong>Tor Browser Series:</strong></p>
<p>Tor Browser 7.0a3<br>
–debug mode from terminal</p>
<p><strong>Other Settings:</strong></p>
<ul>
<li>Nil AppArmor settings or other hardening to interfere with the test.</li>
<li>Whonix-GW was not used, just the standard Qubes networking.</li>
</ul>
<p><strong>Functional Features:</strong></p>
<ul>
<li>Tor connects correctly.</li>
<li>A functional Tor Connection with <a href="http://check.torproject.org">check.torproject.org</a> (“Test Tor Network Settings”).</li>
<li>About Tor Browser shows:</li>
</ul>
<blockquote>
<p>7.0a3 (based on Mozilla Firefox 52.1.0) (64-bit). “You are currently on the alpha update channel.”</p>
</blockquote>
<ul>
<li>Add-ons update correctly and the browser restarts fine.</li>
<li>Changing the security slider works.</li>
<li>DuckDuckGo and other https search engines work.</li>
<li>DuckDuckGo .onion search works.</li>
<li>Visible Tor Circuit works.</li>
<li>“New Tor Circuit for this Site” works.</li>
<li>“New Identity” works.</li>
<li>General website browsing works.</li>
<li>Youtube works. In fact the video seems much smoother than 45.9 ESR.</li>
<li>Whonix .onion and <a href="http://whonix.org">whonix.org</a> are very smooth and fast, and  those edits are looking fine. <img src="//forums.whonix.org/images/emoji/twitter/wink.png?v=5" title=":wink:" class="emoji" alt=":wink:">
</li>
<li>Tested at the medium security level and segmentation faults (see below) seem to miraculously dissapear.</li>
<li>The sound works fine. None of the problems reported by some Gentoo Linux (and other platform) users appear for this alpha release.</li>
<li>Tested online Javascript gaming (basic) and it’s working nicely. In fact, ESR 52.1 has improved the video quality a lot. It is noticeable.</li>
<li>TBB debug output isn’t showing anything strange on the medium security level setting. Just some add-ons update manifest warnings which are nothing to worry about.</li>
<li>about:support shows e10s is running:</li>
</ul>
<blockquote>
<p>1/1 (Enabled by default)</p>
</blockquote>
<ul>
<li>Safe mode is off (as expected). <a href="https://support.mozilla.org/en-US/kb/troubleshoot-firefox-issues-using-safe-mode?cache=no">https://support.mozilla.org/en-US/kb/troubleshoot-firefox-issues-using-safe-mode?cache=no</a>
</li>
<li>Panopticlick shows (unfortunately) much more data being harvested at the medium level compared to the high security level e.g. Hash of canvas fingerprint, Screen Size and Color Depth, System Fonts, Touch Support Settings, Cookies enabled.</li>
<li>Other fingerprinting values are spoofed, but still a unique value is derived.</li>
</ul>
<p><strong>Browser Crashes:</strong></p>
<p>The only two problems are these below. They are known to The Tor Project and related to this Tor Trac bug:</p>
<p><a href="https://trac.torproject.org/projects/tor/ticket/21962" class="onebox" target="_blank">https://trac.torproject.org/projects/tor/ticket/21962</a></p>
<ul>
<li>Changing/checking add-ons preferences crash the browser in high-security slider mode:</li>
</ul>
<blockquote>
<p>./start-tor-browser: line 368:  1098 Segmentation fault      TOR_CONTROL_PASSWD=${TOR_CONTROL_PASSWD} ./firefox --class “Tor Browser” -profile TorBrowser/Data/Browser/profile.default “${@}” &lt; /dev/null</p>
</blockquote>
<ul>
<li>Tor Browser also occasionally crashes with the same segmentation fault (randomly) in high security slider mode e.g. when browsing. The output is like that above.</li>
</ul>
<p>Qubes logs shows the crash in the plug-in container:</p>
<blockquote>
<p>Chrome_ChildThr[1295]: segfault at 0 ip 0000000000405167 sp 00007f3102a7c400 error 6 in plugin-container[400000+40000]</p>
</blockquote>
<p><strong>Tor Browser Solution:</strong></p>
<p>Running in medium security setting gives a solid and stable browsing experience and no repeat of segmentation faults.</p>
<p><strong>Conclusion:</strong></p>
<p>All in all, I am very pleasantly surprised that this works so well. 52.1 ESR seems to work in Qubes except for (bad) known Tor Project bugs.</p>
<p>In high security mode, this is their worst alpha release yet. But at the medium or low security slider mode, maybe it is their best (I sound like a salesperson). It is a very solid Tor browsing experience and has a nice feel to it given the improved video experience.</p>
<p>None of the other problems as seen in the Whonix AppVM emerge.</p>
<p><strong>Preliminary Conclusion:</strong></p>
<p>Since Tor Browser based on 52.1 ESR is running fine in a Qubes Debian AppVM, this suggests something is wrong with the Qubes-Whonix template settings (potentially also non-Qubes-Whonix, but I don’t run it).</p>
<p>This is probably unrelated to just Apparmor given earlier trials where this variable was removed.</p>
<p>Let me know if you want any further information or tests.</p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/7</link>
        <pubDate>Sun, 23 Apr 2017 14:27:53 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-7</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="5" data-topic="3786">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>So you have some more functionality in non-Qubes-Whonix?</p>
</blockquote>
</aside>
<p>I didn’t say that in my previous post.</p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/6</link>
        <pubDate>Sun, 23 Apr 2017 11:56:34 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-6</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p>Good call.</p>
<p>Let me try and run Tor Browser in a standard Debian template in Qubes, then we have more information.</p>
<p>So you have some more functionality in non-Qubes-Whonix? That’s interesting if that’s the case.</p>
<p>Re: Apparmor -&gt; yeah, probably no difference between those user cases (forgetting that all the profiles apply to the Workstation apps from memory).</p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/5</link>
        <pubDate>Sat, 22 Apr 2017 17:45:50 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-5</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Does anyone think they could send a pull request for <a href="https://github.com/Whonix/apparmor-profile-torbrowser/blob/master/etc/apparmor.d/home.tor-browser.firefox">https://github.com/Whonix/apparmor-profile-torbrowser/blob/master/etc/apparmor.d/home.tor-browser.firefox</a> to sort out these apparmor denied messages?</p>
<hr>
<p>The issues you’ve been reporting… It would be very good to know which issues are only happening inside Whonix, and which ones are not. Like for example:</p>
<aside class="quote" data-post="1" data-topic="3786">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Tor Button Missing in Action (doesn’t appear), so can’t change security slider.</p>
</blockquote>
</aside>
<p>That works for me.</p>
<p>Does it work for you in a Qubes Debian jessie template? And is broken inside Whonix-Workstation? Then that would be a bug that Whonix could be responsible for. Otherwise such issues belong to the Tor Project issue tracker. (And very welcome being referenced here to stay up to date.)</p>
<hr>
<aside class="quote" data-post="1" data-topic="3786">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<ol start="2">
<li>Tor Browser 7.0a3 without Apparmor on Whonix-Workstation</li>
</ol>
</blockquote>
</aside>
<aside class="quote" data-post="1" data-topic="3786">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<ol start="3">
<li>Tor Browser 7.0a3 without AppArmor on Whonix-Workstation and Whonix-Gateway</li>
</ol>
</blockquote>
</aside>
<p>What’s the difference between these test cases?</p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/4</link>
        <pubDate>Sat, 22 Apr 2017 15:38:37 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-4</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="1" data-topic="3786">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/t/f9ae1b/40.png" class="avatar"> torjunkie:</div>
<blockquote>
<p>Considering how many “critical” and “high” severity bugs were identified in this Tor Browser release, it might be time to try v0.0.6 of the sandboxed tor-browser again. Although, the upstream issue hasn’t been fixed for Qubes as I understand it.</p>
</blockquote>
</aside>
<p>For sandboxed-tor-browser (manually installed in Whonix)…</p>
<p>Qubes unresolved issue, need to run:</p>
<pre><code>sudo umount /proc/xen
</code></pre>
<p>( <a href="https://github.com/QubesOS/qubes-issues/issues/2540">https://github.com/QubesOS/qubes-issues/issues/2540</a> )</p>
<p>Whonix unresolved issue, needs newer version of control-port-filter-python (now onion-grater), that will come in Whonix 14, that is blocked by resolving the following tickets somehow <a href="https://phabricator.whonix.org/tag/whonix_14/">https://phabricator.whonix.org/tag/whonix_14/</a> as well as the Debian stretch being blessed stable.</p>
<hr>
<p>Related, there is a another severe bug that stops us from using Tor Browser at all.<br>
<code>Tor Browser 7.0a2 broken in stretch based Whonix 14 - &lt;jemalloc&gt;: Corrupt redzone 0 bytes after 0x7f0503ede9d0 (size 80), byte=0x0</code></p>
<ul>
<li><a href="https://phabricator.whonix.org/T651">https://phabricator.whonix.org/T651</a></li>
<li><a href="https://trac.torproject.org/projects/tor/ticket/21804">https://trac.torproject.org/projects/tor/ticket/21804</a></li>
</ul>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/3</link>
        <pubDate>Sat, 22 Apr 2017 14:56:37 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-3</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p>Moved from the <em>Long wiki edits thread</em>.</p>
<p><strong>Re: Tor Browser ESR 52.0.2 Nightly Test</strong></p>
<p>The ESR 52 nightly build is from the 6th April, so hopefully they have fixed many of these issues / bugs below.</p>
<p><a href="https://lists.torproject.org/pipermail/tbb-dev/2017-April/000501.html" class="onebox" target="_blank">https://lists.torproject.org/pipermail/tbb-dev/2017-April/000501.html</a></p>
<blockquote>
<p>We have first nightly builds based on Firefox 52.0.2esr available:</p>
</blockquote>
<blockquote>
<p><a href="https://people.torproject.org/~gk/testbuilds/tbb-nightly/">https://people.torproject.org/~gk/testbuilds/tbb-nightly/</a></p>
</blockquote>
<blockquote>
<p>The location is a bit unusual but we hit an issue in our nightly build Gitian setup which made some tweaking to our usual build and upload process necessary. Nevertheless, please give this nightly a test if you can as we don’t have much time left before the first alpha based on ESR 52 is due.</p>
</blockquote>
<p><strong>Test Outcome</strong></p>
<p>Tested and (mostly) working in Whonix!</p>
<p><strong>Some problems</strong></p>
<ul>
<li>There is some weird maximizing windows behaviour when checking the “About Tor” button and Add-ons settings (already reported to Tor Project), but it confirms it is FF ESR 52.0.2.</li>
<li>They haven’t disabled Pocket yet.</li>
<li>The Youtube test hangs first time when the security slider is set to medium (but got it working eventually).</li>
<li>Restart Browser (New Identity) maximized and really didn’t want to restart unless the “x” button was hit. I had to manually kill another Tor Browser instance after the new Tor Browser popped up (due to the Youtube error).</li>
</ul>
<p>This AppArmor message appears, but Tor Browser still works:</p>
<blockquote>
<p>apparmor=“DENIED” operation=“open” profile="/home/**/tor-browser*/Browser/firefox" name="/proc/2616/net/route" pid=[redacted] comm=[redacted - long weird set of numbers and letters] requested_mask=“r” denied_mask=“r” fsuid=1000 ouid=0</p>
</blockquote>
<p><strong>Sandbox Options all read true</strong></p>
<blockquote>
<p>Seccomp-BPF (System Call Filtering)    true<br>
Seccomp Thread Synchronization    true<br>
User Namespaces    true<br>
Media Plugin Sandboxing    true</p>
</blockquote>
<p><strong>e10s is (was) still not enabled in Linux</strong></p>
<p>The Tor Project was still working on it at that time.</p>
<blockquote>
<p>Multiprocess Windows     0/1 (Disabled)</p>
</blockquote>
<p><strong>Browser Fingerprinting.</strong></p>
<p>JonDoNym, BrowserLeaks, Panopticlick etc. seem to treat it like the normal Tor Browser, that is, not much showing.</p>
<p>However, the fingerprint was completely unique out of 35,000 odd browsers on Panopticlick, since obviously nobody is (was) running Tor Browser ESR 52 in general.</p>
<p><strong>General Other Tests</strong></p>
<ul>
<li>Restart Browser Test (but with quirks as noted) -&gt; works.</li>
<li>.onion Test -&gt; works (but notes .onions show an insecure padlock, go figure).</li>
<li>New Tor Circuit -&gt; works.</li>
<li>Updating Add-ons -&gt; works.</li>
<li>Youtube (but with quirks as noted) -&gt; works.</li>
<li>Online gaming (simple) -&gt; works.</li>
<li>Twitter &gt; works.</li>
<li>Github -&gt; works.</li>
<li>
<a href="http://Whonix.org">Whonix.org</a> -&gt; works.</li>
<li>Search engines -&gt; works</li>
<li>Other -&gt; Didn’t test.</li>
</ul>
<p>Basically, it is useable in Whonix but very fingerprintable right now. This is particularly true since it wants to periodically maximize the window when you hit some of the menu options.</p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/2</link>
        <pubDate>Sat, 22 Apr 2017 04:31:19 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-2</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
      <item>
        <title>7.0a3 Tor Browser Series -&gt; Defunct in Whonix</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p><strong>1) Tor Browser 6.5.2 with Apparmor</strong></p>
<p>Runs like a dream. Including in a Whonix-WS DisposableVM.</p>
<p><strong>2) Tor Browser 7.0a3 without Apparmor on Whonix-Workstation</strong></p>
<p>Partially Works:</p>
<ul>
<li>Websites OK.</li>
<li>Tor Project IP address check OK</li>
<li>.onions work.</li>
</ul>
<p>But:</p>
<ul>
<li>Tor Button Missing in Action (doesn’t appear), so can’t change security slider.</li>
<li>Can’t interact with add-ons e.g preferences, updating fails with a HTTPS error.</li>
<li>Seems to be running in low security slider (default) mode.</li>
<li>Search engines dead, etc.</li>
</ul>
<p>That is, not useable.</p>
<p><strong>3) Tor Browser 7.0a3 without AppArmor on Whonix-Workstation and Whonix-Gateway</strong></p>
<p>Exactly as above, defunct and not safely useable.</p>
<p><strong>4) Tor Browser 7.0a3 running AppArmor on Whonix-Workstation and Whonix-Gateway</strong></p>
<p>Doesn’t work at all:</p>
<ul>
<li>Whonix landing page doesn’t even appear.</li>
<li>Can’t load any webpages at all.</li>
<li>Apparmor goes crazy with:</li>
</ul>
<blockquote>
<p>apparmor=“DENIED” operation=“open” profile="/home/**/tor-browser*/Browser/firefox" name="/proc/1923/net/route" pid=[redacted] comm=[redacted crazy numbers and letters] requested_mask=“r” denied_mask=“r” fsuid=1000 ouid=0</p>
</blockquote>
<p>x1</p>
<blockquote>
<p>apparmor=“DENIED” operation=“mknod” profile="/home/**/tor-browser*/Browser/firefox" name="/dev/shm/org.chromium.FzXY5G" pid=[redacted] comm=[redacted crazy numbers and letters] requested_mask=“c” denied_mask=“c” fsuid=1000 ouid=1000</p>
</blockquote>
<p>x a million messages.</p>
<p><strong>Conclusions</strong></p>
<p>Based on the scientific method from 1, 2, 3, and 4 above:</p>
<ul>
<li>Tor Browser AppArmor settings are a problem with the alpha series.</li>
<li>ESR 52 (7.0a3 series) is currently incompatible with Whonix (no idea why).</li>
<li>Logs aren’t showing any errors for tests 2 &amp; 3 to provide more info.</li>
<li>Users should stick to 6.5.2 for the time being, which also works fine in a DisposableVM &amp; works with AppArmor.</li>
<li>Note that the ESR 52 nightly from 6th April worked in Whonix (I checked, see wiki edits thread). So, something changed between then and now to break Whonix completely. e10s? Others?</li>
</ul>
<p><strong>General Comments</strong></p>
<p>Considering how many “critical” and “high” severity bugs were identified in this Tor Browser release, it might be time to try v0.0.6 of the sandboxed tor-browser again. Although, the upstream issue hasn’t been fixed for Qubes as I understand it.</p>
<p>With Debian Stretch almost due for release perhaps Whonix 14 isn’t far away too i.e. the updated port filter that was required for the sandbox?</p>
          <p><a href="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786/1</link>
        <pubDate>Thu, 20 Apr 2017 15:28:35 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3786-1</guid>
        <source url="http://forums.whonix.org/t/7-0a3-tor-browser-series-defunct-in-whonix/3786.rss">7.0a3 Tor Browser Series -&gt; Defunct in Whonix</source>
      </item>
  </channel>
</rss>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Linux Random Number Generation (RNG) Innerworkings and Early Boot Seeding - News - Whonix Forum</title>
    <meta name="description" content="Interesting thread: 

 
That lead to this analysis paper about everything you ever wanted to know about how the Linux RNG works, its security assumptions and precautions for backward and forward security. Particularly of&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="8591.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Linux Random Number Generation (RNG) Innerworkings and Early Boot Seeding&#39;" href="8591.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/linux-random-number-generation-rng-innerworkings-and-early-boot-seeding/8591" />
<meta name="twitter:url" content="https://forums.whonix.org/t/linux-random-number-generation-rng-innerworkings-and-early-boot-seeding/8591" />
<meta property="og:title" content="Linux Random Number Generation (RNG) Innerworkings and Early Boot Seeding" />
<meta name="twitter:title" content="Linux Random Number Generation (RNG) Innerworkings and Early Boot Seeding" />
<meta property="og:description" content="Interesting thread:      That lead to this analysis paper about everything you ever wanted to know about how the Linux RNG works, its security assumptions and precautions for backward and forward security. Particularly of interest is info on reusing urandom output as a seed on next boot:     2.5  Initialization  herefore, the designer of the Linux PRNG recommends ascript which, at shutdown, generates data from/dev/urandomand saves it in a file, and at startup, writes the saved data to/dev/urando..." />
<meta name="twitter:description" content="Interesting thread:      That lead to this analysis paper about everything you ever wanted to know about how the Linux RNG works, its security assumptions and precautions for backward and forward security. Particularly of interest is info on reusing urandom output as a seed on next boot:     2.5  Initialization  herefore, the designer of the Linux PRNG recommends ascript which, at shutdown, generates data from/dev/urandomand saves it in a file, and at startup, writes the saved data to/dev/urando..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="4 ‚ù§" />
<meta property="article:published_time" content="2019-12-05T06:17:16+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="8591.html">Linux Random Number Generation (RNG) Innerworkings and Early Boot Seeding</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/news/21.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #AB9364'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>News</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8591.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-05T06:17:16Z' class='post-time'>
                December 5, 2019,  6:17am
              </time>
              <meta itemprop='dateModified' content='2019-12-05T09:34:44Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Interesting thread:<br>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../external.html?link=https://crypto.stackexchange.com/questions/9412/what-to-watch-for-with-openssl-generating-weak-keys-low-entropy" target="_blank">crypto.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../external.html?link=https://crypto.stackexchange.com/users/7772/brian-armstrong" target="_blank">
    <img alt="Brian Armstrong" src="../../../external.html?link=https://www.gravatar.com/avatar/88aaa125be70fd75c1d1b25fa5a2ce2d?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="128" height="128">
  </a>
<h4>
  <a href="../../../external.html?link=https://crypto.stackexchange.com/questions/9412/what-to-watch-for-with-openssl-generating-weak-keys-low-entropy" target="_blank">What to watch for with openssl generating weak keys? (low entropy)</a>
</h4>

<div class="tags">
  <strong>random-number-generator, randomness, entropy, openssl</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../external.html?link=https://crypto.stackexchange.com/users/7772/brian-armstrong" target="_blank">
    Brian Armstrong
  </a>
  on <a href="../../../external.html?link=https://crypto.stackexchange.com/questions/9412/what-to-watch-for-with-openssl-generating-weak-keys-low-entropy" target="_blank">06:48PM - 24 Jul 13 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>That lead to this analysis paper about everything you ever wanted to know about how the Linux RNG works, its security assumptions and precautions for backward and forward security. Particularly of interest is info on reusing urandom output as a seed on next boot:</p>
<aside class="onebox pdf">
  <header class="source">
      <a href="../../../external.html?link=https://eprint.iacr.org/2012/251.pdf" target="_blank">eprint.iacr.org</a>
  </header>
  <article class="onebox-body">
    <a href="../../../external.html?link=https://eprint.iacr.org/2012/251.pdf" target="_blank"><span class="pdf-onebox-logo"></span></a>
<h3><a href="../../../external.html?link=https://eprint.iacr.org/2012/251.pdf" target="_blank">251.pdf</a></h3>

<p class="filesize">757.54 KB</p>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<blockquote>
<p>2.5  Initialization</p>
<p>herefore, the designer of the Linux PRNG recommends ascript which, at shutdown, generates data from/dev/urandomand saves it in a file, and at startup, writes the saved data to/dev/urandom. This mixes the same data into the blocking and nonblocking pools without increasing their entropy counters.Such a script is provided in the default installation of most Linux distributions. In situations where this procedure is not possible, for example in Live CD systems, the nonblocking random number generator should be used with caution directly after the boot process since it might not contain enough entropy</p>
</blockquote>
<p>This is how it is implemented with systemd. Only useful if system had a clean shutdown:</p>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../external.html?link=https://unix.stackexchange.com/questions/388803/why-is-the-random-seed-only-saved-to-disk-on-boot-and-shutdown" target="_blank">unix.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../external.html?link=https://unix.stackexchange.com/users/229660/yt7b97q" target="_blank">
    <img alt="yt7b97q-" src="../../../external.html?link=https://www.gravatar.com/avatar/8b53bb5d7f056e3451dbc7f7d248da82?s=128&amp;d=identicon&amp;r=PG&amp;f=1" class="thumbnail onebox-avatar" width="128" height="128">
  </a>
<h4>
  <a href="../../../external.html?link=https://unix.stackexchange.com/questions/388803/why-is-the-random-seed-only-saved-to-disk-on-boot-and-shutdown" target="_blank">Why is the random seed only saved to disk on boot and shutdown?</a>
</h4>

<div class="tags">
  <strong>linux, random</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../external.html?link=https://unix.stackexchange.com/users/229660/yt7b97q" target="_blank">
    yt7b97q-
  </a>
  on <a href="../../../external.html?link=https://unix.stackexchange.com/questions/388803/why-is-the-random-seed-only-saved-to-disk-on-boot-and-shutdown" target="_blank">10:59AM - 28 Aug 17 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>^^ On why seeds are absolutely important to RNG security:</p>
<blockquote>
<p>The thing to remember about PRNGs is that <em>they are not random</em> . They are entirely deterministic. If one knows the initial input values and the particular PRNG algorithm, one can determine every single future ‚Äúrandom‚Äù output value.</p>
<p>In this case, the algorithm is well known. It is after all, published as part of an open source kernel. So the key to randomness is the <em>seed</em> . The level of ‚Äúrandomness‚Äù that is provided is <em>unpredictability</em> , from one output to the next. Knowing the algorithm and the previous outputs but not the seed, it is <em>unfeasibly hard</em> to predict what the next random output will be. (This is not a formal nor a complete definition of what it means for a PRNG to be <em>cryptographically secure</em> ; but will do as a limited approximation for the purposes of this answer.)</p>
<p>This is the basic reason for the widely-discussed problems with Linux‚Äôs <code>/dev/urandom</code> , which I am just going to gloss over here. At bootstrap, the seed is <em>also</em> well known. The random outputs are all entirely predictable <em>until</em> the PRNG is <em>re-seeded</em> , i.e. supplied with a fresh seed that is unique (or as near as one can get) to that run of that operating system installation, for the first time.</p>
</blockquote>
<p>Great info on early boot entropy seeding, especially problematic on amnesic systems. <em>twuewand</em> is a neat workaround that is unfortunately not packaged for Debian but is small enough:</p>
<p><a href="../../../external.html?link=https://tails.boum.org/blueprint/randomness_seeding/" class="onebox" target="_blank">https://tails.boum.org/blueprint/randomness_seeding/</a></p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <a href="../../../external.html?link=https://www.finnie.org/2011/09/25/introducing-twuewand/" target="_blank">Ryan Finnie</a>
  </header>
  <article class="onebox-body">
    <img src="#" class="thumbnail">

<h3><a href="../../../external.html?link=https://www.finnie.org/2011/09/25/introducing-twuewand/" target="_blank">Introducing twuewand</a></h3>

<p>twuewand is a true hardware random number generator, written in about a hundred lines of Perl.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<hr>
<p>In the meantime until <a href="../rdrand-entropy-config-random-trust-cpu-yes-or-no-rng-core-default-quality/8566/19.html">we can convince upstream to disable hwrng trust on boot</a> which they probably won‚Äôt accept until the <a href="../../../external.html?link=https://www.phoronix.com/scan.php?page=news_item&amp;px=Linux-5.4-Actively-Gen-Entropy">changes</a> by Linus in 5.4 are  in the stable kernel, we should try to drown out the untrusted input as much as possible by installing as many entropy solutions as possible.</p>
        </div>

        <meta itemprop='headline' content='Linux Random Number Generation (RNG) Innerworkings and Early Boot Seeding'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="3" />
           <span class='post-likes'>3 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../twuewand-a-truerand-algorithm-for-generating-entropy-whonix-integration/8880.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../twuewand-a-truerand-algorithm-for-generating-entropy-whonix-integration/8880.html'>
                      <span itemprop='name'>twuewand - a truerand algorithm for generating entropy - Whonix integration</span>
                    </a>
                    <meta itemprop='position' content='10'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../good-read-on-the-linux-security-wrt-to-entropy-randomness/2103/5.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../good-read-on-the-linux-security-wrt-to-entropy-randomness/2103/5.html'>
                      <span itemprop='name'>good read on the linux security wrt to entropy / randomness</span>
                    </a>
                    <meta itemprop='position' content='11'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/anontor'><span itemprop='name'>anontor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8591.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-05T20:42:19Z' class='post-time'>
                December 5, 2019,  8:42pm
              </time>
              <meta itemprop='dateModified' content='2019-12-05T20:42:19Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>This is gold! Thank you!</p>
        </div>

        <meta itemprop='headline' content='Linux Random Number Generation (RNG) Innerworkings and Early Boot Seeding'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

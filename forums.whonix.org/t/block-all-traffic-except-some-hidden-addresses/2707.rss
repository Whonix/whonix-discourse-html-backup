<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Block all traffic except some hidden addresses</title>
    <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707</link>
    <description>How can I modify the Whonix Firewall (or make iptables rules) to block all trafffic that doesn&#39;t go to some specific .onion hidden services and sites? I have a file with .onion addresses of hidden services and web sites, and I want to allow only traffic to those listed .onion urls.

Thanks.</description>
    <language>en</language>
    <lastBuildDate>Sun, 17 Jul 2016 18:19:12 +0000</lastBuildDate>
    <category>General Tor and Anonymity Talk</category>
    <atom:link href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[assd]]></dc:creator>
        <description><![CDATA[
            <p>Sorry for being off-topic but some use cases for 3proxy regex includes blocking any connection that may include metadata or some kind of identifying information or similar. It would log these in a file which could be a source of information for whonixcheck to regularly check so that it could report Whonix blocked a XXX attempt by XXX</p>
<p>It could modify/delete headers which could help with modifying/removing identifying information in non-ssl connections made by badly configured  applications or it could even turn a non-safe browser headers into a Tor Browser-identical one. it also has an ssl plugin to decrypt traffic but I’m not sure if that helps us or not</p>
<p>it could limit bandwidth or traffic size for hidden services or applications and it is also possible to set date or time limits for access</p>
          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/14</link>
        <pubDate>Sun, 17 Jul 2016 18:12:47 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-14</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[assd]]></dc:creator>
        <description><![CDATA[
            <p>Actually there are so many ways to benefit from 3proxy in Whonix it just needs time to find out them all.</p>
<p>For example 3proxy is able to limit bandwidth and/or total traffic size for a port which should help with hardening many things with Tor/Whonix. All at the same time with the blacklist/whitelist/redirecting/chaining and regex match or replace features</p>
          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/13</link>
        <pubDate>Sun, 17 Jul 2016 18:02:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-13</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[assd]]></dc:creator>
        <description><![CDATA[
            <p>Patrick, 3proxy has a very interesting option to use regex to match or even replace content in the connection. I didn’t use it enough but unless I’m mistaken it could solve most of your problems that you described in a post above and even enhance data security in ways that is only limited to imagination</p>
<p><a href="https://3proxy.ru/plugins/PCREPlugin/" class="onebox" target="_blank" rel="nofollow noopener">https://3proxy.ru/plugins/PCREPlugin/</a></p>
<p>There is also a file at the bottom as an example usage.</p>
          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/12</link>
        <pubDate>Sun, 17 Jul 2016 17:46:10 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-12</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>For this very thread, please let’s discuss 3proxy to the extend of the subject <code>Block all traffic except some hidden addresses</code>.</p>
<aside class="quote" data-post="10" data-topic="2707" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/a/9dc877/40.png" class="avatar"> assd:</div>
<blockquote>
<p>Patrick, do you think 3proxy could be considered as an additional firewall for both gateway and workstation considering it can be used to whitelist/blacklist using so many variables? I’m especially wondering if it could help with hardening hidden services.</p>
</blockquote>
</aside>
<p>For other 3proxy discussions, please open a separate thread.</p>
<aside class="quote" data-post="9" data-topic="2707">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/a/9dc877/40.png" class="avatar"> assd:</div>
<blockquote>
<p>If you are interested I could share some of my simple configurations to literally own the control of all connections</p>
</blockquote>
</aside>
<p>Sure. Might be interesting. Feel free to share in a appropriate thread.</p>
          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/11</link>
        <pubDate>Sun, 17 Jul 2016 16:56:14 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-11</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[assd]]></dc:creator>
        <description><![CDATA[
            <p>Patrick, do you think 3proxy could be considered as an additional firewall for both gateway and workstation considering it can be used to whitelist/blacklist using so many variables? I’m especially wondering if it could help with hardening hidden services.</p>
          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/10</link>
        <pubDate>Sun, 17 Jul 2016 16:35:09 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-10</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[assd]]></dc:creator>
        <description><![CDATA[
            <p>Could Whonix implement 3proxy, it can do much more than what is mentioned in this topic. It supports all types of proxies (http,https,socks4,socks5,…)</p>
<p>whitelist/blacklist using IPs/hostnames, filtering by ports, protocols (http, https, ftp, etc.), filtering by user:password and more</p>
<p>you could specify multiple (wildcard) hostnames, (wildcard) IPs, ports, protocols, users for each rule in a single and short line</p>
<p>Other than these you could chain all kinds of proxies for each allowed rule/connection. Which means as many proxy hops after Tor as you like. it is easy to eliminate DNS leaks and only resolve the hostname at the latest hop of the connection</p>
<p>You could redirect each allowed rule/connection to their own Tor socks port you specified, which could also be set to be randomly chosen from a list of ports you specify for each rule.</p>
<p>I guess you could have multiple Tor Browser or other application instances which could use at least one proxy hop in the end to avoid Cloudflare blocks or for different (anonymity) purposes</p>
<p>Also check: <a href="https://forums.whonix.org/t/applications-and-stream-isolation/2740/8">Applications and Stream Isolation</a></p>
<p>If you are interested I could share some of my simple configurations to literally own the control of all connections</p>
<p>I could imagine multiple 3proxy instances used for different purposes in both gateway and workstation by default and by use case. 3proxy has many more features which could replace and improve existing solutions in Whonix</p>
<p>But all the things above could be done with a single 3proxy instance listening on a single port which I guess should be run in workstation but I’m not sure, I didn’t try 3proxy in Whonix</p>
<p>If this could be done on Whonix, what about Qubes or Qubes-Whonix? Extreme access control or overkill?</p>
          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/9</link>
        <pubDate>Sun, 17 Jul 2016 12:59:14 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-9</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Interesting, there might be a way to do this.</p>
<p>Drop all incoming/outgoing traffic. Make an exception for a local-only subnet range say 192.168</p>
<p>Use MapAddress to assign private addresses in the whitelisted range to the Onion Services you want to permit.</p>
<p>Some steps that can help:</p>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="https://serverfault.com/questions/30026/whitelist-allowed-ips-in-out-using-iptables" target="_blank" rel="nofollow noopener">serverfault.com</a>
  </header>
  <article class="onebox-body">
      <a href="https://serverfault.com/users/10388/frank-bannister" target="_blank" rel="nofollow noopener">
    <img alt="Frank Bannister" src="https://www.gravatar.com/avatar/9209ea2a036a546d315da5600f0025b9?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="128" height="128">
  </a>
<h4>
  <a href="https://serverfault.com/questions/30026/whitelist-allowed-ips-in-out-using-iptables" target="_blank" rel="nofollow noopener">Whitelist allowed IPs (in/out) using iptables</a>
</h4>

<div class="tags">
  <strong>linux, iptables, blacklist</strong>
</div>

<div class="date">
  asked by
  
  <a href="https://serverfault.com/users/10388/frank-bannister" target="_blank" rel="nofollow noopener">
    Frank Bannister
  </a>
  on <a href="https://serverfault.com/questions/30026/whitelist-allowed-ips-in-out-using-iptables" target="_blank" rel="nofollow noopener">10:25PM - 22 Jun 09</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/8</link>
        <pubDate>Thu, 07 Jul 2016 15:18:34 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-8</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="4" data-topic="2707" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/j/e8c25b/40.png" class="avatar"> javiermarcon:</div>
<blockquote>
<p>Thanks, iptables can know the content of every packet if the rule uses the string match module, but string match acts on layer 7 so is very ineficient.</p>
</blockquote>
</aside>
<p>Very interesting! If you get this to work, please educate me.</p>
<p>Long time ago <a class="mention" href="http://forums.whonix.org/u/hulahoop">@HulaHoop</a> and me considered something related. Using iptables string match module to filter ControlPort commands. In short: we agreed and concluded that it is not feasible. References:</p>
<p></p><aside class="onebox githubissue">
  <header class="source">
      <a href="https://github.com/Whonix/Whonix/issues/347" target="_blank" rel="nofollow noopener">github.com/Whonix/Whonix</a>
  </header>
  <article class="onebox-body">
    <a href="https://github.com/adrelanos" rel="nofollow noopener">
<img src="https://avatars1.githubusercontent.com/u/1985040?v=2&amp;s=96" class="thumbnail onebox-avatar" width="96" height="96">
</a>

<h4><a href="https://github.com/Whonix/Whonix/issues/347" target="_blank" rel="nofollow noopener">Issue: hardening Tor using iptables - tor-talk posting proposal</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
	on <a href="https://github.com/Whonix/Whonix/issues/347" target="_blank" rel="nofollow noopener">2014-09-26</a>
	</div>
	<div class="user">
	closed by <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
	on <a href="https://github.com/Whonix/Whonix/issues/347" target="_blank" rel="nofollow noopener">2014-10-01</a>
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">Now that we have learned a few things in #344 and #345, maybe we could discuss hardening Tor using iptables?
I am...</pre>

<div class="labels">
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">enhancement</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">iptables</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">security</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">upstream</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<br>
<aside class="onebox githubissue">
  <header class="source">
      <a href="https://github.com/Whonix/Whonix/issues/344" target="_blank" rel="nofollow noopener">github.com/Whonix/Whonix</a>
  </header>
  <article class="onebox-body">
    <a href="https://github.com/HulaHoopWhonix" rel="nofollow noopener">
<img src="https://avatars1.githubusercontent.com/u/7875239?v=2&amp;s=96" class="thumbnail onebox-avatar" width="420" height="420">
</a>

<h4><a href="https://github.com/Whonix/Whonix/issues/344" target="_blank" rel="nofollow noopener">Issue: Robust ControlPort filter whitelist using IPTables itself</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="https://github.com/HulaHoopWhonix" target="_blank" rel="nofollow noopener">HulaHoopWhonix</a>
	on <a href="https://github.com/Whonix/Whonix/issues/344" target="_blank" rel="nofollow noopener">2014-09-26</a>
	</div>
	<div class="user">
	closed by <a href="https://github.com/HulaHoopWhonix" target="_blank" rel="nofollow noopener">HulaHoopWhonix</a>
	on <a href="https://github.com/Whonix/Whonix/issues/344" target="_blank" rel="nofollow noopener">2014-10-29</a>
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">I had this idea for quite a time but had to make sure its even possible before posting it. And fortunately...</pre>

<div class="labels">
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">enhancement</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">iptables</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">security</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<br>
<aside class="onebox githubissue">
  <header class="source">
      <a href="https://github.com/Whonix/Whonix/issues/361" target="_blank" rel="nofollow noopener">github.com/Whonix/Whonix</a>
  </header>
  <article class="onebox-body">
    <a href="https://github.com/HulaHoopWhonix" rel="nofollow noopener">
<img src="https://avatars1.githubusercontent.com/u/7875239?v=2&amp;s=96" class="thumbnail onebox-avatar" width="420" height="420">
</a>

<h4><a href="https://github.com/Whonix/Whonix/issues/361" target="_blank" rel="nofollow noopener">Issue: IPTables String Matching Character Blacklist</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="https://github.com/HulaHoopWhonix" target="_blank" rel="nofollow noopener">HulaHoopWhonix</a>
	on <a href="https://github.com/Whonix/Whonix/issues/361" target="_blank" rel="nofollow noopener">2014-10-30</a>
	</div>
	<div class="user">
	closed by <a href="https://github.com/HulaHoopWhonix" target="_blank" rel="nofollow noopener">HulaHoopWhonix</a>
	on <a href="https://github.com/Whonix/Whonix/issues/361" target="_blank" rel="nofollow noopener">2014-11-02</a>
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">Purpose is to blacklist dangerous non alphanumeric characters and block them from making their way into py-cpfp, as they could be...</pre>

<div class="labels">
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">enhancement</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">security</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<p></p>
          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/7</link>
        <pubDate>Wed, 06 Jul 2016 20:23:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-7</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>javier:</p>
<blockquote>
<p>Thanks, blacklist is the first step to know how to block addresses. Now I know I can write a script that makes all letter combinations (with MapAddress [letters].onion 127.0.0.1) without the ones I want to whitelist, but this will also be ineficient because of the huge file size.</p>
</blockquote>
<p>Yes that would be interesting. I wonder how much space that would take.<br>
And you might find some interesting bugs in Tor while trying to parse<br>
giant config files. My feelings tells me it will not be feasible using<br>
that way but if you try I would be delighted to learn about your results.</p>
          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/6</link>
        <pubDate>Wed, 06 Jul 2016 20:11:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-6</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[javiermarcon]]></dc:creator>
        <description><![CDATA[
            <p>Thanks, blacklist is the first step to know how to block addresses. Now I know I can write a script that makes all letter combinations (with MapAddress [letters].onion 127.0.0.1) without the ones I want to whitelist, but this will also be ineficient because of the huge file size.</p>
          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/5</link>
        <pubDate>Wed, 06 Jul 2016 19:50:33 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-5</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[javiermarcon]]></dc:creator>
        <description><![CDATA[
            <p>Thanks, iptables can know the content of every packet if the rule uses the string match module, but string match acts on layer 7 so is very ineficient.</p>
          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/4</link>
        <pubDate>Wed, 06 Jul 2016 19:41:23 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-4</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>This one is related. But is is a blacklist and you are asking for a whitelist.</p>
<p><a href="https://www.whonix.org/wiki/Tor#Blacklist_Certain_Hidden_Services_from_Connecting">https://www.whonix.org/wiki/Tor#Blacklist_Certain_Hidden_Services_from_Connecting</a></p>
          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/3</link>
        <pubDate>Wed, 06 Jul 2016 19:23:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-3</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>I don’t think this can be done at the iptables level, because it has no awareness of domains let alone onions.</p>
<p>This question also qualifies for being asked in a generic way elsewhere, i.e. in the Tor specific support channels. See:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Support" target="_blank" rel="nofollow noopener">Whonix</a>
  </header>
  <article class="onebox-body">
    <img src="https://www.whonix.org/w/images/9/98/Support-487515640.jpg" class="thumbnail onebox-avatar" width="500" height="500">

<h3><a href="https://www.whonix.org/wiki/Support" target="_blank" rel="nofollow noopener">Support</a></h3>

<p>Various Ways to get Help with Whonix. Free and Professional Support available.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/2</link>
        <pubDate>Wed, 06 Jul 2016 19:21:48 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-2</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
      <item>
        <title>Block all traffic except some hidden addresses</title>
        <dc:creator><![CDATA[javiermarcon]]></dc:creator>
        <description><![CDATA[
            <p>How can I modify the Whonix Firewall (or make iptables rules) to block all trafffic that doesn’t go to some specific .onion hidden services and sites? I have a file with .onion addresses of hidden services and web sites, and I want to allow only traffic to those listed .onion urls.</p>
<p>Thanks.</p>
          <p><a href="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707/1</link>
        <pubDate>Tue, 05 Jul 2016 22:27:51 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2707-1</guid>
        <source url="http://forums.whonix.org/t/block-all-traffic-except-some-hidden-addresses/2707.rss">Block all traffic except some hidden addresses</source>
      </item>
  </channel>
</rss>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Whonix Desktop Installer with Calamares - field report</title>
    <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350</link>
    <description>So after a few days playing with `Calamares` and my &quot;Whonix Desktop&quot; VM and ISO files, I thought it would be time to report back my experience.

See also 

https://forums.whonix.org/t/whonix-host-operating-system/3931

For the discussion related to the Whonix Host/Desktop project.


**In short, the results are quite encouraging.** 

What I did:

* I built a hardened debian 15 VM on debian buster (&quot;Whonix-Desktop VM&quot;;
* I run a few custom chroot bash scripts to customize the Whonix-Desktop VM, installed `virt-manager`,` lib-virt`, etc, copied the Gateway and Workstation VMs, installed non-free firmware and created an ISO file out of it (see link above for complete description)
* On top of that I installed the `Calamares` installer to try it out (in buster repos)

**After a few tests I have now a working ISO file that correctly installs the &quot;Whonix-Desktop&quot; on an external drive (also with encryption!) which is bootable and running, at least on qemu/kvm (didn&#39;t have the opportunity to test it on real hardware yet).**

So it&#39;s pretty amazing I would say, **but there are still a few shortcomings that need to be addressed.**

Here are the few things I learnt while experiencing with `Calamares`:

* I did  not have time to try a UEFI install on a GPT disk, only BIOS on MBR

* I found the documentation related to calamares quite sparse, but maybe because it is self explanatory to developers (the syntax is very clear)
* On Debian Buster, the default  `calamares` package does not provide configuration files for `modules` which must be written by hand, following examples that can be found on [github](https://github.com/calamares)
* Installing the `calamares-settings-debian` package provides all configuration files used by the debian-live team for their new Buster live images with Calamares installer ([link](https://jonathancarter.org/2019/04/13/help-test-debian-live/))
* Only after installing `calamares-settings-debian` was I able to have a completely bootable system, so I think it would be a good idea to depart from their experience and configuration files and modify them to our needs (for instance to change the branding)
* The way I understand it, the default installing sequence provided by `calamares-settings-debian` merely copies the content of the `filesystem.squashfs` file into the target and then executes the needed operations (creating new user, configuring fstab, bootloader, etc.), but does not install packages (it does remove the live-boot related packages though). A side-note: it also needs the `rsync` package otherwise the installer will fail.
* The advantage of this is obvious, as the system is created in a matter of minutes (no need to redownload and recreates everything). 
* The problem is that it also copies the already existing &#39;user&#39; and his home directory, and maybe other stuff that we don&#39;t need, very unclean
* Debian-live installer does not have this problem as its live-user is created at boot-time (its `filesystem.squashfs` file does not contain anything under its `/home` directory)
* It is my understanding that they achieve this behavior by building their iso using the ` live-build` tools which are capable of creating complete debian live-systems and have options that enable to run a lot of stuff at boot-time only (and thus these specific configurations are not copied into the target by the installer)
* Not sure if we can use ` live-build` to create a hardened Whonix ISO from scratch without having to entirely rewrite the VM build process. Lot of work.
* I did find a workaround by installing the ` live-config` package, which enables to append parameters at boot time (or apply them by default) that can reprouce the behavior of debian live-systems. I think it works by reading script files in `/lib/live/config` which are basically a series of test (such as if no user, then launch the live system with default debian user, etc.)
* The workaround I used was &quot;simply&quot; to copy the user .config files into `/etc/skel` on the Whonix-Desktop vm and then `userdel user`. Now the ISO automatically launches an X session with a user `user` (full name: `Debian Live User`) that it creates at boot time (note: I also had to suppress the vboxsf group as it 1000 GUID somehow seemed to conflict with the live-config scripts, preventing them to create the live-user)

* The encryption does not seem to use LVM (is it a problem?)

While it&#39;s quite encouraging and definitely a proof of work, it is still quite experimental, and a lot of configuration work remains to be done, such as:

* Better understand the calamares installer sequence (taking the calamares-settings-debian as a base) in order to configure it exactly to our needs
* Make sure we don&#39;t copy anything unwanted into the target, make sure the new user&#39;s environment on the install target behaves exactly as it is supposed to (also correct groups, etc.)
* Fine-tune the overall ISO environment so it behaves exactly as we need (does the live-user needs sudo rights? Are the settings specific to the hardened debian version environment also applied in live-mode?)

@Patrick et al. what do you think of this? Are you still interested in pursuing this matter further? If yes, what would be the next steps, how could I help further?

Below some screenshots taken from the Whonix-Host Hardened Debian ISO installing itself on an external virtual hard drive (all done in qemu/kvm):

![Screenshot%20from%202019-05-09%2016-56-16|630x500](upload://cbq6D98dbavOiuTccQoMr0VnoiQ.png) 
*boot screen with isolinux (BIOS mode)*

![Screenshot%20from%202019-05-09%2017-01-22|690x426](upload://nj0OKXkmDgMXFWJaaUhFDHiqtJC.png) 
*Calamares installer (default debian 10 branding, I did not try to change anything yet)*

![Screenshot%20from%202019-05-09%2017-01-51|690x425](upload://2nCg27IvQYgW7ZpxfwvxMzViffN.png) 

![Screenshot%20from%202019-05-09%2017-02-27|690x424](upload://6LQ3QDWsymBO3HWMXyFQ07yv6rU.png) 

![Screenshot%20from%202019-05-09%2017-03-05|690x426](upload://mkj9wDW4LZ815rggEaDunAnTi20.png) 

![Screenshot_2019-05-09_17-09-01|690x425](upload://jlgl1ekdXebJed3XYDebKSQnaip.png) 

![Screenshot_2019-05-09_17-11-18|690x304](upload://abCRr2L9rs3DqVuJxsdQBWXL3mr.png) 
*rebooting into the installed system*

![Screenshot_2019-05-09_17-15-19|690x426](upload://luhAvfuBhqWPyaDRBEOcjJdhzjw.png) 
*The newly created user does not belong to the libvirt-qemu and kvm groups, there is an option to configure that in `/etc/calamares/modules/users.conf` I don&#39;t remember if I modified this file accordingly or not... In any case, it is one of the settings that must be addressed*</description>
    <language>en</language>
    <lastBuildDate>Mon, 04 Nov 2019 16:40:30 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>No worries. Yes, please move this forward. Looks like halfway done. Whonix still very much alive and kicking. Kept on merging lots of unrelated (security) enhancements lately. Let me know how things are going.</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/200">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/200</link>
        <pubDate>Mon, 04 Nov 2019 16:40:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-200</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <p>Sorry for my long absence, I was very busy lately. I hope that I will have more time in the coming days/weeks to pursue this matter. Hopefully we can have something ready before the end of the year…<br>
Any help is welcome if someone has some time to spare <img src="//forums.whonix.org/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"><br>
I’ll do a new build from scratch and see what remains to be done, as it’s been so long since I did the last one…<br>
Cheers</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/199">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/199</link>
        <pubDate>Tue, 29 Oct 2019 15:52:19 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-199</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Calamares in Debian integration progress and the way forward in Bullseye:</p>
<p><a href="https://jonathancarter.org/2019/10/17/calamares-plans-for-debian-11/" class="onebox" target="_blank" rel="nofollow noopener">https://jonathancarter.org/2019/10/17/calamares-plans-for-debian-11/</a></p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/198">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/198</link>
        <pubDate>Thu, 17 Oct 2019 17:31:36 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-198</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Note: <a href="https://www.whonix.org/w/index.php?title=Dev%2FBuild_Documentation%2F15_full&amp;type=revision&amp;diff=51000&amp;oldid=50915" rel="nofollow noopener">https://www.whonix.org/w/index.php?title=Dev%2FBuild_Documentation%2F15_full&amp;type=revision&amp;diff=51000&amp;oldid=50915</a></p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/197">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/197</link>
        <pubDate>Thu, 12 Sep 2019 13:29:56 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-197</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="194" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"> onion_knight:</div>
<blockquote>
<p>As of now, no user can <code>sudo</code> , <code>sudo su</code> or <code>su</code> - it never works.</p>
</blockquote>
</aside>
<p>This is working in Non-Qubes-Whonix VMs in <code>15.0.0.4.8</code> (broken tb-starter).<br>
(<code>15.0.0.4.9</code> with fixed tb-starter will be tested soon.)</p>
<p>Since Whonix Host builds are skipping creation of user <code>user</code><br>
i.e. skipping part of <a href="https://github.com/Whonix/anon-base-files/blob/master/debian/anon-base-files.postinst" rel="nofollow noopener">https://github.com/Whonix/anon-base-files/blob/master/debian/anon-base-files.postinst</a><br>
also the following code is skipped</p>
<pre><code>        ## setting password to changeme
        ##
        ## How this password was created:
        ## sudo apt-get install whois
        ## mkpasswd
        ## changeme
        ## Resulted in: aTayYxVyw5kDo
        password="aTayYxVyw5kDo"

           ## Use --encrypted to be able to use a static, precalculated hash for reproducible builds.
           echo "${user_to_be_created}:${password}" | chpasswd --encrypted

           ## old:
           #usermod --append --groups cdrom,audio,dip,sudo,plugdev "$user_to_be_created"
           ##
           ## Prefer addgroup over usermod.
           addgroup "$user_to_be_created" cdrom
           addgroup "$user_to_be_created" audio
           addgroup "$user_to_be_created" dip
           addgroup "$user_to_be_created" sudo
           addgroup "$user_to_be_created" plugdev
</code></pre>
<p>Most importantly skipped:</p>
<pre><code>addgroup "$user_to_be_created" sudo
</code></pre>
<p>Whonix-Host build: To make <code>sudo</code> , <code>sudo su</code> work during ISO Live Boot, at some point these addgroup commands need to be run or some calamares config.</p>
<p>(Optional, not needed, user documentation:) To be able to run <code>su</code> from user <code>user</code> , it is necessary to, see:<br>
<a href="https://www.whonix.org/wiki/Root#Substitute_User_.28su.29_Command" rel="nofollow noopener">https://www.whonix.org/wiki/Root#Substitute_User_.28su.29_Command</a></p>
<aside class="quote no-group" data-post="194" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"> onion_knight:</div>
<blockquote>
<p>The script <a href="https://github.com/Whonix/whonix-libvirt/commit/bb7773e62850fdc76b794500e6bb0c282a55bb2b#diff-6b101485a43d94fa79b3a5dd77a21093" rel="nofollow noopener">usr/lib/whonix-libvirt/live-mode-to-read-only</a> works when ran manually. It seems to fail during build.</p>
</blockquote>
</aside>
<p>Please post output here if you see it failing. Probably/hopefully fixable.</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/196">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/196</link>
        <pubDate>Mon, 02 Sep 2019 13:22:18 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-196</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="193" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>“Show Desktop” button is already implemented, see <a href="https://github.com/Whonix/whonix-xfce-desktop-config/blob/master/etc/skel/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-panel.xml#L44" rel="nofollow noopener">https://github.com/Whonix/whonix-xfce-desktop-config/blob/master/etc/skel/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-panel.xml#L44</a><br>
Works for me in Whonix XFCE VMs in <code>15.0.0.4.8</code> .</p>
</blockquote>
</aside>
<p>You are right, my mistake, I didn’t see it <img src="//forums.whonix.org/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/195">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/195</link>
        <pubDate>Mon, 02 Sep 2019 09:57:52 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-195</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="192" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Kicksecure and Whonix Host are independent projects.</p>
<p>Well, Whonix Host and Whonix VMs are based on Kicksecure, but that’s about it.</p>
</blockquote>
</aside>
<p>OK</p>
<aside class="quote no-group quote-modified" data-post="192" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<blockquote>
<p>Shouldn’t we be installing Kicksecure on the install target instead of generic “Whonix-Host”?</p>
</blockquote>
<p>Therefore, no.</p>
</blockquote>
</aside>
<p>OK</p>
<aside class="quote no-group" data-post="192" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>But why root login? Why not login as user and <code>sudo su</code> ? What advantage does root login on virtual console give?</p>
</blockquote>
</aside>
<p>During Calamares install, the user is given the choice of having the same password for administrator user (root) and his newly created user.</p>
<p>My understanding is that when choosing same password, the newly created user is added to sudo group, if not, then he doesn’t have sudo rights. I need to verify this however.</p>
<p>As of now, no user can <code>sudo</code>, <code>sudo su</code> or <code>su</code> - it never works.</p>
<aside class="quote no-group" data-post="192" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>This could be done during the boot process. Another systemd unit file. Similar to that commit <a href="https://github.com/Whonix/whonix-libvirt/commit/bb7773e62850fdc76b794500e6bb0c282a55bb2b" rel="nofollow noopener">https://github.com/Whonix/whonix-libvirt/commit/bb7773e62850fdc76b794500e6bb0c282a55bb2b</a></p>
<p>Using <code>ConditionKernelCommandLine=!boot=live</code> - i.e. do not do that in when kernel boot parameter includes <code>boot=live</code> .</p>
<p>Or we drop ConditionKernelCommandLine from the systemd unit file and let the script handle chmod change depending on</p>
<pre><code class="lang-auto">if grep -qs "boot=live" /proc/cmdline; then
   ## live mode
   true "do things for live mode"
else
   ## persistent mode
   true "do things for persistent mode"
fi
</code></pre>
<p>I can implement that if you like.</p>
</blockquote>
</aside>
<p>That could be great but I’m afraid that changing the permissions in life-mode will result in copying the entire files into RAM (we had this problem before if I remember correctly) before the permission change can be performed. Worth a try.</p>
<aside class="quote no-group" data-post="192" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Settings disks to read-only when booted in live mode (i.e. <code>ConditionKernelCommandLine=|boot=live</code> ) is actually implemented as per <a href="https://phabricator.whonix.org/T914#18825" rel="nofollow noopener">https://phabricator.whonix.org/T914#18825</a><br>
It might not work though. To debug also see that ticket. Also perhaps run manually to see what the script does not or does wrong.</p>
<p>sudo /<a href="https://github.com/Whonix/whonix-libvirt/commit/bb7773e62850fdc76b794500e6bb0c282a55bb2b#diff-6b101485a43d94fa79b3a5dd77a21093" rel="nofollow noopener">usr/lib/whonix-libvirt/live-mode-to-read-only</a></p>
</blockquote>
</aside>
<p>The script <a href="https://github.com/Whonix/whonix-libvirt/commit/bb7773e62850fdc76b794500e6bb0c282a55bb2b#diff-6b101485a43d94fa79b3a5dd77a21093" rel="nofollow noopener">usr/lib/whonix-libvirt/live-mode-to-read-only</a> works when ran manually. It seems to fail during build.</p>
<aside class="quote no-group" data-post="192" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Not passwordless sudo since that circumvnets the security enhancements made through <a href="https://forums.whonix.org/t/restrict-root-access/7658">Restrict root access</a> / <a href="https://www.whonix.org/wiki/Root" rel="nofollow noopener">https://www.whonix.org/wiki/Root</a>.</p>
</blockquote>
</aside>
<p>This is easily solved by adding a boot parameter, but then we must address the fact that Calamares needs root rights to run (polkit?).</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/194">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/194</link>
        <pubDate>Mon, 02 Sep 2019 09:52:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-194</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="191" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"> onion_knight:</div>
<blockquote>
<p><strong>Small suggestion: add the “Show Desktop” button on the XFCE4-panel</strong> (minimize all windows immediately, very practical when you are overwhelmed with stuff, exists on Windows since ages). It is already installed, just needs to be added in the XFCE4-panel config file.</p>
</blockquote>
</aside>
<p>“Show Desktop” button is already implemented, see <a href="https://github.com/Whonix/whonix-xfce-desktop-config/blob/master/etc/skel/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-panel.xml#L44" rel="nofollow noopener">https://github.com/Whonix/whonix-xfce-desktop-config/blob/master/etc/skel/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-panel.xml#L44</a><br>
Works for me in Whonix XFCE VMs in <code>15.0.0.4.8</code>.</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/193">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/193</link>
        <pubDate>Sat, 31 Aug 2019 13:52:20 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-193</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="191" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"> onion_knight:</div>
<blockquote>
<p>Problem: shouldn’t we need a complete new branding now that Whonix-Host has been officially relabeled “Kicksecure”?</p>
</blockquote>
</aside>
<p>Kicksecure and Whonix Host are independent projects.</p>
<p>Well, Whonix Host and Whonix VMs are based on Kicksecure, but that’s about it.</p>
<p>Kicksecure doesn’t focus on Tor / Whonix integration at all. It might come with Tor installed by default for secure network time synchronization, i.e. sdwdate. The ultimate goal is to move Kicksecure on its own domain name. This may or may never happen due to lack of resources. Depends on how much traction the project will get.</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Kicksecure" target="_blank" rel="nofollow noopener">Whonix</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:103/68;"><img src="https://www.whonix.org/w/images/5/52/Hardening-13423213.jpg" class="thumbnail"></div>

<h3><a href="https://www.whonix.org/wiki/Kicksecure" target="_blank" rel="nofollow noopener">Kicksecure</a></h3>

<p>Kicksecure ™ is a security-hardened Debian based Linux distribution that provides better protection from virus infections.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-post="191" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"> onion_knight:</div>
<blockquote>
<p>Shouldn’t we be installing Kicksecure on the install target instead of generic “Whonix-Host”?</p>
</blockquote>
</aside>
<p>Therefore, no.</p>
<aside class="quote no-group" data-post="191" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"> onion_knight:</div>
<blockquote>
<p>the installed system has no virtual console root access. Very unpractical, especially for a host system. Maybe consider reverting back this recent change for the Whonix-Host version? (see also Restrict root access) -&gt; <strong>still to be discussed and decided</strong></p>
</blockquote>
</aside>
<p>I think no - because then the user needs to have two different passwords.</p>
<p>sudo/root is now nicely sorted and documented here:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Root" target="_blank" rel="nofollow noopener">Whonix</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:103/154;"><img src="https://www.whonix.org/w/images/e/e2/Root123123.jpg" class="thumbnail"></div>

<h3><a href="https://www.whonix.org/wiki/Root" target="_blank" rel="nofollow noopener">Root</a></h3>

<p>Tips on using sudo / root (privileged) commands safely</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>root login can be enabled by the user as per:<br>
<a href="https://www.whonix.org/wiki/Root#Root_Login" rel="nofollow noopener">https://www.whonix.org/wiki/Root#Root_Login</a></p>
<p>But why root login? Why not login as user and <code>sudo su</code>? What advantage does root login on virtual console give?</p>
<aside class="quote no-group" data-post="191" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"> onion_knight:</div>
<blockquote>
<p>By default, the VMs do not start because the virtual disks are not set to readonly in virt-manager -&gt; <strong>still in discussion</strong> (<a href="https://phabricator.whonix.org/T914" rel="nofollow noopener">https://phabricator.whonix.org/T914</a>)</p>
</blockquote>
</aside>
<p>Settings disks to read-only when booted in live mode (i.e. <code>ConditionKernelCommandLine=|boot=live</code>) is actually implemented as per <a href="https://phabricator.whonix.org/T914#18825" rel="nofollow noopener">https://phabricator.whonix.org/T914#18825</a><br>
It might not work though. To debug also see that ticket. Also perhaps run manually to see what the script does not or does wrong.</p>
<p>sudo /<a href="https://github.com/Whonix/whonix-libvirt/commit/bb7773e62850fdc76b794500e6bb0c282a55bb2b#diff-6b101485a43d94fa79b3a5dd77a21093" rel="nofollow noopener">usr/lib/whonix-libvirt/live-mode-to-read-only</a></p>
<aside class="quote no-group" data-post="191" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"> onion_knight:</div>
<blockquote>
<p><strong>BUT</strong> on the install target change .qcow2 files permissions from 0444 to 0644 during the install process</p>
</blockquote>
</aside>
<p>This could be done during the boot process. Another systemd unit file. Similar to that commit <a href="https://github.com/Whonix/whonix-libvirt/commit/bb7773e62850fdc76b794500e6bb0c282a55bb2b" rel="nofollow noopener">https://github.com/Whonix/whonix-libvirt/commit/bb7773e62850fdc76b794500e6bb0c282a55bb2b</a></p>
<p>Using <code>ConditionKernelCommandLine=!boot=live</code> - i.e. do not do that in when kernel boot parameter includes <code>boot=live</code>.</p>
<p>Or we drop ConditionKernelCommandLine from the systemd unit file and let the script handle chmod change depending on</p>
<pre><code class="lang-auto">if grep -qs "boot=live" /proc/cmdline; then
   ## live mode
   true "do things for live mode"
else
   ## persistent mode
   true "do things for persistent mode"
fi
</code></pre>
<p>I can implement that if you like.</p>
<p>But are you sure chmod permissions from 0444 to 0644 is really useful? Once <a href="https://phabricator.whonix.org/T914#18825" rel="nofollow noopener">https://phabricator.whonix.org/T914#18825</a> is fully working, is that still required?</p>
<aside class="quote no-group" data-post="191" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"> onion_knight:</div>
<blockquote>
<p>Currently the live system in ISO mode provides a live-user account with passwordless sudo rights -&gt; can be fixed by adding <code>live-config.noroot</code> to live ISO boot parameters (but then we need to change calamares polkit to allow its execution by sudoless user) -&gt; <strong>still to be discussed and decided</strong></p>
</blockquote>
</aside>
<p>Not passwordless sudo since that circumvnets the security enhancements made through <a href="https://forums.whonix.org/t/restrict-root-access/7658" class="inline-onebox">Restrict root access</a> / <a href="https://www.whonix.org/wiki/Root" rel="nofollow noopener">https://www.whonix.org/wiki/Root</a>.</p>
<aside class="quote no-group" data-post="191" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"> onion_knight:</div>
<blockquote>
<p><strong>Small suggestion: add the “Show Desktop” button on the XFCE4-panel</strong> (minimize all windows immediately, very practical when you are overwhelmed with stuff, exists on Windows since ages). It is already installed, just needs to be added in the XFCE4-panel config file.</p>
</blockquote>
</aside>
<p>Yes, why not.</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/192">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/192</link>
        <pubDate>Fri, 30 Aug 2019 12:50:53 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-192</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <p><strong>Whonix-Host (Kicksecure) Testing Report, v. 15.0.0.4.7</strong></p>
<p>All tests done in KVM until now, not yet on hardware.</p>
<p>Addressing first the last list of bugs as per <a href="https://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/119" class="inline-onebox">Whonix Desktop Installer with Calamares - field report</a> (skipping issues already reported as fixed)</p>
<p><strong>1. Virtual Machine Manager/KVM</strong></p>
<ul>
<li>New issue with virt-manager (both on ISO and install target): Error connecting to graphical console: Error opening Spice console, SpiceClientGTK missing -&gt; <strong>FIXED</strong> by adding package gir1.2-spiceclientgtk-3.0 and needed dependencies</li>
</ul>
<p><strong>2. Calamares Installer</strong></p>
<ul>
<li>
<p>Needs correct branding -&gt; <strong>still to be done</strong> (see also: <a href="https://forums.whonix.org/t/whonix-host-calamares-branding-suggestion/7772/3" class="inline-onebox">Whonix Host Calamares Branding Suggestion</a>)<br>
<strong>Problem: shouldn’t we need a complete new branding now that Whonix-Host has been officially relabeled “Kicksecure”?</strong> Shouldn’t we be installing Kicksecure on the install target instead of generic “Whonix-Host”? Any existing suggestions for graphical design?</p>
</li>
<li>
<p>Does it work in EFI mode? <strong>Still failing in KVM</strong>, maybe related to virtualization, will try on real hardware.</p>
</li>
</ul>
<p><strong>3. Whonix-Host install on HDD</strong></p>
<ul>
<li>
<p>at least one of the kernel hardening boot parameters somehow messes with the CPU detection on the host -&gt; <strong>needs testing on real hardware, see if it still an issue</strong></p>
</li>
<li>
<p>the installed system has no virtual console root access. Very unpractical, especially for a host system. Maybe consider reverting back this recent change for the Whonix-Host version? (see also Restrict root access) -&gt; <strong>still to be discussed and decided</strong></p>
</li>
</ul>
<p><strong>4. Miscellaneous</strong></p>
<ul>
<li>
<p>power-manager plugin + pulseaudio plugin -&gt; <strong>FIXED</strong> (and audio working, at least in KVM)</p>
</li>
<li>
<p>The Whonix Host should be graphically differentiated from the Whonix-VMs. Maybe simply a different background image/color? -&gt; <strong>still to be done</strong></p>
</li>
<li>
<p>Somehow a user user was created during the build … <strong>FIXED</strong></p>
</li>
<li>
<p>By default, the VMs do not start because the virtual disks are not set to readonly in virt-manager -&gt; <strong>still in discussion</strong> (<a href="https://phabricator.whonix.org/T914" rel="nofollow noopener">https://phabricator.whonix.org/T914</a>)<br>
As of now: Whonix-Gateway/Workstation virtualization using ISO file only works, but disks must be manually set to read-only in virt-manager AND booted in live-mode (expected behavior, but may be overwhelming/unpractical for end-user, at least needs documentation).<br>
Same problem on the install target.<br>
<strong>Desired behavior:</strong> when booting in live-mode, set the disks to read-only (in their xml files, as their file permissions are already 0444). <strong>BUT</strong> on the install target change .qcow2 files permissions from  0444 to 0644 during the install process (0444 only needed for live ISO. Probably achievable using some Calamares tweaks/scripting to change the permissions when they are copied over. Needs some researches).</p>
</li>
<li>
<p>Currently the live system in ISO mode provides a live-user account with passwordless sudo rights -&gt; can be fixed by adding<code>live-config.noroot</code> to live ISO boot parameters (but then we need to change calamares polkit to allow its execution by sudoless user) -&gt; <strong>still to be discussed and decided</strong></p>
</li>
</ul>
<p><strong>No more new bugs to report as of now. <img src="//forums.whonix.org/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></strong></p>
<p><strong>Small suggestion: add the “Show Desktop” button on the XFCE4-panel</strong> (minimize all windows immediately, very practical when you are overwhelmed with stuff, exists on Windows since ages). It is already installed, just needs to be added in the XFCE4-panel config file.</p>
<p>I will test on real hardware and see how it behaves.</p>
<p><strong>Overall, good progress!</strong></p>
<p><strong>Some screenshots below</strong></p>
<p></p><div class="lightbox-wrapper"><a class="lightbox" href="//forums.whonix.org/uploads/default/original/2X/b/bb1a4520506e3b962097263421a89835437b4537.png" data-download-href="//forums.whonix.org/uploads/default/bb1a4520506e3b962097263421a89835437b4537" title="18.png"><img src="//forums.whonix.org/uploads/default/optimized/2X/b/bb1a4520506e3b962097263421a89835437b4537_2_671x500.png" alt="18" data-base62-sha1="qHbzm0wdixqO50StoeUnsUjHAub" width="671" height="500" srcset="//forums.whonix.org/uploads/default/optimized/2X/b/bb1a4520506e3b962097263421a89835437b4537_2_671x500.png, //forums.whonix.org/uploads/default/optimized/2X/b/bb1a4520506e3b962097263421a89835437b4537_2_1006x750.png 1.5x, //forums.whonix.org/uploads/default/original/2X/b/bb1a4520506e3b962097263421a89835437b4537.png 2x" data-small-upload="//forums.whonix.org/uploads/default/optimized/2X/b/bb1a4520506e3b962097263421a89835437b4537_2_10x10.png"></a></div><br>
<em>Whonix-Host (Kicksecure) 15.0.0.4.7 booting from the live ISO file in KVM , showing a work session with both Whonix-Gateway and Whonix-Workstation running in live-mode ((nested virtualzation,Tor tab is within the Workstation) and the host system monitor. As expected, a solid amount of RAM is needed (already 5.6 GiB consumed)</em><p></p>
<p></p><div class="lightbox-wrapper"><a class="lightbox" href="//forums.whonix.org/uploads/default/original/2X/7/7cead66522a81a9181dc7bfa9e4b4b9e88b99c59.png" data-download-href="//forums.whonix.org/uploads/default/7cead66522a81a9181dc7bfa9e4b4b9e88b99c59" title="21.png"><img src="//forums.whonix.org/uploads/default/original/2X/7/7cead66522a81a9181dc7bfa9e4b4b9e88b99c59.png" alt="21" data-base62-sha1="hP4lhIcTXAVwjUS3kuQB5kmdp33" width="690" height="495" data-small-upload="//forums.whonix.org/uploads/default/optimized/2X/7/7cead66522a81a9181dc7bfa9e4b4b9e88b99c59_2_10x10.png"></a></div><br>
<em>Whonix-Host (Kicksecure) 15.0.0.4.7 grub menu on the install target (KVM), providing both persistent and live-mode options. Both work.</em><p></p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/191">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/191</link>
        <pubDate>Fri, 30 Aug 2019 12:17:03 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-191</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Sounds really good!</p>
<p>Pretty sure grub2 supports both BIOS booting from ISO (or anywhere) as well as EFI booting.</p>
<p>This is the package which is for BIOS booting (source: grub2): <a href="https://packages.debian.org/search?keywords=grub-pc" rel="nofollow noopener">https://packages.debian.org/search?keywords=grub-pc</a></p>
<p>This is the package which is for EFI booting (source: grub2):<br>
<a href="https://packages.debian.org/search?keywords=grub-efi" class="onebox" target="_blank" rel="nofollow noopener">https://packages.debian.org/search?keywords=grub-efi</a></p>
<p><a href="https://packages.debian.org/buster/grub-rescue-pc" rel="nofollow noopener">https://packages.debian.org/buster/grub-rescue-pc</a> (source: grub2) has:</p>
<ul>
<li>grub-rescue-floppy.img: floppy image.</li>
<li>grub-rescue-cdrom.iso: El Torito CDROM image.</li>
<li>grub-rescue-usb.img: USB image.</li>
</ul>
<p>There is also:</p>
<p><a href="https://www.supergrubdisk.org/" class="onebox" target="_blank" rel="nofollow noopener">https://www.supergrubdisk.org/</a></p>
<p>I don’t yet relationship between isolinux, syslinux and grub2.</p>
<p>Not sure too. And low priority. Could be changed anytime later.</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/190">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/190</link>
        <pubDate>Fri, 30 Aug 2019 11:49:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-190</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="187" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Yes, sure.</p>
<p>As soon as I know the name of these packages, these can be - depending on the package either added to documentation and/or be added here <a href="https://github.com/Whonix/Whonix/blob/master/build-steps.d/1120_prepare-build-machine" rel="nofollow noopener">https://github.com/Whonix/Whonix/blob/master/build-steps.d/1120_prepare-build-machine</a> for automatic installation during build.</p>
</blockquote>
</aside>
<p>Ok, I’ll try to update the list later. Nothing urgent.</p>
<aside class="quote no-group" data-post="187" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>package <a href="https://packages.debian.org/buster/syslinux" rel="nofollow noopener">https://packages.debian.org/buster/syslinux</a><br>
contains /usr/lib/SYSLINUX/ (all upper case)<br>
<a href="https://packages.debian.org/buster/amd64/syslinux/filelist" rel="nofollow noopener">https://packages.debian.org/buster/amd64/syslinux/filelist</a></p>
<p>Would you like to add it here</p>
</blockquote>
</aside>
<p>Yes.</p>
<aside class="quote no-group" data-post="187" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Btw why isolinux / syslinux?</p>
</blockquote>
</aside>
<p>Used for legacy bios boot. Not sure why isolinux instead of grub2… Grub2 is used for EFI bios. This is why we have both in the ISO file. If you boot the ISO in EFI mode, it automatically loads the grub loader. See screenshots below (KVM virtualization, not real hardware):<br>
</p><div class="lightbox-wrapper"><a class="lightbox" href="//forums.whonix.org/uploads/default/original/2X/d/d95d833ffb819ba06d2942ff512b05e31bae777c.png" data-download-href="//forums.whonix.org/uploads/default/d95d833ffb819ba06d2942ff512b05e31bae777c" title="19.png"><img src="//forums.whonix.org/uploads/default/original/2X/d/d95d833ffb819ba06d2942ff512b05e31bae777c.png" alt="19" data-base62-sha1="v0TXAw2jAPHaRg500pZf8BgQzE0" width="690" height="449" data-small-upload="//forums.whonix.org/uploads/default/optimized/2X/d/d95d833ffb819ba06d2942ff512b05e31bae777c_2_10x10.png"></a></div><br>
<div class="lightbox-wrapper"><a class="lightbox" href="//forums.whonix.org/uploads/default/original/2X/8/8662b363e5dc7639e9482efb2b3a12cf510fa204.png" data-download-href="//forums.whonix.org/uploads/default/8662b363e5dc7639e9482efb2b3a12cf510fa204" title="20.png"><img src="//forums.whonix.org/uploads/default/optimized/2X/8/8662b363e5dc7639e9482efb2b3a12cf510fa204_2_664x500.png" alt="20" data-base62-sha1="jaPrFZgRjAcdmPPx3zPYJ2Wk580" width="664" height="500" srcset="//forums.whonix.org/uploads/default/optimized/2X/8/8662b363e5dc7639e9482efb2b3a12cf510fa204_2_664x500.png, //forums.whonix.org/uploads/default/optimized/2X/8/8662b363e5dc7639e9482efb2b3a12cf510fa204_2_996x750.png 1.5x, //forums.whonix.org/uploads/default/original/2X/8/8662b363e5dc7639e9482efb2b3a12cf510fa204.png 2x" data-small-upload="//forums.whonix.org/uploads/default/optimized/2X/8/8662b363e5dc7639e9482efb2b3a12cf510fa204_2_10x10.png"></a></div><p></p>
<p>Maybe grub could be used for both ISO legacy and EFI boots? Maybe worth investigating, maybe not. Not sure of the implications/complexity involved.</p>
<aside class="quote no-group" data-post="187" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Maybe it doesn’t really matter since if we wanted to be compatible with Secure Boot (on the host) we might be able to combine shim-signed with isolinux/syslinux too?</p>
</blockquote>
</aside>
<p>Don’t know yet.</p>
<p>More to come later on testing 15.0.0.4.7 ISO!</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/189">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/189</link>
        <pubDate>Fri, 30 Aug 2019 10:02:09 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-189</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>This has a small chance of a regression in next build (<code>15.0.0.4.9-developers-only</code> and above but that tag is yet to be created).</p>
<aside class="quote" data-post="1" data-topic="7977">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="https://forums.whonix.org/t/port-from-useradd-groupadd-and-usermod-to-adduser-and-addgroup/7977">port from useradd, groupadd and usermod to adduser and addgroup</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/development"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    adduser and addgroup

Quoted from Debian adduser manpage: 

They are friendlier front ends to the low level tools like useradd, groupadd and usermod programs, by default choosing Debian policy conformant UID and GID values, creating a home directory with skeletal configuration, running a custom script, and other features.
  </blockquote>
</aside>

          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/188">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/188</link>
        <pubDate>Fri, 30 Aug 2019 08:36:11 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-188</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="186" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"> onion_knight:</div>
<blockquote>
<p>First remark: there are a bunch of packages that are needed in order to build Whonix that are not listed in the building documentation and that I had to add manually. Maybe worth updating the documentation?</p>
</blockquote>
</aside>
<p>Yes, sure.</p>
<p>As soon as I know the name of these packages, these can be - depending on the package either added to documentation and/or be added here <a href="https://github.com/Whonix/Whonix/blob/master/build-steps.d/1120_prepare-build-machine" rel="nofollow noopener">https://github.com/Whonix/Whonix/blob/master/build-steps.d/1120_prepare-build-machine</a> for automatic installation during build.</p>
<aside class="quote no-group" data-post="186" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"> onion_knight:</div>
<blockquote>
<p><strong>The good news: the build finally succeeded</strong></p>
</blockquote>
</aside>
<p>Yay! <img src="//forums.whonix.org/images/emoji/twitter/partying_face.png?v=9" title=":partying_face:" class="emoji" alt=":partying_face:"></p>
<aside class="quote no-group" data-post="186" data-topic="7350">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/o/f6c823/40.png" class="avatar"> onion_knight:</div>
<blockquote>
<p>As far as I understand the real cause is that I had no directory <code>/usr/lib/syslinux</code> on the building host,</p>
</blockquote>
</aside>
<p><a href="https://github.com/Whonix/Whonix/blob/master/build-steps.d/1120_prepare-build-machine#L236" rel="nofollow noopener">https://github.com/Whonix/Whonix/blob/master/build-steps.d/1120_prepare-build-machine#L236</a></p>
<p>package <a href="https://packages.debian.org/buster/syslinux" rel="nofollow noopener">https://packages.debian.org/buster/syslinux</a><br>
contains /usr/lib/SYSLINUX/ (all upper case)<br>
<a href="https://packages.debian.org/buster/amd64/syslinux/filelist" rel="nofollow noopener">https://packages.debian.org/buster/amd64/syslinux/filelist</a></p>
<p>Would you like to add it here</p>
<aside class="onebox githubblob">
  <header class="source">
      <a href="https://github.com/Whonix/Whonix/blob/master/build-steps.d/1120_prepare-build-machine#L236" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="https://github.com/Whonix/Whonix/blob/master/build-steps.d/1120_prepare-build-machine#L236" target="_blank" rel="nofollow noopener">Whonix/Whonix/blob/master/build-steps.d/1120_prepare-build-machine#L236</a></h4>
<pre class="onebox"><code class="lang-d/1120_prepare-build-machine"><ol class="start lines" start="226" style="counter-reset: li-counter 225 ;">
<li>      packages_to_be_installed+=" virtualbox-source "</li>
<li>      ## The cli package which provides 'VBoxManage'.</li>
<li>      packages_to_be_installed+=" virtualbox "</li>
<li>      ## The gui package which provides 'virtualbox'.</li>
<li>      ## Not required for build but makes sense to have installed for everyone who wants to run their own builds.</li>
<li>      packages_to_be_installed+=" virtualbox-qt "</li>
<li>   fi</li>
<li>
</li>
<li>fi</li>
<li>
</li>
<li class="selected">if [ "$WHONIX_BUILD_ISO" = "true" ]; then</li>
<li>   ## xorriso</li>
<li>   packages_to_be_installed+=" xorriso "</li>
<li>   ## mksquashfs</li>
<li>   packages_to_be_installed+=" squashfs-tools "</li>
<li>   ## grub-mkimage</li>
<li>   packages_to_be_installed+=" grub-common "</li>
<li>   ## /usr/lib/ISOLINUX/isolinux.bin</li>
<li>   packages_to_be_installed+=" isolinux "</li>
<li>   ## /boot/memtest86+.bin</li>
<li>   packages_to_be_installed+=" memtest86+ "</li>
</ol></code></pre>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>or I could add it there too.</p>
<p>Btw why isolinux / syslinux?</p>
<p>Low priority: worth switching to grub2? Would you know how to do that?</p>
<p>Would grub2 be better for UEFI support?</p>
<p>And would grub2 be better for Secure Boot support?<br>
(<a href="https://forums.whonix.org/t/enable-linux-kernel-gpg-verification-in-grub-and-or-enable-secure-boot-by-default/7894" class="inline-onebox">enable Linux kernel gpg verification in grub and/or enable Secure Boot by default</a>)</p>
<p>Maybe it doesn’t really matter since if we wanted to be compatible with Secure Boot (on the host) we might be able to combine shim-signed with isolinux/syslinux too?</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/187">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/187</link>
        <pubDate>Thu, 29 Aug 2019 16:46:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-187</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <p>OK, so I recreated a fresh debian buster VM as build machine (not a Whonix Workstation).</p>
<p>First remark: there are a bunch of packages that are needed in order to build Whonix that are not listed in the building documentation and that I had to add manually. Maybe worth updating the documentation?</p>
<p><strong>The good news: the build finally succeeded</strong></p>
<p>Well, it did fail at <code>././build-steps.d/2550_convert-raw-to-iso</code>**</p>
<pre><code>+++ cp /home/user/whonix_binary/image/boot/isolinux/
cp: missing destination file operand after '/home/user/whonix_binary/image/boot/isolinux/'
</code></pre>
<p>As far as I understand the real cause is that I had no directory <code>/usr/lib/syslinux</code> on the building host, and therefore the following cp command could not be executed:<br>
<code>cp /usr/lib/syslinux/modules/bios/* "$WHONIX_BINARY/image/boot/isolinux/"</code><br>
<strong>Installing syslinux package on the building host solved the problem.</strong></p>
<p>ISO seems to work. Boots normally into X. I will do more tests tomorrow.<br>
Screenshot:<br>
</p><div class="lightbox-wrapper"><a class="lightbox" href="//forums.whonix.org/uploads/default/original/2X/7/745fb065d1f3811c63ddad6ccdf7463f1e58aa43.png" data-download-href="//forums.whonix.org/uploads/default/745fb065d1f3811c63ddad6ccdf7463f1e58aa43" title="17.png"><img src="//forums.whonix.org/uploads/default/optimized/2X/7/745fb065d1f3811c63ddad6ccdf7463f1e58aa43_2_673x500.png" alt="17" data-base62-sha1="gBuoLnVFGtpfZuhMFraQ0qQa7TB" width="673" height="500" srcset="//forums.whonix.org/uploads/default/optimized/2X/7/745fb065d1f3811c63ddad6ccdf7463f1e58aa43_2_673x500.png, //forums.whonix.org/uploads/default/optimized/2X/7/745fb065d1f3811c63ddad6ccdf7463f1e58aa43_2_1009x750.png 1.5x, //forums.whonix.org/uploads/default/original/2X/7/745fb065d1f3811c63ddad6ccdf7463f1e58aa43.png 2x" data-small-upload="//forums.whonix.org/uploads/default/optimized/2X/7/745fb065d1f3811c63ddad6ccdf7463f1e58aa43_2_10x10.png"></a></div><p></p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/186">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/186</link>
        <pubDate>Thu, 29 Aug 2019 15:01:52 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-186</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <p>The “old” VM is an up-to-date debian buster VM. I always built Whonix with it, without problems, until now, where it always fails.<br>
The newer one is a Whonix-Workstation VM, didn’t check the repos I am using.</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/185">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/185</link>
        <pubDate>Wed, 28 Aug 2019 14:34:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-185</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Building inside Whonix?<br>
Not sure that would help but deleting old pre.bsh might help.<br>
Or getting newer helper-scripts (pre.bsh) from testers repository (i.e upgrade from testers repository).</p>
<p>sudo rm /usr/lib/helper-scripts/pre.bsh<br>
sudo rm /usr/lib/pre.bsh</p>
<p>Also the umask changes (later undone already) might cause some issues.</p>
<p>I am building either in Debian buster VMs (with newest security-misc package) or in Whonix VMs which are updated from testers repository. That might make the difference if you’re using stable or testers version of Whonix.</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/184">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/184</link>
        <pubDate>Wed, 28 Aug 2019 14:07:41 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-184</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <p>All my build attempts failed, both on the fresh and the old VM.</p>
<p>As of now, I am unable to build Whonix.</p>
<p>Different errors were thrown, I didn’t have time to take note of all of them. I will retry afresh as soon as possible and report back.</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/183">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/183</link>
        <pubDate>Wed, 28 Aug 2019 13:55:59 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-183</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>I’ll be away for some time as usual.</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/182">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/182</link>
        <pubDate>Tue, 27 Aug 2019 14:09:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-182</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Speculation: an old version of helper-scripts (<code>pre.bsh</code>) shipped in Whonix stable is the cause of this. By installing newer helper-scripts before building Whonix, none of this might happen.</p>
<p>I am probably building with a newer version of helper-scripts, hence not able to reproduce.</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/181">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/181</link>
        <pubDate>Tue, 27 Aug 2019 13:53:21 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-181</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Something that <a href="https://github.com/Whonix/helper-scripts/blob/master/usr/lib/helper-scripts/pre.bsh" rel="nofollow noopener">https://github.com/Whonix/helper-scripts/blob/master/usr/lib/helper-scripts/pre.bsh</a> might be causing this.</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/180">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/180</link>
        <pubDate>Tue, 27 Aug 2019 13:51:37 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-180</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Yes.</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/179">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/179</link>
        <pubDate>Tue, 27 Aug 2019 13:51:22 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-179</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <p>There was an error with uncommitted changes that I chose to ignore, I think it’s safe?</p>
<pre><code>+ true '---------------------------------------------------------------------'
+ error 'Uncommitted changes! See above!'
+ echo '############################################################'
############################################################
+ echo 'ERROR: Uncommitted changes! See above!'
ERROR: Uncommitted changes! See above!
+ echo '############################################################'
############################################################</code></pre>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/178">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/178</link>
        <pubDate>Tue, 27 Aug 2019 13:50:33 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-178</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Now included in git tag:</p>
<pre><code>15.0.0.4.7-developers-only</code></pre>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/177">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/177</link>
        <pubDate>Tue, 27 Aug 2019 13:49:33 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-177</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
      <item>
        <title>Whonix Desktop Installer with Calamares - field report</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <p>Building now with set -x set unconditionnally.<br>
Stage 1120 passed, building continues</p>
          <p><a href="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/176">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350/176</link>
        <pubDate>Tue, 27 Aug 2019 13:48:56 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-7350-176</guid>
        <source url="http://forums.whonix.org/t/whonix-desktop-installer-with-calamares-field-report/7350.rss">Whonix Desktop Installer with Calamares - field report</source>
      </item>
  </channel>
</rss>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Restrict root access - Development - Whonix Forum</title>
    <meta name="description" content="It would be good to restrict root access to make it a lot harder to login as root. 
Uncommenting, auth required pam_wheel.so in /etc/pam.d/su will make it so only users in the root group can use su. This can prevent a co&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="76584658.html?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Restrict root access&#39;" href="7658.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/restrict-root-access/7658?page=2" />
<meta name="twitter:url" content="https://forums.whonix.org/t/restrict-root-access/7658?page=2" />
<meta property="og:title" content="Restrict root access" />
<meta name="twitter:title" content="Restrict root access" />
<meta property="og:description" content="All. As in original post. (Hence I made an almost full quote.)  Please also document each change so those who don‚Äôt like it can reverse it.   Yes, I see no reason against that yet. user user should be able to use sudo, sudo su. When that works, not sure if ‚Äústandalone‚Äù (no sudo) su is still required. Please let me know if blocking su given us further hardening under which threat model.   sudo passwd -l root and/or setting login shell to /sbin/nologin? Either, or? Or both advisable?  Where would..." />
<meta name="twitter:description" content="All. As in original post. (Hence I made an almost full quote.)  Please also document each change so those who don‚Äôt like it can reverse it.   Yes, I see no reason against that yet. user user should be able to use sudo, sudo su. When that works, not sure if ‚Äústandalone‚Äù (no sudo) su is still required. Please let me know if blocking su given us further hardening under which threat model.   sudo passwd -l root and/or setting login shell to /sbin/nologin? Either, or? Or both advisable?  Where would..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="31 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="121 ‚ù§" />
<meta property="article:published_time" content="2019-07-08T23:01:30+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="7658.html">
        <link rel="next" href="76589ba9.html?page=3">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="7658.html">Restrict root access</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/component_security.html' class='discourse-tag' rel="tag">component_security</a>, 
            <a href='../../tag/status_closed_issue_implemented.html' class='discourse-tag' rel="tag">status_closed_issue_implemented</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-08T23:01:30Z' class='post-time'>
                July 8, 2019, 11:01pm
              </time>
              <meta itemprop='dateModified' content='2019-07-08T23:01:30Z'>
          <span itemprop='position'>#21</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="20" data-topic="7658">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Which parts should be implemented?</p>
</blockquote>
</aside>
<p>All. As in original post. (Hence I made an almost full quote.)<br>
Please also document each change so those who don‚Äôt like it can reverse it.</p>
<aside class="quote no-group" data-post="20" data-topic="7658">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Should the user <code>user</code> be able to use <code>su</code> ?</p>
</blockquote>
</aside>
<p>Yes, I see no reason against that yet. user <code>user</code> should be able to use <code>sudo</code>, <code>sudo su</code>. When that works, not sure if ‚Äústandalone‚Äù (no sudo) <code>su</code> is still required. Please let me know if blocking <code>su</code> given us further hardening under which threat model.</p>
<aside class="quote no-group" data-post="20" data-topic="7658">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Should the root account be locked?</p>
</blockquote>
</aside>
<p><code>sudo passwd -l root</code> and/or setting login shell to <code>/sbin/nologin</code>? Either, or? Or both advisable?</p>
<p>Where would that be implemented? In <a href="../../../external.html?link=https://github.com/Whonix/anon-base-files/blob/master/debian/anon-base-files.postinst" rel="nofollow noopener">https://github.com/Whonix/anon-base-files/blob/master/debian/anon-base-files.postinst</a>?</p>
        </div>

        <meta itemprop='headline' content='Restrict root access'>
          <meta itemprop='keywords' content='component_security, status_closed_issue_implemented'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-08T23:09:37Z' class='post-time'>
                July 8, 2019, 11:09pm
              </time>
              <meta itemprop='dateModified' content='2019-07-08T23:09:37Z'>
          <span itemprop='position'>#22</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="21" data-topic="7658">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p><code>sudo passwd -l root</code> and/or setting login shell to <code>/sbin/nologin</code> ? Either, or? Or both advisable?</p>
</blockquote>
</aside>
<p>Setting the login shell to <code>/sbin/nologin</code> won‚Äôt help much. You can still run <code>sudo -u root bash</code> and get shell access. We could implement both but I‚Äôm not sure how. I highly doubt there is a passwd.d.</p>
<aside class="quote no-group" data-post="21" data-topic="7658">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Where would that be implemented? In <a href="../../../external.html?link=https://github.com/Whonix/anon-base-files/blob/master/debian/anon-base-files.postinst" rel="nofollow noopener">https://github.com/Whonix/anon-base-files/blob/master/debian/anon-base-files.postinst</a>?</p>
</blockquote>
</aside>
<p>That sounds like the best way.</p>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-08T23:25:47Z' class='post-time'>
                July 8, 2019, 11:25pm
              </time>
              <meta itemprop='dateModified' content='2019-07-08T23:25:47Z'>
          <span itemprop='position'>#23</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>/etc/pam.d/passwd contains nothing except an include rule for /etc/pam.d/common-password so I edited that instead.</p>
<p>I created a pull request for all these.</p>
<aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/pull/22" target="_blank" rel="nofollow noopener">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
      <a href="../../../external.html?link=https://github.com/madaidan" target="_blank" rel="nofollow noopener">
    <img alt="madaidan" src="../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../external.html?link=https://github.com/Whonix/security-misc/pull/22" target="_blank" rel="nofollow noopener">Restrict access to the root account</a>
</h4>

<div class="date">
  by <a href="../../../external.html?link=https://github.com/madaidan" target="_blank" rel="nofollow noopener">madaidan</a>
  on <a href="../../../external.html?link=https://github.com/Whonix/security-misc/pull/22" target="_blank" rel="nofollow noopener">11:25PM - 08 Jul 19 UTC</a>
</div>

<div class="github-commit-stats">
  <strong>6 commits</strong>
  changed <strong>4 files</strong>
  with <strong>106 additions</strong>
  and <strong>0 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-09T07:37:23Z' class='post-time'>
                July 9, 2019,  7:37am
              </time>
              <meta itemprop='dateModified' content='2019-07-09T07:37:23Z'>
          <span itemprop='position'>#24</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>And after that I just merged that I got a different version on my system due to another package. Contents in <code>/etc/pam.d</code> are influences through a mechanism using configuration drop-in folder <code>/usr/share/pam-configs/</code>. So config-package-dev is quite possibly the wrong approach to implement (most) of our pam changes. Could you look into this please?</p>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-09T14:11:27Z' class='post-time'>
                July 9, 2019,  2:11pm
              </time>
              <meta itemprop='dateModified' content='2019-07-09T14:11:27Z'>
          <span itemprop='position'>#25</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Those files have weird formatting.</p>
<pre><code class="lang-auto">user@host:~$ cat /usr/share/pam-configs/mkhomedir 
Name: Create home directory on login
Default: no
Priority: 0
Session-Type: Additional
Session-Interactive-Only: yes
Session:
	optional	pam_mkhomedir.so
</code></pre>
<p>There‚Äôs a section on the Ubuntu wiki that might be useful.</p>
<p><a href="../../../external.html?link=https://wiki.ubuntu.com/PAMConfigFrameworkSpec" class="onebox" target="_blank" rel="nofollow noopener">https://wiki.ubuntu.com/PAMConfigFrameworkSpec</a></p>
<p>I‚Äôm not sure how this could be implemented.</p>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-11T18:32:12Z' class='post-time'>
                July 11, 2019,  6:32pm
              </time>
              <meta itemprop='dateModified' content='2019-07-11T18:32:12Z'>
          <span itemprop='position'>#26</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>There are two folders:</p>
<ul>
<li>/usr/share/pam</li>
<li>/usr/share/pam-configs</li>
</ul>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-11T22:21:25Z' class='post-time'>
                July 11, 2019, 10:21pm
              </time>
              <meta itemprop='dateModified' content='2019-07-11T22:21:25Z'>
          <span itemprop='position'>#27</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>/usr/share/pam just seems to duplicate some files from /etc/pam.d and give md5 hashes of them.</p>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../help-welcome-kvm-development-staying-the-course/166/307.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../help-welcome-kvm-development-staying-the-course/166/307.html'>
                      <span itemprop='name'>[Help Welcome] KVM Development - staying the course</span>
                    </a>
                    <meta itemprop='position' content='1'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-12T08:14:00Z' class='post-time'>
                July 12, 2019,  8:14am
              </time>
              <meta itemprop='dateModified' content='2019-07-12T08:14:00Z'>
          <span itemprop='position'>#28</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>madaidan via Whonix Forum:</p>
<blockquote>
<p>/usr/share/pam just seems to duplicate some files from /etc/pam.d and give md5 hashes of them.</p>
</blockquote>
<p>Duplicate might be an understatement. /usr/share/pam looks to be the<br>
template from which /etc/pam.d is build and then supplemented with<br>
/usr/share/pam-configs.</p>
<p>Also /usr/sbin/pam-auth-update is involved. But also some other tool<br>
much be involved since I did not see yet what reads from /usr/share/pam.</p>
<p>Our current implementation of changing /etc/pam.d directly using<br>
config-package-dev seems really bad, breaking the usual mechanism for<br>
populating that folder. Not fit for release since hard to later move<br>
back to the proper mechanism, also breaking things for any user/package<br>
using the standardized pam-auth-update mechanism.</p>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-12T11:31:45Z' class='post-time'>
                July 12, 2019, 11:31am
              </time>
              <meta itemprop='dateModified' content='2019-07-12T11:31:45Z'>
          <span itemprop='position'>#29</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>We could make a script that appends the needed lines to the existing files but that seems a bit hacky.</p>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-12T15:56:38Z' class='post-time'>
                July 12, 2019,  3:56pm
              </time>
              <meta itemprop='dateModified' content='2019-07-12T15:56:38Z'>
          <span itemprop='position'>#30</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Really hacky indeed. We first need to understand and exhaust the usual mechanism which all other pam related packages are using (as mentioned above).  There are a ton of packages interacting with pam in a proper way.</p>
<p><a href="../../../external.html?link=https://packages.debian.org/search?suite=default&amp;section=all&amp;arch=any&amp;searchon=names&amp;keywords=libpam" class="onebox" target="_blank" rel="nofollow noopener">https://packages.debian.org/search?suite=default&amp;section=all&amp;arch=any&amp;searchon=names&amp;keywords=libpam</a></p>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-12T16:12:25Z' class='post-time'>
                July 12, 2019,  4:12pm
              </time>
              <meta itemprop='dateModified' content='2019-07-12T16:12:25Z'>
          <span itemprop='position'>#31</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>If you look at the list of files in the packages, you can see that some of those packages are using /usr/share/pam-configs or are putting their module directly in /lib/security.</p>
<p>/usr/share/pam-configs seems to be the best way.</p>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-13T11:42:11Z' class='post-time'>
                July 13, 2019, 11:42am
              </time>
              <meta itemprop='dateModified' content='2019-07-13T11:42:11Z'>
          <span itemprop='position'>#32</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/4079632d1aed4f3e50ea21de674a9b6d537d3e05" target="_blank" rel="nofollow noopener">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
      <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/4079632d1aed4f3e50ea21de674a9b6d537d3e05" target="_blank" rel="nofollow noopener">remove modifying to /etc/pam.d directly (unrelased)</a>
</h4>

  <pre class="message" style="white-space: normal;">config-package-dev displace /etc/securetty
remove trailing spaces
https://forums.whonix.org/t/restrict-root-access/7658/31</pre>

<div class="date">
  by <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/4079632d1aed4f3e50ea21de674a9b6d537d3e05" target="_blank" rel="nofollow noopener">11:41AM - 13 Jul 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>5 files</strong>
  with <strong>12 additions</strong>
  and <strong>38 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-13T12:40:17Z' class='post-time'>
                July 13, 2019, 12:40pm
              </time>
              <meta itemprop='dateModified' content='2019-07-13T12:40:17Z'>
          <span itemprop='position'>#33</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/69b97981f3b5e4efc75954d6957659f1bb8e7d18" target="_blank" rel="nofollow noopener">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
      <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/69b97981f3b5e4efc75954d6957659f1bb8e7d18" target="_blank" rel="nofollow noopener">convert etc/pam.d/su.security-misc to usr/share/pam-configs/wheel</a>
</h4>

  <pre class="message" style="white-space: normal;">https://forums.whonix.org/t/restrict-root-access/7658/32</pre>

<div class="date">
  by <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/69b97981f3b5e4efc75954d6957659f1bb8e7d18" target="_blank" rel="nofollow noopener">12:33PM - 13 Jul 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>2 files</strong>
  with <strong>6 additions</strong>
  and <strong>61 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-13T12:49:41Z' class='post-time'>
                July 13, 2019, 12:49pm
              </time>
              <meta itemprop='dateModified' content='2019-07-13T12:49:41Z'>
          <span itemprop='position'>#34</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Instructions for experimentation:</p>
<p>Get rid of all previous modifications firsts.</p>
<p>Put folder <code>/etc/pam.d</code> under git version control (or similar) so you can see what files get changed in which way.</p>
<p>Get a file into folder <code>/usr/share/pam-configs</code> such as for example <code>/usr/share/pam-configs/wheel</code> into place.</p>
<p>Here is a link below to a version in the git history. It might be removed/updated at a later point.</p>
<aside class="onebox githubblob">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/blob/69b97981f3b5e4efc75954d6957659f1bb8e7d18/usr/share/pam-configs/wheel" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://github.com/Whonix/security-misc/blob/69b97981f3b5e4efc75954d6957659f1bb8e7d18/usr/share/pam-configs/wheel" target="_blank" rel="nofollow noopener">Whonix/security-misc/blob/69b97981f3b5e4efc75954d6957659f1bb8e7d18/usr/share/pam-configs/wheel</a></h4>
<pre><code class="lang-">Name: group root membership required to use su (by package security-misc)
Default: yes
Priority: 260
Auth-Type: Primary
Auth:
	required	pam_wheel.so
</code></pre>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>To simulate what the package would do during installation:</p>
<pre><code>sudo pam-auth-update --package
</code></pre>
<p>Or for manual experimentation:</p>
<pre><code>sudo pam-auth-update
</code></pre>
<p>Then check which changes happened in /etc/pam.d folder using git version control or similar.</p>
<hr>
<p>What‚Äôs happening in last commit is instead of editing <code>/etc/pam.d/su</code> directly, in effect <code>/etc/pam.d/common-auth</code> gets modified. This is the diff:</p>
<pre><code class="lang-auto">diff --git a/common-auth b/common-auth
index 1ed8786..fcaf1b3 100644
--- a/common-auth
+++ b/common-auth
@@ -14,8 +14,7 @@
 # pam-auth-update(8) for details.
 
 # here are the per-package modules (the "Primary" block)
-auth   required        pam_wheel.so 
-auth   [success=1 default=ignore]      pam_unix.so nullok_secure try_first_pass
+auth   [success=1 default=ignore]      pam_unix.so nullok_secure
 # here's the fallback if no module succeeds
 auth   requisite                       pam_deny.so
 # prime the stack with a positive return value if there isn't one already;
</code></pre>
<p>So the line</p>
<pre><code>auth   required        pam_wheel.so 
</code></pre>
<p>gets added above ‚Äúquite early‚Äù. Early enough?</p>
<p>Another important difference is that most if not all pam config files import <code>/etc/pam.d/common-auth</code>. So this change does not only effect <code>/etc/pam.d/su</code> but also sudo, login, cron, polkit-1, others. Is this ok or could cause some issues?</p>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-13T13:37:52Z' class='post-time'>
                July 13, 2019,  1:37pm
              </time>
              <meta itemprop='dateModified' content='2019-07-13T13:37:52Z'>
          <span itemprop='position'>#35</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>upstream bug report:<br>
<a href="../../../external.html?link=https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=931994" rel="nofollow noopener">improve key strengthening, add rounds=65536 to /etc/pam.d/common-password</a></p>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-13T13:46:47Z' class='post-time'>
                July 13, 2019,  1:46pm
              </time>
              <meta itemprop='dateModified' content='2019-07-13T13:46:47Z'>
          <span itemprop='position'>#36</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><a href="../../../external.html?link=https://www.whonix.org/pipermail/whonix-devel/2019-July/001402.html" rel="nofollow noopener">Appropriate place to ask questions on how Debian derivatives would best interact with Debian‚Äôs implementation of pam?</a></p>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-13T14:01:09Z' class='post-time'>
                July 13, 2019,  2:01pm
              </time>
              <meta itemprop='dateModified' content='2019-07-13T14:01:09Z'>
          <span itemprop='position'>#37</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="1" data-topic="7658">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>While not necessarily helpful for just the root account, we can increase the number of hashing rounds when hashing passwords by adding <code>rounds=(number)</code> to the end of the pam_unix.so module in /etc/pam.d/common-password. E.g. <code>rounds=65536</code> . The higher the amount of rounds, the longer it takes to login and set passwords. 65536 rounds takes 1 second even on slow computers.</p>
</blockquote>
</aside>
<p>A clean implementation might require to config-package-dev displace <code>/usr/share/pam-configs/unix</code>. I don‚Äôt think it‚Äôs worth the risk of this implementation. All this does is better protect the hashed password in <code>/etc/shadow</code> from an attacker who got an offline copy of <code>/etc/shadow</code> and runs an offline cracking attack against it. Cases where this applies:</p>
<ul>
<li>someone not using full disk encryption (FDE) and /etc/shadow leaked</li>
<li>broken FDE but no knowledge of root password (but also no longer by attacker required to view any file)</li>
<li>an attacker who didn‚Äôt manage to get the root password through a keylogger (unrealistic since it assumes attacker can already read /etc/shadow)</li>
<li>an attacker who thinks that the password used for linux user  authentication is being used elsewhere and while having full disk access still wants to crack that password too</li>
</ul>
<p>To add the delay against online bruteforcing we are better off using something like tally / tally2 as discussed here:</p>
<aside class="quote" data-post="6" data-topic="7698">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar">
    <a href="../protect-linux-user-accounts-against-brute-force-attacks/7698/6.html">How strong do linux user account passwords have to be when using Full Disk Encryption (FDE) too?</a> <a class="badge-wrapper  bullet" href="../../c/development/8.html"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    Related info for setting timeouts:
  </blockquote>
</aside>

<p>I will revert our current implementation.</p>
<p>After <a href="../../../external.html?link=https://www.whonix.org/pipermail/whonix-devel/2019-July/001402.html" rel="nofollow noopener">Appropriate place to ask questions on how Debian derivatives would best interact with Debian‚Äôs implementation of pam?</a> was answered, I will ask how to cleanly implement this. Already prepared a draft for that:</p>
<p><code>How to append rounds=65536 in /etc/pam.d/common-password as a Debian derivative?</code></p>
<blockquote>
<p>In /etc/pam.d/common-password we would like to change from</p>
<p>password	[success=1 default=ignore]	pam_unix.so obscure sha512</p>
<p>to</p>
<p>password	[success=1 default=ignore]	pam_unix.so obscure sha512 rounds=65536</p>
<p>How would we do that? Fork libpam-runtime and edit /usr/share/pam-configs/unix ? [1] [2] Or is there some more elegant solution using a /usr/share/pam-configs drop-in or so?</p>
<p>Kind regards,<br>
Patrick</p>
<p>[1]<br>
dpkg -S /usr/share/pam-configs/unix<br>
libpam-runtime: /usr/share/pam-configs/unix</p>
<p>[2] <a href="../../../external.html?link=https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=931994" rel="nofollow noopener">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=931994</a></p>
</blockquote>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-13T14:03:01Z' class='post-time'>
                July 13, 2019,  2:03pm
              </time>
              <meta itemprop='dateModified' content='2019-07-13T14:03:01Z'>
          <span itemprop='position'>#38</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/ac25733de871b0da5ef42e2e0283a44d94ac3112" target="_blank" rel="nofollow noopener">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
      <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/ac25733de871b0da5ef42e2e0283a44d94ac3112" target="_blank" rel="nofollow noopener">remove etc/pam.d/common-password.security-misc rounds=65536</a>
</h4>

  <pre class="message" style="white-space: normal;">due to unclean implementation, see:
https://forums.whonix.org/t/restrict-root-access/7658/37</pre>

<div class="date">
  by <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/ac25733de871b0da5ef42e2e0283a44d94ac3112" target="_blank" rel="nofollow noopener">02:01PM - 13 Jul 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>1 files</strong>
  with <strong>0 additions</strong>
  and <strong>33 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-14T10:52:23Z' class='post-time'>
                July 14, 2019, 10:52am
              </time>
              <meta itemprop='dateModified' content='2019-07-14T10:52:23Z'>
          <span itemprop='position'>#39</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <ul>
<li><a href="../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/1128#issuecomment-511185971" rel="nofollow noopener">https://github.com/QubesOS/qubes-issues/issues/1128#issuecomment-511185971</a></li>
</ul>
<hr>
<aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/QubesOS/qubes-core-agent-linux/pull/171" target="_blank" rel="nofollow noopener">github.com/QubesOS/qubes-core-agent-linux</a>
  </header>
  <article class="onebox-body">
      <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../external.html?link=https://github.com/QubesOS/qubes-core-agent-linux/pull/171" target="_blank" rel="nofollow noopener">fix, forbid non-root users using 'su'</a>
</h4>

<div class="date">
  by <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="../../../external.html?link=https://github.com/QubesOS/qubes-core-agent-linux/pull/171" target="_blank" rel="nofollow noopener">10:40AM - 14 Jul 19 UTC</a>
</div>

<div class="github-commit-stats">
  <strong>3 commits</strong>
  changed <strong>8 files</strong>
  with <strong>84 additions</strong>
  and <strong>70 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7658.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-14T11:15:56Z' class='post-time'>
                July 14, 2019, 11:15am
              </time>
              <meta itemprop='dateModified' content='2019-07-14T11:15:56Z'>
          <span itemprop='position'>#40</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="23" data-topic="7658">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><a href="../../../external.html?link=https://github.com/Whonix/security-misc/pull/22" rel="nofollow noopener">Restrict access to the root account</a></p>
</blockquote>
</aside>
<p><a href="../../../external.html?link=https://github.com/Whonix/security-misc/pull/22/files#r303238717" rel="nofollow noopener">https://github.com/Whonix/security-misc/pull/22/files#r303238717</a></p>
<blockquote>
<p>auth       required   pam_wheel.so</p>
</blockquote>
<p>I don‚Äôt think that by itself would have worked? Did you test that?</p>
<pre><code># Uncomment this to force users to be a member of group root
# before they can use `su'. You can also add "group=foo"
# to the end of this line if you want to use a group other
# than the default "root" (but this may have side effect of
# denying "root" user, unless she's a member of "foo" or explicitly
# permitted earlier by e.g. "sufficient pam_rootok.so").
# (Replaces the `SU_WHEEL_ONLY' option from login.defs)
auth       required   pam_wheel.so
</code></pre>
<p>So we would have had to create a group <code>root</code> and add user <code>user</code> to that group <code>root</code> too.</p>
<p>(And hopefully <code>pam_wheel.so</code> in Debian wouldn‚Äôt default to group <code>wheel</code> for historic reasons either (potential bug).)</p>
<p>It seems required to add <code>group=sudo</code>.<br>
For debugging I‚Äôve also added <code>debug</code>.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/ffb61f43ea8011d71cf9c5bba1e277a2f825eea7" target="_blank" rel="nofollow noopener">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
      <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/ffb61f43ea8011d71cf9c5bba1e277a2f825eea7" target="_blank" rel="nofollow noopener">fix, add 'group=sudo' and 'debug' for debugging</a>
</h4>

  <pre class="message" style="white-space: normal;">https://forums.whonix.org/t/restrict-root-access/7658</pre>

<div class="date">
  by <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/ffb61f43ea8011d71cf9c5bba1e277a2f825eea7" target="_blank" rel="nofollow noopener">11:11AM - 14 Jul 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>1 files</strong>
  with <strong>1 additions</strong>
  and <strong>1 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Do you think we should create group <code>sudo</code> and add user <code>user</code> to group <code>root</code>? I am wondering which is the better implementation?</p>
<ul>
<li>More groups don‚Äôt make thing simpler for users, developers, auditors.</li>
<li>Not much point to differentiate between <code>sudo</code> and <code>root</code> nowadays, less so when we preconfigure the whole system with locked down, secure defaults?</li>
<li>Not using <code>root</code> group is less standard conform could be more confusing for something?</li>
</ul>
        </div>

        <meta itemprop='headline' content='Restrict root access'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="7658.html">‚Üê previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="76589ba9.html?page=3">next page ‚Üí</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

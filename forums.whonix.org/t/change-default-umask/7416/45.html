<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>change default umask - #45 by Patrick - Development - Whonix Forum</title>
    <meta name="description" content="The umask is what sets the default permissions for newly created files. Whonix has this set to 022 which gives read access to every user on the system for newly created files. 077 is recommended as it makes newly created&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../74169ba9.html?page=3" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;change default umask&#39;" href="../7416.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/change-default-umask/7416/45" />
<meta name="twitter:url" content="https://forums.whonix.org/t/change-default-umask/7416/45" />
<meta property="og:title" content="change default umask" />
<meta name="twitter:title" content="change default umask" />
<meta property="og:description" content="Run into exactly this issue with command-not-found:  https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=916783  It is probably due to our umask lockdown.  Workaround:  sudo chmod o+r /var/lib/command-not-found/commands.db*  I am considering to apply that workaround by default, not great, but if this is the only of a very few issues due to umask changes this is ok." />
<meta name="twitter:description" content="Run into exactly this issue with command-not-found:  https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=916783  It is probably due to our umask lockdown.  Workaround:  sudo chmod o+r /var/lib/command-not-found/commands.db*  I am considering to apply that workaround by default, not great, but if this is the only of a very few issues due to umask changes this is ok." />
<meta property="article:published_time" content="2019-08-16T15:22:22+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="../74164658.html?page=2">
        <link rel="next" href="../7416fdb0.html?page=4">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../7416.html">change default umask</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-14T07:44:04Z' class='post-time'>
                August 14, 2019,  7:44am
              </time>
              <meta itemprop='dateModified' content='2019-08-14T07:44:04Z'>
          <span itemprop='position'>#40</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/52df8dc0149d597c3106daa7112a01db444e34f1" target="_blank" rel="nofollow noopener">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/52df8dc0149d597c3106daa7112a01db444e34f1" target="_blank" rel="nofollow noopener">optional	pam_umask.so	usergroups umask=006</a>
</h4>


<div class="date">
  by <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/52df8dc0149d597c3106daa7112a01db444e34f1" target="_blank" rel="nofollow noopener">07:37AM - 14 Aug 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>1 files</strong>
  with <strong>1 additions</strong>
  and <strong>1 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='change default umask'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-14T08:06:05Z' class='post-time'>
                August 14, 2019,  8:06am
              </time>
              <meta itemprop='dateModified' content='2019-08-14T08:06:05Z'>
          <span itemprop='position'>#41</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubissue">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/5243" target="_blank" rel="nofollow noopener">github.com/QubesOS/qubes-issues</a>
  </header>
  <article class="onebox-body">
    <a href="../../../../external.html?link=https://github.com/adrelanos" rel="nofollow noopener">
<img src="../../../../external.html?link=https://avatars1.githubusercontent.com/u/1985040?v=2&amp;s=96" class="thumbnail onebox-avatar" width="60" height="60">
</a>

<h4><a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/5243" target="_blank" rel="nofollow noopener">Issue: default file permissions - Qubes default /etc/sudoers.d/umask 0002 vs security-misc default umask 0006</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
	on <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/5243" target="_blank" rel="nofollow noopener">2019-08-14</a>
	</div>
	<div class="user">
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">Due to my work on security-misc (#1885) and with one of its goals to implement strong linux user account separation, user...</pre>

<div class="labels">
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">P: default</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">T: bug</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-14T10:05:19Z' class='post-time'>
                August 14, 2019, 10:05am
              </time>
              <meta itemprop='dateModified' content='2019-08-14T10:05:19Z'>
          <span itemprop='position'>#42</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Whonix 15.0.0.3.6 and also still the upcoming 15.0.0.3.9 still have /home/user accessible by other non-root users. That is for files copied over from /etc/skel during creation of the /home/user folder. umask changes are functional so new files are hidden. This is because during build security-misc gets installed before user <code>user</code> gets created. Not too bad but this can be fixed. Solution…</p>
<blockquote>
<p>Removes read, write and execute access for others for all users who have home folders under folder /home by running for example “chmod o-rwx /home/user” during package installation, upgrade or pam. This will be done only once per folder in folder /home so users who wish to relax file permissions are free to do so. This is to protect previously created files in user home folder which were previously created with lax file permissions prior installation of this package.</p>
</blockquote>
<p>This could use security review.</p>
<p>File <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/usr/share/pam-configs/permission-lockdown-security-misc" rel="nofollow noopener">https://github.com/Whonix/security-misc/blob/master/usr/share/pam-configs/permission-lockdown-security-misc</a> effective results in files <code>/etc/pam.d/common-session</code> / <code>/etc/pam.d/common-session-noninteractive</code> adding after:</p>
<blockquote>
<p>session        required        pam_unix.so</p>
</blockquote>
<p>A new following line:</p>
<blockquote>
<p>session        optional        pam_exec.so debug seteuid /usr/lib/security-misc/permission-lockdown</p>
</blockquote>
<p>Actual implementation is here:<br>
<a href="../../../../external.html?link=https://github.com/Whonix/security-misc/blob/master/usr/lib/security-misc/permission-lockdown" rel="nofollow noopener">https://github.com/Whonix/security-misc/blob/master/usr/lib/security-misc/permission-lockdown</a></p>
<p>Security discussion: I had in mind if using malicious user names in /home leading to root code execution by users, but this isn’t possible because to create a malicious user name, root access is required in the first place. And one who has root access, does not bother exploiting <code>/usr/lib/security-misc/permission-lockdown</code>. Also pam sets sane environment variables which are not in reach by non-root users at that stage. Not using <code>set -e</code> or so because this script failing shouldn’t block login.</p>
<p>See also:<br>
<a href="../../../../external.html?link=https://manpages.debian.org/buster/libpam-modules/pam_exec.8.en.html" class="onebox" target="_blank" rel="nofollow noopener">https://manpages.debian.org/buster/libpam-modules/pam_exec.8.en.html</a></p>
<p>Unfortunately adduser does not support hooks yet.<br>
<a href="../../../../external.html?link=https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=36019" class="onebox" target="_blank" rel="nofollow noopener">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=36019</a><br>
Therefore using pam_exec to make sure home folder gets right permissions before user login.<br>
Postinst isn’t a reliable way to enable this either since the installation time of the security-misc package isn’t fixed during build of VM images. User “user” may or may not be created by the time of the installation of the security-misc package.</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-16T15:01:36Z' class='post-time'>
                August 16, 2019,  3:01pm
              </time>
              <meta itemprop='dateModified' content='2019-08-16T15:01:36Z'>
          <span itemprop='position'>#43</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Currently still:</p>
<pre><code>sudo -u man bash
umask
</code></pre>
<blockquote>
<p>0026</p>
</blockquote>
<p>Will fix.</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-16T15:16:46Z' class='post-time'>
                August 16, 2019,  3:16pm
              </time>
              <meta itemprop='dateModified' content='2019-08-18T00:34:08Z'>
          <span itemprop='position'>#44</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="43" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>EDIT:<br>
Will fix.</p>
</blockquote>
</aside>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/224f95799c36f56c2165fe9284abaceaa84f1d3b" target="_blank" rel="nofollow noopener">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/224f95799c36f56c2165fe9284abaceaa84f1d3b" target="_blank" rel="nofollow noopener">sudo default umask 006</a>
</h4>

  <pre class="message" style="white-space: normal;">https://forums.whonix.org/t/change-default-umask/7416/43</pre>

<div class="date">
  by <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/224f95799c36f56c2165fe9284abaceaa84f1d3b" target="_blank" rel="nofollow noopener">03:15PM - 16 Aug 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>2 files</strong>
  with <strong>6 additions</strong>
  and <strong>0 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<hr>
<p>The only thing that does not honor umask now is <code>sulogin</code>.</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-16T15:22:22Z' class='post-time'>
                August 16, 2019,  3:22pm
              </time>
              <meta itemprop='dateModified' content='2019-08-16T15:22:22Z'>
          <span itemprop='position'>#45</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Run into exactly this issue with <code>command-not-found</code>:<br>
<a href="../../../../external.html?link=https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=916783" class="onebox" target="_blank" rel="nofollow noopener">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=916783</a></p>
<p>It is probably due to our umask lockdown.</p>
<p>Workaround:</p>
<pre><code>sudo chmod o+r /var/lib/command-not-found/commands.db*
</code></pre>
<p>I am considering to apply that workaround by default, not great, but if this is the only of a very few issues due to umask changes this is ok.</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../command-not-found-warningcould-not-open-file-etc-apt-sources-list/7903.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../command-not-found-warningcould-not-open-file-etc-apt-sources-list/7903.html'>
                      <span itemprop='name'>command-not-found - WARNING:root:could not open file &#39;/etc/apt/sources.list&#39;</span>
                    </a>
                    <meta itemprop='position' content='2'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-16T15:29:25Z' class='post-time'>
                August 16, 2019,  3:29pm
              </time>
              <meta itemprop='dateModified' content='2019-08-16T15:29:25Z'>
          <span itemprop='position'>#46</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Another umask related issue also with <code>command-not-found</code>.</p>
<aside class="quote quote-modified" data-post="1" data-topic="7903">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="../../command-not-found-warningcould-not-open-file-etc-apt-sources-list/7903.html">command-not-found - WARNING:root:could not open file '/etc/apt/sources.list'</a> <a class="badge-wrapper  bullet" href="../../../c/development/8.html"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    command-not-found works [1], however is showing that warning. 

WARNING:root:could not open file ‘/etc/apt/sources.list’ 

Whonix does not ship /etc/apt/sources.list but only files in /etc/apt/sources.list.d/ drop-in folder. 
( <a href="../../../../external.html?link=https://github.com/Whonix/anon-apt-sources-list" rel="nofollow noopener">https://github.com/Whonix/anon-apt-sources-list</a> ) 
That is because file /etc/apt/sources.list managed by a package could conflict with local users, causing interactive dpkg config resolution dialog. 
Considering to apply the following workaround. 
sudo touch /etc/apt/sour…
  </blockquote>
</aside>

<p>It does not just require <code>sudo touch /etc/apt/sources.list</code> but also <code>sudo chmod o+r /etc/apt/sources.list</code> due to our umask hardening. I hope we won’t run into many such issues.</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-17T09:35:14Z' class='post-time'>
                August 17, 2019,  9:35am
              </time>
              <meta itemprop='dateModified' content='2019-08-17T09:35:14Z'>
          <span itemprop='position'>#47</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Debian default umask.</p>
<pre><code>umask 022
touch uuu
</code></pre>
<blockquote>
<p>ls -la uuu<br>
-rw-r–r-- 1 user user 0 Aug 17 09:22 uuu</p>
</blockquote>
<p>Currently security.misc changes to 006.</p>
<pre><code>umask 0006
touch abc
</code></pre>
<blockquote>
<p>ls -la abc<br>
-rw-rw---- 1 user user 0 Aug 17 09:23 abc</p>
</blockquote>
<p>While we harden, while we remove <code>others</code> from reading files, we also relax permissions. We allow group members to write to files where they previously did not have write access. This looked ok due to UPG.</p>
<p>However, upon reflection, since we change this system wide, this may be a bad idea.</p>
<p>Some folders/files created by the system/packages are created with a different group. I.e. owner might be <code>root</code> but group might be <code>shadow</code>, <code>pip</code> or otherwise.</p>
<p>Examples:</p>
<pre><code>ls -la /etc/cups/subscriptions.conf
</code></pre>
<blockquote>
<p>-rw-r----- 1 root lp 93 Jul 19 09:40 /etc/cups/subscriptions.conf</p>
</blockquote>
<pre><code>sudo ls -la /etc/ssl/private/ssl-cert-snakeoil.key
</code></pre>
<blockquote>
<p>-rw-r----- 1 root ssl-cert 1704 Mar 27  2018 /etc/ssl/private/ssl-cert-snakeoil.key</p>
</blockquote>
<p>Therefore our hardening attempts might result in actually relaxing write access for group when the group is different than the owner. Debian packages might keep care of the required umask but there might also be bugs.</p>
<p>Similar bugs (which were about too much hardened rather than too relaxed permissions) reported above (<code>command-not-found</code>).</p>
<p>Therefore I am planning on changing default umask yet again.</p>
<pre><code>umask 027
touch test2
ls -al test2
</code></pre>
<blockquote>
<p>-rw-r----- 1 user user 0 Aug 17 09:26 test2</p>
</blockquote>
<p>Thereby we would harden permissions, i.e. <code>others</code> cannot read files but we also don’t relax any permissions (as previously allow <code>group</code> to write).</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-17T09:56:01Z' class='post-time'>
                August 17, 2019,  9:56am
              </time>
              <meta itemprop='dateModified' content='2019-08-17T09:56:01Z'>
          <span itemprop='position'>#48</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/ed90d8b025c1f852856fea0e620c240f35e78a53" target="_blank" rel="nofollow noopener">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/ed90d8b025c1f852856fea0e620c240f35e78a53" target="_blank" rel="nofollow noopener">change default umask to 027</a>
</h4>

  <pre class="message" style="white-space: normal;">as per:
https://forums.whonix.org/t/change-default-umask/7416/47</pre>

<div class="date">
  by <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/ed90d8b025c1f852856fea0e620c240f35e78a53" target="_blank" rel="nofollow noopener">09:55AM - 17 Aug 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>5 files</strong>
  with <strong>12 additions</strong>
  and <strong>12 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-17T21:44:17Z' class='post-time'>
                August 17, 2019,  9:44pm
              </time>
              <meta itemprop='dateModified' content='2019-08-17T21:44:17Z'>
          <span itemprop='position'>#49</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="45" data-topic="7416" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Run into exactly this issue with <code>command-not-found</code> :<br>
<a href="../../../../external.html?link=https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=916783" rel="nofollow noopener">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=916783</a></p>
<p>It is probably due to our umask lockdown.</p>
<p>Workaround:</p>
<pre><code class="lang-auto">sudo chmod o+r /var/lib/command-not-found/commands.db*
</code></pre>
<p>I am considering to apply that workaround by default, not great, but if this is the only of a very few issues due to umask changes this is ok.</p>
</blockquote>
</aside>
<p>I don’t think this is something that should be fixed on Whonix’s end. Debian packages should always set the correct file permissions with <code>chmod</code> or something similar. Relying on the system umask is very unreliable.</p>
<aside class="quote no-group" data-post="46" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Another umask related issue also with <code>command-not-found</code> .</p>
</blockquote>
</aside>
<p>I don’t think that is <code>umask</code> related. Whonix never shipped /etc/apt/sources.list before so getting this error just because of a change in file permissions for a non-existent file is weird and doesn’t seem right.</p>
<p>This is probably something else.</p>
<aside class="quote no-group" data-post="47" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Thereby we would harden permissions, i.e. <code>others</code> cannot read files but we also don’t relax any permissions (as previously allow <code>group</code> to write).</p>
</blockquote>
</aside>
<p>Sounds good.</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-17T21:49:31Z' class='post-time'>
                August 17, 2019,  9:49pm
              </time>
              <meta itemprop='dateModified' content='2019-08-17T21:49:31Z'>
          <span itemprop='position'>#50</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="43" data-topic="7416" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Currently still:</p>
<pre><code class="lang-auto">sudo -u man bash
umask
</code></pre>
<blockquote>
<p>0026</p>
</blockquote>
<p>Will fix.</p>
</blockquote>
</aside>
<p>Setting the umask in /etc/profile might fix that.</p>
<p>Try creating /etc/profile.d/umask.sh and adding <code>umask 027</code>.</p>
<p>Setting the umask via the bashrc may also work. Edit /etc/bash.bashrc and add <code>umask 027</code>.</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-18T00:33:18Z' class='post-time'>
                August 18, 2019, 12:33am
              </time>
              <meta itemprop='dateModified' content='2019-08-18T00:33:18Z'>
          <span itemprop='position'>#51</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="49" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<blockquote>
<p>Run into exactly this issue with <code>command-not-found</code> :<br>
<a href="../../../../external.html?link=https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=916783" rel="nofollow noopener">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=916783</a></p>
<p>It is probably due to our umask lockdown.</p>
<p>Workaround:</p>
<pre><code class="lang-auto">sudo chmod o+r /var/lib/command-not-found/commands.db*
</code></pre>
<p>I am considering to apply that workaround by default, not great, but if this is the only of a very few issues due to umask changes this is ok.</p>
</blockquote>
<p>I don’t think this is something that should be fixed on Whonix’s end.</p>
</blockquote>
</aside>
<p>So what do you suggest? Leave <code>command-not-found</code> broken in next stable Whonix release?</p>
<aside class="quote no-group" data-post="49" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Debian packages should always set the correct file permissions with <code>chmod</code> or something similar.</p>
</blockquote>
</aside>
<p>They should indeed. This is a bug in <code>command-not-found</code>. However, umask changes by security-misc / Whonix will trigger this bug.</p>
<p>This <code>command-not-found</code> bug already has a patch attached <a href="../../../../external.html?link=https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=916783" rel="nofollow noopener">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=916783</a> not yet reviewed by <code>command-not-found</code> Debian maintainers.</p>
<p>So it’s also a Whonix issue meanwhile. Three options</p>
<p>A) leave command-not-found broken by default<br>
B) apply the workaround by default<br>
C) undo umask changes<br>
D) manually apply the command-not-found patch</p>
<aside class="quote no-group" data-post="49" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>I don’t think that is <code>umask</code> related. Whonix never shipped /etc/apt/sources.list before so getting this error just because of a change in file permissions for a non-existent file is weird and doesn’t seem right.</p>
<p>This is probably something else.</p>
</blockquote>
</aside>
<p>This also is a bug in command-not-found. It shouldn’t throw such a warning just because is unavailable.</p>
<p>The security-misc / Whonix related impact here that the workaround which would on before security-misc / Whonix made umask changes would be</p>
<pre><code>sudo touch /etc/apt/sources.list
</code></pre>
<p>After the umask changes the workaround would be</p>
<pre><code>sudo touch /etc/apt/sources.list
sudo chmod o+r /etc/apt/sources.list
</code></pre>
<p>This is a usability issue. Will elaborate.</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="3" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-18T00:36:31Z' class='post-time'>
                August 18, 2019, 12:36am
              </time>
              <meta itemprop='dateModified' content='2019-08-18T00:36:31Z'>
          <span itemprop='position'>#52</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="50" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<blockquote>
<p>Will fix.</p>
</blockquote>
<p>Setting the umask in /etc/profile might fix that.</p>
<p>Try creating /etc/profile.d/umask.sh and adding <code>umask 027</code> .</p>
<p>Setting the umask via the bashrc may also work. Edit /etc/bash.bashrc and add <code>umask 027</code> .</p>
</blockquote>
</aside>
<p>That was already “fixed” with my next post where I linked this this commit:</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/224f95799c36f56c2165fe9284abaceaa84f1d3b" target="_blank" rel="nofollow noopener">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/224f95799c36f56c2165fe9284abaceaa84f1d3b" target="_blank" rel="nofollow noopener">sudo default umask 006</a>
</h4>

  <pre class="message" style="white-space: normal;">https://forums.whonix.org/t/change-default-umask/7416/43</pre>

<div class="date">
  by <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/224f95799c36f56c2165fe9284abaceaa84f1d3b" target="_blank" rel="nofollow noopener">03:15PM - 16 Aug 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>2 files</strong>
  with <strong>6 additions</strong>
  and <strong>0 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Atm there is no need for /etc/profile.d. umask is as of security-misc current state perfectly consistent everywhere the same.</p>
<p>I am writing “fixed” in quotes since while umask now has expected values, this is creating issues. Will elaborate.</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-18T00:46:13Z' class='post-time'>
                August 18, 2019, 12:46am
              </time>
              <meta itemprop='dateModified' content='2019-08-18T00:46:13Z'>
          <span itemprop='position'>#53</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="51" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>This is a usability issue. Will elaborate.</p>
</blockquote>
</aside>
<aside class="quote no-group" data-post="52" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I am writing “fixed” in quotes since while umask now has expected values, this is creating issues. Will elaborate.</p>
</blockquote>
</aside>
<p>Now tb-starter package has this issue:</p>
<blockquote>
<p>bash -n /etc/torbrowser.d/50_user.conf<br>
bash: /etc/torbrowser.d/50_user.conf: Permission denied</p>
</blockquote>
<p>It was reported by a tester here:</p>
<aside class="quote quote-modified" data-post="1" data-topic="7908">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/tnt_bom_bom/40/2148_2.jpg" class="avatar">
    <a href="../../tor-browser-starter-bash-command-bash-n-i-exit-code-126-bash-etc-torbrowser-d-50-user-conf-permission-denied/7908.html">Tor Browser Starter - BASH_COMMAND: bash -n "$i" exit_code: 126 bash: /etc/torbrowser.d/50_user.conf: Permission denied</a> <a class="badge-wrapper  bullet" href="../../../c/support/5.html"><span class="badge-category-bg" style="background-color: #8C6238;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="User support for the Whonix operating system. (devs)">Support</span></a>
  </div>
  <blockquote>
    Whonix Tester Repo: 
Following TBB hardening instructions will break TBB : 


debug: 
user@host:~$ bash -x torbrowser
+ set -e
+ set -o pipefail
+ set -o errtrace
+ '[' -f /usr/lib/helper-scripts/pre.bsh ']'
+ source /usr/lib/helper-scripts/pre.bsh
++ set -o errtrace
+++ mktemp
++ TEMP_FILE_PRE_BSH=/tmp/tmp.2GQyHlCBhO
++ test -o xtrace
++ true 'INFO: Setting DEBDEBUG to 1, because xtrace (-x) is set.'
++ DEBDEBUG=1
++ '[' 1 = 1 ']'
++ set -x
++ colors
++ '[' xterm-256color = '' ']'
++ [[ -t 2 ]]…
  </blockquote>
</aside>

<p>So config files created by root (in <code>/etc</code> dunno if this matters elsewhere too) are now no longer readable by <code>others</code>. This leads to an usability issue as above and might potentially lead to similar issues.</p>
<p>Another issue is <code>sudo make install</code> (by genmkfile) - also leading to permission denied errors since using sudo would install to /usr/bin etc copy with umask unreadable by user <code>user</code>.</p>
<p>Therefore I am considering to remove umask changes. We now have user home folder permission lockdown by security-misc package which effectively does this:</p>
<pre><code>chmod o-rwx /home/user
</code></pre>
<p>That should protect 80-90% of the user’s files from other compromised non-root users anyhow? So if we revert to Debian default <code>-rw-r--r--</code> (umask <code>0022</code>) it does not matter. Compromised non-root users still cannot read files by user <code>user</code> in folder <code>/home/user</code>.</p>
<p>What other folders do you expect users create files in where Debian default <code>-rw-r--r--</code> (umask <code>0022</code>) would cause issues?</p>
<p><code>/tmp</code>? Should not be an issue. Applications should be using <code>mktemp</code> (or appropriate similar API). And there it’s not an issue.</p>
<pre><code>mktemp
</code></pre>
<blockquote>
<p>/tmp/tmp.ol7zDa3XgC</p>
</blockquote>
<pre><code>ls -la /tmp/tmp.ol7zDa3XgC
</code></pre>
<blockquote>
<p>-rw------- 1 user user 0 Aug 17 20:40 /tmp/tmp.ol7zDa3XgC</p>
</blockquote>
<p>Any other cases where Debian default <code>-rw-r--r--</code> (umask <code>0022</code>) is as much of an issue to justify the breakage we are already having and potential further issues?</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-18T18:08:53Z' class='post-time'>
                August 18, 2019,  6:08pm
              </time>
              <meta itemprop='dateModified' content='2019-08-18T18:08:53Z'>
          <span itemprop='position'>#54</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="51" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>So what do you suggest? Leave <code>command-not-found</code> broken in next stable Whonix release?</p>
</blockquote>
</aside>
<p>The bug will probably be fixed in <code>command-not-found</code> before the umask changes are in the next stable Whonix release. If not, the workaround should be applied.</p>
<aside class="quote no-group" data-post="53" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>So config files created by root (in <code>/etc</code> dunno if this matters elsewhere too) are now no longer readable by <code>others</code> . This leads to an usability issue as above and might potentially lead to similar issues.</p>
</blockquote>
</aside>
<p>This can be fixed by only applying the umask changes for non-root users. We can create a profile.d script that checks if the UID is not 0 then applies the new umask. This way, any files created by the root user will still be readable by others which should prevent any configuration files from being messed up.</p>
<p>There likely won’t be many sensitive files created by the root user that isn’t intended to be readable by others anyway.</p>
<aside class="quote no-group" data-post="53" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>That should protect 80-90% of the user’s files from other compromised non-root users anyhow?</p>
</blockquote>
</aside>
<p>No, any newly created file will still be readable by other users. Only the files already in the home folder will be protected. The permission lockdown only runs once so it won’t protect any files created after it has run.</p>
<aside class="quote no-group" data-post="53" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>What other folders do you expect users create files in where Debian default <code>-rw-r--r--</code> (umask <code>0022</code> ) would cause issues?</p>
</blockquote>
</aside>
<p>Mainly newly created files in the home folder.</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-18T20:11:00Z' class='post-time'>
                August 18, 2019,  8:11pm
              </time>
              <meta itemprop='dateModified' content='2019-08-18T20:11:00Z'>
          <span itemprop='position'>#55</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>madaidan via Whonix Forum:</p>
<blockquote>
<aside class="quote no-group" data-post="51" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>So what do you suggest? Leave <code>command-not-found</code> broken in next stable Whonix release?</p>
</blockquote>
</aside>
<p>The bug will probably be fixed in <code>command-not-found</code> before the umask changes are in the next stable Whonix release.</p>
</blockquote>
<p>Unlikely since Whonix now releases more frequently. (Search term:<br>
rolling release.) These changes will make their way into next stable<br>
Whonix release sooner or later. Could be in 1 to 4 weeks.</p>
<blockquote>
<p>If not, the workaround should be applied.</p>
</blockquote>
<p>Yes.</p>
<blockquote>
<p>There likely won’t be many sensitive files created by the root user that isn’t intended to be readable by others anyway.</p>
</blockquote>
<p>ssh keys, ssh authorized_keys, ssl keys, /etc/shadow but these are<br>
probably already handled by the system in read permission restricted<br>
for <code>others</code> ways anyhow so hopefully don’t matter.</p>
<blockquote>
<aside class="quote no-group" data-post="53" data-topic="7416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>That should protect 80-90% of the user’s files from other compromised non-root users anyhow?</p>
</blockquote>
</aside>
<p>No, any newly created file will still be readable by other users. Only the files already in the home folder will be protected. The permission lockdown only runs once so it won’t protect any files created after it has run.</p>
</blockquote>
<p>No. If the root folder forbids read access, any folder after that<br>
“barrier” will also be inaccessible even though having more relaxed<br>
permissions. Example:</p>
<pre><code>touch /home/user/a
chmod o+r /home/user/a
sudo -u man cat /home/user/a
</code></pre>
<blockquote>
<p>cat: /home/user/a: Permission denied</p>
</blockquote>
<p>The permission lockdown keeps out any non-root out of /home/user.</p>
<p>(Unless root would run <code>sudo chmod o+r /home/user</code> or addgroup or<br>
similar but if they do so, they should be free to do so.)</p>
<p>Please run <code>sudo chmod o-rwx /home/user</code> and then try to make any file<br>
accessible in /home/user by non-root users other than user. (Without<br>
again using chmod directly on /home/user.)</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../whonix-virtualbox-15-0-0-4-9-point-release/8076.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../whonix-virtualbox-15-0-0-4-9-point-release/8076.html'>
                      <span itemprop='name'>Whonix VirtualBox 15.0.0.4.9 - Point Release</span>
                    </a>
                    <meta itemprop='position' content='1'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../whonix-virtualbox-15-0-0-4-9-release-candidate-testers-wanted/8023.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../whonix-virtualbox-15-0-0-4-9-release-candidate-testers-wanted/8023.html'>
                      <span itemprop='name'>Whonix VirtualBox 15.0.0.4.9 - Release Candidate - Testers Wanted!</span>
                    </a>
                    <meta itemprop='position' content='2'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-19T12:55:35Z' class='post-time'>
                August 19, 2019, 12:55pm
              </time>
              <meta itemprop='dateModified' content='2019-08-19T12:55:35Z'>
          <span itemprop='position'>#56</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Ah, you’re right. The umask changes should probably be reverted then.</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-24T16:15:22Z' class='post-time'>
                August 24, 2019,  4:15pm
              </time>
              <meta itemprop='dateModified' content='2019-08-24T16:15:22Z'>
          <span itemprop='position'>#57</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/0ae5c5ff14c308ff5307926fbe6d93f44e1c7615" target="_blank" rel="nofollow noopener">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/0ae5c5ff14c308ff5307926fbe6d93f44e1c7615" target="_blank" rel="nofollow noopener">remove umask changes since these are causing issues are are not needed anymore</a>
</h4>

  <pre class="message" style="white-space: normal;">thanks to home folder permission lockdown
https://forums.whonix.org/t/change-default-umask/7416/45</pre>

<div class="date">
  by <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/0ae5c5ff14c308ff5307926fbe6d93f44e1c7615" target="_blank" rel="nofollow noopener">04:14PM - 24 Aug 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>8 files</strong>
  with <strong>2 additions</strong>
  and <strong>502 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-08T10:22:08Z' class='post-time'>
                December 8, 2019, 10:22am
              </time>
              <meta itemprop='dateModified' content='2019-12-08T10:22:08Z'>
          <span itemprop='position'>#58</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/c192644ee328ff8d5d244d10c082b3a871b151b1" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/c192644ee328ff8d5d244d10c082b3a871b151b1" target="_blank">security-misc `/usr/share/pam-configs/permission-lockdown-security-misc` is no longer required, removed.</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-08" data-time="10:21:35" data-timezone="UTC">10:21AM - 08 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 3 files with 4 additions and 9 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/c192644ee328ff8d5d244d10c082b3a871b151b1" target="_blank">
          <span class="added">+4</span>
          <span class="removed">-9</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">Thereby fix apparmor issue.
&gt; Dec 08 09:47:50 host audit[3232]: AVC apparmor="DENIED" operation="exec" profile="/usr/bin/whonixcheck" name="/usr/lib/security-misc/permission-lockdown" pid=3232 comm="sudo" requested_mask="x" denied_mask="x" fsuid=0 ouid=0
&gt; Dec...</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/rcmzzit'><span itemprop='name'>rcmzzit</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7416.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-04-20T01:28:31Z' class='post-time'>
                April 20, 2020,  1:28am
              </time>
              <meta itemprop='dateModified' content='2020-04-20T01:28:31Z'>
          <span itemprop='position'>#59</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>" does not just require <code>sudo touch /etc/apt/sources.list</code> but also <code>sudo chmod o+r /etc/apt/sources.list</code> due to our umask hardening. I hope we won’t run into many such issues"</p>
<p>This worked for me, at least on my primary vm. Still not sure why my VM clones don’t recognize /etc/apt/sources</p>
        </div>

        <meta itemprop='headline' content='change default umask'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="../74164658.html?page=2">← previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="../7416fdb0.html?page=4">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability - #15 by Patrick - Development - Whonix Forum</title>
    <meta name="description" content="A post was merged into an existing topic: Whonix vulerable due to missing processor microcode packages? spectre / meltdown / retpoline / L1 Terminal Fault (L1TF)">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../7647.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability&#39;" href="../7647.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/should-all-kernel-patches-for-cpu-bugs-be-unconditionally-enabled-vs-performance-vs-applicability/7647/15" />
<meta name="twitter:url" content="https://forums.whonix.org/t/should-all-kernel-patches-for-cpu-bugs-be-unconditionally-enabled-vs-performance-vs-applicability/7647/15" />
<meta property="og:title" content="Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability" />
<meta name="twitter:title" content="Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability" />
<meta property="og:description" content="A post was merged into an existing topic: Whonix vulerable due to missing processor microcode packages? spectre / meltdown / retpoline / L1 Terminal Fault (L1TF)" />
<meta name="twitter:description" content="A post was merged into an existing topic: Whonix vulerable due to missing processor microcode packages? spectre / meltdown / retpoline / L1 Terminal Fault (L1TF)" />
<meta property="article:published_time" content="2020-01-29T13:33:55+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="next" href="../76474658.html?page=2">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../7647.html">Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-01T20:45:07Z' class='post-time'>
                July 1, 2019,  8:45pm
              </time>
              <meta itemprop='dateModified' content='2019-07-01T20:45:07Z'>
          <span itemprop='position'>#10</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="1" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Should all kernel patches for CPU bugs be unconditionally enabled? We currently enable all of the mds vulnerability mitigations.</p>
</blockquote>
</aside>
<p>AFAIK Linux enables the mitigations by default whenever possible using auto. Debian also backported patches against mds. [1]</p>
<p>It is only recently (Linux v5.2) that there is a unified switch for disabling all mitigations for performance on machines not facing the network.[2]</p>
<p>[1] <a href="../../../../external.html?link=https://news.softpedia.com/news/debian-patches-new-intel-mds-security-vulnerabilities-in-debian-linux-stretch-526047.shtml" rel="nofollow noopener">https://news.softpedia.com/news/debian-patches-new-intel-mds-security-vulnerabilities-in-debian-linux-stretch-526047.shtml</a></p>
<p>[2] <a href="../../../../external.html?link=https://www.phoronix.com/scan.php?page=news_item&amp;px=Spectre-Meltdown-Easy-Switch-52" rel="nofollow noopener">https://www.phoronix.com/scan.php?page=news_item&amp;px=Spectre-Meltdown-Easy-Switch-52</a></p>
<aside class="quote no-group" data-post="1" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>This should also partly get rid of the need for microcode updates.</p>
</blockquote>
</aside>
<p>Not really. In the case of MDS  microcode is <a href="../../../../external.html?link=https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS" rel="nofollow noopener">needed</a> to be of any effect.</p>
<blockquote>
<p><strong>IMPORTANT:</strong> There is no software fallback mechanism available for processors that have not received microcode updates from Intel. Mitigation is only possible if Intel has provided a microcode update for your processor.</p>
</blockquote>
<p>I really don’t think we should mess with the  default spectre/meltdown kernel switches in this case as upstream is clearly aware of the problem and is taking appropriate action. Non defaults will confuse users and might leave them to other attacks they are otherwise safe from.</p>
<aside class="quote no-group" data-post="2" data-topic="7647" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><code>spectre-meltdown-checker</code> reports that disabling EPT would mitigate L1TF. EPT can be disabled with <code>kvm-intel.ept=0</code> (I think). Does anyone know more about this?</p>
</blockquote>
</aside>
<p>EPT is the Virtualization hardware solution for safe and fast memory isolation allowing deprecation of shadow page tables done in software for hypervisors You don’t want to disable this.</p>
<aside class="quote no-group" data-post="5" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Whonix KVM: Status? <a class="mention" href="../../../../external.html?link=https://forums.whonix.org/u/hulahoop">@HulaHoop</a></p>
<p>Debian based hosts using security-misc package: <code>auto</code> should do?</p>
</blockquote>
</aside>
<p>Yes everything should be left as is.  It comes as <code>auto</code>  by default. The KVM guest kernel will enforce whenever it detects the necessary microcode extensions are activated.</p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-28T08:34:13Z' class='post-time'>
                January 28, 2020,  8:34am
              </time>
              <meta itemprop='dateModified' content='2020-01-28T08:34:13Z'>
          <span itemprop='position'>#11</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="10" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>EPT is the Virtualization hardware solution for safe and fast memory isolation allowing deprecation of shadow page tables done in software for hypervisors You don’t want to disable this.</p>
</blockquote>
</aside>
<p>Quote <a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html#default-mitigations">https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html#default-mitigations</a></p>
<blockquote>
<p>The kernel does not by default enforce the disabling of SMT, which leaves SMT systems vulnerable when running untrusted guests with EPT enabled.</p>
</blockquote>
<p>Since we disable SMT (<code>mds=full,nosmt</code>) that should be ok?</p>
<p>As per <a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html#smt-control">https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html#smt-control</a> there is also a separate kernel boot parameter <code>nosmt=force</code> which I find confusing. Should we set that as well?</p>
<aside class="quote no-group" data-post="10" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>I really don’t think we should mess with the default spectre/meltdown kernel switches in this case as upstream is clearly aware of the problem and is taking appropriate action. Non defaults will confuse users and might leave them to other attacks they are otherwise safe from.</p>
</blockquote>
</aside>
<aside class="quote no-group" data-post="10" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Yes everything should be left as is. It comes as <code>auto</code> by default.</p>
</blockquote>
</aside>
<p>Let’s please reconsider this. Quote <a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html#default-mitigations">https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html#default-mitigations</a></p>
<blockquote>
<p>The kernel does not by default enforce the disabling of SMT, which leaves SMT systems vulnerable when running untrusted guests with EPT enabled.</p>
</blockquote>
<blockquote>
<p>The administrators of cloud and hosting setups have to carefully analyze the risk for their scenarios and make the appropriate mitigation choices, which might even vary across their deployed machines and also result in other changes of their overall setup. There is no way for the kernel to provide a sensible default for this kind of scenarios.</p>
</blockquote>
<p>My reading of that page is that the kernel developers do not want to set secure defaults for all scenarios due to:</p>
<ul>
<li>the huge degraded performance as well as</li>
<li>breaking existing systems that use unattended upgrades.</li>
</ul>
<p>But we have secure by default development goals and more flexibility of blessing some scenarios “then you need to change back the settings” or unsupported.</p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../whonix-vulerable-due-to-missing-processor-microcode-packages-spectre-meltdown-retpoline-l1-terminal-fault-l1tf/5739/75.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../whonix-vulerable-due-to-missing-processor-microcode-packages-spectre-meltdown-retpoline-l1-terminal-fault-l1tf/5739/75.html'>
                      <span itemprop='name'>Whonix vulerable due to missing processor microcode packages? spectre / meltdown / retpoline / L1 Terminal Fault (L1TF)</span>
                    </a>
                    <meta itemprop='position' content='3'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-28T08:36:50Z' class='post-time'>
                January 28, 2020,  8:36am
              </time>
              <meta itemprop='dateModified' content='2020-01-28T08:36:50Z'>
          <span itemprop='position'>#12</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>
<p>L1TF = L1 Terminal Fault</p>
</blockquote>
<p>Should we set <code>l1tf</code> kernel boot parameter?</p>
<blockquote>
<p>[X86] Control mitigation of the L1TF vulnerability on affected CPUs</p>
</blockquote>
<ul>
<li><a href="../../../../external.html?link=https://unix.stackexchange.com/questions/547433/l1d-unconditional-flushing-should-be-enabled-to-fully-mitigate-the-vulnerability">https://unix.stackexchange.com/questions/547433/l1d-unconditional-flushing-should-be-enabled-to-fully-mitigate-the-vulnerability</a></li>
<li><a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html">https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html</a></li>
</ul>
<p>Need to make sure this doesn’t break any virtualizer at the host or any guest VMs.</p>
<p>This is because currently our security-misc config passes</p>
<pre><code>sudo spectre-meltdown-checker ; echo $?
</code></pre>
<p>but fails</p>
<pre><code>sudo spectre-meltdown-checker --paranoid ; echo $?
</code></pre>
<p>due to</p>
<blockquote>
<p>STATUS:  VULNERABLE  (enable L1D unconditional flushing and disable Hyper-Threading to fully mitigate the vulnerability)</p>
</blockquote>
<p>Setting kernel boot parameter <code>l1tf=full,force</code> fixes that.</p>
<hr>
<aside class="quote quote-modified" data-post="369" data-topic="166">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="../../help-welcome-kvm-development-staying-the-course/166/369.html">[Help Welcome] KVM Development - staying the course</a> <a class="badge-wrapper  bullet" href="../../../c/kvm/11.html"><span class="badge-category-bg" style="background-color: #9EB83B;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Everything specific to Whonix KVM. (devs)">KVM</span></a>
  </div>
  <blockquote>
    <a href="../../kernel-hardening/7296/353.html" class="inline-onebox">Kernel Hardening</a> 


Could you please experiment with kernel boot parameter 
l1tf=full,force

and make sure it doesn’t break KVM hosts or guests?
  </blockquote>
</aside>

        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-28T16:21:22Z' class='post-time'>
                January 28, 2020,  4:21pm
              </time>
              <meta itemprop='dateModified' content='2020-01-28T16:21:22Z'>
          <span itemprop='position'>#13</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>These mitigations are much more important on the host for Host/vm isolation, but are needed for interprocess separation in a VM. If anyone can lookup their status in default debian kernels it would be useful so we know what needs to be enabled in security-misc/documented and so on.</p>
<aside class="quote no-group" data-post="11" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>As per <a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html#smt-control">https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html#smt-control</a> there is also a separate kernel boot parameter <code>nosmt=force</code> which I find confusing. Should we set that as well?</p>
</blockquote>
</aside>
<p>The separate option is to guard against disabling via sysfs. I’d enable it to make things more robust in case of malicious actions in a guest.</p>
<p>One important consideration is to find out if AMD systems are unfairly impacted by these mitigations when they don’t really apply to them. In that case we should turn them on for certain CPU families.</p>
<aside class="quote no-group" data-post="11" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>But we have secure by default development goals and more flexibility of blessing some scenarios “then you need to change back the settings” or unsupported.</p>
</blockquote>
</aside>
<p>Agreed.</p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-28T17:15:31Z' class='post-time'>
                January 28, 2020,  5:15pm
              </time>
              <meta itemprop='dateModified' content='2020-01-28T17:15:31Z'>
          <span itemprop='position'>#14</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="12" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>and disable Hyper-Threading to fully</p>
</blockquote>
</aside>
<p>Without disabling HT the vuln would be there, but I heard HT disabling really cripples system perf.</p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
              split this topic 
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-29T13:33:55Z' class='post-time'>
                January 29, 2020,  1:33pm
              </time>
              <meta itemprop='dateModified' content='2020-01-29T13:33:55Z'>
          <span itemprop='position'>#15</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>A post was merged into an existing topic: <a href="../../whonix-vulerable-due-to-missing-processor-microcode-packages-spectre-meltdown-retpoline-l1-terminal-fault-l1tf/5739/78.html">Whonix vulerable due to missing processor microcode packages? spectre / meltdown / retpoline / L1 Terminal Fault (L1TF)</a></p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-29T13:33:37Z' class='post-time'>
                January 29, 2020,  1:33pm
              </time>
              <meta itemprop='dateModified' content='2020-01-29T13:33:37Z'>
          <span itemprop='position'>#16</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Trying to decode this mostly fluff talk video by Intel on L1TF. Quote <a href="../../../../external.html?link=https://www.youtube.com/watch?v=n_pa2AisRUs">https://www.youtube.com/watch?v=n_pa2AisRUs</a></p>
<blockquote>
<p>in some cases where it can’t be guaranteed that all virtualized operating systems have been updated some customers may choose to take additional actions first and coupled with the l1 cache flush they can ensure that only trusted siblings have access to the same processor core this capability is called core scheduling and is already supported by some hypervisors if course scheduling isn’t available and they suspect there might be potentially untrustworthy sibling sharing access to the l1 cache it may be appropriate to take further action like only allowing one thread to run per core this demonstrates what would happen if SMT were disabled while these actions might be applicable to a relatively small portion of the overall market we think it’s important to provide solutions for all our customers</p>
</blockquote>
<p>Did they really mean “if the microcode, host and guest operating systems is patched, then there is no need to disable SMT”?</p>
<p>In other words, did they really mean “only if guests are not patched it might make sense to pin CPUs to guests and/or to disable SMT”?</p>
<p>Is it true that SMT needs to be disabled when running unpatched guests? A malicious guest using kexec to load a malicious kernel couldn’t read secrets by another VM using the same L1 cache if that other VM was patched?</p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-29T14:47:06Z' class='post-time'>
                January 29, 2020,  2:47pm
              </time>
              <meta itemprop='dateModified' content='2020-01-29T14:47:06Z'>
          <span itemprop='position'>#17</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="HulaHoop" data-post="13" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>One important consideration is to find out if AMD systems are unfairly impacted by these mitigations when they don’t really apply to them. In that case we should turn them on for certain CPU families.</p>
</blockquote>
</aside>
<p>This has to remain future work. While there are many researchers find out more and more attacks and kernel developers invent mitigations, there seems to be a severe shortage of people who are working on analysis tools such as spectre-meltdown-checker or enabling mitigations for as many users as easily as possible. Such as through installation of a package such as security-misc or a distribution such as Kicksecure or Whonix-Host. I am not aware of anyone else working on that currently. There are way too many vulnerabilities, mitigations, use scenarios, processors and therefore resulting combinations which makes this hard to implement.</p>
<p>For start, we could use a wiki table with an overview. Not even sure yet what contents such as table would need. Vulnerabilities, mitigations, use scenarios, processor(s) (families), locally exploitable, remotely exploitable, local information leak, remote information leak (<a href="../../../../external.html?link=https://www.eweek.com/security/netspectre-attack-could-enable-remote-cpu-exploitation">NetSpectre</a>), relevant when using a hypervisor vs not using a hypervisor.</p>
<aside class="quote no-group" data-username="HulaHoop" data-post="14" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Without disabling HT the vuln would be there, but I heard HT disabling really cripples system perf.</p>
</blockquote>
</aside>
<p>Qubes disabled HT.<br>
( <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/5547">https://github.com/QubesOS/qubes-issues/issues/5547</a> )<br>
Performance is OK for me with disabled HT but it’s a powerful machine.</p>
<p>I think we should disable HT. Qubes disables it too.</p>
<p>Quote <a href="../../../../external.html?link=https://coreos.com/os/docs/latest/disabling-smt.html">https://coreos.com/os/docs/latest/disabling-smt.html</a></p>
<blockquote>
<p>Recent Intel CPU vulnerabilities (<a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html">L1TF</a> and <a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/mds.html">MDS</a>) cannot be fully mitigated in software without disabling Simultaneous Multi-Threading.</p>
</blockquote>
<p>Therefore we better disable it.</p>
<blockquote>
<p>This can have a substantial performance impact and is only necessary for certain workloads, so for compatibility reasons, SMT is enabled by default.</p>
</blockquote>
<p>I guess for good security, switch from Windows to a Linux distribution. And I guess for advanced security, use Whonix, Whonix-Host, Kicksecure. For our target user it seems appropriate to disable SMT.</p>
<blockquote>
<p>In addition, the Intel <a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/tsx_async_abort.html">TAA</a> vulnerability cannot be fully mitigated without disabling either of SMT or the Transactional Synchronization Extensions (TSX).</p>
</blockquote>
<blockquote>
<p>SMT and TSX should be disabled on affected Intel processors under the following circumstances:</p>
<ol>
<li>A bare-metal host runs untrusted virtual machines, and <a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html#mitigation-selection-guide">other arrangements</a> have not been made for mitigation.</li>
<li>A bare-metal host runs untrusted code outside a virtual machine.</li>
</ol>
</blockquote>
<p>In our threat model we deem most code untrusted. We don’t want to trust any code but sometimes we have to. That’s why we use linux user account separation and mandatory access controls. Because some code is considered not deliberately malicious (such as the browser) but potentially exploitable (therefore considered untrusted). Therefore I think “runs untrusted code outside a virtual machine” always applies in our threat model.</p>
<p>Otherwise also things would be more complicated.</p>
<ul>
<li><s>Kicksecure users not using a hypervisor: no need to disable SMT</s></li>
<li><s>Whonix host users running VMs: should disable SMT</s></li>
</ul>
<blockquote>
<p>SMT can be conditionally disabled by passing <code>mitigations=auto,nosmt</code> on the kernel command line. This will disable SMT only if required for mitigating a vulnerability. This approach has two caveats:</p>
</blockquote>
<blockquote>
<ol>
<li>It does not protect against unknown vulnerabilities in SMT.</li>
</ol>
</blockquote>
<p>I guess at the quantity and speed at which vulnerabilities are published we again ought to disable SMT here.</p>
<blockquote>
<p>Alternatively, SMT can be unconditionally disabled by passing <code>nosmt</code> on the kernel command line. This provides the most protection and avoids possible behavior changes on upgrades, at the cost of a potentially unnecessary reduction in performance.</p>
</blockquote>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-29T15:04:17Z' class='post-time'>
                January 29, 2020,  3:04pm
              </time>
              <meta itemprop='dateModified' content='2020-01-29T15:04:17Z'>
          <span itemprop='position'>#18</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="17" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>This has to remain future work. While there are many researchers find out more and more attacks and kernel developers invent mitigations, there seems to be a severe shortage of people who are working on analysis tools such as spectre-meltdown-checker or enabling mitigations for as many users as easily as possible.</p>
</blockquote>
</aside>
<p>+1</p>
<hr>
<aside class="quote no-group" data-username="Patrick" data-post="17" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>( <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/5547">https://github.com/QubesOS/qubes-issues/issues/5547</a> )<br>
Performance is OK for me with disabled HT but it’s a powerful machine.</p>
<p>I think we should disable HT. Qubes disables it too.</p>
</blockquote>
</aside>
<p>OK</p>
<hr>
<p>The amount of new bugs that keeps being uncovered is staggering and will make anyone’s head spin:<br>
<a href="../../../../external.html?link=https://www.phoronix.com/scan.php?page=news_item&amp;px=Intel-Two-More-Data-Leakage" class="onebox" target="_blank">https://www.phoronix.com/scan.php?page=news_item&amp;px=Intel-Two-More-Data-Leakage</a></p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-30T05:48:07Z' class='post-time'>
                January 30, 2020,  5:48am
              </time>
              <meta itemprop='dateModified' content='2020-01-30T05:48:07Z'>
          <span itemprop='position'>#19</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/c1a0da60beacd027c1c7c94ae44a9d7b1ab708b9" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/c1a0da60beacd027c1c7c94ae44a9d7b1ab708b9" target="_blank">set kernel boot parameter `l1tf=full,force` and `nosmt=force`</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-01-30" data-time="05:46:48" data-timezone="UTC">05:46AM - 30 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 8 additions and 0 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/c1a0da60beacd027c1c7c94ae44a9d7b1ab708b9" target="_blank">
          <span class="added">+8</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">https://forums.whonix.org/t/should-all-kernel-patches-for-cpu-bugs-be-unconditionally-enabled-vs-performance-vs-applicability/7647/17</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-30T10:56:47Z' class='post-time'>
                January 30, 2020, 10:56am
              </time>
              <meta itemprop='dateModified' content='2020-01-30T10:56:47Z'>
          <span itemprop='position'>#20</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="1" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Should all kernel patches for CPU bugs be unconditionally enabled?</p>
</blockquote>
</aside>
<p>After the recent reconsideration, yes.</p>
<aside class="quote no-group" data-username="madaidan" data-post="1" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Setting <code>spectre_v2=on</code> as a boot parameter will force the spectre v2 mitigation to be enabled.</p>
</blockquote>
</aside>
<p>Seems like a good idea.</p>
<p><a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/spectre.html" class="onebox" target="_blank">https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/spectre.html</a></p>
<blockquote>
<p>High security mode</p>
<p>All Spectre variant 2 mitigations can be forced on at boot time for all programs (See the “on” option in <a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/spectre.html#spectre-mitigation-control-command-line">Mitigation control on the kernel command line</a>). This will add overhead as indirect branch speculations for all programs will be restricted.</p>
</blockquote>
<aside class="quote no-group" data-username="madaidan" data-post="1" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><code>l1tf=full,force</code> will enable all mitigations for the L1TF vulnerability and disable smt (which is already disabled with the mds mitigations).</p>
</blockquote>
</aside>
<p>Done above.</p>
<aside class="quote no-group" data-username="madaidan" data-post="1" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><code>spec_store_bypass_disable=on</code> will enable the SSB vulnerability mitigation (spectre v4).</p>
</blockquote>
</aside>
<p>Using that now.</p>
<hr>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/b9d65338bcc76552e4d2169106cd04e6276eb320" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/b9d65338bcc76552e4d2169106cd04e6276eb320" target="_blank">unconditionally enable all CPU bugs (spectre, meltdown, L1TF, ...)</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-01-30" data-time="10:55:13" data-timezone="UTC">10:55AM - 30 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 8 additions and 0 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/b9d65338bcc76552e4d2169106cd04e6276eb320" target="_blank">
          <span class="added">+8</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">this might reduce performance
* `spectre_v2=on`
* `spec_store_bypass_disable=on`
* `tsx=off`
* `tsx_async_abort=full,nosmt`
Thanks to @madaidan for the suggestion!
https://forums.whonix.org/t/should-all-kernel-patches-for-cpu-bugs-be-unconditionally-enabled-vs-performance-vs-applicability/7647</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Please let me know should any mitigation not be unconditionally enabled yet.</p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-30T20:42:27Z' class='post-time'>
                January 30, 2020,  8:42pm
              </time>
              <meta itemprop='dateModified' content='2020-01-31T14:48:55Z'>
          <span itemprop='position'>#21</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="HulaHoop" data-post="375" data-topic="166">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"><a href="../../help-welcome-kvm-development-staying-the-course/166/375">[Help Welcome] KVM Development - staying the course</a>
</div>
<blockquote>
<p>As an aside it seems the new kernel command turns all mitigations on including disabling SMT. I think it’s more manageable if you switch to using that instead of specifying every knob.</p>
<pre><code class="lang-auto">mitigations=auto,nosmt
</code></pre>
</blockquote>
</aside>
<p>This is an important point. I was wondering about this too. And I could be wrong here. It would be very much desirable to simplify this. However, I think <code>mitigations=auto</code> isn’t the same as <code>mitigations=force</code>, while the latter does not seem to exist yet. This seems like a missing kernel feature but I wasn’t sure it’s worth a feature request.</p>
<p><code>mitigations=auto</code> means “conditionally enable” while <code>mitigations=force</code> would mean “unconditionally enable”.</p>
<p><a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/index.html">https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/index.html</a> and following pages don’t mention <code>mitigations=</code>.</p>
<p>quote <a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/kernel-parameters.html?highlight=kernel%20parameters">https://www.kernel.org/doc/html/latest/admin-guide/kernel-parameters.html?highlight=kernel%20parameters</a></p>
<blockquote>
<p>mitigations=<br>
[X86,PPC,S390,ARM64] Control optional mitigations for<br>
CPU vulnerabilities.  This is a set of curated,<br>
arch-independent options, each of which is an<br>
aggregation of existing arch-specific options.</p>
</blockquote>
<blockquote>
<p>auto (default)</p>
</blockquote>
<p>I.e. auto is already the default. <code>mitigations=auto</code> would essentially do nothing.</p>
<blockquote>
<p>auto,nosmt<br>
Mitigate all CPU vulnerabilities, disabling SMT<br>
if needed.  This is for users who always want to<br>
be fully mitigated, even if it means losing SMT.<br>
Equivalent to: l1tf=flush,nosmt [X86]<br>
mds=full,nosmt [X86]<br>
tsx_async_abort=full,nosmt [X86]</p>
</blockquote>
<p>It does not set <code>l1tf=full,force</code>, <code>nosmt=force</code>, <code>tsx=off</code>, <code>spectre_v2=on</code>, <code>pti=on</code>.</p>
<p><a href="../../../../external.html?link=https://docs.clip-os.org/clipos/kernel.html">https://docs.clip-os.org/clipos/kernel.html</a> writes</p>
<blockquote>
<ul>
<li>
<code>mitigations</code> : This parameter controls optional mitigations for CPU vulnerabilities in an arch-independent and more coarse-grained way. For now, we keep using arch-specific options for the sake of explicitness. Not setting this parameter equals setting it to <code>auto</code> , which itself does not update anything.</li>
</ul>
</blockquote>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../help-welcome-kvm-development-staying-the-course/166/376.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../help-welcome-kvm-development-staying-the-course/166/376.html'>
                      <span itemprop='name'>[Help Welcome] KVM Development - staying the course</span>
                    </a>
                    <meta itemprop='position' content='5'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-31T17:15:34Z' class='post-time'>
                January 31, 2020,  5:15pm
              </time>
              <meta itemprop='dateModified' content='2020-01-31T17:15:34Z'>
          <span itemprop='position'>#22</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I don’t see any point in forcing these to be enabled. The kernel will automatically detect if the CPU is vulnerable and if it is, will enable the mitigations. If it isn’t vulnerable, it won’t enable the mitigations but that doesn’t matter since they aren’t needed.</p>
<p>Debian disables TSX by default with <code>CONFIG_X86_INTEL_TSX_MODE_OFF=y</code> but I guess the <code>tsx=off</code> parameter is useful for kernels with it enabled by default.</p>
<p><code>nosmt=force</code> is redundant. We already disable SMT with <code>mds=full,nosmt</code>.</p>
<p><code>tsx_async_abort=full,nosmt</code> is redundant as TSX is already disabled.</p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-02-01T14:06:26Z' class='post-time'>
                February 1, 2020,  2:06pm
              </time>
              <meta itemprop='dateModified' content='2020-02-01T14:06:26Z'>
          <span itemprop='position'>#23</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="22" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>I don’t see any point in forcing these to be enabled.</p>
</blockquote>
</aside>
<p>Which ones? All recent ones or only the ones mentioned in your last post?</p>
<aside class="quote no-group" data-username="madaidan" data-post="22" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Debian disables TSX by default with <code>CONFIG_X86_INTEL_TSX_MODE_OFF=y</code> but I guess the <code>tsx=off</code> parameter is useful for kernels with it enabled by default.</p>
</blockquote>
</aside>
<p>Yes.</p>
<aside class="quote no-group" data-username="madaidan" data-post="22" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><code>nosmt=force</code> is redundant. We already disable SMT with <code>mds=full,nosmt</code> .</p>
</blockquote>
</aside>
<p><code>mds=full,nosmt</code> does not make that redundant.<br>
Though, <code>l1tf=full,force</code> makes it redundant.</p>
<p><code>l1tf=full,force</code> <a href="../../../../external.html?link=https://www.kernel.org/doc/Documentation/admin-guide/kernel-parameters.txt">https://www.kernel.org/doc/Documentation/admin-guide/kernel-parameters.txt</a> says</p>
<blockquote>
<p>Implies the ‘nosmt=force’ command line option. (i.e. sysfs control of SMT is disabled.)</p>
</blockquote>
<p><code>mds=full,nosmt</code> does not say “Implies the ‘nosmt=force’”.</p>
<p>The reason why I am interested in <code>nosmt=force</code> is:</p>
<blockquote>
<p>Force disable SMT, cannot be undone via the sysfs control file.</p>
</blockquote>
<p>Which seems useful at least for purposes of <a href="../../untrusted-root-improve-security-by-restricting-root/7998.html" class="inline-onebox">Untrusted Root - improve Security by Restricting Root</a>.</p>
<aside class="quote no-group" data-username="madaidan" data-post="22" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><code>tsx_async_abort=full,nosmt</code> is redundant as TSX is already disabled.</p>
</blockquote>
</aside>
<p>I see your point. But I am not sure.</p>
<p>As per <a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/tsx_async_abort.html">https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/tsx_async_abort.html</a> here are some possible combinations (these are listed in a table on that page):</p>
<hr>
<ul>
<li>tsx=on</li>
<li>tsx_async_abort=full,nosmt</li>
<li>As above, cross-thread attacks on SMT mitigated.</li>
</ul>
<hr>
<ul>
<li>tsx=off</li>
<li>tsx_async_abort=full,nosmt</li>
<li>TSX might be disabled if microcode provides a TSX control MSR. If so, system is not vulnerable.</li>
</ul>
<hr>
<p>What also confuses me:</p>
<blockquote>
<p>Default mitigations</p>
<p>The kernel’s default action for vulnerable processors is:</p>
<p>Deploy TSX disable mitigation (tsx_async_abort=full tsx=off).</p>
</blockquote>
<p>A combination of tsx=off and tsx_async_abort=full.</p>
<p>Why didn’t they write simpler:</p>
<blockquote>
<p>Deploy TSX disable mitigation (tsx=off).</p>
</blockquote>
<p>Therefore perhaps better to keep  <code>tsx_async_abort=full,nosmt</code>?</p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
              split this topic 
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-02-02T07:47:13Z' class='post-time'>
                February 2, 2020,  7:47am
              </time>
              <meta itemprop='dateModified' content='2020-02-02T07:47:13Z'>
          <span itemprop='position'>#24</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>3 posts were merged into an existing topic: <a href="../../whonix-vulerable-due-to-missing-processor-microcode-packages-spectre-meltdown-retpoline-l1-terminal-fault-l1tf/5739/81.html">Whonix vulerable due to missing processor microcode packages? spectre / meltdown / retpoline / L1 Terminal Fault (L1TF)</a></p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-02-05T21:42:11Z' class='post-time'>
                February 5, 2020,  9:42pm
              </time>
              <meta itemprop='dateModified' content='2020-02-05T21:42:11Z'>
          <span itemprop='position'>#25</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="23" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Which ones? All recent ones or only the ones mentioned in your last post?</p>
</blockquote>
</aside>
<p>All except maybe <code>tsx=off</code>.</p>
<aside class="quote no-group" data-username="Patrick" data-post="23" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p><code>mds=full,nosmt</code> does not say “Implies the ‘nosmt=force’”.</p>
</blockquote>
</aside>
<p><code>mds=full,nosmt</code>:</p>
<blockquote>
<p>full,nosmt - Enable MDS mitigation and disable SMT on vulnerable CPUs</p>
</blockquote>
<p><code>nosmt=force</code>:</p>
<blockquote>
<p>nosmt=force: Force disable SMT, cannot be undone via the sysfs control file.</p>
</blockquote>
<p>They both do essentially the same thing. <code>mds=full,nosmt</code> can’t be undone via sysfs either.</p>
<pre><code class="lang-auto">user@host:~$ cat /sys/devices/system/cpu/smt/control
notsupported
</code></pre>
<aside class="quote no-group" data-username="Patrick" data-post="23" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I see your point. But I am not sure.</p>
</blockquote>
</aside>
<p>My interpretation of the docs is using <code>tsx=off</code> and <code>tsx_async_abort=full,nosmt</code> together will only disable TSX <strong>if the mitigation isn’t available</strong>. Just using <code>tsx=off</code> should disable TSX regardless.</p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-02-06T10:16:06Z' class='post-time'>
                February 6, 2020, 10:16am
              </time>
              <meta itemprop='dateModified' content='2020-02-06T10:16:06Z'>
          <span itemprop='position'>#26</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="25" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>All except maybe <code>tsx=off</code> .</p>
</blockquote>
</aside>
<p>I might still misinterpret that. Please send a pull request since I guess that is easier than trying to ask/explain it.</p>
<hr>
<p>Intuition tells me that</p>
<ul>
<li>if <code>tsx=off</code> is set, i.e. if tsx is disabled anyhow, there is no need for <code>tsx_async_abort=full</code>.</li>
<li>but on the other hand if <code>tsx=off</code> is set anyhow, <code>tsx_async_abort=full</code> is superfluous and shouldn’t do harm. Therefore in doubt, set it.</li>
</ul>
<p>However, quote <a href="../../../../external.html?link=https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/tsx_async_abort.html">https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/tsx_async_abort.html</a> contradicts my intuition:</p>
<blockquote>
<p>Default mitigations<br>
The kernel’s default action for vulnerable processors is:<br>
Deploy TSX disable mitigation (tsx_async_abort=full tsx=off).</p>
</blockquote>
<p>Therefore I interpret <code>tsx_async_abort=full tsx=off</code> as a valid, sensible, non-illogical option. Switching <code>tsx_async_abort=full</code> to <code>tsx_async_abort=full,nosmt</code> is just an extension of that.</p>
<p>The kernel’s default action for vulnerable processors is <code>tsx_async_abort=full tsx=off</code>. Therefore I concluded to set <code>tsx_async_abort=full tsx=off</code> regardless to reach goal of unconditionally enabling mitigation seven if the processor not detected as vulnerable. [Plus add <code>,nosmt</code>.]</p>
<p>I guess we’ll get only higher certainty on that by asking the kernel developers and/or reading the kernel source code.</p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-02-07T16:26:20Z' class='post-time'>
                February 7, 2020,  4:26pm
              </time>
              <meta itemprop='dateModified' content='2020-02-07T16:26:20Z'>
          <span itemprop='position'>#27</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="26" data-topic="7647">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>but on the other hand if <code>tsx=off</code> is set anyhow, <code>tsx_async_abort=full</code> is superfluous and shouldn’t do harm. Therefore in doubt, set it.</p>
</blockquote>
</aside>
<p>No.</p>
<blockquote>
<p>My interpretation of the docs is using <code>tsx=off</code> and <code>tsx_async_abort=full,nosmt</code> together will only disable TSX <strong>if the mitigation isn’t available</strong> . Just using <code>tsx=off</code> should disable TSX regardless.</p>
</blockquote>
<p>Using <code>tsx_async_abort=full</code> along with <code>tsx=off</code> will still enable TSX which can leave us open to 0days the mitigation doesn’t prevent.</p>
<p>Just using <code>tsx=off</code> should leave TSX always disabled and protect us from all TSX vulnerabilities.</p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-02-08T10:23:18Z' class='post-time'>
                February 8, 2020, 10:23am
              </time>
              <meta itemprop='dateModified' content='2020-02-08T10:23:18Z'>
          <span itemprop='position'>#28</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Could you please look this up in the kernel source code?</p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7647.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-02-11T20:10:10Z' class='post-time'>
                February 11, 2020,  8:10pm
              </time>
              <meta itemprop='dateModified' content='2020-02-11T20:10:10Z'>
          <span itemprop='position'>#29</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="28" data-topic="7647" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Could you please look this up in the kernel source code?</p>
</blockquote>
</aside>
<p>I couldn’t find anything.</p>
<p>I think we should just leave all CPU mitigation things to the kernel default as it automatically enables needed mitigations if the device is vulnerable.</p>
        </div>

        <meta itemprop='headline' content='Should all kernel patches for CPU bugs be unconditionally enabled? Vs Performance vs Applicability'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><b><a rel="next" itemprop="url" href="../76474658.html?page=2">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

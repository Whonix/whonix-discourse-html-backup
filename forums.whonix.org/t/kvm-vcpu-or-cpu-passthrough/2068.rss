<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>KVM, vcpu or cpu-passthrough</title>
    <link>http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068</link>
    <description>The Tor process on Whonix-Gateway machine is using a lot of CPU under load and its slow, the reason seems to be that there is no AES passed to the KVM guest.

I changed from vcpu to a cpu host-passthrough like this in the Whonix-Gateway xml file

  &lt;cpu mode=&#39;host-passthrough&#39;&gt;
    &lt;topology sockets=&#39;1&#39; cores=&#39;2&#39; threads=&#39;1&#39;/&gt;
  &lt;/cpu&gt; 

Checking /proc/cpuinfo now shows AES and alot of other features and Tor uses around 2-3% at max.

Are there any reasons that it uses vcpu as default? Is it bad to pass AES to the guest?
Now that the hosts cpu is directly passed to the guest there are a lot more cpu features added, could one of these be exploited if a guest would be hacked? Maybe find serial number of the CPU and identify who bought it ?</description>
    <language>en</language>
    <lastBuildDate>Sat, 06 Feb 2016 20:55:00 +0000</lastBuildDate>
    <category>KVM</category>
    <atom:link href="http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>KVM, vcpu or cpu-passthrough</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Did some tests and it seems its a bug where the virtualization instruction is included in the cpumask. In newer versions of qemu the virtual cpu does not touch virtualization instructions fo either architecture and enables them by default and so resolves this.</p>
<p><a href="https://bbs.archlinux.org/viewtopic.php?id=182142" class="onebox" target="_blank">https://bbs.archlinux.org/viewtopic.php?id=182142</a></p>
<p>Thanks for the bug report. The line will be added for compatibility until qemu for stable is updated.</p>
          <p><a href="http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068/8</link>
        <pubDate>Sat, 06 Feb 2016 20:55:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2068-8</guid>
        <source url="http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068.rss">KVM, vcpu or cpu-passthrough</source>
      </item>
      <item>
        <title>KVM, vcpu or cpu-passthrough</title>
        <dc:creator><![CDATA[yesbox]]></dc:creator>
        <description><![CDATA[
            <p>Thank you! I followed your instructions but was getting this error when creating the machine from the new xml:</p>
<p>error: unsupported configuration: guest and host CPU are not compatible: Host CPU does not provide required features: svm</p>
<p>SVM seems to be a AMD only feature, so i disabled it with this line:<br>
&lt; feature policy=‘disable’ name=‘svm’/ &gt;</p>
          <p><a href="http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068/5</link>
        <pubDate>Sat, 06 Feb 2016 12:23:58 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2068-5</guid>
        <source url="http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068.rss">KVM, vcpu or cpu-passthrough</source>
      </item>
      <item>
        <title>KVM, vcpu or cpu-passthrough</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Add the cpumode chunk to your guest’s xml file from:</p>
<p>honix-libvirt/blob/master/usr/share/whonix-libvirt/xml/Whonix-Workstation.xml</p>
          <p><a href="http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068/4</link>
        <pubDate>Fri, 05 Feb 2016 05:51:43 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2068-4</guid>
        <source url="http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068.rss">KVM, vcpu or cpu-passthrough</source>
      </item>
      <item>
        <title>KVM, vcpu or cpu-passthrough</title>
        <dc:creator><![CDATA[yesbox]]></dc:creator>
        <description><![CDATA[
            <p>Ok, sounds good. What changes did you make to add AES to the guest? Maybe i can change it manually on my guests instead of giving them the whole CPU? Or is there a beta download of Whonix 13 i can check out?</p>
          <p><a href="http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068/3</link>
        <pubDate>Thu, 04 Feb 2016 05:40:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2068-3</guid>
        <source url="http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068.rss">KVM, vcpu or cpu-passthrough</source>
      </item>
      <item>
        <title>KVM, vcpu or cpu-passthrough</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <blockquote>
<p>Are there any reasons that it uses vcpu as default? Is it bad to pass AES to the guest?</p>
</blockquote>
<p>The vpcu masks out a lot of details about the host cpu that could leak information to an adversary that manages to take over your vm. No its not bad to pass through the AES instruction its one of the changes I added some time ago and will be available with Whonix 13.</p>
          <p><a href="http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068/2</link>
        <pubDate>Thu, 04 Feb 2016 04:37:56 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2068-2</guid>
        <source url="http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068.rss">KVM, vcpu or cpu-passthrough</source>
      </item>
      <item>
        <title>KVM, vcpu or cpu-passthrough</title>
        <dc:creator><![CDATA[yesbox]]></dc:creator>
        <description><![CDATA[
            <p>The Tor process on Whonix-Gateway machine is using a lot of CPU under load and its slow, the reason seems to be that there is no AES passed to the KVM guest.</p>
<p>I changed from vcpu to a cpu host-passthrough like this in the Whonix-Gateway xml file</p>
  
    
   
<p>Checking /proc/cpuinfo now shows AES and alot of other features and Tor uses around 2-3% at max.</p>
<p>Are there any reasons that it uses vcpu as default? Is it bad to pass AES to the guest?<br>
Now that the hosts cpu is directly passed to the guest there are a lot more cpu features added, could one of these be exploited if a guest would be hacked? Maybe find serial number of the CPU and identify who bought it ?</p>
          <p><a href="http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068/1</link>
        <pubDate>Wed, 03 Feb 2016 20:47:19 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2068-1</guid>
        <source url="http://forums.whonix.org/t/kvm-vcpu-or-cpu-passthrough/2068.rss">KVM, vcpu or cpu-passthrough</source>
      </item>
  </channel>
</rss>

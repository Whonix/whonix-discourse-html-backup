<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Shared Folder does not work with Kicksecure</title>
    <link>http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058</link>
    <description>I have a following question: after I&#39;ve distro-morphed my debian host into Kicksecure I cannot start Whonix WS with KVM anymore. The reason is the shared folder: &quot;failed to open &#39;/home/user/shared&#39;: Permission denied&quot;. Whonix WS can be started after removing the shared Filesystem. Permission was set as required: chmod 777 /home/user/shared. 
Any suggestions?

Does anyone successfully use Kicksecure as a Host + Shared Folder with  Whonix WS / KVM?

Here is a complete error message:


Error starting domain: internal error: qemu unexpectedly closed the monitor: 2021-08-02T19:29:55.777651Z qemu-system-x86_64: -device virtio-9p-pci,id=fs0,fsdev=fsdev-fs0,mount_tag=shared,bus=pci.0,addr=0x8: cannot initialize fsdev &#39;fsdev-fs0&#39;: failed to open &#39;/home/user/shared&#39;: Permission denied

Traceback (most recent call last):
  File &quot;/usr/share/virt-manager/virtManager/asyncjob.py&quot;, line 75, in cb_wrapper
    callback(asyncjob, *args, **kwargs)
  File &quot;/usr/share/virt-manager/virtManager/asyncjob.py&quot;, line 111, in tmpcb
    callback(*args, **kwargs)
  File &quot;/usr/share/virt-manager/virtManager/libvirtobject.py&quot;, line 66, in newfn
    ret = fn(self, *args, **kwargs)
  File &quot;/usr/share/virt-manager/virtManager/domain.py&quot;, line 1400, in startup
    self._backend.create()
  File &quot;/usr/lib/python3/dist-packages/libvirt.py&quot;, line 1080, in create
    if ret == -1: raise libvirtError (&#39;virDomainCreate() failed&#39;, dom=self)
libvirt.libvirtError: internal error: qemu unexpectedly closed the monitor: 2021-08-02T19:29:55.777651Z qemu-system-x86_64: -device virtio-9p-pci,id=fs0,fsdev=fsdev-fs0,mount_tag=shared,bus=pci.0,addr=0x8: cannot initialize fsdev &#39;fsdev-fs0&#39;: failed to open &#39;/home/user/shared&#39;: Permission denied</description>
    <language>en</language>
    <lastBuildDate>Fri, 06 Aug 2021 15:55:26 +0000</lastBuildDate>
    <category>KVM</category>
    <atom:link href="http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Shared Folder does not work with Kicksecure</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p><code>/usr/lib/security-misc/permission-lockdown</code> runs:</p>
<pre><code>chmod o-rwx /home/user
</code></pre>
<p>chmod <code>others</code> (<code>o</code>) remove (<code>-</code>) permissions:</p>
<ul>
<li>read (<code>r</code>)</li>
<li>write (<code>w</code>)</li>
<li>execute (<code>x</code>) (<a href="https://superuser.com/questions/168578/why-must-a-folder-be-executable/169418" class="inline-onebox">linux - Why must a folder be executable? - Super User</a>)</li>
</ul>
<p>Which is very important for meaningful user separation.</p>
<p>Whonix KVM shared folder needs a cleaner solution. Putting it in user home folder <code>/home/user/shared</code> is unclean. Mentioned here:</p>
<aside class="quote quote-modified" data-post="442" data-topic="166">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="https://forums.whonix.org/t/help-welcome-kvm-development-staying-the-course/166/442">[Help Welcome] KVM Development - staying the course</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/kvm/11"><span class="badge-category-bg" style="background-color: #9EB83B;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Everything specific to Whonix KVM. (devs)">KVM</span></a>
  </div>
  <blockquote>
    <a href="https://forums.whonix.org/t/issue-creating-shared-directory-between-host-and-guest/11245" class="inline-onebox">Issue creating shared directory between host and guest</a> reminds me… chmod 777 /home/user/shared isn’t a great. Security issue and usability issue. 
As per <a href="https://chmod-calculator.com/">https://chmod-calculator.com/</a> 777 allow public (i.e. any linux user account including those not having business there on the system) to read, write, execute files from that folder. 
Is there some more canonical way to set up shared folders with KVM? 
[1] Under which user is KVM attempting to write to shared folders? 
[1] Under which group is KV…
  </blockquote>
</aside>

          <p><a href="http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058/6</link>
        <pubDate>Fri, 06 Aug 2021 15:55:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12058-6</guid>
        <source url="http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058.rss">Shared Folder does not work with Kicksecure</source>
      </item>
      <item>
        <title>Shared Folder does not work with Kicksecure</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>I think Kicksecure tightens directory permissions more than the  plain Debian and that would interfere with shared folder permissions<br>
cc/ <a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a></p>
          <p><a href="http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058/5</link>
        <pubDate>Fri, 06 Aug 2021 02:09:48 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12058-5</guid>
        <source url="http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058.rss">Shared Folder does not work with Kicksecure</source>
      </item>
      <item>
        <title>Shared Folder does not work with Kicksecure</title>
        <dc:creator><![CDATA[daxbereni]]></dc:creator>
        <description><![CDATA[
            <p>No, I did not enable SELinux.<br>
I’ve started with the standard Debian 10 Buster and shared folder worked just fine.<br>
After that I’ve converted Debian into Kicksecure as described here: /wiki/Kicksecure/Debian<br>
After that Whonix Workstation could not be started anymore.<br>
If I remove shared Filesystem I can use Workstation again, but re-enabling the shared Filesystem makes Whonix Workstation unusable again.</p>
          <p><a href="http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058/4</link>
        <pubDate>Wed, 04 Aug 2021 20:27:32 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12058-4</guid>
        <source url="http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058.rss">Shared Folder does not work with Kicksecure</source>
      </item>
      <item>
        <title>Shared Folder does not work with Kicksecure</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Are you running a distro with SELinux enabled?</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://aws1.discourse-cdn.com/business4/uploads/askfedora/optimized/2X/8/8e97dccbf4e32dc81e9a47240ba241159f50bd9e_2_32x32.png" class="site-icon" width="32" height="32">

      <a href="https://ask.fedoraproject.org/t/unable-to-share-folder-with-virt-manager-qemu/2580/14" target="_blank" rel="noopener" title="02:38PM - 23 July 2019">Ask Fedora – 23 Jul 19</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/362;"><img src="https://aws1.discourse-cdn.com/business4/uploads/askfedora/original/2X/c/cf161822e29520f74e3e0dd71d40aacd83bf9ade.png" class="thumbnail" width="690" height="362"></div>

<h3><a href="https://ask.fedoraproject.org/t/unable-to-share-folder-with-virt-manager-qemu/2580/14" target="_blank" rel="noopener">Unable to share folder with virt-manager/qemu</a></h3>

  <p>getfacl $HOME</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058/3</link>
        <pubDate>Wed, 04 Aug 2021 03:14:10 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12058-3</guid>
        <source url="http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058.rss">Shared Folder does not work with Kicksecure</source>
      </item>
      <item>
        <title>Shared Folder does not work with Kicksecure</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Consider this one until/if someone gets around it:</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">

      <a href="https://www.whonix.org/wiki/Unspecific" target="_blank" rel="noopener" title="01:00PM - 19 July 2021">Whonix – 19 Jul 21</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:110/58;"><img src="https://www.whonix.org/w/images/4/47/Whonix_Facebook_Social_Share.png" class="thumbnail" width="110" height="58"></div>

<h3><a href="https://www.whonix.org/wiki/Unspecific" target="_blank" rel="noopener">Information Booster might be Available!</a></h3>

  <p>Learn how other resources might be helpful since this is mostly unspecific to Whonix ™.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058/2</link>
        <pubDate>Mon, 02 Aug 2021 20:33:12 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12058-2</guid>
        <source url="http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058.rss">Shared Folder does not work with Kicksecure</source>
      </item>
      <item>
        <title>Shared Folder does not work with Kicksecure</title>
        <dc:creator><![CDATA[daxbereni]]></dc:creator>
        <description><![CDATA[
            <p>I have a following question: after I’ve distro-morphed my debian host into Kicksecure I cannot start Whonix WS with KVM anymore. The reason is the shared folder: “failed to open ‘/home/user/shared’: Permission denied”. Whonix WS can be started after removing the shared Filesystem. Permission was set as required: chmod 777 /home/user/shared.<br>
Any suggestions?</p>
<p>Does anyone successfully use Kicksecure as a Host + Shared Folder with  Whonix WS / KVM?</p>
<p>Here is a complete error message:</p>
<p>Error starting domain: internal error: qemu unexpectedly closed the monitor: 2021-08-02T19:29:55.777651Z qemu-system-x86_64: -device virtio-9p-pci,id=fs0,fsdev=fsdev-fs0,mount_tag=shared,bus=pci.0,addr=0x8: cannot initialize fsdev ‘fsdev-fs0’: failed to open ‘/home/user/shared’: Permission denied</p>
<p>Traceback (most recent call last):<br>
File “/usr/share/virt-manager/virtManager/asyncjob.py”, line 75, in cb_wrapper<br>
callback(asyncjob, *args, **kwargs)<br>
File “/usr/share/virt-manager/virtManager/asyncjob.py”, line 111, in tmpcb<br>
callback(*args, **kwargs)<br>
File “/usr/share/virt-manager/virtManager/libvirtobject.py”, line 66, in newfn<br>
ret = fn(self, *args, **kwargs)<br>
File “/usr/share/virt-manager/virtManager/domain.py”, line 1400, in startup<br>
self._backend.create()<br>
File “/usr/lib/python3/dist-packages/libvirt.py”, line 1080, in create<br>
if ret == -1: raise libvirtError (‘virDomainCreate() failed’, dom=self)<br>
libvirt.libvirtError: internal error: qemu unexpectedly closed the monitor: 2021-08-02T19:29:55.777651Z qemu-system-x86_64: -device virtio-9p-pci,id=fs0,fsdev=fsdev-fs0,mount_tag=shared,bus=pci.0,addr=0x8: cannot initialize fsdev ‘fsdev-fs0’: failed to open ‘/home/user/shared’: Permission denied</p>
          <p><a href="http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058/1</link>
        <pubDate>Mon, 02 Aug 2021 20:26:18 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-12058-1</guid>
        <source url="http://forums.whonix.org/t/shared-folder-does-not-work-with-kicksecure/12058.rss">Shared Folder does not work with Kicksecure</source>
      </item>
  </channel>
</rss>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Qubes DispVM technical discussion - #3 by entr0py - Qubes-Whonix - Whonix Forum</title>
    <meta name="description" content="For a better understanding on DispVMs, today and future. First interesting read...">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../3232.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Qubes DispVM technical discussion&#39;" href="../3232.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/qubes-dispvm-technical-discussion/3232/3" />
<meta name="twitter:url" content="https://forums.whonix.org/t/qubes-dispvm-technical-discussion/3232/3" />
<meta property="og:title" content="Qubes DispVM technical discussion" />
<meta name="twitter:title" content="Qubes DispVM technical discussion" />
<meta property="og:description" content="Wow, what a mess. I started writing wiki. You never realize how messy something is until you have to explain it to someone else…    I think proper term for dvm is savefile but I’d like to just call it a “dispVM template” because people have a better idea what a template is - this is nothing like any savefile that most people are used to. Although “templateVM” and “dispVM template” could be confusing also.    If /home/user/.qubes-dispvm-customized is present, does that mean that any file that is ..." />
<meta name="twitter:description" content="Wow, what a mess. I started writing wiki. You never realize how messy something is until you have to explain it to someone else…    I think proper term for dvm is savefile but I’d like to just call it a “dispVM template” because people have a better idea what a template is - this is nothing like any savefile that most people are used to. Although “templateVM” and “dispVM template” could be confusing also.    If /home/user/.qubes-dispvm-customized is present, does that mean that any file that is ..." />
<meta property="article:published_time" content="2016-12-04T08:23:50+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="next" href="../32324658.html?page=2">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../3232.html">Qubes DispVM technical discussion</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/qubes-whonix/12.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #63a0ff'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Qubes-Whonix</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-03T16:24:17Z' class='post-time'>
                December 3, 2016,  4:24pm
              </time>
              <meta itemprop='dateModified' content='2016-12-03T16:24:17Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>For a better understanding on DispVMs, today and future. First interesting read…</p>
<aside class="onebox githubissue">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/1335" target="_blank" rel="nofollow noopener">github.com/QubesOS/qubes-issues</a>
  </header>
  <article class="onebox-body">
    <a href="../../../../external.html?link=https://github.com/adrelanos" rel="nofollow noopener">
<img src="../../../../external.html?link=https://avatars1.githubusercontent.com/u/1985040?v=2&amp;s=96" class="thumbnail onebox-avatar" width="96" height="96">
</a>

<h4><a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/1335" target="_blank" rel="nofollow noopener">Issue: home folder of template not inherited by DispVM</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
	on <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/1335" target="_blank" rel="nofollow noopener">2015-10-14</a>
	</div>
	<div class="user">
	closed by <a href="../../../../external.html?link=https://github.com/marmarek" target="_blank" rel="nofollow noopener">marmarek</a>
	on <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/1335" target="_blank" rel="nofollow noopener">2017-10-23</a>
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">Qubes generally:
When one creates a TemplateBased-VM, its home folder, originally is inherited from the TemplateVM it is based upon. From then,...</pre>

<div class="labels">
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">C: core</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">P: major</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">enhancement</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">release-notes</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../long-wiki-edits-thread/3477/104.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../long-wiki-edits-thread/3477/104.html'>
                      <span itemprop='name'>Long Wiki Edits Thread</span>
                    </a>
                    <meta itemprop='position' content='4'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../long-wiki-edits-thread/3477/705.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../long-wiki-edits-thread/3477/705.html'>
                      <span itemprop='name'>Long Wiki Edits Thread</span>
                    </a>
                    <meta itemprop='position' content='5'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../long-wiki-edits-thread/3477/105.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../long-wiki-edits-thread/3477/105.html'>
                      <span itemprop='name'>Long Wiki Edits Thread</span>
                    </a>
                    <meta itemprop='position' content='6'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-03T17:55:18Z' class='post-time'>
                December 3, 2016,  5:55pm
              </time>
              <meta itemprop='dateModified' content='2016-12-03T17:55:18Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubissue">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2468#issuecomment-264597089" target="_blank" rel="nofollow noopener">github.com/QubesOS/qubes-issues</a>
  </header>
  <article class="onebox-body">
    <a href="../../../../external.html?link=https://github.com/andrewclausen" rel="nofollow noopener">
<img src="../../../../external.html?link=https://avatars1.githubusercontent.com/u/8624424?v=2&amp;s=96" class="thumbnail onebox-avatar" width="96" height="96">
</a>

<h4><a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2468#issuecomment-264597089" target="_blank" rel="nofollow noopener">Issue: Documentation for template upgrade should recommend qvm-create-default-dvm</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="../../../../external.html?link=https://github.com/andrewclausen" target="_blank" rel="nofollow noopener">andrewclausen</a>
	on <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2468#issuecomment-264597089" target="_blank" rel="nofollow noopener">2016-11-30</a>
	</div>
	<div class="user">
	closed by <a href="../../../../external.html?link=https://github.com/andrewdavidwong" target="_blank" rel="nofollow noopener">andrewdavidwong</a>
	on <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2468#issuecomment-264597089" target="_blank" rel="nofollow noopener">2016-12-01</a>
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">Qubes OS version:
R3.2
Affected TemplateVMs:
all
Summary:
The documentation for upgrading template VMs ought to recommend using the new template for disposable VMs using qvm-create-default-dvm.
Details:
When...</pre>

<div class="labels">
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">C: doc</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">enhancement</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/entr0py'><span itemprop='name'>entr0py</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-04T08:23:50Z' class='post-time'>
                December 4, 2016,  8:23am
              </time>
              <meta itemprop='dateModified' content='2016-12-04T08:23:50Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Wow, what a mess. I started writing wiki. You never realize how messy something is until you have to explain it to someone else…</p>
<ol>
<li>
<p>I think proper term for dvm is savefile but I’d like to just call it a “dispVM template” because people have a better idea what a template is - this is nothing like any savefile that most people are used to. Although “templateVM” and “dispVM template” could be confusing also.</p>
</li>
<li>
<p>If <code>/home/user/.qubes-dispvm-customized</code> is present, does that mean that <strong>any file</strong> that is different from the underlying templateVM will be preserved? Or only files in certain directories? If the templateVM gets a package update that changes a file that has been customized by the user, which version will it keep?</p>
</li>
<li>
<p>I just realized I’m making guesses on some things I’ve written because I can’t test them myself without disrupting my own dispVM template. I actually only <strong>know</strong> one way to update Tor Browser in a dispVM - the way I do it. launch torbrowser in dvm-template, use tb internal updater, then qvm-create-default-dvm. I need to know what happens in the following situation:</p>
</li>
</ol>
<p>~ user creates new dispVM template.<br>
~ <code>first-boot-home-population</code> will copy TBB to /home/user/.tb<br>
~ and touch <code>first-boot-home-population.done</code><br>
~ the .done file is inherited by new dispVMs so TBB is not copied for each individual dispVM</p>
<p>~ now new version of TBB is released and tb-updater is updated in whonix-ws<br>
~ but no changes will be made to dispVM template</p>
<p>~ now user runs qvm-create-default-dvm whonix-ws<br>
~ since <code>.qubes-dispvm-customized</code> is not present, the existing TBB &amp; .done file are discarded and a new dispVM template is created<br>
~ repeat from the top and new dispVM template has new TBB</p>
<p>Correct?</p>
<p>And this doesn’t work for users that have customized dispVM template, because the .done file persists and whonix-ws will not copy over the new TBB.</p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/torjunkie'><span itemprop='name'>torjunkie</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-04T13:27:08Z' class='post-time'>
                December 4, 2016,  1:27pm
              </time>
              <meta itemprop='dateModified' content='2016-12-04T13:27:08Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>OK, fun and games!</p>
<p>Based on all this technical information and much confusion, I have a draft for wiki entries below. This allows for Qubes-Whonix users to either:</p>
<p>a) install a standard dispVM Whonix-WS template;<br>
b) install an optional dispVM Whonix-WS template with hardcoded changes for the hardened Tor Browser;<br>
c) steps to create a customized dispVM Whonix-WS; and<br>
d) steps to maintain dispVM images so the Tor Browser is up-to-date, whether it is the standard or hardcoded version.</p>
<p>Correct my text where I’m wrong - which I surely will be. <img src="../../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>I’ve just tested this procedure for the hardcoded (hardened) Tor Browser and customized dispVM changes, and it works fine <strong>except customized changes are never maintained.</strong></p>
<p>It doesn’t matter if I run the touch command before or after using the Tor Browser, any changes are not maintained. Can someone in Qubes 3.2 please try it and see if it works for you.</p>
<p>There is no reason it should work for entr0py in 3.1, and not work in 3.2.</p>
<p>Below, I have just focused on steps required i.e. ‘do this’, ‘then do this’, because most users simply don’t care about the technical reasons involved, they just want a working solution.</p>
<p><strong>Initial creation of the dispVM (Whonix-WS) in Qubes 3.2</strong></p>
<p>Note: existing dispVMs will be based on the Fedora-23 or Fedora-24 template</p>
<p><strong>1) Delete any existing instances of your dispVM</strong></p>
<blockquote>
<p>Qubes VM Manager -&gt; View -&gt; Show/Hide Internal VMs</p>
</blockquote>
<blockquote>
<p>Right click on the template ending in “-dvm”</p>
</blockquote>
<blockquote>
<p>Select “Remove VM”</p>
</blockquote>
<p><strong>2) OPTIONAL STEP - For users defaulting to the hardened Tor Browser series only</strong></p>
<p>Note: Hardcoding of the tb-updater version is required</p>
<p>Special note for hardened Tor Browser users: Using this method means the user will potentially be at risk for a day or two following a Tor Browser security update. The alpha updates always come later than the stable release.</p>
<p>A) Open Konsole in the Whonix-WS TemplateVM</p>
<blockquote>
<p>Left click on Qubes 3.2 ‘Q’ icon -&gt; Select Template: whonix-ws -&gt; Select Konsole</p>
</blockquote>
<p>B) Create a user configuration file</p>
<p>Whonix 13:</p>
<blockquote>
<p>sudo nano /etc/torbrowser.d/50_user.configuration</p>
</blockquote>
<p>Whonix 14:</p>
<blockquote>
<p>sudo nano /etc/torbrowser.d/50_user.configuration</p>
</blockquote>
<p>OR</p>
<blockquote>
<p>sudo nano /rw/config/torbrowser.d/50_user.conf</p>
</blockquote>
<p>C) Set tbb version to hardened</p>
<blockquote>
<p>tbb_version=“6.5a5-hardened”</p>
</blockquote>
<p>D) Save file</p>
<blockquote>
<p>Ctrl + X</p>
</blockquote>
<p>E) Update the Whonix-WS TemplateVM</p>
<blockquote>
<p>sudo apt-get update &amp;&amp; sudo apt-get dist-upgrade</p>
</blockquote>
<p>F) Run the Tor Browser Downloader in the Whonix-WS TemplateVM</p>
<blockquote>
<p>Left click on Qubes 3.2 ‘Q’ icon -&gt; Select Template: whonix-ws -&gt; Run ‘Tor Browser Downloader’*</p>
</blockquote>
<p>Note: If this option does not appear in the menu, add it to the menu with ‘Add more shortcuts…’ option</p>
<p>G) Check the Tor Browser signature</p>
<p>DO NOT install the Tor Browser unless the signature and subkey matches those below:</p>
<blockquote>
<p>pub   4096R/0x4E2C6E8793298290 2014-12-15 [expires: 2020-08-24]<br>
Key fingerprint = EF6E 286D DA85 EA2A 4BA7  DE68 4E2C 6E87 9329 8290<br>
uid   Tor Browser Developers (signing key) <a href="mailto:torbrowser@torproject.org">torbrowser@torproject.org</a><br>
sub   4096R/0x2E1AC68ED40814E0 2014-12-15 [expires: 2017-08-25]<br>
sub   4096R/0x7017ADCEF65C2036 2014-12-15 [expires: 2017-08-25]<br>
sub   4096R/0xD1483FA6C3C07136 2016-08-24 [expires: 2018-08-24]</p>
</blockquote>
<p><strong>3) Create the dispVM based on the Whonix-WS TemplateVM</strong></p>
<p>A) Open a terminal in dom0</p>
<blockquote>
<p>Left click on Qubes 3.2 ‘Q’ icon -&gt; Select System Tools -&gt; Xfce Terminal</p>
</blockquote>
<p>B) Create the disp-VM</p>
<p>Run the commands:</p>
<blockquote>
<p>qvm-create-default-dvm whonix-ws</p>
</blockquote>
<blockquote>
<p>exit</p>
</blockquote>
<p><strong>4) Confirm the netVM is set to sys-whonix</strong></p>
<blockquote>
<p>Qubes VM Manager -&gt; View -&gt; Show/Hide Internal dispVMs</p>
</blockquote>
<blockquote>
<p>Right click on “Whonix-WS-dvm”</p>
</blockquote>
<blockquote>
<p>Select “VM Settings”</p>
</blockquote>
<p>NetVM should be using sys-whonix. Change it if that is not the case.</p>
<p><strong>5) Check the disp-VM based on Whonix-WS works</strong></p>
<blockquote>
<p>Left click on Qubes 3.2 ‘Q’ icon -&gt; Select DisposableVM -&gt; xterm</p>
</blockquote>
<p>Run the command:</p>
<blockquote>
<p>torbrowser</p>
</blockquote>
<p><strong>6) Check Tor Browser version is correct</strong></p>
<blockquote>
<p>In the url tab, enter about:tor -&gt; press enter</p>
</blockquote>
<p>Check the Tor Browser instance either shows “6.0.7” or “6.5.a5-hardened” and matches the version you just installed.</p>
<p><strong>Customization of the dispVM (Whonix-WS) in Qubes 3.2</strong></p>
<p>Note: This step is OPTIONAL and is only required if you wish to store bookmarks, changes to add-on settings, maintain updates to the Tor Browser using the browser’s internal updater, and other unique changes.</p>
<p><strong>1) Launch Konsole (Terminal) in the dispVM</strong></p>
<p>Two methods are available to do this:</p>
<blockquote>
<p>Left click on Qubes 3.2 ‘Q’ icon -&gt; Select DisposableVM -&gt; xterm</p>
</blockquote>
<p>OR</p>
<blockquote>
<p>Left click on the Qubes 3.2 ‘Q’ icon -&gt; Select System Tools -&gt; Xfce Terminal and run the command:</p>
</blockquote>
<blockquote>
<p>qvm-run -a whonix-ws-dvm xterm</p>
</blockquote>
<p><strong>2) Create a customized file path</strong></p>
<p>Enter the command:</p>
<blockquote>
<p>touch /home/user/.qubes-dispvm-customized</p>
</blockquote>
<p><strong>3) Make changes you wish to persist in the dispVM</strong></p>
<p>Note: this usually relates to bookmarks, add-on updates, the privacy slider, javascript settings, search engine preferences, and minor Tor Browser updates you wish to persist</p>
<p>A) Run Tor Browser with the command:</p>
<blockquote>
<p>torbrowser</p>
</blockquote>
<p>B) Make changes as required and/or run the Tor Browser internal updater:</p>
<blockquote>
<p>Select the green onion -&gt; “Check for Tor Browser update…”</p>
</blockquote>
<p><strong>4) Close the Tor Browser</strong></p>
<p><strong>5) Shutdown the dispVM</strong></p>
<p><strong>6) Recreate the whonix-ws dispVM</strong></p>
<p>A) Open a terminal in dom0</p>
<blockquote>
<p>Left click on Qubes 3.2 ‘Q’ icon -&gt; Select System Tools -&gt; Xfce Terminal</p>
</blockquote>
<p>B) Re-create the disp-VM</p>
<p>Run the commands:</p>
<blockquote>
<p>qvm-create-default-dvm whonix-ws</p>
</blockquote>
<blockquote>
<p>exit</p>
</blockquote>
<p><strong>7) Check all of your changes are now persistent</strong></p>
<p><strong>Keeping your dispVM (Whonix-WS) image up to date</strong></p>
<p>Important: If you DID NOT customize your dispVM to allow changes to be maintained, this means your dispVM private image WILL NOT CONSISTENTLY run the updated Tor Browser when subsequent releases become available. That is, your manual updates from within the dispVM will be lost after each session.</p>
<p>These steps must be followed after each major TBB release or minor update.</p>
<p><strong>1) OPTIONAL STEP - Users who hardcoded their TBB version</strong></p>
<p>Update your config file to show the latest hardened Tor Browser release. For example:</p>
<p>A) Open Konsole in the Whonix-WS TemplateVM</p>
<blockquote>
<p>Left click on Qubes 3.2 ‘Q’ icon -&gt; Select Template: whonix-ws -&gt; Select Konsole</p>
</blockquote>
<p>B) Edit the user configuration file</p>
<p>Whonix 13:</p>
<blockquote>
<p>sudo nano /etc/torbrowser.d/50_user.configuration</p>
</blockquote>
<p>Whonix 14:</p>
<blockquote>
<p>sudo nano /etc/torbrowser.d/50_user.configuration</p>
</blockquote>
<p>OR</p>
<blockquote>
<p>sudo nano /rw/config/torbrowser.d/50_user.conf</p>
</blockquote>
<p>C) Set tbb version to the latest hardened version, for example:</p>
<blockquote>
<p>tbb_version=“6.5a6-hardened”</p>
</blockquote>
<p>D) Save file</p>
<blockquote>
<p>Ctrl + X</p>
</blockquote>
<p><strong>2) Update the Whonix-WS TemplateVM</strong></p>
<p>Run Konsole in the Whonix-WS TemplateVM</p>
<p>Run the command:</p>
<blockquote>
<p>sudo apt-get update &amp;&amp; sudo apt-get dist-upgrade</p>
</blockquote>
<p><strong>3) Re-create the dispVM based on the updated Whonix-WS TemplateVM</strong></p>
<p>A) Open a terminal in dom0</p>
<blockquote>
<p>Left click on Qubes 3.2 ‘Q’ icon -&gt; Select System Tools -&gt; Xfce Terminal</p>
</blockquote>
<p>B) Re-create the disp-VM</p>
<p>Run the commands:</p>
<blockquote>
<p>qvm-create-default-dvm whonix-ws</p>
</blockquote>
<blockquote>
<p>exit</p>
</blockquote>
<p><strong>4) Confirm the netVM is still set to sys-whonix</strong></p>
<blockquote>
<p>Qubes VM Manager -&gt; View -&gt; Show/Hide Internal dispVMs</p>
</blockquote>
<blockquote>
<p>Right click on “Whonix-WS-dvm” -&gt; Select “VM Settings”</p>
</blockquote>
<p>NetVM should be using sys-whonix. Change it if that is not the case.</p>
<p><strong>5) Check the disp-VM based on Whonix-WS works</strong></p>
<blockquote>
<p>Left click on Qubes 3.2 ‘Q’ icon -&gt; Select DisposableVM -&gt; xterm</p>
</blockquote>
<p>Run the command:</p>
<blockquote>
<p>torbrowser</p>
</blockquote>
<p><strong>6) Check the Tor Browser version is correct</strong></p>
<p>In the url tab, enter:</p>
<blockquote>
<p>about:tor</p>
</blockquote>
<p>Check the Tor Browser instance matches the updated version you just installed.</p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-04T16:23:13Z' class='post-time'>
                December 4, 2016,  4:23pm
              </time>
              <meta itemprop='dateModified' content='2016-12-04T16:23:13Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I don’t think it is useful to set <code>tbb_version="6.5a5-hardened"</code> and then apt-get upgrade tb-updater.</p>
<ul>
<li>Doesn’t work if there is no upgrade of the tb-updater package. (Unless inventing bigger hacks such as apt-get --reinstall.) So you’d still needlessly wait for me to upload the upgraded the tb-updater package.</li>
<li>Would be simpler to disable tb-updater automatically downloading the hardcoded version during apt-get upgrade of tb-updater. <code>tb_install_follow=false</code>
</li>
<li>Then just <code>update-torbrowser</code> and select “6.5a5-hardened” interactively during download verification screen. I left in the ability to manually use <code>update-torbrowser</code> inside TemplateVMs exactly for such reasons.</li>
</ul>
<p>In TemplateVM or DispVM TemplateVM it probably is best not to touch <code>/rw</code>. In that case rather use <code>/etc</code>. This is because the purpose of <code>/rw</code> is to overwrite settings from within TemplateBasedVMs.</p>
<p><a class="mention" href="../../../../external.html?link=https://forums.whonix.org/u/torjunkie">@torjunkie</a> These instructions are a good basis for being added to the wiki. Could you just add them to some final or temporary wiki page instead of posting them in the forums? Then I could just make small modifications as explained above. I’d split them into smaller changes and accompany them with an explanatory wiki edit message that you then could read in the wiki history of that page. I guess that would be more time efficient. (Just write the markup once for the wiki rather than once for the forums and later again for the wiki.)</p>
<p>( Created some temporary page in case needed. <a href="../../../../external.html?link=https://www.whonix.org/wiki/Qubes/temp">https://www.whonix.org/wiki/Qubes/temp</a> )</p>
<p>( Btw since you appreciate learning Whonix internals, one tip. Try running update-torbrowser from command line. Although that output needs to be improved for Whonix 14, it for example explains a bit about the folder into which Tor Browser will be stored. )</p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-04T16:36:26Z' class='post-time'>
                December 4, 2016,  4:36pm
              </time>
              <meta itemprop='dateModified' content='2016-12-04T16:36:26Z'>
          <span itemprop='position'>#6</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>The code on how DispVM home is created and how the (non-)existence of the <code>/home/user/.qubes-dispvm-customized</code> status file influences things was <a href="../../../../external.html?link=https://github.com/marmarek/qubes-core-agent-linux/commit/a69acdabbfb60d88971644cfad50165091a66b9f">recently</a> changed. These changes already ended up in Qubes R3.2 testing repository. So it is probably worth only concentrating on that [before it will be totally changed for good in Qubes 4.0]. (If you are on Qubes R3.2 stable can you please tell if you also already go these changes?)</p>
<p>init - <code>/usr/lib/qubes/init/setup-dvm-home.sh</code><br>
<a href="../../../../external.html?link=https://github.com/marmarek/qubes-core-agent-linux/blob/master/init/setup-dvm-home.sh">https://github.com/marmarek/qubes-core-agent-linux/blob/master/init/setup-dvm-home.sh</a></p>
<p>function <code>initialize_home</code> - <code>/usr/lib/qubes/init/functions</code>:<br>
<a href="../../../../external.html?link=https://github.com/marmarek/qubes-core-agent-linux/blob/master/init/functions#L122">https://github.com/marmarek/qubes-core-agent-linux/blob/master/init/functions#L122</a></p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-04T16:49:21Z' class='post-time'>
                December 4, 2016,  4:49pm
              </time>
              <meta itemprop='dateModified' content='2016-12-04T16:49:21Z'>
          <span itemprop='position'>#7</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I have all Qubes git repositories on my disk in folder <code>~/Qubes</code>. (And scripts to keep them all up to date.) If I want for example to learn about <code>qubes-dispvm-customized</code>, I am using the following “ultimate” grep command (that I can also use in VM template build VMs).</p>
<pre><code>grep --exclude-dir=mnt --exclude-dir=qubes-src/linux-template-builder/mnt --exclude=changelog.upstream --exclude-dir=.git --exclude-dir=chroot-debian --exclude-dir=chroot-jessie -l -r qubes-dispvm-customized</code></pre>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-04T17:32:17Z' class='post-time'>
                December 4, 2016,  5:32pm
              </time>
              <meta itemprop='dateModified' content='2016-12-04T17:32:17Z'>
          <span itemprop='position'>#8</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>My conclusion is, that dom0 has no knowledge about DispVM template status file <code>/home/user/.qubes-dispvm-customized</code>.</p>
<hr>
<p>When you have killed and deleted disp1, disp2 (if existing) in Qubes VM Manager (QVMM) and then deleted <code>whonix-ws-dvm</code> (<code>qvm-remove whonix-ws-dvm</code> or using QVMM)… I.e. from a somewhat fresh/clean/resetted state. When you run <code>qvm-create-default-dvm whonix-ws</code> (same for all templates), then “DVM boot complete” indicates that the DVM template was booted (without you seeing that).</p>
<p>Since seeing is believing, you can run in another terminal window "sudo xl console whonix-ws-dvm` during DVM creation (qvm-create-default-dvm). (Run this command several times if it does not work at first, since qvm-create-default-dvm may not be at that stage yet.)</p>
<p><code>qubesdb-read /qubes-vm-type</code> inside DVM template outputs <code>AppVM</code>.</p>
<p>That is why during that time <a href="../../../../external.html?link=https://github.com/Whonix/tb-updater/blob/master/lib/systemd/system/tb-updater-first-boot.service">tb-updater-first-boot.service</a> will <a href="../../../../external.html?link=https://github.com/Whonix/tb-updater/blob/master/usr/lib/tb-updater/first-boot-home-population">copy</a> <code>/var/cache/tb-binary/*</code> to <code>/home/user</code>. (Resulting in the <code>/home/user/.tb/tor-browser</code> DispVM “template”.)</p>
<p>The confusion comes from Qubes calling it on one hand DVM template and on the other hand starting that DVM template like an TemplateBased AppVM.</p>
<hr>
<p>Start whonix-ws-dvm. (<code>qvm-start whonix-ws-dvm &amp;&amp; qvm-run whonix-ws-dvm konsole</code>)</p>
<ul>
<li>create some random file in root image <code>/etc/zzzzzzzzzz</code>
</li>
<li>create some random file in private image <code>/home/user/zzzzzzzzzz</code>
</li>
</ul>
<p>Shut down the VM (<code>sudo poweroff</code>). Start whonix-ws-dvm again. Learn, that:</p>
<ul>
<li>the random file in root image <code>/etc/zzzzzzzzzz</code> is lost</li>
<li>the random file in private image <code>/home/user/zzzzzzzzzz</code> still exists</li>
</ul>
<p>So DVM “template” really is started like an TemplateBased AppVM.</p>
<p>Shut the DVM “template” down for more experiments.</p>
<p>Now start whonix-ws TemplateVM. Create a file <code>/etc/zzz_create_in_whonix-ws_TemplateVM</code> as well as <code>/home/user/zzz_create_in_whonix-ws_TemplateVM</code>. Shut down whonix-ws- TemplateVM.</p>
<p>Start a DVM “template” konsole. See that <code>/etc/zzz_create_in_whonix-ws_TemplateVM</code> exists. Start DispVM (<code>/usr/lib/qubes/qfile-daemon-dvm qubes.VMShell dom0 DEFAULT red</code>). And run into some Qubes issue:</p>
<aside class="onebox githubissue">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2482" target="_blank" rel="nofollow noopener">github.com/QubesOS/qubes-issues</a>
  </header>
  <article class="onebox-body">
    <a href="../../../../external.html?link=https://github.com/adrelanos" rel="nofollow noopener">
<img src="../../../../external.html?link=https://avatars1.githubusercontent.com/u/1985040?v=2&amp;s=96" class="thumbnail onebox-avatar" width="96" height="96">
</a>

<h4><a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2482" target="_blank" rel="nofollow noopener">Issue: DispVM start error - error: internal error: Failed to save domain '30' with libxenlight</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
	on <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2482" target="_blank" rel="nofollow noopener">2016-12-04</a>
	</div>
	<div class="user">
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">Qubes OS version (e.g., R3.2):
R3.2 with testing repository.
Affected TemplateVMs (e.g., fedora-23, if applicable):
whonix-ws (but probably not a template issue)
Actual behavior:
/usr/lib/qubes/qfile-daemon-dvm qubes.VMShell...</pre>

<div class="labels">
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">C: core</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-04T17:41:03Z' class='post-time'>
                December 4, 2016,  5:41pm
              </time>
              <meta itemprop='dateModified' content='2016-12-04T17:41:03Z'>
          <span itemprop='position'>#9</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>So my progress on “best way to keep Tor Browser updated in [customized] DispVM / hardened Tor Browser in DispVM” is blocked for a while now so I can provide debug information.</p>
<p>Since DispVM “template” is actually started like an AppVM… Please try the following. Start a <code>whonix-ws-dvm</code> (DVM “template”) konsole and run <code>update-torbrowser</code> there. Once you installed the version of your choice, it should end up in home folder. Then shut <code>whonix-ws-dvm</code> down. From then, you should have up to date Tor Browser also in [customized] DispVM.</p>
<p>I guess all of this will become a lot easier in Qubes 4.0 when the double layered DispVM implementation is replaced by the much (from user point of view) simpler implementation.</p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/entr0py'><span itemprop='name'>entr0py</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-05T01:50:33Z' class='post-time'>
                December 5, 2016,  1:50am
              </time>
              <meta itemprop='dateModified' content='2016-12-05T01:50:33Z'>
          <span itemprop='position'>#10</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>So after studying your posts, it sounds like <code>.qubes-dispvm-customized</code> function is to preserve a dispVM template’s private storage area when <code>qvm-create-default-dvm</code> is run on top of an existing dispVM template - making it function like a template-basedVM in terms of file persistence. Otherwise, the dispVM template is completely reset when a new dispVM template is created.</p>
<p>Given that, I think the steps that I outlined <a href="3.html">above</a>, represent the simplest way for users to get new TBB in <strong>non-customized</strong> dispVM templates. Of course, I will also add optional instructions for customized templates (and users who wish to use TB internal updater).</p>
<p>Please review this explanation for accuracy:</p>
<ol>
<li>
<p>user creates new dispVM template to replace a non-customized DVM template.</p>
</li>
<li>
<p><code>first-boot-home-population</code> copies TBB to /home/user/.tb because qubes categorizes dispVM templates as appVMs.</p>
</li>
<li>
<p><code>first-boot-home-population.done</code> is created and <strong>preserved</strong> in the dispVM template because <code>/var/cache/tb-updater</code> is defined as a bind-dir in <code>/usr/lib/qubes-bind-dirs.d</code></p>
</li>
<li>
<p><code>first-boot-home-population.done</code> is visible to new dispVMs (disp1,disp2,…) and so <code>first-boot-home-population</code> is not executed when each dispVM is launched.</p>
</li>
<li>
<p>now new version of TBB is released and tb-updater is updated in whonix-ws template</p>
</li>
<li>
<p>when the dvm template is auto-refreshed by the template change, new TBB in <code>/var/cache/tb-binary</code> is copied to the dvm-template. But no changes are made to <code>/home/user/.tb</code></p>
</li>
<li>
<p>now user runs <code>qvm-create-default-dvm whonix-ws</code></p>
</li>
<li>
<p>since <code>.qubes-dispvm-customized</code> is not present, the entire dispVM template is discarded and the process begins again from Step <span class="hashtag">#1</span>.</p>
</li>
</ol>
<aside class="quote" data-post="5" data-topic="3232">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p><a class="mention" href="../../../../external.html?link=https://forums.whonix.org/u/torjunkie">@torjunkie</a> These instructions are a good basis for being added to the wiki.</p>
</blockquote>
</aside>
<p><a class="mention" href="../../../../external.html?link=https://forums.whonix.org/u/torjunkie">@torjunkie</a> If you haven’t written up text for this entry already, I started last night on some prose and instructions also. I will incorporate your suggestions and post to the main wiki page: <a href="../../../../external.html?link=https://www.whonix.org/wiki/Qubes/Disposable_VM">https://www.whonix.org/wiki/Qubes/Disposable_VM</a>. In my version, I’d like to add hardened TBB instructions to a footnote, once you and Patrick sort out the best method for switching over whonix-ws template. The instructions are complicated enough already without giving high visibility to the alpha TBBs.</p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/entr0py'><span itemprop='name'>entr0py</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-05T04:25:23Z' class='post-time'>
                December 5, 2016,  4:25am
              </time>
              <meta itemprop='dateModified' content='2016-12-05T04:25:23Z'>
          <span itemprop='position'>#11</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="9" data-topic="3232">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Since DispVM “template” is actually started like an AppVM… Please try the following. Start a whonix-ws-dvm (DVM “template”) konsole and run update-torbrowser there. Once you installed the version of your choice, it should end up in home folder. Then shut whonix-ws-dvm down. From then, you should have up to date Tor Browser also in [customized] DispVM.</p>
</blockquote>
</aside>
<p>Without testing, this sounds right <strong>except</strong> the TB installation will only persist if <code>.qubes-dispvm-customized</code> is present. Because next time user boots <code>whonix-ws</code> to run <code>apt-get update</code>, the TB installation will be overwritten by whatever is in <code>/var/cache/tb-binary</code> in <code>whonix-ws</code> - when a new dispVM is launched. If no changes were ever made to <code>whonix-ws</code> after this procedure, then <code>.qubes-dispvm-customized</code> would not be needed because <code>qvm-create-default-dvm</code> would never be run by dom0. And TB installation would have no reason to be ever overwritten. ???</p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/torjunkie'><span itemprop='name'>torjunkie</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-05T13:08:44Z' class='post-time'>
                December 5, 2016,  1:08pm
              </time>
              <meta itemprop='dateModified' content='2016-12-05T13:08:44Z'>
          <span itemprop='position'>#12</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Hi entr0py &amp; Patrick</p>
<p>Good information! I’ll have to wrap my head around it all, as I thought this disp-VM issue was going to be an ‘easy win’. Famous last words. <img src="../../../images/emoji/twitter/dizzy_faceae52.png?v=5" title=":dizzy_face:" class="emoji" alt=":dizzy_face:"></p>
<p>entr0py - as you have suggested, please feel free to write your stuff up and insert into the section Patrick has created. Borrow anything you like, if it is useful.</p>
<p>Agree that hardened stuff is better left as a footnote until the basic browser + remembered (customized) changes can be bedded down.</p>
<p>Patrick - I’ll look at your notes and technical analysis and see if the customized stuff can be worked out at my end. I’m not a technical genius like yourself.</p>
<p>Cheers</p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-05T15:04:58Z' class='post-time'>
                December 5, 2016,  3:04pm
              </time>
              <meta itemprop='dateModified' content='2016-12-05T15:04:58Z'>
          <span itemprop='position'>#13</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Any thoughts on the (previously existing) quote <a href="../../../../external.html?link=https://www.whonix.org/wiki/Tor_Browser#Running_Tor_Browser_in_Qubes_TemplateVM">https://www.whonix.org/wiki/Tor_Browser#Running_Tor_Browser_in_Qubes_TemplateVM</a></p>
<blockquote>
<p>Don’t start Tor Browser in the whonix-ws TemplateVM or whonix-ws-dvm DisposableVM-TemplateVM. It is not expected to be done that way and wrong. […]</p>
</blockquote>
<hr>
<aside class="onebox githubissue">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2486" target="_blank" rel="nofollow noopener">github.com/QubesOS/qubes-issues</a>
  </header>
  <article class="onebox-body">
    <a href="../../../../external.html?link=https://github.com/adrelanos" rel="nofollow noopener">
<img src="../../../../external.html?link=https://avatars1.githubusercontent.com/u/1985040?v=2&amp;s=96" class="thumbnail onebox-avatar" width="96" height="96">
</a>

<h4><a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2486" target="_blank" rel="nofollow noopener">Issue: invent term for DisposableVM-TemplateVM and add to glossary</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
	on <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2486" target="_blank" rel="nofollow noopener">2016-12-05</a>
	</div>
	<div class="user">
	closed by <a href="../../../../external.html?link=https://github.com/andrewdavidwong" target="_blank" rel="nofollow noopener">andrewdavidwong</a>
	on <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2486" target="_blank" rel="nofollow noopener">2017-02-12</a>
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">https://www.qubes-os.org/doc/glossary/
debian-8 or whonix-ws we call TemplateVM
debian-8-dvm or whonix-ws-dvm - How to call those? DisposableVM-TemplateVM?
I'd like to add them to the glossary.
(Such...</pre>

<div class="labels">
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">C: doc</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">task</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-05T15:25:18Z' class='post-time'>
                December 5, 2016,  3:25pm
              </time>
              <meta itemprop='dateModified' content='2016-12-05T15:25:18Z'>
          <span itemprop='position'>#14</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I am in process of of working through the wiki edits by <a class="mention" href="../../../../external.html?link=https://forums.whonix.org/u/entr0py">@entr0py</a> . For now only stylistic changes. Feel free to discuss these. For example I don’t like the two new lines so much. If you think that a more visible separate was useful we could add <code>-----</code> (which results in and is the same as <code>&lt;hr&gt;</code>. (As I did for some <a href="../../../../external.html?link=https://www.whonix.org/wiki/Tunnels/Connecting_to_a_VPN_before_Tor">tunnel</a> documentation.)</p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-05T16:18:11Z' class='post-time'>
                December 5, 2016,  4:18pm
              </time>
              <meta itemprop='dateModified' content='2016-12-05T16:18:11Z'>
          <span itemprop='position'>#15</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubissue">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2489" target="_blank" rel="nofollow noopener">github.com/QubesOS/qubes-issues</a>
  </header>
  <article class="onebox-body">
    <a href="../../../../external.html?link=https://github.com/adrelanos" rel="nofollow noopener">
<img src="../../../../external.html?link=https://avatars1.githubusercontent.com/u/1985040?v=2&amp;s=96" class="thumbnail onebox-avatar" width="96" height="96">
</a>

<h4><a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2489" target="_blank" rel="nofollow noopener">Issue: add list of which folders persist in TemplateBasedVMs and which do not to documentation</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
	on <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2489" target="_blank" rel="nofollow noopener">2016-12-05</a>
	</div>
	<div class="user">
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">Probably save to add it on this page addressing advanced users:
https://www.qubes-os.org/doc/template-implementation/
But I think would also be useful to be added to...</pre>

<div class="labels">
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">C: doc</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">task</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-05T16:26:20Z' class='post-time'>
                December 5, 2016,  4:26pm
              </time>
              <meta itemprop='dateModified' content='2016-12-05T16:26:20Z'>
          <span itemprop='position'>#16</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>
<p>Under the Qubes TemplateVM model [1], any changes made to a TemplateBasedVM’s root filesystem are lost upon reboot. This can be advantageous from a security viewpoint since malicious code installed to the root filesystem is discarded prior to the next session.</p>
</blockquote>
<p>(On TemplateBasedVM) I somewhat disagree with the latter sentence. This would work indeed against off-the-shelf malware that targets general Linux and installs itself lets say as a rootkit in /etc somehow. It would not work against off-the-shelf malware with “Qubes support” let alone for tailored malware.</p>
<p>Also Qubes doesn’t declare that as security feature. What an security feature is, that if one TemplateBasedVM is compromised (considered a permanent compromise until that TemplateBasedVM gets purged), is that it cannot spread to the TemplateVM or other TemplateBasedVMs.</p>
<p>Therefore I removed that sentence.</p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-05T16:44:03Z' class='post-time'>
                December 5, 2016,  4:44pm
              </time>
              <meta itemprop='dateModified' content='2016-12-05T16:44:03Z'>
          <span itemprop='position'>#17</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Quote <a href="../../../../external.html?link=https://www.whonix.org/wiki/Qubes/Disposable_VM">https://www.whonix.org/wiki/Qubes/Disposable_VM</a></p>
<blockquote>
<p>Qubes does not have a built-in snapshot capability like VirtualBox that<br>
can completely revert all changes back to a particular VM state.</p>
</blockquote>
<p>True. Added a footnote:</p>
<blockquote>
<p>Apart from [<a href="../../../../external.html?link=https://www.qubes-os.org/doc/dom0-tools/qvm-revert-template-changes/">https://www.qubes-os.org/doc/dom0-tools/qvm-revert-template-changes/</a> qvm-revert-template-changes] which can only revert back prior the previous (not last) shutdown of the TemplateVM.</p>
</blockquote>
<p>And another footnote:<br>
<a href="../../qubes-vm-snapshots-using-git-svn/3240.html">https://forums.whonix.org/t/qubes-vm-snapshots-using-git-svn</a></p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../advertisement-tracking-real-threat-to-whonix-project/3200/13.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../advertisement-tracking-real-threat-to-whonix-project/3200/13.html'>
                      <span itemprop='name'>Advertisement Tracking - Real threat to Whonix Project</span>
                    </a>
                    <meta itemprop='position' content='4'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/entr0py'><span itemprop='name'>entr0py</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-05T21:00:49Z' class='post-time'>
                December 5, 2016,  9:00pm
              </time>
              <meta itemprop='dateModified' content='2016-12-05T21:00:49Z'>
          <span itemprop='position'>#18</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="13" data-topic="3232">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Any thoughts on the (previously existing) quote <a href="../../../../external.html?link=https://www.whonix.org/wiki/Tor_Browser#Running_Tor_Browser_in_Qubes_TemplateVM">https://www.whonix.org/wiki/Tor_Browser#Running_Tor_Browser_in_Qubes_TemplateVM</a></p>
<aside class="quote">
<blockquote>
<p>Don’t start Tor Browser in the whonix-ws TemplateVM or whonix-ws-dvm DisposableVM-TemplateVM. It is not expected to be done that way and wrong. […]</p>
</blockquote>
</aside>
</blockquote>
</aside>
<p>The conservative view would be to recommend that as a best practice. However, we are already relying on Tor Browser not to generate any unique identifiers every time we use it. So logically, it should be safe to run in a template for customization purposes. But it really needs to be stressed that customization is a dangerous exercise. For example, I found by accident that a seemingly innocuous change:<br>
<code>NoScript -&gt; Options -&gt; Notifications -&gt; check 'Show message about blocked scripts'</code><br>
will alter reported screen size when JS is enabled.</p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../application-customization-and-privacy-issues/3245.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../application-customization-and-privacy-issues/3245.html'>
                      <span itemprop='name'>Application Customization and Privacy Issues</span>
                    </a>
                    <meta itemprop='position' content='1'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-05T21:03:33Z' class='post-time'>
                December 5, 2016,  9:03pm
              </time>
              <meta itemprop='dateModified' content='2016-12-05T21:03:33Z'>
          <span itemprop='position'>#19</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Agreed! Please add!</p>
<hr>
<p>I haven’t forgotten to answer your questions in.</p>
<ul>
<li><a href="10.html">Qubes DispVM technical discussion</a></li>
<li><a href="11.html">Qubes DispVM technical discussion</a></li>
</ul>
<p>Good question. Next question. <img src="../../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>My advice now is “check your Tor Browser version and make it work”:</p>
<p><a href="../../../../external.html?link=https://www.whonix.org/wiki/Qubes/Disposable_VM#Warning:_Check_your_Tor_Browser_Version">https://www.whonix.org/wiki/Qubes/Disposable_VM#Warning:_Check_your_Tor_Browser_Version</a></p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../application-customization-and-privacy-issues/3245.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../application-customization-and-privacy-issues/3245.html'>
                      <span itemprop='name'>Application Customization and Privacy Issues</span>
                    </a>
                    <meta itemprop='position' content='2'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../3232.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-12-05T21:23:05Z' class='post-time'>
                December 5, 2016,  9:23pm
              </time>
              <meta itemprop='dateModified' content='2016-12-05T21:23:05Z'>
          <span itemprop='position'>#20</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>So far so good! Great work!</p>
<p>I am done editing on top of your changes and suggestions for now. Made lots of nitpick edits and also real enhancements.</p>
<p>Now, having it documented so far, using hardened Tor Browser in [customized] DispVM is not that hard? In case of issues just use update-torbrowser in DisposableVM-Template. Please feel free to add it. Then use  <a href="../../../../external.html?link=https://www.whonix.org/wiki/Qubes/Disposable_VM#Warning:_Check_your_Tor_Browser_Version">https://www.whonix.org/wiki/Qubes/Disposable_VM#Warning:_Check_your_Tor_Browser_Version</a>.</p>
<p>As for adding instructions for hardened Tor Browser version vs complexity, I think there is an acceptable solution. Use the <code>expand</code> button. See <a>example Whonix mediawiki markup using <code>expand</code> buttons</a>.</p>
<p>I guess this is as far as we can reasonable get with Qubes R3.2 without going into a lot more effort and gymnastics.</p>
<p>Let’s post this sometime soon on qubes-devel? And afterwards also on Whonix blog and qubes-user?</p>
        </div>

        <meta itemprop='headline' content='Qubes DispVM technical discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><b><a rel="next" itemprop="url" href="../32324658.html?page=2">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

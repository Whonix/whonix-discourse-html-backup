<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Enabling AppArmor</title>
    <link>http://forums.whonix.org/t/enabling-apparmor/1398</link>
    <description>Hi,

During Whonix Qubes setup I followed the instructions for enabling apparmour, but aa-status says its not enabled/loaded.

I double-checked that the qvm pref is set properly, so I don&#39;t know what went wrong.</description>
    <language>en</language>
    <lastBuildDate>Mon, 21 Sep 2015 17:02:47 +0000</lastBuildDate>
    <category>Qubes-Whonix</category>
    <atom:link href="http://forums.whonix.org/t/enabling-apparmor/1398.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Great!</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/19">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/19</link>
        <pubDate>Mon, 21 Sep 2015 17:02:47 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-19</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Is this something that can be reproduced using the Debian templates and worth being reported against Qubes upstream?</p>
<p>It would be weird if the kernel works now but if AppArmor would break because of a bug introduced in upcoming versions.</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/17">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/17</link>
        <pubDate>Mon, 21 Sep 2015 14:21:38 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-17</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="13" data-topic="1398">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/c/edb3f5/40.png" class="avatar"> cprise:</div>
<blockquote>
<p>I’ll follow up in the other thread if that’s OK with you.</p>
</blockquote>
</aside>
<p>Yes.</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/15</link>
        <pubDate>Sat, 19 Sep 2015 18:06:07 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-15</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[cprise]]></dc:creator>
        <description><![CDATA[
            <p>OK, after switching to kernel 3.18.17-6 apparmor now loads. Looks like its the kernel after all… 3.19.3-4 won’t load the module.</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/14</link>
        <pubDate>Sat, 19 Sep 2015 17:31:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-14</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[cprise]]></dc:creator>
        <description><![CDATA[
            <p>After adding apparmor-utils to the debian8 template and starting one of those appvms, aa-status says the module isn’t loaded. This is the /proc/cmdline:</p>
<p>root=/dev/mapper/dmroot ro nomodeset console=hvc0 rd_NO_PLYMOUTH 3 nopat apparmor=1 security=apparmor</p>
<p>If there is no workaround forthcoming, I’ll put apparmor on the backburner for now. I’d rather get a typical whonix setup working smoothly and help you iron out the wrinkles. I’ll follow up in the other thread if that’s OK with you.</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/13</link>
        <pubDate>Sat, 19 Sep 2015 17:21:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-13</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Does enabling AppArmor in the plain Debian templates work for you?</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/12</link>
        <pubDate>Sat, 19 Sep 2015 14:08:01 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-12</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>/proc/cmdline looks good. I don’t know then why “sudo aa-status” doesn’t show it enabled then.</p>
<p>[hr]</p>
<p>The second whonxicheck warning… Try this.</p>
<pre><code class="lang-auto"></code></pre>
<p>You installed whonixcheck from the testers repository. And probably also a lot more. That works well for Whonix 12 development images, but upgrades Whonix 11 -&gt; Whonix 12 are not yet tested. I am not surprised by these issues. Those have to be covered in in upgrade instructions.</p>
<p>I don’t know yet what causes the terminal opening bug. But I don’t know what Whonix specific could cause this. I think it’s a Qubes upstream bug / race condition. Could be <a href="https://github.com/QubesOS/qubes-issues/issues/1172">https://github.com/QubesOS/qubes-issues/issues/1172</a> ? Maybe <a href="https://github.com/QubesOS/qubes-issues/issues/1138">https://github.com/QubesOS/qubes-issues/issues/1138</a>.</p>
<p>If you would like to help debug this, see what /var/lib/qubes/vm-templates/whonix-gw/apps.templates/konsole.desktop is doing. Try to emulate that from a dom0 terminal. qvm-run. Without -q. With --pass-io.</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/11</link>
        <pubDate>Sat, 19 Sep 2015 05:48:34 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-11</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[cprise]]></dc:creator>
        <description><![CDATA[
            <p>user@host:~$ cat /proc/cmdline<br>
root=/dev/mapper/dmroot ro nomodeset console=hvc0 rd_NO_PLYMOUTH 3 nopat apparmor=1 security=apparmor</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/10</link>
        <pubDate>Sat, 19 Sep 2015 04:28:35 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-10</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[cprise]]></dc:creator>
        <description><![CDATA[
            <p>[quote=“Patrick, post:6, topic:1398”]Can you please check, if</p>
<pre><code class="lang-auto"></code></pre>
<p>contains</p>
<pre><code class="lang-auto"></code></pre>
<p>?</p>
<p>Kernel should have nothing to do with it. Certainly recent enough. Works for me with Qubes Q3 RC2 default 3.18.17-6. Please try if it works with that one.</p>
<p>(Edit: RC2 not RC1)[/quote]</p>
<p>I’m having trouble just getting a terminal to run in the gw. It takes over 2min before any windows appear (timesync and whonixcheck) and then I can run a terminal. This is not how I’m used to Whonix-Qubes running.</p>
<p>Whonixcheck is looking pretty scary… The template and appvms are pristine, but everything in the list shows ERROR <em>and</em> it has the temerity to tell me there are unwanted packages in the system:</p>
<blockquote>WARNING: Whonix Unwanted Packages Test Result: 2 unwanted package(s) installed. It is recommended that you remove them from your TemplateVM. 
1. Open a terminal, dom0 -&gt; Start Menu -&gt; Whonix-Gateway TemplateVM -&gt; Terminal. 
2. Purge 
sudo apt-get purge chrony ntpdate 
3. Shutdown the Whonix-Gateway TemplateVM. (dom0 -&gt; Qubes VM Manager -&gt; right click Whonix-Gateway TemplateVM -&gt; Shutdown VM) 
4. Shutdown and restart this Template-Based ProxyVM. (dom0 -&gt; Qubes VM Manager -&gt; right click 'anon-gw' -&gt; Shutdown VM) 
See also: https://www.whonix.org/wiki/Whonix_Debian_Packages 
If you know what you are doing, feel free to disable this check. Create a file /etc/whonix.d/50_whonixcheck_user and add: 
whonixcheck_skip_functions+=" check_unwanted_packages " 
ERROR: Check Timezone Result: 
/etc/timezone settings different from Whonix defaults. 
timezone_file_expected_content: Etc/UTC 
timezone_file_actual_content: UTC 
ERROR: Check Timezone Result: 
Settings different from Whonix defaults. (See above!) 
You could try to fix this. 
dom0 -&gt; Start Menu -&gt; 'anon-gw' -&gt; Konsole
sudo su 
echo "Etc/UTC" &gt; /etc/timezone 
cp "/usr/share/zoneinfo/Etc/UTC" "/etc/localtime"
It is generally recommended to keep the default as per Whonix Design. [1] If you did not change timezone related settings, please report this Whonix bug. 
If you know what you are doing, feel free to disable this check. Create a file /etc/whonix.d/50_whonixcheck_user and add: 
whonixcheck_skip_functions+=" check_timezone "
[1] https://www.whonix.org/wiki/Dev/Design-Shared#timezone 
ERROR: Systemd Clock Check Result: 
Unexpected results by timedatectl. 
ttimedatectl_output_pretty: 
Local time: Sat 2015-09-19 04:10:42 UTC
Universal time: Sat 2015-09-19 04:10:42 UTC
RTC time: n/a
Time zone: UTC (UTC, +0000)
NTP enabled: yes
NTP synchronized: no
RTC in local TZ: no
DST active: n/a
It is generally recommended to keep the default as per Whonix Design. [1] If you did not change timezone related settings, please report this Whonix bug. If you know what you are doing and changed this on purpose, feel free to disable this check. [2] 
<p>[1] <a href="https://www.whonix.org/wiki/Dev/Design-Shared#timezone" rel="nofollow noopener">https://www.whonix.org/wiki/Dev/Design-Shared#timezone</a><br>
[2] Create a file /etc/whonix.d/50_whonixcheck_user and add:<br>
whonixcheck_skip_functions+=" check_systemd_clock "</p>
</blockquote>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/9</link>
        <pubDate>Sat, 19 Sep 2015 04:26:13 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-9</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Whonix doesn’t require/enforce/etc. any canonical kernel versions.</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/8</link>
        <pubDate>Sun, 13 Sep 2015 08:31:41 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-8</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Can you please check, if</p>
<pre><code class="lang-auto"></code></pre>
<p>contains</p>
<pre><code class="lang-auto"></code></pre>
<p>?</p>
<p>Kernel should have nothing to do with it. Certainly recent enough. Works for me with Qubes Q3 RC2 default 3.18.17-6. Please try if it works with that one.</p>
<p>(Edit: RC2 not RC1)</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/6</link>
        <pubDate>Sat, 12 Sep 2015 20:30:57 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-6</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[cprise]]></dc:creator>
        <description><![CDATA[
            <p>I’ve tested it in both templates and both template-based vms. It did not appear I needed to set the prefs for the template-based vms as the settings carried over. But then I manually set them just in case.</p>
<p>Could the kernel version have something to do with it? The vms are using 3.19.3-4.</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/5</link>
        <pubDate>Sat, 12 Sep 2015 19:45:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-5</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Running this in the AppVM?</p>
<p>"At the moment, if you want to use this, you must apply these settings to the TemplateVMs as well as the TemplateBasedVMs. Once Qubes Q3 gets released, TemplateBasedVMs will inherit the kernelopts setting of their TemplateVM. "<br>
(<a href="https://github.com/QubesOS/qubes-issues/issues/1091">https://github.com/QubesOS/qubes-issues/issues/1091</a>)</p>
<p>If “qvm-prefs -l whonix-ws kernelopts” says ““nopat apparmor=1 security=apparmor”” then this only applies to the whonix-ws TemplateVM. You have to apply this setting to AppVMs separately.</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/4</link>
        <pubDate>Fri, 11 Sep 2015 20:38:33 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-4</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[cprise]]></dc:creator>
        <description><![CDATA[
            <p>Yes, I restarted them. Those parameters match mine and the result is “1”.</p>
<p>If I run aa-status by itself it says the apparmor module is not loaded.</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/3</link>
        <pubDate>Fri, 11 Sep 2015 20:07:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-3</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
      <item>
        <title>Enabling AppArmor</title>
        <dc:creator><![CDATA[cprise]]></dc:creator>
        <description><![CDATA[
            <p>Hi,</p>
<p>During Whonix Qubes setup I followed the instructions for enabling apparmour, but aa-status says its not enabled/loaded.</p>
<p>I double-checked that the qvm pref is set properly, so I don’t know what went wrong.</p>
          <p><a href="http://forums.whonix.org/t/enabling-apparmor/1398/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/enabling-apparmor/1398/1</link>
        <pubDate>Fri, 11 Sep 2015 18:32:09 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1398-1</guid>
        <source url="http://forums.whonix.org/t/enabling-apparmor/1398.rss">Enabling AppArmor</source>
      </item>
  </channel>
</rss>

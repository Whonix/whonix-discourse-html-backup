<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>How to set global environment variables as a Linux distribution? - /etc/environment.d - #4 by Patrick - Development - Whonix Forum</title>
    <meta name="description" content="How to set global environment variables as a Linux distribution? 
Possibilities… 

A) systemd /etc/environment.d might not be designed for that: 

Applicability
config files in /etc/environment.d/*.conf don&amp;#39;t work · Issu&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../15635.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;How to set global environment variables as a Linux distribution? - /etc/environment.d&#39;" href="../15635.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/how-to-set-global-environment-variables-as-a-linux-distribution-etc-environment-d/15635/4" />
<meta name="twitter:url" content="https://forums.whonix.org/t/how-to-set-global-environment-variables-as-a-linux-distribution-etc-environment-d/15635/4" />
<meta property="og:title" content="How to set global environment variables as a Linux distribution? - /etc/environment.d" />
<meta name="twitter:title" content="How to set global environment variables as a Linux distribution? - /etc/environment.d" />
<meta property="og:description" content="As mentioned here:    systemd DefaultEnvironment mechanism doesn’t work with display manager lightdm for some reason.  Therefore porting all of Kicksecure / Whonix to systemd DefaultEnvironment mechanism is probably not a good idea until that is resolved and this being more tested in more environments." />
<meta name="twitter:description" content="As mentioned here:    systemd DefaultEnvironment mechanism doesn’t work with display manager lightdm for some reason.  Therefore porting all of Kicksecure / Whonix to systemd DefaultEnvironment mechanism is probably not a good idea until that is resolved and this being more tested in more environments." />
<meta property="article:published_time" content="2022-10-04T16:48:04+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../15635.html">How to set global environment variables as a Linux distribution? - /etc/environment.d</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../15635.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-27T20:05:06Z' class='post-time'>
                September 27, 2022,  8:05pm
              </time>
              <meta itemprop='dateModified' content='2022-09-27T21:19:29Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>How to set global environment variables as a Linux distribution?</p>
<p>Possibilities…</p>
<hr>
<p><strong>A)</strong> systemd <a href="../../../../external.html?link=https://www.freedesktop.org/software/systemd/man/environment.d.html">/etc/environment.d</a> might not be designed for that:</p>
<ul>
<li><a href="../../../../external.html?link=https://www.freedesktop.org/software/systemd/man/environment.d.html#Applicability">Applicability</a></li>
<li><a href="../../../../external.html?link=https://github.com/systemd/systemd/issues/12938#issuecomment-508381592" class="inline-onebox">config files in /etc/environment.d/*.conf don't work · Issue #12938 · systemd/systemd · GitHub</a></li>
<li><a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/6408" class="inline-onebox">Qubes VMs ignore /etc/environment.d drop-in folder · Issue #6408 · QubesOS/qubes-issues · GitHub</a></li>
</ul>
<p>Pretty weird that systemd implemented /etc/environment.d in a way that is different from what would be expected similar to /etc/environment.</p>
<hr>
<p><strong>B)</strong> Perhaps systemd <a href="../../../../external.html?link=https://www.freedesktop.org/software/systemd/man/systemd-system.conf.html#DefaultEnvironment=">DefaultEnvironment=</a>?</p>
<ul>
<li>
<code>/etc/systemd/user.conf</code>
<ul>
<li><code>DefaultEnvironment=TESTVAR=xxx</code></li>
<li>works for Qubes terminal emulator but fails for virtual console (dom0: <code>sudo xl console vm-name</code>).</li>
</ul>
</li>
<li>
<code>/etc/systemd/system.conf</code>
<ul>
<li><code>DefaultEnvironment=TESTVAR=xxx</code></li>
<li>works for
<ul>
<li>Qubes Debian terminal emulator and in virtual console</li>
<li>Debian terminal emulator and in virtual console</li>
</ul>
</li>
</ul>
</li>
<li><code>/usr/lib/systemd/system.conf.d/30_kicksecure.conf</code></li>
</ul>
<pre><code class="lang-auto">[Manager]
DefaultEnvironment=TESTVAR=1
</code></pre>
<ul>
<li>Works for Qubes terminal emulator and in virtual console.</li>
</ul>
<hr>
<p><strong>C)</strong>  Perhaps systemd <code>Environment=</code> for getty? (login shell)</p>
<hr>
<p><strong>D)</strong> Perhaps systemd <code>EnvironmentFile=</code> for getty? (login shell)</p>
<hr>
<p><strong>E)</strong>  <a href="../../../../external.html?link=https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=704054">Debian /etc/environment.d</a> but they didn’t like my feature request. That was probably pre systemd introducing their version of /etc/environment.d. Back then I failed to follow-up with use case examples for some reason as they requested to explain why this feature was requested.</p>
<p>Another attempt to for a feature request /etc/environment.d from Debian (now under a different folder since it’s already taken). Even if they reject it, they might suggest - ideally - an already existing better mechanism.</p>
<hr>
<p><strong>F)</strong> A feature request against PAM upstream, because quote:</p>
<blockquote>
<p>The /etc/environment file is owned by pam.</p>
</blockquote>
<aside class="onebox githubissue" data-onebox-src="../../../../external.html?link=https://github.com/linux-pam/linux-pam/issues/122">
  <header class="source">

      <a href="../../../../external.html?link=https://github.com/linux-pam/linux-pam/issues/122" target="_blank" rel="noopener">github.com/linux-pam/linux-pam</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue">
	  <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/linux-pam/linux-pam/issues/122" target="_blank" rel="noopener">pam_env: environment variable configuration directory for packaging</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2019-07-04" data-time="13:13:20" data-timezone="UTC">01:13PM - 04 Jul 19 UTC</span>
      </div>


      <div class="user">
        <a href="../../../../external.html?link=https://github.com/guoyunhe" target="_blank" rel="noopener">
          <img alt="guoyunhe" src="../../../../external.html?link=https://avatars.githubusercontent.com/u/5836790?v=4" class="onebox-avatar-inline" width="20" height="20">
          guoyunhe
        </a>
      </div>
    </div>

    <div class="labels">
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          enhancement
        </span>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">I am working on Fcitx on KDE Wayland. Need to add the following environment vari<span class="show-more-container"><a href="#" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">ables:

```
INPUT_METHOD=fcitx
GTK_IM_MODULE=fcitx
QT_IM_MODULE=fcitx
```

It works when I write those into `/etc/environment`. But I need to package the configuration into package `fcitx` so it requires a separate file. I tried `/etc/environment.d/fcitx.conf` but it doesn't work.

Can pam support this? Thanks!</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<hr>
<p>Related discussions:</p>
<aside class="onebox githubissue" data-onebox-src="../../../../external.html?link=https://github.com/ayekat/localdir/issues/32">
  <header class="source">

      <a href="../../../../external.html?link=https://github.com/ayekat/localdir/issues/32" target="_blank" rel="noopener">github.com/ayekat/localdir</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue">
	  <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/ayekat/localdir/issues/32" target="_blank" rel="noopener">Switch to environment.d for setting envvars</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-11-05" data-time="13:53:05" data-timezone="UTC">01:53PM - 05 Nov 20 UTC</span>
      </div>

        <div class="date">
          closed <span class="discourse-local-date" data-format="ll" data-date="2021-04-16" data-time="20:31:50" data-timezone="UTC">08:31PM - 16 Apr 21 UTC</span>
        </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/ayekat" target="_blank" rel="noopener">
          <img alt="ayekat" src="../../../../external.html?link=https://avatars.githubusercontent.com/u/299058?v=4" class="onebox-avatar-inline" width="20" height="20">
          ayekat
        </a>
      </div>
    </div>

    <div class="labels">
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          Enhancement/Feature
        </span>
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          Fixed
        </span>
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          pam
        </span>
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          XDG
        </span>
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          systemd
        </span>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">With PAM developers having switched to setting `user_readenv` to 0 by default re<span class="show-more-container"><a href="#" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">cently, and now with them voicing their intent to [remove `~/.pam_environment` entirely](https://github.com/linux-pam/linux-pam/issues/7#issuecomment-721595903), it's a good moment to seriously start thinking about moving variable declaration to environment.d.

The downsides are:

* environment.d reads from `$XDG_CONFIG_HOME/environment.d`, so there is a bit of a bootstrapping issue here: with pam_env disappearing, one can no longer define `$XDG_CONFIG_HOME` before environment.d runs (so it will either default to the specification-defined default (`~/.config`), or whatever the local sysadmin decides to set system-wide). We'll need a not-too-painful way of adapting to the individual cases; probably by symlinking `~/system-specific-xdg_config_home/environment.d` to `~/.local/etc/environment.d` as part of the initial dotfiles setup.
* environment.d only applies to the systemd user daemon, but not the user *session*. So we will need a way to import variables into the login session as well. Either by `eval`ing the output of `systemctl show-environment`, or by reading the environment.d files directly (given that the `show-environment` output isn't POSIX conform, so we can't put that in `etc/sh/profile.d`).

It's less than ideal, but as far as I can see, it's the only thing that is currently left for setting environment variables.</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit" data-onebox-src="../../../../external.html?link=https://github.com/ayekat/localdir/commit/81bc3dd62ba1555ecbcda988b3011696993634a3">
  <header class="source">

      <a href="../../../../external.html?link=https://github.com/ayekat/localdir/commit/81bc3dd62ba1555ecbcda988b3011696993634a3" target="_blank" rel="noopener">github.com/ayekat/localdir</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/ayekat/localdir/commit/81bc3dd62ba1555ecbcda988b3011696993634a3" target="_blank" rel="noopener">Move variable declaration from pam_environment to environment.d</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2021-04-16" data-time="18:36:12" data-timezone="UTC">06:36PM - 16 Apr 21 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/ayekat" target="_blank" rel="noopener">
          <img alt="ayekat" src="../../../../external.html?link=https://avatars.githubusercontent.com/u/299058?v=4" class="onebox-avatar-inline" width="20" height="20">
          ayekat
        </a>
      </div>

      <div class="lines" title="changed 4 files with 103 additions and 42 deletions">
        <a href="../../../../external.html?link=https://github.com/ayekat/localdir/commit/81bc3dd62ba1555ecbcda988b3011696993634a3" target="_blank" rel="noopener">
          <span class="added">+103</span>
          <span class="removed">-42</span>
        </a>
      </div>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">Because environment.d only applies to the systemd user instance (but not
the use<span class="show-more-container"><a href="../../../../external.html?link=https://github.com/ayekat/localdir/commit/81bc3dd62ba1555ecbcda988b3011696993634a3" target="_blank" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">r session), we additionally need to process those files in the
login shell now. In the long term, we may want to move more variables to
environment.d (not just the ones for XDG).

We still keep pam_environment around for declaring XDG_CONFIG_HOME (to
solve the chicken-or-egg issue for systemd-environment-d-generator) and
ZDOTDIR (to solve the chicken-or-egg issue for zsh).

In cases where pam_env.so no longer loads ~/.pam_environment (either
because of local configuration, or because of pam_env.so dropping
support for that entirely), the work-around is to symlink ~/.config to
~/.local/lib/dotfiles/config (which then contains a single symlink for
environment.d) and symlink ~/.zlogin to ~/.local/etc/zsh/.zlogin.

An alternative would be to kindly ask the system administrator to set
XDG_CONFIG_HOME and ZDOTDIR to desired values for my user (though I
still have to find the most elegant way to achieve that).</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric" data-onebox-src="../../../../external.html?link=https://www.reddit.com/r/zsh/comments/3ubrdr/proper_way_to_set_zdotdir/">
  <header class="source">
      <img src="../../../../external.html?link=https://www.redditstatic.com/desktop2x/img/favicon/android-icon-192x192.png" class="site-icon" width="192" height="192">

      <a href="../../../../external.html?link=https://www.reddit.com/r/zsh/comments/3ubrdr/proper_way_to_set_zdotdir/" target="_blank" rel="noopener">reddit</a>
  </header>

  <article class="onebox-body">
    

<h3><a href="../../../../external.html?link=https://www.reddit.com/r/zsh/comments/3ubrdr/proper_way_to_set_zdotdir/" target="_blank" rel="noopener">r/zsh - Proper way to set $ZDOTDIR?</a></h3>

  <p>12 votes and 2 comments so far on Reddit</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='How to set global environment variables as a Linux distribution? - /etc/environment.d'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../change-default-shell-from-bash-to-zsh-by-default/14792/15.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../change-default-shell-from-bash-to-zsh-by-default/14792/15.html'>
                      <span itemprop='name'>Change default shell from bash to zsh by default?</span>
                    </a>
                    <meta itemprop='position' content='11'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../15635.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-28T11:12:46Z' class='post-time'>
                September 28, 2022, 11:12am
              </time>
              <meta itemprop='dateModified' content='2022-09-28T11:12:46Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>All packages shipped by Kicksecure / Whonix setting environment variables should deprecate their use of <code>/etc/X11/Xsession.d</code> and <code>/etc/profile.d</code>. Instead. the systemd <code>DefaultEnvironment</code> mechanism should be used.</p>
<p>This style:</p>
<aside class="quote no-group" data-username="Patrick" data-post="1" data-topic="15635">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<ul>
<li><code>/usr/lib/systemd/system.conf.d/30_kicksecure.conf</code></li>
</ul>
<pre><code class="lang-auto">[Manager]
DefaultEnvironment=TESTVAR=1
</code></pre>
</blockquote>
</aside>
<p>Of course, split into different files and contained in the packages that require these.</p>
<hr>
<p><code>/etc/X11/Xsession.d</code> and <code>/etc/profile.d</code> mechanism:</p>
<ul>
<li>Works in Debian (and Qubes Debian) in Xorg</li>
<li>Doesn’t work for virtual console with zsh.</li>
<li>Works with Wayland?</li>
<li>Works on non-systemd systems.
<ul>
<li>Related: <a href="../../../../external.html?link=https://phabricator.whonix.org/T998" class="inline-onebox">⚓ T998 Whonix without systemD</a> (Rejected.)</li>
<li>Therefore not important since there are no ports / maintainers for non-systemd enabled systems anyway and also one on the horizon. Other init systems would need to support something similar to <code>DefaultEnvironment</code>.</li>
</ul>
</li>
</ul>
<hr>
<p>systemd <code>DefaultEnvironment</code> mechanism:</p>
<ul>
<li>Works in Debian (and Qubes Debian) in Xorg</li>
<li>Doesn’t work for virtual console with zsh.</li>
<li>Probably works with Wayland.</li>
<li>Only for systemd enabled Linux distributions.</li>
</ul>
        </div>

        <meta itemprop='headline' content='How to set global environment variables as a Linux distribution? - /etc/environment.d'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../change-default-shell-from-bash-to-zsh-by-default/14792/24.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../change-default-shell-from-bash-to-zsh-by-default/14792/24.html'>
                      <span itemprop='name'>Change default shell from bash to zsh by default?</span>
                    </a>
                    <meta itemprop='position' content='2'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/nyxnor'><span itemprop='name'>nyxnor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../15635.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-28T11:22:20Z' class='post-time'>
                September 28, 2022, 11:22am
              </time>
              <meta itemprop='dateModified' content='2022-09-28T11:22:20Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="2" data-topic="15635">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p><code>/etc/profile.d</code></p>
</blockquote>
</aside>
<p>Just to note, this is for Bourne shells, not Z shells (unless in compatibility mode)</p>
        </div>

        <meta itemprop='headline' content='How to set global environment variables as a Linux distribution? - /etc/environment.d'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../15635.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-10-04T16:48:04Z' class='post-time'>
                October 4, 2022,  4:48pm
              </time>
              <meta itemprop='dateModified' content='2022-10-04T16:48:04Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>As mentioned here:</p>
<aside class="quote quote-modified" data-post="41" data-topic="14792">
  <div class="title">
    <div class="quote-controls"></div>
    <img loading="lazy" alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar">
    <a href="../../change-default-shell-from-bash-to-zsh-by-default/14792/41.html">Change default shell from bash to zsh by default?</a> <a class="badge-wrapper  bullet" href="../../../c/development/8.html"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of components looking for maintainer)">Development</span></a>
  </div>
  <blockquote>
    All of this is now in the developers repository. 

Two issues… 

inconsistent ZDOTDIR environment variable


bug: With lightdm display manager (on my Debian host operating system + distro morphed into Kicksecure): ZDOTDIR environment variable missing
ok: Whonix Xfce for VirtualBox which is using gdm display manager:  ZDOTDIR environment variable ok
ok: virtual consoles

Seems like DefaultEnvironment= isn’t as consistent / reliable as desired. 

changing default shell is failing in Whonix Xfce fo…
  </blockquote>
</aside>

<p>systemd <code>DefaultEnvironment</code> mechanism doesn’t work with display manager <code>lightdm</code> for some reason.</p>
<p>Therefore porting all of Kicksecure / Whonix to systemd <code>DefaultEnvironment</code> mechanism is probably not a good idea until that is resolved and this being more tested in more environments.</p>
        </div>

        <meta itemprop='headline' content='How to set global environment variables as a Linux distribution? - /etc/environment.d'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

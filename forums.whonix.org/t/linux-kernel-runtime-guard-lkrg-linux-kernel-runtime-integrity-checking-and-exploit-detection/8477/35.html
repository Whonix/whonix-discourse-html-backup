<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection - #35 by Patrick - Development - Whonix Forum</title>
    <meta name="description" content="Quote https://www.openwall.com/lkrg/ 

Linux Kernel Runtime Guard (LKRG) is a loadable kernel module that performs runtime integrity checking of the Linux kernel and detection of security vulnerability exploits against t&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../84774658.html?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection&#39;" href="../8477.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/linux-kernel-runtime-guard-lkrg-linux-kernel-runtime-integrity-checking-and-exploit-detection/8477/35" />
<meta name="twitter:url" content="https://forums.whonix.org/t/linux-kernel-runtime-guard-lkrg-linux-kernel-runtime-integrity-checking-and-exploit-detection/8477/35" />
<meta property="og:title" content="Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection" />
<meta name="twitter:title" content="Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection" />
<meta property="og:description" content="As for LKRG loading it as early as possible is non-trivial. Currently loading LKRG as early as possible would cause some issues. For example it would detect changes by tirdad as malicious and show a lot false positive messages. Asked upstream about it:  Compiling LKRG static into the Kernel / Loading LKRG kernel module as early as possible or after other modules?" />
<meta name="twitter:description" content="As for LKRG loading it as early as possible is non-trivial. Currently loading LKRG as early as possible would cause some issues. For example it would detect changes by tirdad as malicious and show a lot false positive messages. Asked upstream about it:  Compiling LKRG static into the Kernel / Loading LKRG kernel module as early as possible or after other modules?" />
<meta property="article:published_time" content="2020-02-01T13:30:02+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="../8477.html">
        <link rel="next" href="../84779ba9.html?page=3">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../8477.html">Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-15T13:43:26Z' class='post-time'>
                January 15, 2020,  1:43pm
              </time>
              <meta itemprop='dateModified' content='2020-01-15T13:43:26Z'>
          <span itemprop='position'>#30</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>LKRG is not yet compatible with hardened kernel.</p>
<aside class="quote quote-modified" data-post="259" data-topic="7598">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="../../kernel-recompilation-for-better-hardening/7598/259.html">kernel recompilation for better hardening</a> <a class="badge-wrapper  bullet" href="../../../c/development/8.html"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    hardened-kernel 0.8-1 on Non-Qubes-Whonix Whonix-Gateway and Whonix-Workstation. 
DKMS does not run during linux kernel package upgrade. Therefore after reboot LKRG and tirdad no longer functions. 

Jan 15 13:36:06 host modprobe[213]: modprobe: ERROR: could not insert ‘p_lkrg’: Exec format error 

Workaround until DKMS will be properly run after kernel package upgrade: 
sudo apt install --reinstall lkrg-dkms tirdad-dkms

Tirdad is fixed after that procedure. 
DKMS might not run since the package…
  </blockquote>
</aside>

<p>Not worth contacting upstream about it yet. I am still waiting for upstream to provide signed git commits so I can test a newer version before more experimentation is worthwhile.</p>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-17T13:37:03Z' class='post-time'>
                January 17, 2020,  1:37pm
              </time>
              <meta itemprop='dateModified' content='2020-01-17T13:37:03Z'>
          <span itemprop='position'>#31</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Upstream providing signed git commits now.</p>
<p>LKRG pacakge in Whonix git master and developers repository updated as per:</p>
<blockquote>
<p>LKRG version commit 403f2fa92cdb8071a39afa031f08719972aa563e<br>
Date:   Thu Jan 16 06:05:15 2020 +0000<br>
Commit message: Fix compilation on non-x86 platforms for kernel 5.3+</p>
</blockquote>
<hr>
<aside class="quote no-group quote-modified" data-post="18" data-topic="8477">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Bug on Qubes, Debian buster.</p>
<pre><code class="lang-auto">cat /proc/version
</code></pre>
<blockquote>
<p>Linux version 5.3.0-0.bpo.2-amd64 (debian-kernel@…<a href="../../../../external.html?link=http://ts.debian.org/">ts.debian.org</a>) (gcc<br>
version 8.3.0 (Debian 8.3.0-6)) <span class="hashtag">#1</span> SMP Debian 5.3.9-2~bpo10+1 (2019-11-13)</p>
</blockquote>
</blockquote>
</aside>
<aside class="quote no-group quote-modified" data-post="18" data-topic="8477">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<blockquote>
<p>[p_lkrg] [KOBJ] ALERT !!! MODULE’S &lt;nf_nat&gt; HASH IS DIFFERENT it is<br>
[0x3d9dae4aaff5f86d] and should be [0xd8e509a7b4d09682] !!!<br>
[p_lkrg] ALERT !!! SYSTEM HAS BEEN COMPROMISED - DETECTED DIFFERENT 7<br>
CHECKSUMS !!!</p>
</blockquote>
<p>reported upstream:<br>
<a href="../../../../external.html?link=https://www.openwall.com/lists/lkrg-users/2019/12/23/1">https://www.openwall.com/lists/lkrg-users/2019/12/23/1</a></p>
</blockquote>
</aside>
<p>Fixed. Reported. And found maybe another (smaller) issue:</p>
<p><a href="../../../../external.html?link=https://www.openwall.com/lists/lkrg-users/2020/01/17/2">? p_kmod_hash+0x2a1/0x3b0 [p_lkrg] - was: LIST HASH IS DIFFERENT -<br>
nf_nat / nf_conntrack Linux version 5.3.0-0</a></p>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-24T06:23:47Z' class='post-time'>
                January 24, 2020,  6:23am
              </time>
              <meta itemprop='dateModified' content='2020-01-24T06:23:47Z'>
          <span itemprop='position'>#32</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="11" data-topic="8477">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p><a href="../../../../external.html?link=https://www.openwall.com/lists/lkrg-users/2019/11/18/1">LKRG kills VirtualBox host VMs</a> <a href="../../../../external.html?link=https://web.archive.org/web/https://www.openwall.com/lists/lkrg-users/2019/11/18/1">[archive]</a></p>
</blockquote>
</aside>
<p>VirtualBox host support is now on the horizon:<br>
<a href="../../../../external.html?link=https://www.openwall.com/lists/lkrg-users/2020/01/24/1" class="onebox" target="_blank">https://www.openwall.com/lists/lkrg-users/2020/01/24/1</a></p>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-24T07:31:25Z' class='post-time'>
                January 24, 2020,  7:31am
              </time>
              <meta itemprop='dateModified' content='2020-01-24T07:31:25Z'>
          <span itemprop='position'>#33</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><a href="../../../../external.html?link=https://www.openwall.com/lists/lkrg-users/2020/01/24/2">sysctl vs module parameters / Can sysctl be set before loading the module? | was: bug: LKRG kills VirtualBox host VMs</a></p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/5da17965c12aa2e65dc54e4ef48286959ac5ba61" target="_blank">github.com/Whonix/lkrg</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/5da17965c12aa2e65dc54e4ef48286959ac5ba61" target="_blank">add VirtualBox host support</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-01-24" data-time="07:30:15" data-timezone="UTC">07:30AM - 24 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 4 files with 37 additions and 1 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/5da17965c12aa2e65dc54e4ef48286959ac5ba61" target="_blank">
          <span class="added">+37</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">add user space loader which sets `lkrg.enforce_msr=0 lkrg.enforce_pcfi=1`
Do not start lkrg systemd service after installation to avoid
loading LKRG kernel module to...</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-24T15:37:46Z' class='post-time'>
                January 24, 2020,  3:37pm
              </time>
              <meta itemprop='dateModified' content='2020-01-24T15:37:46Z'>
          <span itemprop='position'>#34</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/b75086f195069767e8b60789d4790e282188da74" target="_blank">github.com/Whonix/lkrg</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/b75086f195069767e8b60789d4790e282188da74" target="_blank">lkrg-loader: remove "lsmod | grep -q vbox" from VirtualBox host detection</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-01-24" data-time="07:40:11" data-timezone="UTC">07:40AM - 24 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 0 additions and 4 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/b75086f195069767e8b60789d4790e282188da74" target="_blank">
          <span class="added">+0</span>
          <span class="removed">-4</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">since this would be true in VirtualBox guest VM as well</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/a05cd57ac2630e0ceef551a8b52e1eded56daf5c" target="_blank">github.com/Whonix/lkrg</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/a05cd57ac2630e0ceef551a8b52e1eded56daf5c" target="_blank">fix path to lkrg-loader</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-01-24" data-time="07:53:32" data-timezone="UTC">07:53AM - 24 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 1 additions and 1 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/a05cd57ac2630e0ceef551a8b52e1eded56daf5c" target="_blank">
          <span class="added">+1</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>

  </div>
</div>




  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/dd41ee489abe519e215506567fb50669be11d319" target="_blank">github.com/Whonix/lkrg</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/dd41ee489abe519e215506567fb50669be11d319" target="_blank">Load LKRG before VirtualBox kernel module load service.</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-01-24" data-time="09:08:47" data-timezone="UTC">09:08AM - 24 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 4 additions and 0 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/dd41ee489abe519e215506567fb50669be11d319" target="_blank">
          <span class="added">+4</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>




  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<hr>
<p><a href="../../../../external.html?link=https://www.openwall.com/lists/lkrg-users/2020/01/24/3">UMH blocked when though lkrg.block_modules = 0</a></p>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-02-01T13:30:02Z' class='post-time'>
                February 1, 2020,  1:30pm
              </time>
              <meta itemprop='dateModified' content='2020-02-01T13:30:02Z'>
          <span itemprop='position'>#35</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="358" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"><a href="../../kernel-hardening/7296/358">Kernel Hardening</a>
</div>
<blockquote>
<p>LKRG and tirdad should be loaded as early as possible. Preferably, they would also be built-in but that’s not supported (yet?).</p>
</blockquote>
</aside>
<p>As for LKRG loading it as early as possible is non-trivial. Currently loading LKRG as early as possible would cause some issues. For example it would detect changes by tirdad as malicious and show a lot false positive messages. Asked upstream about it:</p>
<p><a href="../../../../external.html?link=https://www.openwall.com/lists/lkrg-users/2020/02/01/2">Compiling LKRG static into the Kernel / Loading LKRG kernel module as early as possible or after other modules?</a></p>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../kernel-hardening/7296/359.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../kernel-hardening/7296/359.html'>
                      <span itemprop='name'>Kernel Hardening</span>
                    </a>
                    <meta itemprop='position' content='3'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-02-13T00:15:14Z' class='post-time'>
                February 13, 2020, 12:15am
              </time>
              <meta itemprop='dateModified' content='2020-02-13T00:15:14Z'>
          <span itemprop='position'>#36</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>The wiki page got noticed by spender.</p>
<aside class="onebox twitterstatus">
  <header class="source">
      <a href="../../../../external.html?link=https://twitter.com/grsecurity/status/1227663796761747456" target="_blank">twitter.com</a>
  </header>
  <article class="onebox-body">
    <img src="../../../../external.html?link=https://pbs.twimg.com/profile_images/886033783165771779/ZhFjJ6L-_400x400.jpg" class="thumbnail onebox-avatar" width="60" height="60">

<h4><a href="../../../../external.html?link=https://twitter.com/grsecurity/status/1227663796761747456" target="_blank">grsecurity (grsecurity)</a></h4>

<div class="tweet"> <a href="../../../../external.html?link=https://twitter.com/ChaosDatumz" target="_blank">@ChaosDatumz</a> Didn't see this other part -- I would take anything published by Whonix with a (gigantic? tiny? whichever is worse) grain of salt when it comes to anything security-related.  Oh, and this one didn't age too well: <a target="_blank" href="../../beyond-grsecurity-the-future-of-linux-security-is-brighter-than-ever/3842.html">forums.whonix.org/t/beyond-grsec…</a>
</div>

<div class="date">
  <a href="../../../../external.html?link=https://twitter.com/grsecurity/status/1227663796761747456" target="_blank">6:40 PM - 12 Feb 2020</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-02-14T08:39:58Z' class='post-time'>
                February 14, 2020,  8:39am
              </time>
              <meta itemprop='dateModified' content='2020-02-14T08:39:58Z'>
          <span itemprop='position'>#37</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="1" data-topic="8931">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="../../dkms-kernel-modules-lkrg-and-tirdad-fail-to-properly-recompile-on-kernel-upgrade/8931.html">DKMS kernel modules (LKRG and tirdad) fail to properly recompile on kernel upgrade</a> <a class="badge-wrapper  bullet" href="../../../c/development/8.html"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    Confirmed. Investigating.
  </blockquote>
</aside>

        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-02-14T09:22:56Z' class='post-time'>
                February 14, 2020,  9:22am
              </time>
              <meta itemprop='dateModified' content='2020-02-14T09:22:56Z'>
          <span itemprop='position'>#38</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Above fixed.</p>
<hr>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/878f2dcc895d609082110cf20b5d59164f3535b8" target="_blank">github.com/Whonix/lkrg</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/878f2dcc895d609082110cf20b5d59164f3535b8" target="_blank">Auto load LKRG after installation.</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-02-14" data-time="09:19:45" data-timezone="UTC">09:19AM - 14 Feb 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 0 additions and 3 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/878f2dcc895d609082110cf20b5d59164f3535b8" target="_blank">
          <span class="added">+0</span>
          <span class="removed">-3</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">Since LKRG now supports module parameters and VirtualBox host support,
it can be automatically started after installation since it would no longer
kill...</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-02-14T11:25:29Z' class='post-time'>
                February 14, 2020, 11:25am
              </time>
              <meta itemprop='dateModified' content='2020-02-14T11:25:29Z'>
          <span itemprop='position'>#39</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><a href="../../../../external.html?link=https://www.openwall.com/lists/lkrg-users/2020/02/14/2">LKRG is compatible with Debian Linux buster-backports 5.4.8-1~bpo10+1 kernel</a></p>
<p>A Debian issue but unrelated to LKRG:<br>
<a href="../../../../external.html?link=https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=951315">linux-image-amd64 vs linux-headers-amd64 Debian buster-backports version mismatch bpo.2 vs bpo.3</a></p>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-04-23T16:46:57Z' class='post-time'>
                April 23, 2020,  4:46pm
              </time>
              <meta itemprop='dateModified' content='2020-04-23T16:46:57Z'>
          <span itemprop='position'>#40</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <ul>
<li><a href="../../../../external.html?link=https://www.openwall.com/lists/lkrg-users/2020/04/18/1">testing LKRG</a></li>
<li><a href="../../../../external.html?link=https://www.openwall.com/lists/lkrg-users/2020/04/23/1">LKRG unfit for installation by default in Whonix / Kicksecure due to kernel boot console output - usability issue</a></li>
</ul>
<p>Related: <a href="../../../../external.html?link=https://phabricator.whonix.org/T950">T950: prevent kernel info leaks</a></p>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-05-07T12:48:38Z' class='post-time'>
                May 7, 2020, 12:48pm
              </time>
              <meta itemprop='dateModified' content='2020-05-07T12:48:38Z'>
          <span itemprop='position'>#41</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Rebased on upstream master branch.</p>
<aside class="quote no-group" data-username="Patrick" data-post="40" data-topic="8477">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p><a href="../../../../external.html?link=https://www.openwall.com/lists/lkrg-users/2020/04/23/1">LKRG unfit for installation by default in Whonix / Kicksecure due to kernel boot console output - usability issue</a></p>
</blockquote>
</aside>
<p>This was addressed by upstream:<br>
<a href="../../../../external.html?link=https://www.openwall.com/lists/lkrg-users/2020/04/23/2">https://www.openwall.com/lists/lkrg-users/2020/04/23/2</a></p>
<hr>
<p>A bug was privately reported and upstream is on it already:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://d301sr5gafysq2.cloudfront.net/4db2538192ba/img/logos/bitbucket/android-chrome-192x192.png" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://bitbucket.org/Adam_pi3/lkrg-main/pull-requests/4" target="_blank">bitbucket.org</a>
  </header>
  <article class="onebox-body">
    <img src="../../../../external.html?link=https://bytebucket.org/ravatar/%7B225cf208-ae7e-4a0d-a154-46295859819b%7D?ts=c" class="thumbnail" width="" height="">

<h3><a href="../../../../external.html?link=https://bitbucket.org/Adam_pi3/lkrg-main/pull-requests/4" target="_blank">If SMEP is not support on the architecture don't enforce it.</a></h3>

<p>While loading the LKRG on my VM I got automatically panic.  
This occure after the 2aef433.

‌</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Added a workaround (useful anyhow) in meanwhile:</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/54cbae96c97127b8b8ee654e44d5869ad90adf4c" target="_blank">github.com/Whonix/lkrg</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/54cbae96c97127b8b8ee654e44d5869ad90adf4c" target="_blank">set smep_enforce=0 if SMEP not available</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-05-06" data-time="18:57:11" data-timezone="UTC">06:57PM - 06 May 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 15 additions and 3 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/commit/54cbae96c97127b8b8ee654e44d5869ad90adf4c" target="_blank">
          <span class="added">+15</span>
          <span class="removed">-3</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">allow appending lkrg_opts kernel paramaters
allow replacing whole lkrg invocation through lkrg_exec</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-06-14T16:57:42Z' class='post-time'>
                June 14, 2020,  4:57pm
              </time>
              <meta itemprop='dateModified' content='2020-06-14T16:57:42Z'>
          <span itemprop='position'>#42</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Quote <a href="../../../../external.html?link=https://www.openwall.com/lists/lkrg-users/2020/06/14/5">https://www.openwall.com/lists/lkrg-users/2020/06/14/5</a></p>
<blockquote>
<p>Date: Sun, 14 Jun 2020 17:37:59 +0200<br>
From: Solar Designer &lt;solar@…nwall.com&gt;<br>
To: lkrg-users@…ts.openwall.com<br>
Subject: rootkit detection</p>
<p>Hi,</p>
<p>Adam found this interesting Master’s Thesis of Juho Junnila, entitled<br>
“Effectiveness of Linux Rootkit Detection Tools”:</p>
<p><a href="../../../../external.html?link=http://jultika.oulu.fi/files/nbnfioulu-202004201485.pdf">http://jultika.oulu.fi/files/nbnfioulu-202004201485.pdf</a></p>
<p>It shows LKRG as the most effective kernel rootkit detector (of those<br>
tested), as long as LKRG is loaded before the rootkit.  It also shows<br>
LKRG sometimes detect rootkits even when LKRG is loaded after the<br>
rootkit (we never intended that to work, but it sometimes does anyway,<br>
which is OK).  Finally, it shows that LKRG never detects pure userspace<br>
rootkits (as expected; it would probably be a bug if it did).</p>
<p>In particular, when LKRG is loaded before the rootkit, it detected 8 out<br>
of 9 kernel rootkits tested: Diamorphine, Honey Pot Bears,<br>
LilyOfTheValley, Nuk3 Gh0st, Puszek, Reptile, Rootfoo Linux Rootkit,<br>
Sutekh.  There were no false positives.  No other tested rootkit<br>
detector was anywhere close to LKRG’s effectiveness at detecting kernel<br>
rootkits, with AIDE, OSSEC, and Rootkit Hunter detecting 2 out of 9<br>
each, and Chkrootkit detecting none.  These other detectors did,<br>
however, detect some userspace rootkits, which LKRG doesn’t try to.  The<br>
combination of AIDE and LKRG is shown to be most effective, detecting 14<br>
out of 15 rootkits total (both user and kernel space ones).</p>
<p>None of the tools detected Keysniffer, which the thesis describes as:</p>
<p>“Keysniffer is an LKM that can be classified as a kernel mode rootkit<br>
due to its kernel hooking capabilities.  It is a keylogger that records<br>
keyboard events to debugfs, an in-memory file system used for Linux<br>
kernel debugging.  It does not feature any particular anti-detection<br>
mechanisms except that it prevents accessing the log file by non-root<br>
users and the module is named “kisni.ko” by default to avoid immediate<br>
suspicion when listing kernel modules. (Jana, 2019.)  While Keysniffer<br>
may not meet the criteria of all rootkit definitions due to its lack of<br>
specific hiding functionalities, it does meet the criteria by Harley and<br>
Lee (2007) and is thus included in this study.”</p>
<p>While the above doesn’t say it, I think the non-detection of Keysniffer<br>
by LKRG is due to it being too similar to non-malicious kernel modules.<br>
The functionality described would conceivably be provided by a module<br>
not intended for malicious use, and the module doesn’t need to mess with<br>
the kernel’s integrity to provide this functionality.  The non-detection<br>
by other tools is probably because Keysniffer wasn’t popular enough, as<br>
its signature-based detection is definitely practical.</p>
<p>Of course, none of these rootkits tried to bypass LKRG.  If they wanted<br>
to, they could e.g. simply “rmmod p_lkrg” before loading themselves into<br>
the kernel.  (Or the attacker could do that manually.)  In LKRG<br>
development, we’re currently more focused on exploits run before the<br>
attacker got legitimate-looking privileged access to the system.  We’re<br>
not as focused on rootkits, which are loaded with legitimate-looking<br>
privileged access.</p>
<p>That said, there are a few things we could do in the future to make it<br>
more difficult and/or less reliable to bypass detection by LKRG-aware<br>
rootkit loading.  We could password-protect the module unloading and<br>
sysctl interfaces of LKRG, and/or provide a way to disable those after<br>
initial configuration.  We could also provide setup instructions and/or<br>
our own userspace components around LKRG where alerts would be sent to a<br>
remote system, including alerts of LKRG being unloaded or reconfigured.</p>
<p>Alexander</p>
</blockquote>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
              split this topic 
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-06-15T14:56:11Z' class='post-time'>
                June 15, 2020,  2:56pm
              </time>
              <meta itemprop='dateModified' content='2020-06-15T14:56:11Z'>
          <span itemprop='position'>#43</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>A post was split to a new topic: <a href="../../rootkit-detection-system-aide/9754.html">rootkit detection system - AIDE</a></p>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-08-25T14:46:27Z' class='post-time'>
                August 25, 2020,  2:46pm
              </time>
              <meta itemprop='dateModified' content='2020-08-25T14:46:27Z'>
          <span itemprop='position'>#44</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>LKRG 0.8.1 is in all repositories since some time now.</p>
<hr>
<p><a href="../../../../external.html?link=https://www.openwall.com/presentations/OSTconf2020-LKRG-In-A-Nutshell/" class="onebox" target="_blank">https://www.openwall.com/presentations/OSTconf2020-LKRG-In-A-Nutshell/</a></p>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-19T20:29:23Z' class='post-time'>
                December 19, 2020,  8:29pm
              </time>
              <meta itemprop='dateModified' content='2020-12-19T20:29:23Z'>
          <span itemprop='position'>#45</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>When LKRG is installed on one kernel and then the user switches to another kernel, it breaks (e.g. installing it on hardened-kernel and then booting into vanilla):</p>
<pre><code class="lang-auto">lkrg-loader[249]: INFO: Running 'modprobe p_lkrg msr_validate=0 pcfi_validate=1 ' ...
lkrg-loader[249]: modprobe: FATAL: Module p_lkrg not found in directory /lib/modules/4.19.0-13-amd64
lkrg-loader[249]: ####################################################################
lkrg-loader[249]: ## BEGIN ERROR in /usr/lib/lkrg/lkrg-loader detected!
lkrg-loader[249]: ##
lkrg-loader[249]: ## ERROR LOG:
lkrg-loader[249]: ## See above.
lkrg-loader[249]: ##
lkrg-loader[249]: ## BASH_COMMAND: modprobe p_lkrg $lkrg_opts
lkrg-loader[249]: ## EXIT_CODE: 1
lkrg-loader[249]: ##
lkrg-loader[249]: ## END ERROR in /usr/lib/lkrg/lkrg-loader detected!
lkrg-loader[249]: ## Please report this bug!
lkrg-loader[249]: ####################################################################
</code></pre>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-20T06:37:38Z' class='post-time'>
                December 20, 2020,  6:37am
              </time>
              <meta itemprop='dateModified' content='2020-12-20T06:37:38Z'>
          <span itemprop='position'>#46</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>How did you install hardened-kernel? <code>dpkg</code> or APT? Could you share installation log please? I would like to see any messages regarding DKMS.</p>
<p>The LKRG Debian packaging supports DKMS. It’s already confirmed to work stable during Debian kernel upgrades. From LKRG / DKMS perspective, I wonder what is making the difference.</p>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-21T19:28:40Z' class='post-time'>
                December 21, 2020,  7:28pm
              </time>
              <meta itemprop='dateModified' content='2020-12-21T19:28:40Z'>
          <span itemprop='position'>#47</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="46" data-topic="8477">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>How did you install hardened-kernel? <code>dpkg</code> or APT?</p>
</blockquote>
</aside>
<p>APT.</p>
<aside class="quote no-group" data-username="Patrick" data-post="46" data-topic="8477">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Could you share installation log please? I would like to see any messages regarding DKMS.</p>
</blockquote>
</aside>
<pre><code class="lang-auto">user@host:~$ sudo apt install lkrg
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following packages were automatically installed and are no longer required:
  linux-headers-4.19.0-10-amd64 linux-headers-4.19.0-10-common linux-headers-4.19.0-11-amd64 linux-headers-4.19.0-11-common
  linux-image-4.19.0-10-amd64 linux-image-4.19.0-11-amd64
Use 'sudo apt autoremove' to remove them.
The following additional packages will be installed:
  lkrg-dkms
The following NEW packages will be installed:
  lkrg lkrg-dkms
0 upgraded, 2 newly installed, 0 to remove and 1 not upgraded.
Need to get 97.0 kB of archives.
After this operation, 897 kB of additional disk space will be used.
Do you want to continue? [Y/n] 
Get:1 tor+https://deb.whonix.org buster-developers/main amd64 lkrg-dkms amd64 0:0.8.1.0-1 [89.9 kB]
Get:2 tor+https://deb.whonix.org buster-developers/main amd64 lkrg amd64 0:0.8.1.0-1 [7,064 B]
Fetched 97.0 kB in 3s (36.5 kB/s)
Selecting previously unselected package lkrg-dkms.
(Reading database ... 181991 files and directories currently installed.)
Preparing to unpack .../lkrg-dkms_0%3a0.8.1.0-1_amd64.deb ...
Unpacking lkrg-dkms (0.8.1.0-1) ...
Selecting previously unselected package lkrg.
Preparing to unpack .../lkrg_0%3a0.8.1.0-1_amd64.deb ...
Unpacking lkrg (0.8.1.0-1) ...
Setting up lkrg-dkms (0.8.1.0-1) ...
Loading new lkrg-0.8.1 DKMS files...
Building for 4.19.122
Building initial module for 4.19.122
Done.

p_lkrg.ko:
Running module version sanity check.
 - Original module
   - No original module exists within this kernel
 - Installation
   - Installing to /lib/modules/4.19.122/updates/dkms/

depmod...

DKMS: install completed.
Created symlink /etc/systemd/system/multi-user.target.wants/lkrg-dkms.service → /lib/systemd/system/lkrg-dkms.service.
Setting up lkrg (0.8.1.0-1) ...
</code></pre>
<aside class="quote no-group" data-username="Patrick" data-post="46" data-topic="8477">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>The LKRG Debian packaging supports DKMS. It’s already confirmed to work stable during Debian kernel upgrades. From LKRG / DKMS perspective, I wonder what is making the difference.</p>
</blockquote>
</aside>
<p>The module is only present for a specific kernel. E.g. in my case it is installed in <code>/lib/modules/4.19.122</code> but not anything else in <code>/lib/modules</code>. Further verified by:</p>
<pre><code class="lang-auto">user@host:~$ sudo modinfo p_lkrg
filename:       /lib/modules/4.19.122/updates/dkms/p_lkrg.ko
[...]
</code></pre>
<p>Whereas, on the other kernel:</p>
<pre><code class="lang-auto">user@host:~$ sudo modinfo lkrg
modinfo: ERROR: Module lkrg not found.
</code></pre>
<p>Thus, the <code>modprobe</code> command cannot find which module to load.</p>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-21T21:30:24Z' class='post-time'>
                December 21, 2020,  9:30pm
              </time>
              <meta itemprop='dateModified' content='2020-12-21T21:30:24Z'>
          <span itemprop='position'>#48</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="47" data-topic="8477">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><code>user@host:~$ sudo modinfo p_lkrg</code></p>
</blockquote>
</aside>
<aside class="quote no-group" data-username="madaidan" data-post="47" data-topic="8477">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><code>user@host:~$ sudo modinfo lkrg</code></p>
</blockquote>
</aside>
<p>Different command. <code>p_lkrg</code>. (I didn’t invent the <code>p_</code>. Upstream did.) But probably just a mistake. Not the reason.</p>
<p>So you had kernels 4.19.0 and 4.19.122 installed. The latter, the newer kernel version 4.19.122 was loaded. Kernel module was build for 4.19.122 only. Right?</p>
<p>I wonder how/if this can be fixed. See  the DKMS file,<code>debian/lkrg-dkms.dkms</code>.</p>
<aside class="onebox githubblob">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/blob/master/debian/lkrg-dkms.dkms" target="_blank" rel="noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="../../../../external.html?link=https://github.com/Whonix/lkrg/blob/master/debian/lkrg-dkms.dkms" target="_blank" rel="noopener">Whonix/lkrg/blob/master/debian/lkrg-dkms.dkms</a></h4>
<pre><code class="lang-dkms">## Copyright (C) 2019 - 2020 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions.

PACKAGE_NAME="lkrg"

## TODO: how?
#PACKAGE_VERSION="#MODULE_VERSION#"

PACKAGE_VERSION="0.8.1"

BUILT_MODULE_LOCATION[0]="output"
BUILT_MODULE_NAME[0]="p_lkrg"

DEST_MODULE_LOCATION[0]="/extra"
DEST_MODULE_NAME[0]="p_lkrg"

AUTOINSTALL="yes"

ENOUGH_RAM="1950"
total_ram="$(free -m | sed  -n -e '/^Mem:/s/^[^0-9]*\([0-9]*\) .*/\1/p')"
</code></pre>

  This file has been truncated. <a href="../../../../external.html?link=https://github.com/Whonix/lkrg/blob/master/debian/lkrg-dkms.dkms" target="_blank" rel="noopener">show original</a>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Then feel free to compare with this with other DKMS files.</p>
<p>Try:</p>
<pre><code>sudo dkms status
</code></pre>
<p>Also interesting:</p>
<blockquote>
<p>/var/lib/dpkg/info/lkrg-dkms.postinst</p>
</blockquote>
<pre><code>sudo sh -x /var/lib/dpkg/info/lkrg-dkms.postinst configure
</code></pre>
<p>Reveals what is required to debug further:</p>
<pre><code>sudo sh -x /usr/lib/dkms/common.postinst lkrg 0.8.1 /usr/share/lkrg-dkms
</code></pre>
<p>The latter shows how list of kernels is generated. (Runs as root.)</p>
<pre><code>KERNELS=$(ls /lib/modules/ 2&gt;/dev/null || true)
</code></pre>
<p>Try this command.</p>
<pre><code>sudo ls /lib/modules/
</code></pre>
<p>Perhaps apparmor-profile-everything or other issue which messes up setting of <code>KERNELS</code>? xtrace of <code>/usr/lib/dkms/common.postinst </code> might reveal that.</p>
<p>For me it builds modules for all installed kernel versions. I guess that is the default.</p>
<p>Dunno if DKMS in Debian only works for APT installed kernels but we’re already talking only about APT installed kernels here.</p>
<blockquote>
<p>/etc/dkms/framework.conf</p>
</blockquote>
<pre><code>## Automatic installation and upgrade for all installed kernels (if set to a
## non-null value)
# autoinstall_all_kernels=""
</code></pre>
<p>Quote <a href="../../../../external.html?link=https://bugs.launchpad.net/ubuntu/+source/ubuntu-release-upgrader/+bug/1844805">https://bugs.launchpad.net/ubuntu/+source/ubuntu-release-upgrader/+bug/1844805</a></p>
<blockquote>
<p>I see there’s one caveat, the autoinstall_all_kernels variable in /etc/dkms/framework.conf can be set to build for all installed kernels, not just the current and newest. But the default is to build only for current and newest.</p>
</blockquote>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8477.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-21T21:46:45Z' class='post-time'>
                December 21, 2020,  9:46pm
              </time>
              <meta itemprop='dateModified' content='2020-12-21T21:46:45Z'>
          <span itemprop='position'>#49</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="48" data-topic="8477">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Different command. <code>p_lkrg</code>. (I didn’t invent the <code>p_</code>. Upstream did.) But probably just a mistake. Not the reason.</p>
</blockquote>
</aside>
<p>They’re interchangeable and neither work on the second kernel while both work on the first.</p>
<aside class="quote no-group" data-username="Patrick" data-post="48" data-topic="8477">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>So you had kernels 4.19.0 and 4.19.122 installed. The latter, the newer kernel version 4.19.122 was loaded. Kernel module was build for 4.19.122 only. Right?</p>
</blockquote>
</aside>
<p>Yes.</p>
<aside class="quote no-group" data-username="Patrick" data-post="48" data-topic="8477">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Dunno if DKMS in Debian only works for APT installed kernels but we’re already talking only about APT installed kernels here.</p>
</blockquote>
</aside>
<p>I compiled hardened-kernel manually and installed it via <code>dpkg -i</code>. I don’t think that would be classified as an “APT installed kernel”. hardened-kernel is the 4.19.122 one.</p>
<aside class="quote no-group" data-username="Patrick" data-post="48" data-topic="8477">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<pre><code class="lang-auto">## Automatic installation and upgrade for all installed kernels (if set to a
## non-null value)
# autoinstall_all_kernels=""
</code></pre>
</blockquote>
</aside>
<p>Setting</p>
<pre><code>autoinstall_all_kernels="yes"
</code></pre>
<p>fixed it.</p>
        </div>

        <meta itemprop='headline' content='Linux Kernel Runtime Guard (LKRG) - Linux Kernel Runtime Integrity Checking and Exploit Detection'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="../8477.html">← previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="../84779ba9.html?page=3">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>kvm-clock instead of timesync on install in gateway</title>
    <link>http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587</link>
    <description>Installed Whonix (13.0.0.1.1) in KVM on debian 8.5 following https://www.whonix.org/wiki/KVM quite closely. But after starting the Whonix gateway and running whonix check I get the error:

[quote]PVClock Test Result:
Unwanted PVClock kvm-clock acpi_pm detected! Using this PVClock together with whonix is recommended against, because it conflicts with Whonix&#39;s TimwAnc design [1].

If you know what you are doing, feel free to disable this check. Create a file /etc/whonix.d/50_whonixcheck_user.conf and add:
        
        whonixcheck_skip_functions+=&quot;pvclock_unwanted_detected&#39;

Recommand action: 
- If you are using KVM, you probably did not follow Whonix&#39;s KVM instructions. [2]
[/quote]

The Gateway does indeed has kvm-time installed/active and no timesync installed. The Workstation does has timesync and it works as was used to with VirtualBox.

Wondering what went wrong with the install and how this problem can be fixed in a safe/secure manner. KVM-time instead of the normal timesync seems to be a serious risk for anonymity (linking host time to Gateway).</description>
    <language>en</language>
    <lastBuildDate>Tue, 19 Jan 2021 05:33:06 +0000</lastBuildDate>
    <category>KVM</category>
    <atom:link href="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>kvm-clock instead of timesync on install in gateway</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="alabay" data-post="8" data-topic="2587">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/a/e5b9ba/40.png" class="avatar"> alabay:</div>
<blockquote>
<p>I have two “Whonix-Gateway.xml” and “Whonix-Workstation.xml” files in directories “/etc/libvirt/qemu” and “/run/libvert/qemu”. In which directory should I Convert Libvirt Templates to QEMU?</p>
</blockquote>
</aside>
<p>According to instructions: neither. The <code>Whonix-Workstation.xml</code> file is generated by running the <code>sudo virsh dumpxml [...]</code> command.</p>
          <p><a href="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/9</link>
        <pubDate>Tue, 19 Jan 2021 05:33:06 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2587-9</guid>
        <source url="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587.rss">kvm-clock instead of timesync on install in gateway</source>
      </item>
      <item>
        <title>kvm-clock instead of timesync on install in gateway</title>
        <dc:creator><![CDATA[alabay]]></dc:creator>
        <description><![CDATA[
            <p>Thanks for replying.</p>
<blockquote>
<p>One reason might either be a too old KVM version or newer version than Whonix KVM was tested with.</p>
</blockquote>
<p>I Installed it last week by running the command “sudo apt install virt-manager”.</p>
<blockquote>
<p>What’s your host operating system and version?</p>
</blockquote>
<pre><code>Linux Mint 20 Cinnamon (Cinnamon version 4.6.7).
Kernel: Linux 5.4.0-60-generic.
</code></pre>
<blockquote>
<p>What’s your KVM version?</p>
</blockquote>
<p>When I run “apt show -a qemu-system-x86” it says:<br>
Package: qemu-system-x86<br>
Version: 1:4.2-3ubuntu6.10</p>
<blockquote>
<p>Did you make any modifications to the KVM XML files?`</p>
</blockquote>
<p>I think the only commands I ran related to XML files were:<br>
sudo virsh -c qemu:///system net-define Whonix_external*.xml<br>
sudo virsh -c qemu:///system net-define Whonix_internal*.xml</p>
<blockquote>
<p>To debug, please run these commands.<br>
sudo cat /sys/devices/system/clocksource/clocksource0/available_clocksource</p>
</blockquote>
<p><code>kvm-clock tsc acpi_pm</code></p>
<blockquote>
<p>sudo cat /sys/devices/system/clocksource/clocksource0/current_clocksource</p>
</blockquote>
<p><code>kvm-clock</code></p>
<blockquote>
<p>Maybe also [Convert Libvirt Templates to QEMU Commands] would help with debugging. Share the contents of the resulting <code>Whonix-Gateway.args</code> file here so <a class="mention" href="http://forums.whonix.org/u/hulahoop">@HulaHoop</a> can compare with how these should look like.</p>
</blockquote>
<p>I have two “Whonix-Gateway.xml” and “Whonix-Workstation.xml” files in directories “/etc/libvirt/qemu” and “/run/libvert/qemu”. In which directory should I Convert Libvirt Templates to QEMU?</p>
<p>Thank you.</p>
          <p><a href="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/8</link>
        <pubDate>Tue, 19 Jan 2021 01:39:58 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2587-8</guid>
        <source url="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587.rss">kvm-clock instead of timesync on install in gateway</source>
      </item>
      <item>
        <title>kvm-clock instead of timesync on install in gateway</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>One reason might either be a too old KVM version or newer version than Whonix KVM was tested with.</p>
<p>What’s your host operating system and version?</p>
<p>What’s your KVM version?</p>
<p>Did you make any modifications to the KVM XML files?</p>
<p>To debug, please run these commands.</p>
<pre><code>sudo cat /sys/devices/system/clocksource/clocksource0/available_clocksource

sudo cat /sys/devices/system/clocksource/clocksource0/current_clocksource
</code></pre>
<p>And post the output here.</p>
<p>Maybe also <a href="https://www.whonix.org/wiki/KVM#Convert_Libvirt_Templates_to_QEMU_Commands">Convert Libvirt Templates to QEMU Commands</a> would help with debugging. Share the contents of the resulting <code>Whonix-Gateway.args</code> file here so <a class="mention" href="http://forums.whonix.org/u/hulahoop">@HulaHoop</a> can compare with how these should look like.</p>
          <p><a href="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/7</link>
        <pubDate>Mon, 18 Jan 2021 08:54:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2587-7</guid>
        <source url="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587.rss">kvm-clock instead of timesync on install in gateway</source>
      </item>
      <item>
        <title>kvm-clock instead of timesync on install in gateway</title>
        <dc:creator><![CDATA[alabay]]></dc:creator>
        <description><![CDATA[
            <p>Hi, I am new to using Whonix and KVM. When I enter the command “whonixcheck” in the Workstation terminal, I get the following error…</p>
<pre><code>[WARNING] [whonixcheck] PVClock Test Result:

Unwanted PVClock kvm-clock tsc acpi_pm  detected! Using this PVClock together with Whonix is recommended against, because it conflicts with Whonix's TimeSync design [1].

If you know what you are doing, feel free to disable this check.
Create a file /etc/whonix.d/50_whonixcheck_user.conf and add:
whonixcheck_skip_functions+=" pvclock_unwanted_detected "

Recommended action:
- If you are using KVM, you probably did not follow Whonix's KVM instructions. [2]
- Or use a different supported Whonix platform. [3]

[1] https://www.whonix.org/wiki/Dev/TimeSync
[2] https://www.whonix.org/wiki/KVM
[3] https://www.whonix.org/wiki/Supported_Platforms
</code></pre>
<p>I don’t get any such error in the Gateway.<br>
Can anyone advise how to fix this? Thank you.</p>
          <p><a href="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/6</link>
        <pubDate>Sun, 17 Jan 2021 23:02:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2587-6</guid>
        <source url="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587.rss">kvm-clock instead of timesync on install in gateway</source>
      </item>
      <item>
        <title>kvm-clock instead of timesync on install in gateway</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Now in all repos.</p>
          <p><a href="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/5</link>
        <pubDate>Sun, 12 Jun 2016 13:31:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2587-5</guid>
        <source url="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587.rss">kvm-clock instead of timesync on install in gateway</source>
      </item>
      <item>
        <title>kvm-clock instead of timesync on install in gateway</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="3" data-topic="2587">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/k/e95f7d/40.png" class="avatar"> kvmtime:</div>
<blockquote>
<p>I used the Whonix Stable Repository and have installed or deleted anything in this Gateway.</p>
</blockquote>
</aside>
<p>The update is in the stable-proposed repo and not stable yet. Follow steps <a href="https://www.whonix.org/wiki/Whonix-APT-Repository#stable_proposed_updates">here</a> to enable this branch.</p>
<aside class="quote" data-post="3" data-topic="2587">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/k/e95f7d/40.png" class="avatar"> kvmtime:</div>
<blockquote>
<p>But I still had some concerns about kvm-time, I understood it has access to the host time (possibly with an offset?). This seem like a risk if the Gateway would get compromised, even if this is unlikely/ more trusted then Workstation.</p>
</blockquote>
</aside>
<p>You shouldn’t have any concerns. You should trust I made the correct decision after a lot of research and thinking. Please re-read my explanation in my last post about this.</p>
          <p><a href="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/4</link>
        <pubDate>Sun, 12 Jun 2016 13:15:20 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2587-4</guid>
        <source url="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587.rss">kvm-clock instead of timesync on install in gateway</source>
      </item>
      <item>
        <title>kvm-clock instead of timesync on install in gateway</title>
        <dc:creator><![CDATA[kvmtime]]></dc:creator>
        <description><![CDATA[
            <p>Thanks for your replay, didn’t run update/upgrade yet since I believed this would be a serious error.</p>
<p>But I still had some concerns about kvm-time, I understood it has access to the host time (possibly with an offset?). This seem like a risk if the Gateway would get compromised, even if this is unlikely/ more trusted then Workstation.</p>
<p>EDIT: sudo apt-get update &amp;&amp; apt-get dist-upgrade only updated about 45 packages and no new packages where installed in the KVM Gateway. Of the updated packages I did not recognize them as being time related (but I do not know all packages by heart). The same error stayed after running whonixcheck and timesync is still nowhere on my Gateway. I used the Whonix Stable Repository and have installed or deleted anything in this Gateway.</p>
<p>Should I manually install timesync in the Gateway?</p>
          <p><a href="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/3</link>
        <pubDate>Sat, 11 Jun 2016 22:38:21 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2587-3</guid>
        <source url="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587.rss">kvm-clock instead of timesync on install in gateway</source>
      </item>
      <item>
        <title>kvm-clock instead of timesync on install in gateway</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>What you are seeing is caused by a bug in Whonixcheck. Please update the packages on the gateway and the warning should go away.</p>
<p>There are no risks from the changes made to return to kvmclock in the gateway. All time leaks have been eliminated and no untrusted or misbehaving apps run there. The benefit is you no longer have to restart the gateway after suspending your machine for a long time for it to connect to Tor and for timesync to then connect.</p>
          <p><a href="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/2</link>
        <pubDate>Sat, 11 Jun 2016 22:09:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2587-2</guid>
        <source url="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587.rss">kvm-clock instead of timesync on install in gateway</source>
      </item>
      <item>
        <title>kvm-clock instead of timesync on install in gateway</title>
        <dc:creator><![CDATA[kvmtime]]></dc:creator>
        <description><![CDATA[
            <p>Installed Whonix (13.0.0.1.1) in KVM on debian 8.5 following <a href="https://www.whonix.org/wiki/KVM" rel="nofollow noopener">https://www.whonix.org/wiki/KVM</a> quite closely. But after starting the Whonix gateway and running whonix check I get the error:</p>
<p>[quote]PVClock Test Result:<br>
Unwanted PVClock kvm-clock acpi_pm detected! Using this PVClock together with whonix is recommended against, because it conflicts with Whonix’s TimwAnc design [1].</p>
<p>If you know what you are doing, feel free to disable this check. Create a file /etc/whonix.d/50_whonixcheck_user.conf and add:</p>
<pre><code>    whonixcheck_skip_functions+="pvclock_unwanted_detected'
</code></pre>
<p>Recommand action:</p>
<ul>
<li>If you are using KVM, you probably did not follow Whonix’s KVM instructions. [2]<br>
[/quote]</li>
</ul>
<p>The Gateway does indeed has kvm-time installed/active and no timesync installed. The Workstation does has timesync and it works as was used to with VirtualBox.</p>
<p>Wondering what went wrong with the install and how this problem can be fixed in a safe/secure manner. KVM-time instead of the normal timesync seems to be a serious risk for anonymity (linking host time to Gateway).</p>
          <p><a href="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587/1</link>
        <pubDate>Sat, 11 Jun 2016 13:57:44 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-2587-1</guid>
        <source url="http://forums.whonix.org/t/kvm-clock-instead-of-timesync-on-install-in-gateway/2587.rss">kvm-clock instead of timesync on install in gateway</source>
      </item>
  </channel>
</rss>

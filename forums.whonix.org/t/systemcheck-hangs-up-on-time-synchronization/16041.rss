<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Systemcheck hangs up on Time Synchronization</title>
    <link>http://forums.whonix.org/t/systemcheck-hangs-up-on-time-synchronization/16041</link>
    <description>I recently updated Gateway and Workstation to 16.0.4 running out of Virtual Box. I had some connectivity issues and had to update usr/local/etc/torrc.d/50_user.conf

Now everything seems to work fine but I still can’t connect to Tor due to a Time Synchronization error. When I run systemcheck I get the following message:

&gt; [ERROR] [systemcheck] Time Synchronization Result:
&gt; systemcheck gave up waiting.
&gt;
&gt;
&gt;
&gt; Time synchronization status: fail
&gt; sdwdate reports: Maximum allowed number of failures. Giving up.

Checking the sdwdate logs gives me some more info:

&gt; ### START: ### /usr/libexec/helper-scripts/onion-time-pre-script
&gt;
&gt;
&gt;
&gt; __ Status: Subsequent run after boot.
&gt; __ Static Time Sanity Check: Within minimum time ‘Fri Feb 18 00:00:00 UTC 2022’ and expiration timestamp ‘Tue May 17 10:00:00 UTC 2033’, ok.
&gt; __ Tor reports: NOTICE BOOTSTRAP PROGRESS=100 TAG=done SUMMARY=“Done”
&gt; __ Tor circuit: established
&gt; __ Tor Consensus Time Sanity Check: Clock within consensus parameters consensus/valid-after 2022-11-28 14:00:00 and consensus/valid-until 2022-11-28 17:00:00.
&gt; __ Conclusion: Tor already reports circuit established.
&gt; __ ### END: ### Exiting with exit_code ‘0’ indicating ‘success’.
&gt; 2022-11-28 14:59:21 - sdwdate - INFO - PREPARATION RESULT: SUCCESS.

But when the Onions are pulled in to establish the time, all URLs produce the same error message:

&gt; Failed to establish a new connection: [Errno 111] Connection refused

Ultimately ending with the summary:

&gt; 2022-11-28 14:59:22 - sdwdate - INFO - failed_urls: 9 allowed_failures: 7
&gt; 2022-11-28 14:59:22 - sdwdate - ERROR - Maximum allowed number of failures. Giving up.
&gt; 2022-11-28 14:59:22 - sdwdate - INFO - Sleeping for 90 minutes, ok.

I’ve tried restarting sdwdate, restarting network and restarting Tor via Gateway and Workstation. I’ve also tried setting the time/date manually but this didn’t fix anything. Can someone tell me where I’m going wrong?</description>
    <language>en</language>
    <lastBuildDate>Wed, 30 Nov 2022 20:49:13 +0000</lastBuildDate>
    <category>Support</category>
    <atom:link href="http://forums.whonix.org/t/systemcheck-hangs-up-on-time-synchronization/16041.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Systemcheck hangs up on Time Synchronization</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Manually setting the time cannot fix sdwdate. After you manually set the time you’re all set and done. Then you basically did sdwdate’s job.</p>
<hr>
<p>Attempts to fix sdwdate:</p>
<ol>
<li>
<p>Check if your local <code>/etc/sdwdate.d/30_default.conf</code> matches <a href="https://github.com/Kicksecure/sdwdate/blob/master/etc/sdwdate.d/30_default.conf" class="inline-onebox">sdwdate/30_default.conf at master · Kicksecure/sdwdate · GitHub</a>. If not, then you did not receive all updates. (Sometimes the git version might be ahead of the version shipped in packages but that’s not the case at time of writing.)</p>
</li>
<li>
<p>Check if you can open the onions where sdwdate failed in Tor Browser. If you cannot, then sdwdate won’t be able to either. Or pick some onions from the sdwdate config and try to open them in Tor Browser.</p>
</li>
<li>
<p>Your Tor client might have chosen a slow Tor entry guard. → <a href="https://www.whonix.org/wiki/Tor_Entry_Guards#Manual_Rotation_of_Tor_Guards">Tor Entry Guards - Whonix chapter Manual Rotation of Tor Guards in Whonix wiki</a></p>
</li>
<li>
<p>There could be a network obstacle?</p>
</li>
</ol>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.whonix.org/wiki/Network_Obstacle">
  <header class="source">
      <img src="https://www.whonix.org/w/images/a/a4/Whonix-home-favicon.ico" class="site-icon" width="32" height="32">

      <a href="https://www.whonix.org/wiki/Network_Obstacle" target="_blank" rel="noopener" title="07:45PM - 24 November 2022">Whonix – 24 Nov 22</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:640/320;"><img src="https://www.whonix.org/w/images/7/73/Networkobstacle123123455.png" class="thumbnail" width="640" height="320"></div>

<h3><a href="https://www.whonix.org/wiki/Network_Obstacle" target="_blank" rel="noopener">Network Obstacle</a></h3>

  <p>Organizational background on Network Obstacles.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<ol start="5">
<li>The Tor network might be too slow / under DOS / overload. In that case I won’t be able to suggest a solution. But not likely because we don’t have many similar reports currently.</li>
</ol>
<p>I was running our <code>/usr/share/sdwdate/onion-tester</code> just now and all sdwdate onion time sources so far were OK.</p>
          <p><a href="http://forums.whonix.org/t/systemcheck-hangs-up-on-time-synchronization/16041/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/systemcheck-hangs-up-on-time-synchronization/16041/2</link>
        <pubDate>Wed, 30 Nov 2022 20:49:13 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-16041-2</guid>
        <source url="http://forums.whonix.org/t/systemcheck-hangs-up-on-time-synchronization/16041.rss">Systemcheck hangs up on Time Synchronization</source>
      </item>
      <item>
        <title>Systemcheck hangs up on Time Synchronization</title>
        <dc:creator><![CDATA[KiloBone]]></dc:creator>
        <description><![CDATA[
            <p>I recently updated Gateway and Workstation to 16.0.4 running out of Virtual Box. I had some connectivity issues and had to update usr/local/etc/torrc.d/50_user.conf</p>
<p>Now everything seems to work fine but I still can’t connect to Tor due to a Time Synchronization error. When I run systemcheck I get the following message:</p>
<blockquote>
<p>[ERROR] [systemcheck] Time Synchronization Result:<br>
systemcheck gave up waiting.</p>
<p>Time synchronization status: fail<br>
sdwdate reports: Maximum allowed number of failures. Giving up.</p>
</blockquote>
<p>Checking the sdwdate logs gives me some more info:</p>
<blockquote>
<h3>START: ### /usr/libexec/helper-scripts/onion-time-pre-script</h3>
<p>__ Status: Subsequent run after boot.<br>
__ Static Time Sanity Check: Within minimum time ‘Fri Feb 18 00:00:00 UTC 2022’ and expiration timestamp ‘Tue May 17 10:00:00 UTC 2033’, ok.<br>
__ Tor reports: NOTICE BOOTSTRAP PROGRESS=100 TAG=done SUMMARY=“Done”<br>
__ Tor circuit: established<br>
__ Tor Consensus Time Sanity Check: Clock within consensus parameters consensus/valid-after 2022-11-28 14:00:00 and consensus/valid-until 2022-11-28 17:00:00.<br>
__ Conclusion: Tor already reports circuit established.<br>
__ ### END: ### Exiting with exit_code ‘0’ indicating ‘success’.<br>
2022-11-28 14:59:21 - sdwdate - INFO - PREPARATION RESULT: SUCCESS.</p>
</blockquote>
<p>But when the Onions are pulled in to establish the time, all URLs produce the same error message:</p>
<blockquote>
<p>Failed to establish a new connection: [Errno 111] Connection refused</p>
</blockquote>
<p>Ultimately ending with the summary:</p>
<blockquote>
<p>2022-11-28 14:59:22 - sdwdate - INFO - failed_urls: 9 allowed_failures: 7<br>
2022-11-28 14:59:22 - sdwdate - ERROR - Maximum allowed number of failures. Giving up.<br>
2022-11-28 14:59:22 - sdwdate - INFO - Sleeping for 90 minutes, ok.</p>
</blockquote>
<p>I’ve tried restarting sdwdate, restarting network and restarting Tor via Gateway and Workstation. I’ve also tried setting the time/date manually but this didn’t fix anything. Can someone tell me where I’m going wrong?</p>
          <p><a href="http://forums.whonix.org/t/systemcheck-hangs-up-on-time-synchronization/16041/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/systemcheck-hangs-up-on-time-synchronization/16041/1</link>
        <pubDate>Wed, 30 Nov 2022 20:07:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-16041-1</guid>
        <source url="http://forums.whonix.org/t/systemcheck-hangs-up-on-time-synchronization/16041.rss">Systemcheck hangs up on Time Synchronization</source>
      </item>
  </channel>
</rss>

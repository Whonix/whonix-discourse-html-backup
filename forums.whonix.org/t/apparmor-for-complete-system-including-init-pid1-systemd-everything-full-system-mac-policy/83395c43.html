<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy - AppArmor - Whonix Forum</title>
    <meta name="description" content="Currently, Whonix only has AppArmor profiles for a few high-risk applications. This isnâ€™t the best. It would be much better to have everything confined by default, including init which would greatly increase security. 
T&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="83395c43.html?page=17" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy&#39;" href="8339.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/apparmor-for-complete-system-including-init-pid1-systemd-everything-full-system-mac-policy/8339?page=17" />
<meta name="twitter:url" content="https://forums.whonix.org/t/apparmor-for-complete-system-including-init-pid1-systemd-everything-full-system-mac-policy/8339?page=17" />
<meta property="og:title" content="AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy" />
<meta name="twitter:title" content="AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy" />
<meta property="og:description" content="Quote https://wiki.debian.org/AppArmor/Debug    Profiles in complain mode will send ALLOWED lines in the logs for entries that would normally be DENIED in enforce mode. You can use this to tweak configs before turning them on in enforce mode.   Could you fix the following please?  sudo journalctl -b -o cat | grep denied   AVC apparmor=â€œALLOWEDâ€ operation=â€œexecâ€ profile=_/usr/lib/whonix-firewall/_.html name=&quot;/bin/systemctl&quot; pid=1874 comm=â€œfirewall-restarâ€ requested_mask=â€œxâ€ denied_mask=â€œxâ€ fsuid=0 oui..." />
<meta name="twitter:description" content="Quote https://wiki.debian.org/AppArmor/Debug    Profiles in complain mode will send ALLOWED lines in the logs for entries that would normally be DENIED in enforce mode. You can use this to tweak configs before turning them on in enforce mode.   Could you fix the following please?  sudo journalctl -b -o cat | grep denied   AVC apparmor=â€œALLOWEDâ€ operation=â€œexecâ€ profile=_/usr/lib/whonix-firewall/_.html name=&quot;/bin/systemctl&quot; pid=1874 comm=â€œfirewall-restarâ€ requested_mask=â€œxâ€ denied_mask=â€œxâ€ fsuid=0 oui..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="97 mins ğŸ•‘" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="496 â¤" />
<meta property="article:published_time" content="2020-01-01T12:19:38+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="833942a7.html?page=16">
        <link rel="next" href="83399683.html?page=18">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="8339.html">AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/apparmor/14.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #12A89D'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>AppArmor</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-01T12:19:38Z' class='post-time'>
                January 1, 2020, 12:19pm
              </time>
              <meta itemprop='dateModified' content='2020-01-01T12:19:38Z'>
          <span itemprop='position'>#323</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Quote <a href="../../../external.html?link=https://wiki.debian.org/AppArmor/Debug">https://wiki.debian.org/AppArmor/Debug</a></p>
<blockquote>
<ul>
<li>Profiles in complain mode will send ALLOWED lines in the logs for entries that would normally be DENIED in enforce mode. You can use this to tweak configs before turning them on in enforce mode.</li>
</ul>
</blockquote>
<p>Could you fix the following please?</p>
<pre><code>sudo journalctl -b -o cat | grep denied
</code></pre>
<blockquote>
<p>AVC apparmor=â€œALLOWEDâ€ operation=â€œexecâ€ profile="/usr/lib/whonix-firewall/<strong>" name="/bin/systemctl" pid=1874 comm=â€œfirewall-restarâ€ requested_mask=â€œxâ€ denied_mask=â€œxâ€ fsuid=0 ouid=0 target="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl"<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_inheritâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/tmp/tmp.zs8SEbAZQf" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
audit: type=1400 audit(1577880763.053:19): apparmor=â€œALLOWEDâ€ operation=â€œexecâ€ profile="/usr/lib/whonix-firewall/</strong>" name="/bin/systemctl" pid=1874 comm=â€œfirewall-restarâ€ requested_mask=â€œxâ€ denied_mask=â€œxâ€ fsuid=0 ouid=0 target="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl"<br>
audit: type=1400 audit(1577880763.053:20): apparmor=â€œALLOWEDâ€ operation=â€œfile_inheritâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/tmp/tmp.zs8SEbAZQf" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
audit: type=1400 audit(1577880763.053:21): apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/bin/systemctl" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/bin/systemctl" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/ld-2.28.so" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/etc/ld.so.cache" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libc-2.28.so" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libc-2.28.so" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libselinux.so.1" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
audit: type=1400 audit(1577880763.053:22): apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/ld-2.28.so" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
audit: type=1400 audit(1577880763.053:23): apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/etc/ld.so.cache" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
audit: type=1400 audit(1577880763.053:24): apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libc-2.28.so" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
audit: type=1400 audit(1577880763.053:25): apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libc-2.28.so" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
audit: type=1400 audit(1577880763.053:26): apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libselinux.so.1" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
audit: type=1400 audit(1577880763.053:27): apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libselinux.so.1" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libselinux.so.1" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/liblzma.so.5.2.4" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/liblzma.so.5.2.4" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/usr/lib/x86_64-linux-gnu/liblz4.so.1.8.3" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/usr/lib/x86_64-linux-gnu/liblz4.so.1.8.3" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libgcrypt.so.20.2.4" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libgcrypt.so.20.2.4" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libblkid.so.1.1.0" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libblkid.so.1.1.0" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libpthread-2.28.so" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libpthread-2.28.so" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libpcre.so.3.13.3" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libpcre.so.3.13.3" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
audit: type=1400 audit(1577880763.053:28): apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/liblzma.so.5.2.4" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libdl-2.28.so" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libdl-2.28.so" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libgpg-error.so.0.26.1" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libgpg-error.so.0.26.1" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libuuid.so.1.3.0" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libuuid.so.1.3.0" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/proc/filesystems" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/usr/lib/locale/locale-archive" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/proc/1874/stat" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/proc/1/environ" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/proc/1/sched" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/proc/cmdline" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/usr/share/zoneinfo/UCT" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/run/log/journal/" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/etc/machine-id" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/run/log/journal/b08dfa6083e7567a1921a715000001fb/" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/run/log/journal/b08dfa6083e7567a1921a715000001fb/system.journal" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/run/log/journal/b08dfa6083e7567a1921a715000001fb/system@e059de1a43f24dd48f17f28ccce65000-0000000000000001-00059b12fd2ef886.journal" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/proc/sys/kernel/random/boot_id" pid=1874 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œexecâ€ profile="/usr/lib/whonix-firewall/<strong>" name="/bin/systemctl" pid=1878 comm=â€œfirewall-restarâ€ requested_mask=â€œxâ€ denied_mask=â€œxâ€ fsuid=0 ouid=0 target="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl"<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/bin/systemctl" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/ld-2.28.so" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/etc/ld.so.cache" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libc-2.28.so" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libc-2.28.so" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libselinux.so.1" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libselinux.so.1" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/liblzma.so.5.2.4" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/liblzma.so.5.2.4" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/usr/lib/x86_64-linux-gnu/liblz4.so.1.8.3" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/usr/lib/x86_64-linux-gnu/liblz4.so.1.8.3" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libgcrypt.so.20.2.4" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libgcrypt.so.20.2.4" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libblkid.so.1.1.0" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libblkid.so.1.1.0" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libpthread-2.28.so" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libpthread-2.28.so" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libpcre.so.3.13.3" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libpcre.so.3.13.3" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libdl-2.28.so" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libdl-2.28.so" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libgpg-error.so.0.26.1" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libgpg-error.so.0.26.1" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libuuid.so.1.3.0" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œfile_mmapâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/lib/x86_64-linux-gnu/libuuid.so.1.3.0" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrmâ€ denied_mask=â€œrmâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/proc/filesystems" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/usr/lib/locale/locale-archive" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/proc/1878/stat" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/proc/1/environ" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>//null-/bin/systemctl" name="/proc/1/sched" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>//null-/bin/systemctl" name="/proc/cmdline" pid=1878 comm=â€œsystemctlâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œchownâ€ profile="/usr/lib/whonix-firewall/</strong>" name="/run/sdwdate/success" pid=1889 comm=â€œchownâ€ requested_mask=â€œwâ€ denied_mask=â€œwâ€ fsuid=0 ouid=109<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œchownâ€ profile="/usr/lib/whonix-firewall/<strong>" name="/run/sdwdate/first_success" pid=1889 comm=â€œchownâ€ requested_mask=â€œwâ€ denied_mask=â€œwâ€ fsuid=0 ouid=109<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>" name="/etc/sudoers.d/" pid=1891 comm=â€œsudoâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/<strong>" name="/etc/sudoers.d/" pid=1896 comm=â€œsudoâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/</strong>" name="/etc/gai.conf" pid=1939 comm=â€œiptablesâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
AVC apparmor=â€œALLOWEDâ€ operation=â€œopenâ€ profile="/usr/lib/whonix-firewall/**" name="/etc/gai.conf" pid=1940 comm=â€œiptablesâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0</p>
</blockquote>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-01T12:57:30Z' class='post-time'>
                January 1, 2020, 12:57pm
              </time>
              <meta itemprop='dateModified' content='2020-01-01T12:57:30Z'>
          <span itemprop='position'>#324</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Untested. Not sure yet this makes sense.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-everything/commit/5170d8e929430205c92641a73d39ab1cbef8aa12" target="_blank">github.com/Whonix/apparmor-profile-everything</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-everything/commit/5170d8e929430205c92641a73d39ab1cbef8aa12" target="_blank">/usr/lib/security-misc/pam_only_if_login flags=(attach_disconnected) {</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-01-01" data-time="12:56:39" data-timezone="UTC">12:56PM - 01 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 8 additions and 0 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-everything/commit/5170d8e929430205c92641a73d39ab1cbef8aa12" target="_blank">
          <span class="added">+8</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">#include &lt;abstractions/kicksecure-shell-script&gt;
}
/usr/lib/security-misc/pam-abort-on-locked-password flags=(attach_disconnected) {
 #include &lt;abstractions/kicksecure-shell-script&gt;
}</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-01T14:27:39Z' class='post-time'>
                January 1, 2020,  2:27pm
              </time>
              <meta itemprop='dateModified' content='2020-01-01T14:27:39Z'>
          <span itemprop='position'>#325</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Happening without apparmor-profile-everything.</p>
<blockquote>
<p>Jan 01 13:45:16 host audit[8484]: AVC apparmor=â€œDENIEDâ€ operation=â€œexecâ€ profile="/usr/bin/whonixcheck" name="/usr/lib/security-misc/pam_only_if_login" pid=8484 comm=â€œsudoâ€ requested_mask=â€œxâ€ denied_mask=â€œxâ€ fsuid=0 ouid=0<br>
Jan 01 13:45:16 host sudo[8484]: pam_exec(sudo:account): execve(/usr/lib/security-misc/pam_only_if_login,â€¦) failed: Permission denied<br>
Jan 01 13:45:16 host sudo[8483]: pam_exec(sudo:account): /usr/lib/security-misc/pam_only_if_login failed: exit code 13<br>
Jan 01 13:45:16 host sudo[8483]: pam_access(sudo:account): failed to open accessfile=[/etc/security/access-security-misc.conf]: Permission denied<br>
Jan 01 13:45:16 host sudo[8483]: pam_access(sudo:account): failed to parse the module arguments<br>
Jan 01 13:45:16 host sudo[8483]:     user : PAM account management error: Critical error - immediate abort ; TTY=unknown ; PWD=/ ; USER=whonixcheck ; COMMAND=/usr/lib/whonixcheck/whonixcheck --daemon --gui --cli<br>
Jan 01 13:45:16 host audit[8483]: AVC apparmor=â€œDENIEDâ€ operation=â€œopenâ€ profile="/usr/bin/whonixcheck" name="/etc/security/access-security-misc.conf" pid=8483 comm=â€œsudoâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0<br>
Jan 01 13:45:16 host kernel: audit: type=1400 audit(1577886316.624:289): apparmor=â€œDENIEDâ€ operation=â€œexecâ€ profile="/usr/bin/whonixcheck" name="/usr/lib/security-misc/pam_only_if_login" pid=8484 comm=â€œsudoâ€ requested_mask=â€œxâ€ denied_mask=â€œxâ€ fsuid=0 ouid=0<br>
Jan 01 13:45:16 host kernel: audit: type=1400 audit(1577886316.624:290): apparmor=â€œDENIEDâ€ operation=â€œopenâ€ profile="/usr/bin/whonixcheck" name="/etc/security/access-security-misc.conf" pid=8483 comm=â€œsudoâ€ requested_mask=â€œrâ€ denied_mask=â€œrâ€ fsuid=0 ouid=0</p>
</blockquote>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-01T14:37:34Z' class='post-time'>
                January 1, 2020,  2:37pm
              </time>
              <meta itemprop='dateModified' content='2020-01-01T14:37:34Z'>
          <span itemprop='position'>#326</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Had to revert this. And even add more <code>Ux</code> rules. Things have to stay functional without apparmor-profile-everything installed. At minimum until apparmor-profile-everything is ready for production (not functional in Qubes yes, boot modes not done/tested).</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-anondist/commit/04d2be17aeef26b0bce0f7c74d76fb9367ce4771" target="_blank">github.com/Whonix/apparmor-profile-anondist</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-anondist/commit/04d2be17aeef26b0bce0f7c74d76fb9367ce4771" target="_blank">Revert "remove"</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-01-01" data-time="14:26:45" data-timezone="UTC">02:26PM - 01 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 3 additions and 0 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-anondist/commit/04d2be17aeef26b0bce0f7c74d76fb9367ce4771" target="_blank">
          <span class="added">+3</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">This reverts commit a55417e067616f1cb5a1d64725f43c26b1a40de1.</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-anondist/commit/8945cebb5e986bb3bba70ba8f694e0b6f494f630" target="_blank">github.com/Whonix/apparmor-profile-anondist</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-anondist/commit/8945cebb5e986bb3bba70ba8f694e0b6f494f630" target="_blank">Revert "Replace Ux rules"</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-01-01" data-time="14:29:24" data-timezone="UTC">02:29PM - 01 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 2 additions and 2 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-anondist/commit/8945cebb5e986bb3bba70ba8f694e0b6f494f630" target="_blank">
          <span class="added">+2</span>
          <span class="removed">-2</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">This reverts commit 2070406b60bbbaff52095537a90b385eb0a33a3d.</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-anondist/commit/a169daa3f9bd5fc0a54af6c483f55cea240f573a" target="_blank">github.com/Whonix/apparmor-profile-anondist</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-anondist/commit/a169daa3f9bd5fc0a54af6c483f55cea240f573a" target="_blank">  /usr/lib/security-misc/pam_only_if_login rUx,</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-01-01" data-time="14:30:53" data-timezone="UTC">02:30PM - 01 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 2 additions and 0 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-anondist/commit/a169daa3f9bd5fc0a54af6c483f55cea240f573a" target="_blank">
          <span class="added">+2</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">/etc/security/access-security-misc.conf r,</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-anondist/commit/0ec077b6ae99ed08b6607ef9322de1986d256baa" target="_blank">github.com/Whonix/apparmor-profile-anondist</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-anondist/commit/0ec077b6ae99ed08b6607ef9322de1986d256baa" target="_blank">/usr/lib/security-misc/pam-abort-on-locked-password rUx,</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-01-01" data-time="14:31:56" data-timezone="UTC">02:31PM - 01 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 1 additions and 0 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-anondist/commit/0ec077b6ae99ed08b6607ef9322de1986d256baa" target="_blank">
          <span class="added">+1</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>




  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>I wonder how things could be made play well once apparmor-profile-everything gets installed, i.e. above rules removed.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-01T17:52:47Z' class='post-time'>
                January 1, 2020,  5:52pm
              </time>
              <meta itemprop='dateModified' content='2020-01-01T17:52:47Z'>
          <span itemprop='position'>#327</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="323" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Could you fix the following please?</p>
</blockquote>
</aside>
<aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/whonix-firewall/pull/4" target="_blank">github.com/Whonix/whonix-firewall</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/whonix-firewall/pull/4" target="_blank">Apparmor fixes</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> â† <code>madaidan:apparmor</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-01-01" data-time="17:50:57" data-timezone="UTC">05:50PM - 01 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/madaidan" target="_blank">
          <img alt="madaidan" src="../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>

      <div class="lines" title="1 commits changed 1 files with 12 additions and 6 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/whonix-firewall/pull/4/files" target="_blank">
          <span class="added">+12</span>
          <span class="removed">-6</span>
        </a>
      </div>
    </div>

  </div>
</div>
  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>A bunch of other permissions like the ones in /lib/ are already granted by the base abstraction.</p>
<aside class="quote no-group" data-post="324" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Untested. Not sure yet this makes sense.</p>
</blockquote>
</aside>
<p>Whatâ€™s the point of this?</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-01T19:26:19Z' class='post-time'>
                January 1, 2020,  7:26pm
              </time>
              <meta itemprop='dateModified' content='2020-01-01T19:26:19Z'>
          <span itemprop='position'>#328</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>madaidan via Whonix Forum:</p>
<blockquote>
<p>Whatâ€™s the point of this?</p>
</blockquote>
<p>Same as other security-misc pam apparmor profiles.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-01T19:33:41Z' class='post-time'>
                January 1, 2020,  7:33pm
              </time>
              <meta itemprop='dateModified' content='2020-01-01T19:33:41Z'>
          <span itemprop='position'>#329</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>The other profiles are there because they needed permissions not in the main init-systemd profile. pam_only_if_login and pam-abort-on-locked-password donâ€™t seem to need to access anything not already permitted.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-01T19:35:33Z' class='post-time'>
                January 1, 2020,  7:35pm
              </time>
              <meta itemprop='dateModified' content='2020-01-01T19:35:33Z'>
          <span itemprop='position'>#330</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Oh, nevermind. I see. We need the <code>rpx</code> rule in the base abstraction so it needs a profile.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-01T19:36:27Z' class='post-time'>
                January 1, 2020,  7:36pm
              </time>
              <meta itemprop='dateModified' content='2020-01-01T19:36:27Z'>
          <span itemprop='position'>#331</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Reverted and reverted the revert. <img src="../../images/emoji/twitter/slight_smilec164.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-11T20:55:23Z' class='post-time'>
                January 11, 2020,  8:55pm
              </time>
              <meta itemprop='dateModified' content='2020-01-11T20:55:23Z'>
          <span itemprop='position'>#332</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="261" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>The systemd profile is the everyone else profile. I do want to move away from that though and split up init-systemd to an init-only profile and everything else into a more restrictive profile. Maybe via something like</p>
<pre><code class="lang-auto">/usr/bin/** px -&gt; confined_app,
</code></pre>
</blockquote>
</aside>
<p>A better way would be to create our own app launcher that uses <code>aa-exec</code> to run the app in a <code>confined_app</code> profile although that might be too much work having to decide which apps run in <code>confined_app</code> by default and make it usable.</p>
<p>If we do decide to do this though, we can also do things like run each app as their own user in their own bubblewrap sandbox for better confinement.</p>
<p>Similar to android which has zygote.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-13T17:19:46Z' class='post-time'>
                January 13, 2020,  5:19pm
              </time>
              <meta itemprop='dateModified' content='2020-01-13T17:19:46Z'>
          <span itemprop='position'>#333</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>With developers repository.</p>
<pre><code>Jan 13 17:17:56 host audit[1876]: AVC apparmor="ALLOWED" operation="ptrace" profile="/usr/lib/whonix-firewall/**" pid=1876 comm="systemctl" requested_mask="read" denied_mask="read" peer="unconfined"
Jan 13 17:17:56 host audit[1876]: AVC apparmor="ALLOWED" operation="open" profile="/usr/lib/whonix-firewall/**" name="/proc/cmdline" pid=1876 comm="systemctl" requested_mask="r" denied_mask="r" fsuid=0 ouid=0
Jan 13 17:17:56 host audit[1876]: AVC apparmor="ALLOWED" operation="ptrace" profile="/usr/lib/whonix-firewall/**" pid=1876 comm="systemctl" requested_mask="read" denied_mask="read" peer="unconfined"
Jan 13 17:17:56 host kernel: audit: type=1400 audit(1578935876.449:19): apparmor="ALLOWED" operation="ptrace" profile="/usr/lib/whonix-firewall/**" pid=1876 comm="systemctl" requested_mask="read" denied_mask="read" peer="unconfined"
Jan 13 17:17:56 host kernel: audit: type=1400 audit(1578935876.449:20): apparmor="ALLOWED" operation="open" profile="/usr/lib/whonix-firewall/**" name="/proc/cmdline" pid=1876 comm="systemctl" requested_mask="r" denied_mask="r" fsuid=0 ouid=0
Jan 13 17:17:56 host kernel: audit: type=1400 audit(1578935876.449:21): apparmor="ALLOWED" operation="ptrace" profile="/usr/lib/whonix-firewall/**" pid=1876 comm="systemctl" requested_mask="read" denied_mask="read" peer="unconfined"
Jan 13 17:17:56 host audit[1880]: AVC apparmor="ALLOWED" operation="ptrace" profile="/usr/lib/whonix-firewall/**" pid=1880 comm="systemctl" requested_mask="read" denied_mask="read" peer="unconfined"
Jan 13 17:17:56 host audit[1880]: AVC apparmor="ALLOWED" operation="open" profile="/usr/lib/whonix-firewall/**" name="/proc/cmdline" pid=1880 comm="systemctl" requested_mask="r" denied_mask="r" fsuid=0 ouid=0
Jan 13 17:17:56 host kernel: audit: type=1400 audit(1578935876.457:22): apparmor="ALLOWED" operation="ptrace" profile="/usr/lib/whonix-firewall/**" pid=1880 comm="systemctl" requested_mask="read" denied_mask="read" peer="unconfined"
Jan 13 17:17:56 host kernel: audit: type=1400 audit(1578935876.457:23): apparmor="ALLOWED" operation="open" profile="/usr/lib/whonix-firewall/**" name="/proc/cmdline" pid=1880 comm="systemctl" requested_mask="r" denied_mask="r" fsuid=0 ouid=0
Jan 13 17:17:56 host kernel: audit: type=1400 audit(1578935876.457:24): apparmor="ALLOWED" operation="ptrace" profile="/usr/lib/whonix-firewall/**" pid=1880 comm="systemctl" requested_mask="read" denied_mask="read" peer="unconfined"
Jan 13 17:17:56 host audit[1880]: AVC apparmor="ALLOWED" operation="ptrace" profile="/usr/lib/whonix-firewall/**" pid=1880 comm="systemctl" requested_mask="read" denied_mask="read" peer="unconfined"
</code></pre>
<p>Could you fix please?</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-13T17:28:08Z' class='post-time'>
                January 13, 2020,  5:28pm
              </time>
              <meta itemprop='dateModified' content='2020-01-13T17:28:08Z'>
          <span itemprop='position'>#334</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/whonix-firewall/pull/5" target="_blank">github.com/Whonix/whonix-firewall</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/whonix-firewall/pull/5" target="_blank">Allow ptracing</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> â† <code>madaidan:apparmor</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-01-13" data-time="17:27:59" data-timezone="UTC">05:27PM - 13 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/madaidan" target="_blank">
          <img alt="madaidan" src="../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>

      <div class="lines" title="1 commits changed 1 files with 2 additions and 0 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/whonix-firewall/pull/5/files" target="_blank">
          <span class="added">+2</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>
  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-13T17:40:40Z' class='post-time'>
                January 13, 2020,  5:40pm
              </time>
              <meta itemprop='dateModified' content='2020-01-13T17:40:40Z'>
          <span itemprop='position'>#335</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Merged.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-13T20:02:46Z' class='post-time'>
                January 13, 2020,  8:02pm
              </time>
              <meta itemprop='dateModified' content='2020-01-13T20:02:46Z'>
          <span itemprop='position'>#336</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="317" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>I donâ€™t know how, but everythingâ€™s breaking now</p>
</blockquote>
</aside>
<p>I figured out the problem. Denying write access to <code>/**/systemd/</code> causes this.</p>
<p>That and a few other things are fixed in <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-everything/pull/32">https://github.com/Whonix/apparmor-profile-everything/pull/32</a></p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-14T13:43:32Z' class='post-time'>
                January 14, 2020,  1:43pm
              </time>
              <meta itemprop='dateModified' content='2020-01-14T13:43:32Z'>
          <span itemprop='position'>#337</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Merged.</p>
<pre><code>  ## Deny access to /boot and /usr/src to hide them from the logs.
  audit deny /boot/ rw,
  audit deny /boot/** rw,
  audit deny /usr/src/ rw,
  audit deny /usr/src/** rw,
</code></pre>
<p>What hiding form the logs useful for here?</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-14T16:46:20Z' class='post-time'>
                January 14, 2020,  4:46pm
              </time>
              <meta itemprop='dateModified' content='2020-01-14T16:46:20Z'>
          <span itemprop='position'>#338</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="337" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>What hiding form the logs useful for here?</p>
</blockquote>
</aside>
<p>By â€œlogsâ€, I mean apparmor logs. I noticed that something would try to access /boot and /usr/src which would then give unwanted errors in the logs.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-14T18:02:52Z' class='post-time'>
                January 14, 2020,  6:02pm
              </time>
              <meta itemprop='dateModified' content='2020-01-14T18:02:52Z'>
          <span itemprop='position'>#339</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>madaidan via Whonix Forum:</p>
<blockquote>
<aside class="quote no-group" data-post="337" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>What hiding form the logs useful for here?</p>
</blockquote>
</aside>
<p>By â€œlogsâ€, I mean apparmor logs.</p>
</blockquote>
<p>I know.</p>
<blockquote>
<p>I noticed that something would try to access /boot and /usr/src which would then give unwanted errors in the logs.</p>
</blockquote>
<p>What accesses /boot and /usr/src? That would be good to know so that can<br>
be documented. Anything trying to access these folders and failing might<br>
be OK but it might also break some functionality. Therefore better to<br>
initially log this and disable logging later after we at least know the<br>
major, default installed things which try to access these folders.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-14T19:16:27Z' class='post-time'>
                January 14, 2020,  7:16pm
              </time>
              <meta itemprop='dateModified' content='2020-01-14T19:16:27Z'>
          <span itemprop='position'>#340</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>For some reason, remove-system.map wasnâ€™t being confined under kicksecure-shell-script for me so it was giving those errors. I replaced the profiles with the ones in git and the errors stopped.</p>
<p>I removed the deny rules and added more System.map locations in <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-everything/pull/33">https://github.com/Whonix/apparmor-profile-everything/pull/33</a></p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-14T19:25:24Z' class='post-time'>
                January 14, 2020,  7:25pm
              </time>
              <meta itemprop='dateModified' content='2020-01-14T19:25:24Z'>
          <span itemprop='position'>#341</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Iâ€™m getting this error now due to our sysctl restrictions:</p>
<pre><code>AVC apparmor="DENIED" operation="open" profile="init-systemd" name="/proc/sys/kernel/core_pattern" pid=1 comm="systemd-shutdow" requested_mask="w" denied_mask="w" fsuid=0 ouid=0
</code></pre>
<p>Weâ€™ll need to create a systemd-shutdown profile for this although I donâ€™t know why it needs access to that anyway.</p>
<p>We should also create a profile for Xorg since itâ€™s a large amount of code, has a history of vulnerabilities and to get rid of this error:</p>
<pre><code>AVC apparmor="DENIED" operation="capable" profile="init-systemd" pid=1715 comm="Xorg" capability=17  capname="sys_rawio"
</code></pre>
<p>Granting CAP_SYS_RAWIO in the main profile is not ok as it opens up so many ways to escalate to kernel privileges such as iopl().</p>
<p>Even if we do make an X profile, I donâ€™t know if Iâ€™m comfortable with exposing CAP_SYS_RAWIO to a program with such huge attack surface.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-14T20:26:34Z' class='post-time'>
                January 14, 2020,  8:26pm
              </time>
              <meta itemprop='dateModified' content='2020-01-14T20:26:34Z'>
          <span itemprop='position'>#342</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-everything/pull/34" target="_blank">github.com/Whonix/apparmor-profile-everything</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-everything/pull/34" target="_blank">Create systemd-shutdown profile and remove CAP_SYS_BOOT</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> â† <code>madaidan:systemd-shutdown</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-01-14" data-time="20:23:05" data-timezone="UTC">08:23PM - 14 Jan 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/madaidan" target="_blank">
          <img alt="madaidan" src="../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>

      <div class="lines" title="5 commits changed 3 files with 31 additions and 1 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-everything/pull/34/files" target="_blank">
          <span class="added">+31</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>

  </div>
</div>
  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Now at 23 capabilities.</p>
<p>Will <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-everything/pull/25">https://github.com/Whonix/apparmor-profile-everything/pull/25</a> get merged?</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="833942a7.html?page=16">â† previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="83399683.html?page=18">next page â†’</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

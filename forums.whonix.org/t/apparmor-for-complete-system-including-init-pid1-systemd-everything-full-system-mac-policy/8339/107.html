<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy - #107 by Patrick - AppArmor - Whonix Forum</title>
    <meta name="description" content="Currently, Whonix only has AppArmor profiles for a few high-risk applications. This isn’t the best. It would be much better to have everything confined by default, including init which would greatly increase security. 
T&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../8339c575.html?page=6" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy&#39;" href="../8339.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/apparmor-for-complete-system-including-init-pid1-systemd-everything-full-system-mac-policy/8339/107" />
<meta name="twitter:url" content="https://forums.whonix.org/t/apparmor-for-complete-system-including-init-pid1-systemd-everything-full-system-mac-policy/8339/107" />
<meta property="og:title" content="AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy" />
<meta name="twitter:title" content="AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy" />
<meta property="og:description" content="That would be great!   I don’t see any difference between “apparmor=0” and “boot in full root mode”.  Differences are only usability and project philosophy.   “apparmor=0”: more difficult for users. Less visible. Users wanting to tinker more likely to give up. More inconvenient. Less users shooting their own feet using Whonix. They might choose an inferior solution though and thereby shoot their own feet. An attacker can instruct a user to use “apparmor=0”. Might be harder to convince. “boot in..." />
<meta name="twitter:description" content="That would be great!   I don’t see any difference between “apparmor=0” and “boot in full root mode”.  Differences are only usability and project philosophy.   “apparmor=0”: more difficult for users. Less visible. Users wanting to tinker more likely to give up. More inconvenient. Less users shooting their own feet using Whonix. They might choose an inferior solution though and thereby shoot their own feet. An attacker can instruct a user to use “apparmor=0”. Might be harder to convince. “boot in..." />
<meta property="article:published_time" content="2019-11-17T17:50:13+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="../8339af4d.html?page=5">
        <link rel="next" href="../8339235c.html?page=7">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../8339.html">AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/apparmor/14.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #12A89D'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>AppArmor</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-16T20:12:04Z' class='post-time'>
                November 16, 2019,  8:12pm
              </time>
              <meta itemprop='dateModified' content='2019-11-16T20:12:04Z'>
          <span itemprop='position'>#102</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="101" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/p/898d66/40.png" class="avatar"> Patrick_mobile:</div>
<blockquote>
<p>Any other option to not prevent those users who choose to use third party repositories to allow them easily do that?</p>
</blockquote>
</aside>
<p>No. Unless they disable apparmor with the boot parameter and then modify it. Allowing the user to edit it allows the attacker to abuse it.</p>
<aside class="quote no-group" data-post="101" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/p/898d66/40.png" class="avatar"> Patrick_mobile:</div>
<blockquote>
<p>Bothered me that my old phone had locked bootloader and refused root access no matter what. Not intending to do that same.</p>
</blockquote>
</aside>
<p>A locked bootloader and restricted root is an essential part of android’s security model. If you can easily bypass it, so can an attacker.</p>
<p>A user can always just use <code>apparmor=0</code> as a boot parameter to disable it but I don’t think an ordinary user facing option should be available.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-17T06:42:49Z' class='post-time'>
                November 17, 2019,  6:42am
              </time>
              <meta itemprop='dateModified' content='2019-11-17T06:42:49Z'>
          <span itemprop='position'>#103</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="102" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>android’s security model</p>
</blockquote>
</aside>
<p>Btw I do think that there are some good things there. Worth replicating in Linux desktop distributions. This is complex, therefore a while ago I wrote my thoughts on that subject here:<br>
<a href="../../../../external.html?link=https://www.whonix.org/wiki/Kicksecure#iPhone_and_Android_Level_Security_for_Linux_Desktop_Distributions">https://www.whonix.org/wiki/Kicksecure#iPhone_and_Android_Level_Security_for_Linux_Desktop_Distributions</a></p>
<aside class="quote no-group" data-post="102" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>A user can always just use <code>apparmor=0</code> as a boot parameter to disable it but</p>
</blockquote>
</aside>
<p>Is there a way to say more limited, “don’t use apparmor-profile-everything” rather than saying “don’t use apparmor at all”? Even if a user chooses to boot in “full root mode”, it would be prudent to keep apparmor enabled. Just not apparmor-profile-everything.</p>
<aside class="quote no-group" data-post="102" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>A locked bootloader and restricted root is an essential part of android’s security model. If you can easily bypass it, so can an attacker.</p>
</blockquote>
</aside>
<p>The only way to bypass it could be if the user decides to bypass it? No other technical bypass / weakness? “Only” user mistake?</p>
<aside class="quote no-group" data-post="102" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>A user can always just use <code>apparmor=0</code> as a boot parameter to disable it but I don’t think an ordinary user facing option should be available.</p>
</blockquote>
</aside>
<p>I am not sure. I am leaning towards user freedom, usability rather than locking down security while worsening user freedom. From my perspective, I keep working on Whonix for 7 years already, and now I don’t want to harm/kill the project by creating a situation similar to “Ubuntu amazon search lens” controversy.</p>
<p>This needs to be discussed with the community and cannot be decided on the sideline in a long, very technical discussion.</p>
<p>Created a quick, not so serious poll.</p>
<aside class="onebox twitterstatus">
  <header class="source">
      <a href="../../../../external.html?link=https://twitter.com/Whonix/status/1195951984274075648" target="_blank">twitter.com</a>
  </header>
  <article class="onebox-body">
    <img src="../../../../external.html?link=https://pbs.twimg.com/profile_images/747394861549162496/q6YdTSix_400x400.jpg" class="thumbnail onebox-avatar" width="60" height="60">

<h4><a href="../../../../external.html?link=https://twitter.com/Whonix/status/1195951984274075648" target="_blank">Whonix ™ (Whonix)</a></h4>

<div class="tweet"> Which one is more important?
 <a href="../../../../external.html?link=https://twitter.com/search?q=%23security" target="_blank">#security</a> or <a href="../../../../external.html?link=https://twitter.com/search?q=%23freedom" target="_blank">#freedom</a>?

Choose one.

^PS</div>

<div class="date">
  <a href="../../../../external.html?link=https://twitter.com/Whonix/status/1195951984274075648" target="_blank">6:29 AM - 17 Nov 2019</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>But I do know that the wording and bias of a poll influences the result of a poll. Therefore, if you wish to run a differently worded poll, let me know.</p>
<p>This is a huge directional development decision. I’ll be creating a separate discussion and Whonix forum and twitter poll where I explain this change in more laymen terms.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-17T06:49:12Z' class='post-time'>
                November 17, 2019,  6:49am
              </time>
              <meta itemprop='dateModified' content='2019-11-17T06:49:12Z'>
          <span itemprop='position'>#104</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="100" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>I don’t think we should use a grub boot menu for that. Users might see “admin mode”, think it would fix their problem, boots with it, it doesn’t fix their problem and now everything runs unconfined.</p>
</blockquote>
</aside>
<p>grub allows multi layered boot menus. I.e. after choosing “admin mode”, there could be another screen which explains the risk of this and this likely won’t fix their issue.<br>
There are ways to inform the user. Highlight the importance. And if users still go ahead and shoot their own feet, they should be able to do so.<br>
Although “grub multi layered boot menu warning” could be future work and doesn’t need to be included in the first iteration.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-17T15:31:00Z' class='post-time'>
                November 17, 2019,  3:31pm
              </time>
              <meta itemprop='dateModified' content='2019-11-17T15:31:00Z'>
          <span itemprop='position'>#105</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="103" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Is there a way to say more limited, “don’t use apparmor-profile-everything” rather than saying “don’t use apparmor at all”? Even if a user chooses to boot in “full root mode”, it would be prudent to keep apparmor enabled. Just not apparmor-profile-everything.</p>
</blockquote>
</aside>
<p>This looks like a great compromise. However if it comes down to security vs freedom, I will pick freedom every time. I don’t feel like fighting with the OS every time I want to do something on my terms. Making different variations of security boot modes that goes the whole nine yards is reasonable <strong>as long as I can choose to run without them</strong>.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-17T17:06:54Z' class='post-time'>
                November 17, 2019,  5:06pm
              </time>
              <meta itemprop='dateModified' content='2019-11-17T17:06:54Z'>
          <span itemprop='position'>#106</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="103" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Is there a way to say more limited, “don’t use apparmor-profile-everything” rather than saying “don’t use apparmor at all”? Even if a user chooses to boot in “full root mode”, it would be prudent to keep apparmor enabled. Just not apparmor-profile-everything.</p>
</blockquote>
</aside>
<p>Yes. Modify <a href="../../../../external.html?link=https://github.com/Whonix/apparmor-profile-everything/blob/master/etc/initramfs-tools/scripts/init-bottom/apparmor-profile-everything">https://github.com/Whonix/apparmor-profile-everything/blob/master/etc/initramfs-tools/scripts/init-bottom/apparmor-profile-everything</a> to only run if a certain boot parameter is not found in /proc/cmdline.</p>
<aside class="quote no-group" data-post="103" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>The only way to bypass it could be if the user decides to bypass it? No other technical bypass / weakness? “Only” user mistake?</p>
</blockquote>
</aside>
<p>No. If root wasn’t restricted what stops an attacker from using <code>su</code> the same way the user does?</p>
<aside class="quote no-group" data-post="103" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>But I do know that the wording and bias of a poll influences the result of a poll. Therefore, if you wish to run a differently worded poll, let me know.</p>
</blockquote>
</aside>
<p>“security or freedom” is a bit blunt and can make people assume all kinds of things (e.g. NSA surveillance is essentially security over freedom). Would be better if it’s something like “security of the operating system or freedom to customize the operating system”.</p>
<aside class="quote no-group" data-post="104" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>grub allows multi layered boot menus. I.e. after choosing “admin mode”, there could be another screen which explains the risk of this and this likely won’t fix their issue.<br>
There are ways to inform the user. Highlight the importance. And if users still go ahead and shoot their own feet, they should be able to do so.</p>
</blockquote>
</aside>
<p>That would be a good idea then. I’d be fine with that.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-17T17:50:13Z' class='post-time'>
                November 17, 2019,  5:50pm
              </time>
              <meta itemprop='dateModified' content='2019-11-17T17:50:13Z'>
          <span itemprop='position'>#107</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="106" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<blockquote>
<p>Is there a way to say more limited, “don’t use apparmor-profile-everything” rather than saying “don’t use apparmor at all”? Even if a user chooses to boot in “full root mode”, it would be prudent to keep apparmor enabled. Just not apparmor-profile-everything.</p>
</blockquote>
<p>Yes. Modify <a href="../../../../external.html?link=https://github.com/Whonix/apparmor-profile-everything/blob/master/etc/initramfs-tools/scripts/init-bottom/apparmor-profile-everything">https://github.com/Whonix/apparmor-profile-everything/blob/master/etc/initramfs-tools/scripts/init-bottom/apparmor-profile-everything</a> to only run if a certain boot parameter is not found in /proc/cmdline.</p>
</blockquote>
</aside>
<p>That would be great!</p>
<aside class="quote no-group quote-modified" data-post="106" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<blockquote>
<p>The only way to bypass it could be if the user decides to bypass it? No other technical bypass / weakness? “Only” user mistake?</p>
</blockquote>
<p>No. If root wasn’t restricted what stops an attacker from using <code>su</code> the same way the user does?</p>
</blockquote>
</aside>
<p>I don’t see any difference between “apparmor=0” and “boot in full root mode”.</p>
<p>Differences are only usability and project philosophy.</p>
<ul>
<li>“apparmor=0”: more difficult for users. Less visible. Users wanting to tinker more likely to give up. More inconvenient. Less users shooting their own feet using Whonix. They might choose an inferior solution though and thereby shoot their own feet. An attacker can instruct a user to use “apparmor=0”. Might be harder to convince.</li>
<li>“boot in full root mode”: easier for users. Well visible. Users can tinker easily. More convenient. An attacker can instruct a user to use “full admin mode” more easily, but we can add a warning screen in between and make it actually harder to convince than “apparmor=0”.</li>
</ul>
<p>As for non-social attacks (attacker instructing user to do that), I don’t see any differences.</p>
<aside class="quote no-group" data-post="106" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>“security or freedom” is a bit blunt and can make people assume all kinds of things (e.g. NSA surveillance is essentially security over freedom). Would be better if it’s something like “security of the operating system or freedom to customize the operating system”.</p>
</blockquote>
</aside>
<p>I agree. Not easy to word that. Hence, I didn’t even try to seriously word that previously due to time restraints.</p>
<p>That’s an interesting question too. Even though we fortunately don’t need to ask consensus (since finding agreement easier than anticipated)… I’d still be interested to ask. Just interesting and maybe useful for future. Draft tweet.</p>
<blockquote>
<p>Which one is more important?</p>
<p><span class="hashtag">#Security</span> of the operating system or <span class="hashtag">#Freedom</span> to customize the operating system?</p>
<p>Choose one.</p>
<p>^PS</p>
<p>[ ] Security of the operating system<br>
[ ] Freedom to customize the operating system</p>
</blockquote>
<p>(<code>^PS</code>: not sure I should sign with my own name. Anything.)</p>
<p>Let me know if you like any changes to that tweet poll draft.</p>
<aside class="quote no-group" data-post="106" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>That would be a good idea then. I’d be fine with that.</p>
</blockquote>
</aside>
<p>Awesome! Please implement.</p>
<p>Together with live mode, we’d have 4 boot modes.</p>
<ul>
<li>persistent + regular</li>
<li>persistent + full admin (warning)</li>
<li>live + regular</li>
<li>persistent + full admin (warning)</li>
</ul>
<p>“regular” to not call it “restricted”. (We want people use it and hopefully happily don’t notice restrictions.)</p>
<p>But could become convulted if we ever introduce a no-root boot mode? I guess a no-root (root disabled) boot mode (even default one day) would still be useful? no-root (+apparmor-profile-everything) seems most difficult to succeed in a VM escape.</p>
<p>(related: <a href="../../multiple-boot-modes-for-better-security-persistent-user-live-user-persistent-secureadmin-persistent-superadmin-persistent-recovery-mode/7708.html" class="inline-onebox">multiple boot modes for better security: persistent + root | persistent + noroot | live + root | live + noroot</a>)</p>
<p>Let me know if you need help with grub boot menu. New menu entries seem easy.<br>
Once figured out (which wasn’t trivial) but now that it’s done <a href="../../../../external.html?link=https://github.com/Whonix/grub-live/tree/master/etc/grub.d">https://github.com/Whonix/grub-live/tree/master/etc/grub.d</a> looks easy.<br>
Wouldn’t be hard to add more grub boot menu entries. But multi layered grub menu could be harder.<br>
But a warning screen to warn against full admin mode (with timeout, dismissable, whatnot) could also be implemented blocking (other services from starting) and at early boot using systemd unit file?</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-17T17:57:12Z' class='post-time'>
                November 17, 2019,  5:57pm
              </time>
              <meta itemprop='dateModified' content='2019-11-17T17:57:12Z'>
          <span itemprop='position'>#108</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="107" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Let me know if you like any changes to that tweet poll draft.</p>
</blockquote>
</aside>
<p>It looks great.</p>
<aside class="quote no-group" data-post="107" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Awesome! Please implement.</p>
</blockquote>
</aside>
<p>I have no experience in custom grub menus so I can’t implement this.</p>
<aside class="quote no-group" data-post="107" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I guess a no-root (root disabled) boot mode (even default one day) would still be useful?</p>
</blockquote>
</aside>
<p>It would be very useful. Root is still far more privileged than the ordinary user even when attempting to create an untrusted root user.</p>
<aside class="quote no-group" data-post="107" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>But a warning screen to warn against full admin mode (with timeout, dismissable, whatnot) could also be implemented blocking (other services from starting) and at early boot using systemd unit file?</p>
</blockquote>
</aside>
<p>I think a grub menu would be the best approach.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-17T18:08:50Z' class='post-time'>
                November 17, 2019,  6:08pm
              </time>
              <meta itemprop='dateModified' content='2019-11-17T18:08:50Z'>
          <span itemprop='position'>#109</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="108" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>It looks great.</p>
</blockquote>
</aside>
<p>One roadblock. Twitter allows a maximum of 25 characters per poll choice.</p>
<p>Choice 1</p>
<blockquote>
<p>Security of the operating system</p>
</blockquote>
<p>32/25</p>
<hr>
<p>Choice 2</p>
<blockquote>
<p>Freedom to customize the operating system</p>
</blockquote>
<p>41/25</p>
<p>These need to be shortened somehow. Please suggest.</p>
<aside class="quote no-group" data-post="108" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>It would be very useful. Root is still far more privileged than the ordinary user even when attempting to create an untrusted root user.</p>
</blockquote>
</aside>
<p>Alright. So for future when apparmor-profile-everything is ready…</p>
<ul>
<li>persistent + regular</li>
<li>persistent + full-root (DANGER!)</li>
<li>live + regular</li>
<li>persistent + full-root (DANGER!)</li>
</ul>
<p>And later if no-root gets implemented…</p>
<ul>
<li>persistent + no-root</li>
<li>persistent + root</li>
<li>persistent + full-root (DANGER!)</li>
<li>live + no-root</li>
<li>live + root</li>
<li>persistent + full-root (DANGER!)</li>
</ul>
<p>(Didn’t think much yet about the wording. Open for suggestions. Can be done when time has come.)</p>
<aside class="quote no-group" data-post="108" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>I have no experience in custom grub menus so I can’t implement this.</p>
</blockquote>
</aside>
<aside class="quote no-group" data-post="108" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>I think a grub menu would be the best approach.</p>
</blockquote>
</aside>
<p>I am fairly certain, I can add all these boot menu entries. These would run the kernel with different boot parameters. And the kernel or any other program/script else can read these and act accordingly.<br>
But a layered boot menu… A simple yet solid implementation similar to grub-live… Maybe not possible.<br>
Maybe adding <code>(DANGER!)</code> to non-layered grub boot menu makes this clear? But maybe a longer explanation is warranted?</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-17T18:38:50Z' class='post-time'>
                November 17, 2019,  6:38pm
              </time>
              <meta itemprop='dateModified' content='2019-11-17T18:38:50Z'>
          <span itemprop='position'>#110</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="109" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>These need to be shortened somehow. Please suggest.</p>
</blockquote>
</aside>
<p>Replace “operating system” with “OS” and “Freedom” with “Able” so it’s “Security of the OS or Able to customize the OS”.</p>
<aside class="quote no-group" data-post="109" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Maybe adding <code>(DANGER!)</code> to non-layered grub boot menu makes this clear? But maybe a longer explanation is warranted?</p>
</blockquote>
</aside>
<p>It would be better to give a longer explanation.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-17T18:49:35Z' class='post-time'>
                November 17, 2019,  6:49pm
              </time>
              <meta itemprop='dateModified' content='2019-11-17T18:49:35Z'>
          <span itemprop='position'>#111</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="110" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Replace “operating system” with “OS” and “Freedom” with “Able” so it’s “Security of the OS or Able to customize the OS”.</p>
</blockquote>
</aside>
<p>Posted. (Could delete and re-post if something wrong.)</p>
<aside class="onebox twitterstatus">
  <header class="source">
      <a href="../../../../external.html?link=https://twitter.com/Whonix/status/1196137962888556544" target="_blank">twitter.com</a>
  </header>
  <article class="onebox-body">
    <img src="../../../../external.html?link=https://pbs.twimg.com/profile_images/747394861549162496/q6YdTSix_400x400.jpg" class="thumbnail onebox-avatar" width="60" height="60">

<h4><a href="../../../../external.html?link=https://twitter.com/Whonix/status/1196137962888556544" target="_blank">Whonix ™ (Whonix)</a></h4>

<div class="tweet"> Which one is more important?

Security of the operating system (OS) or being able to customize the operating system?

Choose one.

^PS</div>

<div class="date">
  <a href="../../../../external.html?link=https://twitter.com/Whonix/status/1196137962888556544" target="_blank">6:48 PM - 17 Nov 2019</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-post="110" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>It would be better to give a longer explanation.</p>
</blockquote>
</aside>
<p>Alright. Only thing I can think of is during early boot (systemd unit that blocks other services) and waits for yes/no continue boot with timeout (continue boot) (for headless).</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-18T20:23:50Z' class='post-time'>
                November 18, 2019,  8:23pm
              </time>
              <meta itemprop='dateModified' content='2019-11-18T20:23:50Z'>
          <span itemprop='position'>#112</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I’m not sure the best way to go about this but I created this <a href="../../../../external.html?link=https://paste.debian.net/hidden/02763571/">https://paste.debian.net/hidden/02763571/</a>. It’s a bit of a mess but it works (mostly).</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-18T20:47:44Z' class='post-time'>
                November 18, 2019,  8:47pm
              </time>
              <meta itemprop='dateModified' content='2019-11-18T20:47:44Z'>
          <span itemprop='position'>#113</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Maybe better a wrapper script that runs <code>env -i another-wrapper</code> to make sure the whole wrapper runs under <code>env -i</code>? Wrapper might be best since then we can whitelist some sane env vars (such as for proper console color settings?)</p>
<p>Or <code>env</code> in the shebang?</p>
<pre><code>#!/usr/bin/env -S -i /bin/bash
</code></pre>
<p>Above might even be too much? Even clears <code>SUDO_USER</code>.</p>
<p>We’re not the first ones to do this?</p>
<p>Parsing args better as per <a href="../../../../external.html?link=https://mywiki.wooledge.org/BashFAQ/035">https://mywiki.wooledge.org/BashFAQ/035</a></p>
<p>Similarly used many times in Whonix source code and rock solid. (Needs modification.)</p>
<pre><code class="lang-auto">   ## Thanks to:
   ## http://mywiki.wooledge.org/BashFAQ/035

   while :
   do
       case $1 in
           -h | --help | -\?)
               return 0
               ;;
           --)
               shift
               break
               ;;
           -*)
               echo "$SCRIPTNAME unknown option: $1" &gt;&amp;2
               EXIT_CODE="1"
               cleanup "1"
               return 0
               ;;
           *)
               break
               ;;
       esac
   done

   ## If there are input files (for example) that follow the options, they
   ## will remain in the "$@" positional parameters.
</code></pre>
<p>Also need to whitelist some parameters such as <code>--no-install-recommends</code>, similar ones and whatever comes up later.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-18T21:02:02Z' class='post-time'>
                November 18, 2019,  9:02pm
              </time>
              <meta itemprop='dateModified' content='2019-11-18T21:02:02Z'>
          <span itemprop='position'>#114</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="113" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Parsing args better as per <a href="../../../../external.html?link=https://mywiki.wooledge.org/BashFAQ/035">https://mywiki.wooledge.org/BashFAQ/035</a></p>
</blockquote>
</aside>
<p>Thanks. I didn’t think of using that for this.</p>
<p>How would I parse the package names this way?</p>
<p>Maybe keep the original for loop for “whitelisted_options” and use this approach just for “whitelisted_commands”?</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-18T22:14:37Z' class='post-time'>
                November 18, 2019, 10:14pm
              </time>
              <meta itemprop='dateModified' content='2019-11-18T22:14:37Z'>
          <span itemprop='position'>#115</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="113" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Maybe better a wrapper script that runs <code>env -i another-wrapper</code> to make sure the whole wrapper runs under <code>env -i</code> ?</p>
</blockquote>
</aside>
<p>Then nothing will run the other wrapper script under <code>env -i</code>.</p>
<aside class="quote no-group" data-post="113" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Or <code>env</code> in the shebang?</p>
</blockquote>
</aside>
<p>Doesn’t work. Create a file with</p>
<pre><code>#!/usr/bin/env -S -i /bin/bash
env
</code></pre>
<p>All environment variables are still there.</p>
<p>We can use apparmor’s environment scrubbing on the wrapper and then use <code>env -i /usr/bin/apt-get</code> in the wrapper.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-18T22:15:59Z' class='post-time'>
                November 18, 2019, 10:15pm
              </time>
              <meta itemprop='dateModified' content='2019-11-18T22:25:31Z'>
          <span itemprop='position'>#116</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>A newer script: <a href="../../../../external.html?link=https://paste.debian.net/hidden/3a742e21/">https://paste.debian.net/hidden/3a742e21/</a></p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-19T04:14:03Z' class='post-time'>
                November 19, 2019,  4:14am
              </time>
              <meta itemprop='dateModified' content='2019-11-19T04:14:03Z'>
          <span itemprop='position'>#117</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="115" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<blockquote>
<p>Maybe better a wrapper script that runs <code>env -i another-wrapper</code> to make sure the whole wrapper runs under <code>env -i</code> ?</p>
</blockquote>
<p>Then nothing will run the other wrapper script under <code>env -i</code> .</p>
</blockquote>
</aside>
<p><code>/usr/bin/rapt</code></p>
<pre><code class="lang-auto">#!/bin/bash
env -i /usr/bin/rapt2 "$@"
</code></pre>
<p>Apparmor would enforce that users are only allowed to run <code>/usr/bin/rapt</code> and not <code>/usr/bin/rapt2</code>.</p>
<aside class="quote no-group quote-modified" data-post="115" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<blockquote>
<p>Or <code>env</code> in the shebang?</p>
</blockquote>
<p>Doesn’t work. Create a file with</p>
<pre><code class="lang-auto">#!/usr/bin/env -S -i /bin/bash
env
</code></pre>
<p>All environment variables are still there.</p>
</blockquote>
</aside>
<p>Works for me.</p>
<p><code>/home/user/test</code>:</p>
<pre><code class="lang-auto">#!/usr/bin/env -S -i /bin/bash

set -x

true x

env

true y

exit
</code></pre>
<pre><code>./test
</code></pre>
<pre><code class="lang-auto">+ true x
+ env
PWD=/home/user
SHLVL=1
_=/usr/bin/env
+ true y
+ exit
</code></pre>
<p>Otherwise there would be a lot more env vars.</p>
<aside class="quote no-group" data-post="115" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>We can use apparmor’s environment scrubbing on the wrapper</p>
</blockquote>
</aside>
<p>Maybe that only as defense in depth and not only solution.</p>
<aside class="quote no-group" data-post="115" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>and then use <code>env -i /usr/bin/apt-get</code> in the wrapper.</p>
</blockquote>
</aside>
<p>I am not sure I am chasing unimportant details here, but I guess it would be better to run as little as possible with non-sanitized env vars. I.e. the wrapper that checks the parameters is probably best to run wholly with sanitized env.</p>
<p>one</p>
<pre><code>while :
do
    case $1 in
        update)
</code></pre>
<p>two</p>
<pre><code>while :
do
    case $2 in
        --fix-missing)
            break
            ;;
</code></pre>
<p>Do we really need two? Could just be the same loop?</p>
<p>This is because apt supports all syntax.</p>
<ul>
<li><code>apt --no-install-recommends install pkg-name</code></li>
<li><code>apt install pkg-name --no-install-recommends</code></li>
<li><code>apt install --no-install-recommends pkg-name</code></li>
</ul>
<p>Ideally, we’d be as non-intrusive as possible. Not breaking existing users workflows / scripts.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-19T15:32:24Z' class='post-time'>
                November 19, 2019,  3:32pm
              </time>
              <meta itemprop='dateModified' content='2019-11-19T15:32:24Z'>
          <span itemprop='position'>#118</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>
<p>Nov 19 15:22:17 host audit[528]: AVC apparmor=“DENIED” operation=“exec” profile="/usr/lib/security-misc/permission-lockdown" name="/usr/bin/chmod" pid=528 comm=“permission-lock” requested_mask=“x” denied_mask=“x” fsuid=0 ouid=0<br>
Nov 19 15:22:17 host audit[528]: AVC apparmor=“DENIED” operation=“open” profile="/usr/lib/security-misc/permission-lockdown" name="/usr/bin/chmod" pid=528 comm=“permission-lock” requested_mask=“r” denied_mask=“r” fsuid=0 ouid=0<br>
Nov 19 15:24:59 host enable-firewall[379]: /usr/lib/security-misc/permission-lockdown: line 56: /usr/bin/chmod: Permission denied</p>
</blockquote>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/81e4f580af1ea12e79e387d4977771f37c50e7c1" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/81e4f580af1ea12e79e387d4977771f37c50e7c1" target="_blank">etc/apparmor.d/usr.lib.security-misc.permission-lockdown: /usr/bin/chmod mrix,</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-11-19" data-time="15:29:02" data-timezone="UTC">03:29PM - 19 Nov 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 1 additions and 0 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/commit/81e4f580af1ea12e79e387d4977771f37c50e7c1" target="_blank">
          <span class="added">+1</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>




  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-19T15:51:52Z' class='post-time'>
                November 19, 2019,  3:51pm
              </time>
              <meta itemprop='dateModified' content='2019-11-19T15:51:52Z'>
          <span itemprop='position'>#119</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>
<p>packages_list="$(grep -h ^Package:  /var/lib/apt/lists/deb.*_Packages | sed -e ‘s/Package: //g’)"</p>
</blockquote>
<p>Maybe a cleaner way? How does APT’s bash auto completion (press tab to complete package name) get the names of packages from?</p>
<p>Maybe we don’t need to whitelist package names and commands? Maybe all commands are ok? Maybe only parameters starting with a dash <code>-</code> need to be whitelisted?</p>
<p>What about removal of essential packages which provide apparmor-profile-everything functionality to begin with? <code>sudo apt purge apparmor-profile-everything</code> Blacklist these?</p>
<p>Removing any dependency that makes apparmor, apparmor-profile-everything work could help an attacker get rid of apparmor-profile-everything</p>
<p>Even swapping the init system from systemd to something else or something else could break apparmor?</p>
<p>Or installing some package that conflicts with the apparmor package would result in its removal, does that exist? Or are there packages that disable apparmor after reboot (another LSM)? Install selinux to get rid of apparmor? Just guessing. No substance yet.</p>
<p>Blacklist approach could have holes.</p>
<p>Seems rather hard to tame APT. Are we the first ones to restrict APT?</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-19T16:44:43Z' class='post-time'>
                November 19, 2019,  4:44pm
              </time>
              <meta itemprop='dateModified' content='2019-11-19T16:44:43Z'>
          <span itemprop='position'>#120</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="117" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p><code>/usr/bin/rapt</code></p>
</blockquote>
</aside>
<p>Sure, but nothing executes <code>rapt</code> with <code>env -i</code>.</p>
<p>What stops an attacker from using LD_PRELOAD tricks with <code>rapt</code> to prevent <code>rapt2</code> being run in a clean environment?</p>
<aside class="quote no-group" data-post="117" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Do we really need two? Could just be the same loop?</p>
</blockquote>
</aside>
<p>How would that work? Especially for the packages.</p>
<aside class="quote no-group" data-post="119" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>What about removal of essential packages which provide apparmor-profile-everything functionality to begin with? <code>sudo apt purge apparmor-profile-everything</code> Blacklist these?</p>
</blockquote>
</aside>
<p>The <code>dangerous-files</code> abstraction already fixes that. Those files aren’t writable although that abstraction isn’t enabled in the apt profile yet.</p>
<aside class="quote no-group" data-post="119" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Even swapping the init system from systemd to something else or something else could break apparmor?</p>
</blockquote>
</aside>
<p>The other init would still be confined under apparmor and besides all binaries/libraries are read-only and read-write only for apt.</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8339.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-11-19T17:07:35Z' class='post-time'>
                November 19, 2019,  5:07pm
              </time>
              <meta itemprop='dateModified' content='2019-11-19T17:07:35Z'>
          <span itemprop='position'>#121</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="120" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<blockquote>
<p><code>/usr/bin/rapt</code></p>
</blockquote>
<p>Sure, but nothing executes <code>rapt</code> with <code>env -i</code> .</p>
</blockquote>
</aside>
<p>I see. I would hope that the only thing exposed being <code>env</code> would be more resilient to that then anything else doing by the wrapper.</p>
<aside class="quote no-group quote-modified" data-post="120" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<blockquote>
<p>Do we really need two? Could just be the same loop?</p>
</blockquote>
<p>How would that work? Especially for the packages.</p>
</blockquote>
</aside>
<p>I’ll see if I can implement the wrapper. Secure, yet not breaking apt’s interface (except for non-whitelisted).</p>
<aside class="quote no-group quote-modified" data-post="120" data-topic="8339">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<blockquote>
<p>What about removal of essential packages which provide apparmor-profile-everything functionality to begin with? <code>sudo apt purge apparmor-profile-everything</code> Blacklist these?</p>
</blockquote>
<p>The <code>dangerous-files</code> abstraction already fixes that. Those files aren’t writable although that abstraction isn’t enabled in the apt profile yet.</p>
</blockquote>
</aside>
<p>How would <code>dangerous-files</code> block <code>sudo apt purge apparmor</code>?</p>
        </div>

        <meta itemprop='headline' content='AppArmor for Complete System - Including init, PID1, Systemd, Everything! - Full System MAC policy'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="../8339af4d.html?page=5">← previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="../8339235c.html?page=7">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>API for working with Tor circuits on Whonix</title>
    <link>http://forums.whonix.org/t/api-for-working-with-tor-circuits-on-whonix/11692</link>
    <description>Hi Whonix team,

an app X works with a bundled Tor and it connects to its Tor control port to send HTTP requests under different identities (Tor circuits). Can the app be modified to work under Whonix? Currently it does not work because of Tor-over-Tor problem (I think!)

There are several ideas one can come up with how to modify the application:

1) Simply don&#39;t use the bundled Tor in the app and send clearnet HTTP requests which are &quot;torrified&quot; by Whonix. This does not work because it ignores the requirent for &quot;having access to multiple Tor circuits&quot;.

2) Just ignore that Whonix runs everything over Tor. Then we are in Tor-over-Tor situation and AFAIK recently a Tor version was released with a patch that attempts to prevent that. It&#39;s not recommended anyway.

3) Make the the bundled Tor in the app circumevent Whonix&#39;s Tor. I don&#39;t think it&#39;s possible. (Mentioning it just for the record)

4) Use some Whonix API to get access to Tor&#39;s circuits. Is there anything like that?

I&#39;m asking this question to get some feedback about preferred approach for this (if there is any). 

Thank you for any reply!</description>
    <language>en</language>
    <lastBuildDate>Sat, 22 May 2021 13:52:27 +0000</lastBuildDate>
    <category>Support</category>
    <atom:link href="http://forums.whonix.org/t/api-for-working-with-tor-circuits-on-whonix/11692.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>API for working with Tor circuits on Whonix</title>
        <dc:creator><![CDATA[cetgrury]]></dc:creator>
        <description><![CDATA[
            <p>Thank you very much for taking the time to write the answer! Appreciated!</p>
          <p><a href="http://forums.whonix.org/t/api-for-working-with-tor-circuits-on-whonix/11692/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/api-for-working-with-tor-circuits-on-whonix/11692/3</link>
        <pubDate>Sat, 22 May 2021 13:52:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-11692-3</guid>
        <source url="http://forums.whonix.org/t/api-for-working-with-tor-circuits-on-whonix/11692.rss">API for working with Tor circuits on Whonix</source>
      </item>
      <item>
        <title>API for working with Tor circuits on Whonix</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Documentation exists for a few applications re-configured for use with system Tor.</p>
<p>useful upstream feature request:</p>
<ul>
<li>support using application-name with system Tor</li>
<li>support using application-name with Tor running on a different computer / IP</li>
<li>support using application-name with Whonix</li>
</ul>
<p>Definition of <code>system Tor</code>:</p>
<ul>
<li><a href="https://support.torproject.org/glossary/little-t-tor/">https://support.torproject.org/glossary/little-t-tor/</a></li>
<li><a href="https://packages.debian.org/search?suite=buster&amp;keywords=tor">https://packages.debian.org/search?suite=buster&amp;keywords=tor</a></li>
</ul>
<p>For a few applications that ship their own Tor binary and/or use system Tor, documentation has been created to use these applications with Whonix:<br>
<a href="https://www.whonix.org/wiki/Special:WhatLinksHere/Template:Control_Port_Filter_Python_Profile_Add">https://www.whonix.org/wiki/Special:WhatLinksHere/Template:Control_Port_Filter_Python_Profile_Add</a></p>
<p>(login required so copied here at time of writing)</p>
<ul>
<li>
<a href="https://www.whonix.org/wiki/ZeroNet">ZeroNet</a> (transclusion) ‎ (<a href="https://www.whonix.org/w/index.php?title=Special:WhatLinksHere&amp;target=ZeroNet">← links</a> | <a href="https://www.whonix.org/w/index.php?title=ZeroNet&amp;action=edit">edit</a>)</li>
<li>
<a href="https://www.whonix.org/wiki/OnionShare">OnionShare</a> (transclusion) ‎ (<a href="https://www.whonix.org/w/index.php?title=Special:WhatLinksHere&amp;target=OnionShare">← links</a> | <a href="https://www.whonix.org/w/index.php?title=OnionShare&amp;action=edit">edit</a>)</li>
<li>
<a href="https://www.whonix.org/wiki/Bisq">Bisq</a> (transclusion) ‎ (<a href="https://www.whonix.org/w/index.php?title=Special:WhatLinksHere&amp;target=Bisq">← links</a> | <a href="https://www.whonix.org/w/index.php?title=Bisq&amp;action=edit">edit</a>)</li>
<li>
<a href="https://www.whonix.org/wiki/Deprecated/Ricochet_IM">Deprecated/Ricochet IM</a> (transclusion) ‎ (<a href="https://www.whonix.org/w/index.php?title=Special:WhatLinksHere&amp;target=Deprecated%2FRicochet+IM">← links</a> | <a href="https://www.whonix.org/w/index.php?title=Deprecated/Ricochet_IM&amp;action=edit">edit</a>)</li>
</ul>
<p>One solution is to configure the application (or request such a feature upstream or send a pull request) to use system Tor, in other words localhost, IP 127.0.0.1 port 9050 and set a socks user name. The Tor (not Whonix) feature <code>IsolateSOCKSAuth</code> would help here.</p>
<p>Quote Tor manual - <a href="https://2019.www.torproject.org/docs/tor-manual.html.en">https://2019.www.torproject.org/docs/tor-manual.html.en</a></p>
<blockquote>
<p><strong>IsolateSOCKSAuth</strong></p>
</blockquote>
<blockquote>
<p>Don’t share circuits with streams for which different SOCKS authentication was provided. (For HTTPTunnelPort connections, this option looks at the Proxy-Authorization and X-Tor-Stream-Isolation headers. On by default; you can disable it with <strong>NoIsolateSOCKSAuth</strong>.)</p>
</blockquote>
<p>Some applications such as Tor Browser intelligently set a unique socks user name when appropriate such as per browser tab. Depends on the specifics of the application. Also unrelated to Whonix. This is general application Tor friendliness.</p>
<p>There’s no Whonix API. And hopefully it’s not needed.</p>
<p>For example, work on making <a href="https://github.com/digitalautonomy/wahay">wahay</a> work inside Whonix has been done by <a class="mention" href="http://forums.whonix.org/u/jeremyrand">@JeremyRand</a>. Perhaps useful:<br>
<a href="https://github.com/digitalautonomy/wahay/issues?q=whonix">https://github.com/digitalautonomy/wahay/issues?q=whonix</a></p>
<p>wahay’s case (or any similar one) is a bit more complicated since that application uses ephemeral Tor onion services. For applications that only use Tor as a client, i.e. not use Tor onion services (server), it’s easier.</p>
<p>If any API is still needed, then Tor has an extensive one. The Tor control protocol.<br>
<a href="https://gitweb.torproject.org/torspec.git/tree/control-spec.txt">https://gitweb.torproject.org/torspec.git/tree/control-spec.txt</a></p>
<p>related:</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Onion-grater" target="_blank" rel="noopener" title="03:00PM - 23 August 2020">Whonix – 23 Aug 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:110/58;"><img src="https://www.whonix.org/w/images/4/47/Whonix_Facebook_Social_Share.png" class="thumbnail" width="110" height="58"></div>

<h3><a href="https://www.whonix.org/wiki/Onion-grater" target="_blank" rel="noopener">Onion-grater</a></h3>

<p>information about onion-grater</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Dev/Whonix_friendly_applications_best_practices" target="_blank" rel="noopener" title="05:48AM - 05 May 2021">Whonix – 5 May 21</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:110/58;"><img src="https://www.whonix.org/w/images/4/47/Whonix_Facebook_Social_Share.png" class="thumbnail" width="110" height="58"></div>

<h3><a href="https://www.whonix.org/wiki/Dev/Whonix_friendly_applications_best_practices" target="_blank" rel="noopener">Dev/Whonix friendly applications best practices</a></h3>

<p>Best practices on writing applications compatible with Whonix ™.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://gitlab.torproject.org/uploads/-/system/appearance/favicon/1/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://gitlab.torproject.org/legacy/trac/-/wikis/doc/Tor_friendly_applications_best_practices" target="_blank" rel="noopener">GitLab</a>
  </header>
  <article class="onebox-body">
    <img src="https://gitlab.torproject.org/uploads/-/system/project/avatar/414/trac.png" class="thumbnail onebox-avatar" width="16" height="16">

<h3><a href="https://gitlab.torproject.org/legacy/trac/-/wikis/doc/Tor_friendly_applications_best_practices" target="_blank" rel="noopener">Tor_friendly_applications_best_practices · Wiki · Legacy / Trac</a></h3>

<p>Welcome to The Tor Project's Gitlab</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Dev/anon-ws-disable-stacked-tor" target="_blank" rel="noopener" title="10:30PM - 26 November 2020">Whonix – 26 Nov 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:110/58;"><img src="https://www.whonix.org/w/images/4/47/Whonix_Facebook_Social_Share.png" class="thumbnail" width="110" height="58"></div>

<h3><a href="https://www.whonix.org/wiki/Dev/anon-ws-disable-stacked-tor" target="_blank" rel="noopener">Dev/anon-ws-disable-stacked-tor</a></h3>

<p>Preventing Tor over Tor for Tor Browser, TorChat and others.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/api-for-working-with-tor-circuits-on-whonix/11692/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/api-for-working-with-tor-circuits-on-whonix/11692/2</link>
        <pubDate>Fri, 21 May 2021 14:29:03 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-11692-2</guid>
        <source url="http://forums.whonix.org/t/api-for-working-with-tor-circuits-on-whonix/11692.rss">API for working with Tor circuits on Whonix</source>
      </item>
      <item>
        <title>API for working with Tor circuits on Whonix</title>
        <dc:creator><![CDATA[cetgrury]]></dc:creator>
        <description><![CDATA[
            <p>Hi Whonix team,</p>
<p>an app X works with a bundled Tor and it connects to its Tor control port to send HTTP requests under different identities (Tor circuits). Can the app be modified to work under Whonix? Currently it does not work because of Tor-over-Tor problem (I think!)</p>
<p>There are several ideas one can come up with how to modify the application:</p>
<ol>
<li>
<p>Simply don’t use the bundled Tor in the app and send clearnet HTTP requests which are “torrified” by Whonix. This does not work because it ignores the requirent for “having access to multiple Tor circuits”.</p>
</li>
<li>
<p>Just ignore that Whonix runs everything over Tor. Then we are in Tor-over-Tor situation and AFAIK recently a Tor version was released with a patch that attempts to prevent that. It’s not recommended anyway.</p>
</li>
<li>
<p>Make the the bundled Tor in the app circumevent Whonix’s Tor. I don’t think it’s possible. (Mentioning it just for the record)</p>
</li>
<li>
<p>Use some Whonix API to get access to Tor’s circuits. Is there anything like that?</p>
</li>
</ol>
<p>I’m asking this question to get some feedback about preferred approach for this (if there is any).</p>
<p>Thank you for any reply!</p>
          <p><a href="http://forums.whonix.org/t/api-for-working-with-tor-circuits-on-whonix/11692/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/api-for-working-with-tor-circuits-on-whonix/11692/1</link>
        <pubDate>Fri, 21 May 2021 13:25:44 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-11692-1</guid>
        <source url="http://forums.whonix.org/t/api-for-working-with-tor-circuits-on-whonix/11692.rss">API for working with Tor circuits on Whonix</source>
      </item>
  </channel>
</rss>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Derivative Maker Automated CI Builder - Development - Whonix Forum</title>
    <meta name="description" content="Per request of @Patrick , I created a CI integration for the derivative-maker repository. 

What it does
This tool runs a Github Actions workflow when a commit is pushed. 
The workflow runs an automation suite on a rem&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="144689ba9.html?page=3" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Derivative Maker Automated CI Builder&#39;" href="14468.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/derivative-maker-automated-ci-builder/14468?page=3" />
<meta name="twitter:url" content="https://forums.whonix.org/t/derivative-maker-automated-ci-builder/14468?page=3" />
<meta property="og:title" content="Derivative Maker Automated CI Builder" />
<meta name="twitter:title" content="Derivative Maker Automated CI Builder" />
<meta property="og:description" content="Yes.   That one should be easy hopefully.  binary_build_folder_dist is currently set to  &quot;$HOMEVAR/derivative-binary&quot;   binary_build_folder_dist=&quot;$HOMEVAR/derivative-binary&quot;   But can be overwritten using an environment variable.  binary_build_folder_dist=&quot;/path/to/folder&quot; export binary_build_folder_dist   That one may not be so easy to fix since I couldnâ€™t reproduce that locally.  There might be some service running on the server which accesses that folder for some purpose such as KDE baloo in..." />
<meta name="twitter:description" content="Yes.   That one should be easy hopefully.  binary_build_folder_dist is currently set to  &quot;$HOMEVAR/derivative-binary&quot;   binary_build_folder_dist=&quot;$HOMEVAR/derivative-binary&quot;   But can be overwritten using an environment variable.  binary_build_folder_dist=&quot;/path/to/folder&quot; export binary_build_folder_dist   That one may not be so easy to fix since I couldnâ€™t reproduce that locally.  There might be some service running on the server which accesses that folder for some purpose such as KDE baloo in..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="35 mins ðŸ•‘" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="90 â¤" />
<meta property="article:published_time" content="2022-08-29T09:21:04+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="144684658.html?page=2">
        <link rel="next" href="14468fdb0.html?page=4">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="14468.html">Derivative Maker Automated CI Builder</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-29T09:21:04Z' class='post-time'>
                August 29, 2022,  9:21am
              </time>
              <meta itemprop='dateModified' content='2022-08-29T09:21:04Z'>
          <span itemprop='position'>#41</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="bee" data-post="38" data-topic="14468">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/bee/40/2338_2.png" class="avatar"> bee:</div>
<blockquote>
<p><a class="mention" href="../../../external.html?link=https://forums.whonix.org/u/patrick">@Patrick</a>, it looks like I am getting very close.</p>
</blockquote>
</aside>
<p>Yes.</p>
<aside class="quote no-group" data-username="bee" data-post="38" data-topic="14468">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/bee/40/2338_2.png" class="avatar"> bee:</div>
<blockquote>
<p>When the build commands get run, it puts <code>derivative-binary</code> in <code>~/</code>. Is there any way we could have it put it in <code>../</code> instead. Again, this is because of the way I am mounting the machines and what not.</p>
</blockquote>
</aside>
<p>That one should be easy hopefully.</p>
<p><code>binary_build_folder_dist</code> is currently set to  <code>"$HOMEVAR/derivative-binary"</code></p>
<blockquote>
<p>binary_build_folder_dist="$HOMEVAR/derivative-binary"</p>
</blockquote>
<p>But can be overwritten using an environment variable.</p>
<pre><code>binary_build_folder_dist="/path/to/folder"
export binary_build_folder_dist
</code></pre>
<aside class="quote no-group" data-username="bee" data-post="38" data-topic="14468">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/bee/40/2338_2.png" class="avatar"> bee:</div>
<blockquote>
<p>My CI is successfully building the gateway, which is great news. When building the workstation however, I ran in to an error about being unable to umount. Relevant logs are at the bottom of post.</p>
</blockquote>
</aside>
<p>That one may not be so easy to fix since I couldnâ€™t reproduce that locally.</p>
<p>There might be some service running on the server which accesses that folder for some purpose such as KDE baloo indexing service. (Probably not that but something similar.)</p>
<p>Could you please share a</p>
<pre><code>sudo ps aux
</code></pre>
<p>of the server?</p>
<p>Are logs posted automatically anywhere yet? If so or once that happens, I might be able to debug this easier but adding more and more debugging code to the build script.</p>
<p>Added more debugging (and maybe even a fix).</p>
<aside class="quote no-group" data-username="bee" data-post="38" data-topic="14468">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/bee/40/2338_2.png" class="avatar"> bee:</div>
<blockquote>
<p>I am definitely thinking that only building these VMs when a tagged is pushed is the way to go, because it is taking CI over an hour to build the VMs for both the gateway and the workstation. So when developing <code>derivative-maker</code>, you can push a developers only tag for troubleshooting, or perhaps even create a debug tag in order to iterate. Is that okay?</p>
</blockquote>
</aside>
<p>Yes, very much so.</p>
<aside class="quote no-group" data-username="bee" data-post="39" data-topic="14468">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/bee/40/2338_2.png" class="avatar"> bee:</div>
<blockquote>
<p>My ideal goal would be for us to have this CI feature implemented by end of this week, if we can troubleshoot the build issues together.</p>
</blockquote>
</aside>
<p>Yes, that would be amazing!</p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/bee'><span itemprop='name'>bee</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-31T23:08:06Z' class='post-time'>
                August 31, 2022, 11:08pm
              </time>
              <meta itemprop='dateModified' content='2022-08-31T23:08:06Z'>
          <span itemprop='position'>#42</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>New error with the <code>umount_kill.sh</code> script after rebase</p>
<p><a href="../../../external.html?link=https://github.com/Mycobee/derivative-maker/suites/8079002777/artifacts/348404541" rel="noopener nofollow ugc">logs</a></p>
<pre><code class="lang-auto">+ sudo --non-interactive test -d /var/cache/pbuilder/base.cow_amd64
+ /home/ansible/derivative-maker/help-steps/umount_kill.sh /var/cache/pbuilder/base.cow_amd64/
/home/ansible/derivative-maker/help-steps/umount_kill.sh: ERROR: This MUST be run as root (sudo)!
++ errorhandlergeneral ERR
++ last_failed_exit_code=1
++ last_failed_bash_command='"$dist_source_help_steps_folder/umount_kill.sh" "$base_folder/"'
++ output_cmd_set
++ '[' -o xtrace ']'
++ output_cmd=true
++ true 'INFO: Middle of function errorhandlergeneral of ././build-steps.d/1200_create-debian-packages.'
++ errorhandlerprocessshared ERR
++ last_script=././build-steps.d/1200_create-debian-packages
++ trap_signal_type_previous=
++ '[' '' = '' ']'
++ trap_signal_type_previous=unset
++ trap_signal_type_last=ERR
++ dist_build_error_counter=1
</code></pre>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/bee'><span itemprop='name'>bee</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-31T23:18:17Z' class='post-time'>
                August 31, 2022, 11:18pm
              </time>
              <meta itemprop='dateModified' content='2022-08-31T23:18:17Z'>
          <span itemprop='position'>#43</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Pretty sure it just needs <code>$SUDO_TO_ROOT</code> on lines 182 and 229 in <code>build-steps.d/1200_create-debian-packages</code>. Fixed on my branch</p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-01T12:33:36Z' class='post-time'>
                September 1, 2022, 12:33pm
              </time>
              <meta itemprop='dateModified' content='2022-09-01T12:33:36Z'>
          <span itemprop='position'>#44</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Thanks! That and other similar cases is now fixed in <code>16.0.7.2-developers-only</code>.</p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/bee'><span itemprop='name'>bee</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-01T16:18:37Z' class='post-time'>
                September 1, 2022,  4:18pm
              </time>
              <meta itemprop='dateModified' content='2022-09-01T16:18:37Z'>
          <span itemprop='position'>#45</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I guess I dont know what I am talking about because things still arenâ€™t working.</p>
<p><a href="../../../external.html?link=https://github.com/Mycobee/derivative-maker/suites/8092965185/artifacts/349436450" rel="noopener nofollow ugc">logs</a></p>
<p>On the upside I got all the mounted volume issues fixed by just making the VPS a little larger and ditching the volume + mount logic. It was cheaper to add 50 gigs to the disk than have a 100gb block storage attached anyway <img src="../../images/emoji/twitter/man_shrugginge5bf.png?v=12" title=":man_shrugging:" class="emoji" alt=":man_shrugging:"></p>
<p>No need to make things unnecessarily complicated I suppose</p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-02T07:56:15Z' class='post-time'>
                September 2, 2022,  7:56am
              </time>
              <meta itemprop='dateModified' content='2022-09-02T07:56:15Z'>
          <span itemprop='position'>#46</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Thank you for your patience with me!</p>
<p>More debugging in <code>16.0.7.3-developers-only</code> added and maybe even fixed.</p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/bee'><span itemprop='name'>bee</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-02T19:55:09Z' class='post-time'>
                September 2, 2022,  7:55pm
              </time>
              <meta itemprop='dateModified' content='2022-09-02T19:55:09Z'>
          <span itemprop='position'>#47</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>No worries at all! Still having errors on the latest master build <a class="mention" href="../../../external.html?link=https://forums.whonix.org/u/patrick">@Patrick</a></p>
<p><a href="../../../external.html?link=https://github.com/Mycobee/derivative-maker/suites/8113445835/artifacts/350921689" rel="noopener nofollow ugc">logs</a></p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-02T21:38:14Z' class='post-time'>
                September 2, 2022,  9:38pm
              </time>
              <meta itemprop='dateModified' content='2022-09-02T21:38:14Z'>
          <span itemprop='position'>#48</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Hopefully fixed in <code>16.0.7.4-developers-only</code>.</p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/bee'><span itemprop='name'>bee</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-03T01:03:06Z' class='post-time'>
                September 3, 2022,  1:03am
              </time>
              <meta itemprop='dateModified' content='2022-09-03T01:03:06Z'>
          <span itemprop='position'>#49</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Thank you. It seems as though this fixed the issues.</p>
<p>I am back to this weird mount issue, and would love some input.</p>
<p><a href="../../../external.html?link=https://github.com/Mycobee/derivative-maker/suites/8116452478/artifacts/351107168" rel="noopener nofollow ugc">logs</a></p>
<h4>
<a name="the-error-1" class="anchor" href="#the-error-1"></a>The error:</h4>
<pre><code class="lang-auto">$ sudo --non-interactive umount /home/ansible/derivative-binary/Whonix-Gateway-XFCE_image
umount: /home/ansible/derivative-binary/Whonix-Gateway-XFCE_image: target is busy.
</code></pre>
<h4>
<a name="the-system-being-mounted-2" class="anchor" href="#the-system-being-mounted-2"></a>The system being mounted:</h4>
<pre><code class="lang-auto">$ df -h | grep -i derivative
/dev/mapper/loop0p1   98G  2.8G   91G   4% /home/ansible/derivative-binary/Whonix-Gateway-XFCE_image
</code></pre>
<h4>
<a name="processes-running-3" class="anchor" href="#processes-running-3"></a>Processes running:</h4>
<pre><code class="lang-auto">$ ps aux
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root           1  0.0  0.2  99556  5560 ?        Ss   Aug31   0:12 /sbin/init
root           2  0.0  0.0      0     0 ?        S    Aug31   0:00 [kthreadd]
root           3  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [rcu_gp]
root           4  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [rcu_par_gp]
root           6  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [kworker/0:0H-events_highpri]
root           8  0.0  0.0      0     0 ?        I&lt;   Aug31   0:13 [kworker/0:1H-events_highpri]
root           9  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [mm_percpu_wq]
root          10  0.0  0.0      0     0 ?        S    Aug31   0:00 [rcu_tasks_rude_]
root          11  0.0  0.0      0     0 ?        S    Aug31   0:00 [rcu_tasks_trace]
root          12  0.0  0.0      0     0 ?        S    Aug31   0:11 [ksoftirqd/0]
root          13  0.0  0.0      0     0 ?        I    Aug31   0:16 [rcu_sched]
root          14  0.0  0.0      0     0 ?        S    Aug31   0:01 [migration/0]
root          16  0.0  0.0      0     0 ?        S    Aug31   0:00 [cpuhp/0]
root          18  0.0  0.0      0     0 ?        S    Aug31   0:00 [kdevtmpfs]
root          19  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [netns]
root          20  0.0  0.0      0     0 ?        S    Aug31   0:00 [kauditd]
root          21  0.0  0.0      0     0 ?        S    Aug31   0:00 [khungtaskd]
root          22  0.0  0.0      0     0 ?        S    Aug31   0:00 [oom_reaper]
root          23  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [writeback]
root          24  0.0  0.0      0     0 ?        S    Aug31   0:09 [kcompactd0]
root          25  0.0  0.0      0     0 ?        SN   Aug31   0:00 [ksmd]
root          26  0.0  0.0      0     0 ?        SN   Aug31   0:00 [khugepaged]
root          44  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [kintegrityd]
root          45  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [kblockd]
root          46  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [blkcg_punt_bio]
root          47  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [edac-poller]
root          48  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [devfreq_wq]
root          50  0.0  0.0      0     0 ?        S    Aug31   0:06 [kswapd0]
root          51  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [kthrotld]
root          52  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [acpi_thermal_pm]
root          53  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [ipv6_addrconf]
root          63  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [kstrp]
root          66  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [zswap-shrink]
root          67  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [kworker/u3:0]
root         109  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [ata_sff]
root         110  0.0  0.0      0     0 ?        S    Aug31   0:00 [scsi_eh_0]
root         111  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [scsi_tmf_0]
root         112  0.0  0.0      0     0 ?        S    Aug31   0:00 [scsi_eh_1]
root         113  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [scsi_tmf_1]
root         115  0.0  0.0      0     0 ?        S    Aug31   0:00 [scsi_eh_2]
root         117  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [scsi_tmf_2]
root         182  0.0  0.0      0     0 ?        S    Aug31   0:13 [jbd2/vda1-8]
root         183  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [ext4-rsv-conver]
root         231  0.0  1.4 134824 30340 ?        Ss   Aug31   0:06 /lib/systemd/systemd-journald
root         294  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [cryptd]
root         326  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [ttm_swap]
root         360  0.0  0.2   8120  4880 ?        Ss   Aug31   0:07 /usr/sbin/haveged --Foreground --verbose=1
root         573  0.0  0.1  21336  3068 ?        Ss   Aug31   0:00 /lib/systemd/systemd-udevd
apt-cac+     601  0.0  0.3 459892  7900 ?        Ssl  Aug31   0:02 /usr/sbin/apt-cacher-ng -c /etc/apt-cacher-ng ForeGround=1
root         604  0.0  0.0   5576  1768 ?        Ss   Aug31   0:00 /usr/sbin/cron -f
message+     605  0.0  0.0   7984  1960 ?        Ss   Aug31   0:01 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
root         606  0.0  0.6 1225244 12580 ?       Ssl  Aug31   0:00 /opt/digitalocean/bin/droplet-agent
root         608  0.0  0.1 220740  2448 ?        Ssl  Aug31   0:01 /usr/sbin/rsyslogd -n -iNONE
root         615  0.0  0.1  13680  3064 ?        Ss   Aug31   0:01 /lib/systemd/systemd-logind
_chrony      627  0.0  0.1  18968  2276 ?        S    Aug31   0:00 /usr/sbin/chronyd -F 1
root         628  0.0  0.0   2812  1152 tty1     Ss+  Aug31   0:00 /sbin/agetty -o -p -- \u --noclear tty1 linux
root         629  0.0  0.0   4336  1400 ttyS0    Ss+  Aug31   0:00 /sbin/agetty -o -p -- \u --keep-baud 115200,57600,38400,9600 ttyS0 vt220
_chrony      630  0.0  0.0  10776  1920 ?        S    Aug31   0:00 /usr/sbin/chronyd -F 1
root         632  0.0  0.2  13296  4308 ?        Ss   Aug31   0:01 sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups
root         633  0.0  0.5 106124 11012 ?        Ssl  Aug31   0:00 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal
root        1267  0.0  0.4 288416  9976 ?        Ssl  Aug31   0:01 /usr/libexec/packagekitd
root        1271  0.0  0.2 233444  5044 ?        Ssl  Aug31   0:00 /usr/libexec/polkitd --no-debug
root      135422  0.0  0.0      0     0 ?        I&lt;   Sep02   0:00 [iprt-VBoxWQueue]
ansible   184556  0.0  0.1  15252  3884 ?        Ss   00:00   0:01 /lib/systemd/systemd --user
ansible   184557  0.0  0.1 102276  2996 ?        S    00:00   0:00 (sd-pam)
root      185769  0.0  0.2  14220  4448 ?        Ss   00:01   0:00 sshd: ansible [priv]
ansible   185776  0.0  0.2  15464  4428 ?        S    00:01   0:03 sshd: ansible@pts/1
ansible   185777  0.0  0.2   7080  4612 pts/1    Ss   00:01   0:00 -bash
root      270187  0.1  0.0      0     0 ?        I    00:20   0:02 [kworker/0:3-events]
root      334178  0.0  0.0      0     0 ?        I    00:38   0:00 [kworker/0:1-events]
root      340479  0.9  0.0      0     0 ?        S&lt;   00:39   0:12 [loop0]
root      340481  0.0  0.0      0     0 ?        I&lt;   00:39   0:00 [kdmflush]
root      340499  0.1  0.0      0     0 ?        S    00:39   0:02 [jbd2/dm-0-8]
root      340500  0.0  0.0      0     0 ?        I&lt;   00:39   0:00 [ext4-rsv-conver]
root      383805  0.0  0.0      0     0 ?        I    00:45   0:00 [kworker/u2:0-flush-254:0]
root      385028  0.0  0.0      0     0 ?        I    00:52   0:00 [kworker/u2:1-events_unbound]
ansible   385050  0.0  0.1   8592  3188 pts/1    R+   01:00   0:00 ps aux
</code></pre>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/bee'><span itemprop='name'>bee</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-03T01:08:44Z' class='post-time'>
                September 3, 2022,  1:08am
              </time>
              <meta itemprop='dateModified' content='2022-09-03T01:08:44Z'>
          <span itemprop='position'>#50</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="41" data-topic="14468">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Are logs posted automatically anywhere yet?</p>
</blockquote>
</aside>
<p>They are always posted as the artifacts of the build, so on my fork <code>Mycobee/derivative-maker</code> you can go to the actions folder and see the logs for each run.</p>
<p>Also, here is <code>sudo ps aux</code> per request</p>
<pre><code class="lang-auto">$ sudo ps aux
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root           1  0.0  0.2  99556  5560 ?        Ss   Aug31   0:12 /sbin/init
root           2  0.0  0.0      0     0 ?        S    Aug31   0:00 [kthreadd]
root           3  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [rcu_gp]
root           4  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [rcu_par_gp]
root           6  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [kworker/0:0H-events_highpri]
root           8  0.0  0.0      0     0 ?        I&lt;   Aug31   0:13 [kworker/0:1H-events_highpri]
root           9  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [mm_percpu_wq]
root          10  0.0  0.0      0     0 ?        S    Aug31   0:00 [rcu_tasks_rude_]
root          11  0.0  0.0      0     0 ?        S    Aug31   0:00 [rcu_tasks_trace]
root          12  0.0  0.0      0     0 ?        S    Aug31   0:11 [ksoftirqd/0]
root          13  0.0  0.0      0     0 ?        I    Aug31   0:16 [rcu_sched]
root          14  0.0  0.0      0     0 ?        S    Aug31   0:01 [migration/0]
root          16  0.0  0.0      0     0 ?        S    Aug31   0:00 [cpuhp/0]
root          18  0.0  0.0      0     0 ?        S    Aug31   0:00 [kdevtmpfs]
root          19  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [netns]
root          20  0.0  0.0      0     0 ?        S    Aug31   0:00 [kauditd]
root          21  0.0  0.0      0     0 ?        S    Aug31   0:00 [khungtaskd]
root          22  0.0  0.0      0     0 ?        S    Aug31   0:00 [oom_reaper]
root          23  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [writeback]
root          24  0.0  0.0      0     0 ?        S    Aug31   0:09 [kcompactd0]
root          25  0.0  0.0      0     0 ?        SN   Aug31   0:00 [ksmd]
root          26  0.0  0.0      0     0 ?        SN   Aug31   0:00 [khugepaged]
root          44  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [kintegrityd]
root          45  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [kblockd]
root          46  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [blkcg_punt_bio]
root          47  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [edac-poller]
root          48  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [devfreq_wq]
root          50  0.0  0.0      0     0 ?        S    Aug31   0:06 [kswapd0]
root          51  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [kthrotld]
root          52  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [acpi_thermal_pm]
root          53  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [ipv6_addrconf]
root          63  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [kstrp]
root          66  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [zswap-shrink]
root          67  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [kworker/u3:0]
root         109  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [ata_sff]
root         110  0.0  0.0      0     0 ?        S    Aug31   0:00 [scsi_eh_0]
root         111  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [scsi_tmf_0]
root         112  0.0  0.0      0     0 ?        S    Aug31   0:00 [scsi_eh_1]
root         113  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [scsi_tmf_1]
root         115  0.0  0.0      0     0 ?        S    Aug31   0:00 [scsi_eh_2]
root         117  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [scsi_tmf_2]
root         182  0.0  0.0      0     0 ?        S    Aug31   0:13 [jbd2/vda1-8]
root         183  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [ext4-rsv-conver]
root         231  0.0  1.5 134824 30736 ?        Ss   Aug31   0:06 /lib/systemd/systemd-journald
root         294  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [cryptd]
root         326  0.0  0.0      0     0 ?        I&lt;   Aug31   0:00 [ttm_swap]
root         360  0.0  0.2   8120  4880 ?        Ss   Aug31   0:07 /usr/sbin/haveged --Foreground --verbose=1
root         573  0.0  0.1  21336  3068 ?        Ss   Aug31   0:00 /lib/systemd/systemd-udevd
apt-cac+     601  0.0  0.3 459892  7900 ?        Ssl  Aug31   0:02 /usr/sbin/apt-cacher-ng -c /etc/apt-cacher-ng ForeGround=1
root         604  0.0  0.0   5576  1768 ?        Ss   Aug31   0:00 /usr/sbin/cron -f
message+     605  0.0  0.0   7984  1960 ?        Ss   Aug31   0:01 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
root         606  0.0  0.6 1225244 12580 ?       Ssl  Aug31   0:00 /opt/digitalocean/bin/droplet-agent
root         608  0.0  0.1 220740  2448 ?        Ssl  Aug31   0:01 /usr/sbin/rsyslogd -n -iNONE
root         615  0.0  0.1  13680  3064 ?        Ss   Aug31   0:01 /lib/systemd/systemd-logind
_chrony      627  0.0  0.1  18968  2276 ?        S    Aug31   0:00 /usr/sbin/chronyd -F 1
root         628  0.0  0.0   2812  1152 tty1     Ss+  Aug31   0:00 /sbin/agetty -o -p -- \u --noclear tty1 linux
root         629  0.0  0.0   4336  1400 ttyS0    Ss+  Aug31   0:00 /sbin/agetty -o -p -- \u --keep-baud 115200,57600,38400,9600 ttyS0 vt220
_chrony      630  0.0  0.0  10776  1920 ?        S    Aug31   0:00 /usr/sbin/chronyd -F 1
root         632  0.0  0.2  13296  4308 ?        Ss   Aug31   0:01 sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups
root         633  0.0  0.5 106124 11012 ?        Ssl  Aug31   0:00 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal
root        1267  0.0  0.4 288416  9976 ?        Ssl  Aug31   0:01 /usr/libexec/packagekitd
root        1271  0.0  0.2 233444  5044 ?        Ssl  Aug31   0:00 /usr/libexec/polkitd --no-debug
root      135422  0.0  0.0      0     0 ?        I&lt;   Sep02   0:00 [iprt-VBoxWQueue]
ansible   184556  0.0  0.1  15252  3884 ?        Ss   00:00   0:01 /lib/systemd/systemd --user
ansible   184557  0.0  0.1 102276  2996 ?        S    00:00   0:00 (sd-pam)
root      185769  0.0  0.2  14220  4448 ?        Ss   00:01   0:00 sshd: ansible [priv]
ansible   185776  0.0  0.2  15464  4428 ?        S    00:01   0:03 sshd: ansible@pts/1
ansible   185777  0.0  0.2   7080  4636 pts/1    Ss   00:01   0:00 -bash
root      270187  0.1  0.0      0     0 ?        I    00:20   0:03 [kworker/0:3-events]
root      334178  0.0  0.0      0     0 ?        I    00:38   0:00 [kworker/0:1-events]
root      340479  0.7  0.0      0     0 ?        S&lt;   00:39   0:12 [loop0]
root      340481  0.0  0.0      0     0 ?        I&lt;   00:39   0:00 [kdmflush]
root      340499  0.1  0.0      0     0 ?        S    00:39   0:02 [jbd2/dm-0-8]
root      340500  0.0  0.0      0     0 ?        I&lt;   00:39   0:00 [ext4-rsv-conver]
root      383805  0.0  0.0      0     0 ?        I    00:45   0:00 [kworker/u2:0-flush-254:0]
root      385028  0.0  0.0      0     0 ?        I    00:52   0:00 [kworker/u2:1-events_unbound]
root      385055  0.0  0.0      0     0 ?        I    01:05   0:00 [kworker/u2:2-flush-254:0]
root      385058  0.0  0.0      0     0 ?        I    01:06   0:00 [kworker/u2:3]
root      385059  0.0  0.2   9280  4756 pts/1    S+   01:06   0:00 sudo ps aux
</code></pre>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/bee'><span itemprop='name'>bee</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-03T01:10:16Z' class='post-time'>
                September 3, 2022,  1:10am
              </time>
              <meta itemprop='dateModified' content='2022-09-03T01:10:16Z'>
          <span itemprop='position'>#51</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>This issue with <code>umount</code> was occuring later in the build process, a few tags ago</p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/bee'><span itemprop='name'>bee</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-03T01:18:54Z' class='post-time'>
                September 3, 2022,  1:18am
              </time>
              <meta itemprop='dateModified' content='2022-09-03T01:18:54Z'>
          <span itemprop='position'>#52</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>More things</p>
<p>The below command returns nothing</p>
<pre><code class="lang-auto">$ sudo lsof /home/ansible/derivative-binary/Whonix-Gateway-XFCE_image/
</code></pre>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/bee'><span itemprop='name'>bee</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-03T01:24:29Z' class='post-time'>
                September 3, 2022,  1:24am
              </time>
              <meta itemprop='dateModified' content='2022-09-03T01:24:29Z'>
          <span itemprop='position'>#53</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I think I may have narrowed down the culprit. Some sort of loopback device backing file is created on the VPS, perhaps by Digital Ocean.</p>
<pre><code class="lang-auto">$ sudo losetup -a
/dev/loop0: [65025]:1312791 (/home/ansible/derivative-binary/85e3ae26a1fa287badd3957b88fa03bbe1b7205a/Whonix-Gateway-XFCE-85e3ae26a1fa287badd3957b88fa03bbe1b7205a.Intel_AMD64.raw)
</code></pre>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-03T21:14:57Z' class='post-time'>
                September 3, 2022,  9:14pm
              </time>
              <meta itemprop='dateModified' content='2022-09-03T21:14:57Z'>
          <span itemprop='position'>#54</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="bee" data-post="49" data-topic="14468">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/bee/40/2338_2.png" class="avatar"> bee:</div>
<blockquote>
<p><code>/home/ansible/derivative-binary/Whonix-Gateway-XFCE_image</code></p>
</blockquote>
</aside>
<p>Can you unmount /home/ansible/derivative-binary/Whonix-Gateway-XFCE_image somehow?</p>
<aside class="quote no-group" data-username="bee" data-post="49" data-topic="14468">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/bee/40/2338_2.png" class="avatar"> bee:</div>
<blockquote>
<h4>Processes running:</h4>
<pre><code class="lang-auto">$ ps aux
</code></pre>
</blockquote>
</aside>
<p>Thatâ€™s quite a lot. I donâ€™t know all of them.</p>
<p>Which distribution was used? Possible to start with Debian minimal as a build system?</p>
<p>Thatâ€™s just to lower the amount of daemons that might do something inside the newly mounted folder which then prevents unmounting it.</p>
<aside class="quote no-group" data-username="bee" data-post="53" data-topic="14468">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/bee/40/2338_2.png" class="avatar"> bee:</div>
<blockquote>
<pre><code class="lang-auto">$ sudo losetup -a
/dev/loop0: [65025]:1312791 (/home/ansible/derivative-binary/85e3ae26a1fa287badd3957b88fa03bbe1b7205a/Whonix-Gateway-XFCE-85e3ae26a1fa287badd3957b88fa03bbe1b7205a.Intel_AMD64.raw)
</code></pre>
</blockquote>
</aside>
<p>That is supposed to be unmounted during <code>help-steps/unmount-raw</code>. The command unmounting it should look similar toâ€¦</p>
<pre><code>sudo kpartx -d -s -v "/home/ansible/derivative-binary/85e3ae26a1fa287badd3957b88fa03bbe1b7205a/Whonix-Gateway-XFCE-85e3ae26a1fa287badd3957b88fa03bbe1b7205a.Intel_AMD64.raw" ; echo $?
</code></pre>
<p>But above command wonâ€™t work without a prior unmount:</p>
<pre><code>sudo umount /home/ansible/derivative-binary/Whonix-Gateway-XFCE_image
</code></pre>
<p>Which is broken.</p>
<p>So the proper order which is already implemented by the build script is:</p>
<ol>
<li>kpartx loop</li>
<li>mount</li>
<li>umount</li>
<li>kpartx unloop</li>
</ol>
<aside class="quote no-group" data-username="bee" data-post="53" data-topic="14468" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/bee/40/2338_2.png" class="avatar"> bee:</div>
<blockquote>
<p>I think I may have narrowed down the culprit. Some sort of loopback device backing file is created on the VPS, perhaps by Digital Ocean.</p>
<pre><code class="lang-auto">$ sudo losetup -a
/dev/loop0: [65025]:1312791 (/home/ansible/derivative-binary/85e3ae26a1fa287badd3957b88fa03bbe1b7205a/Whonix-Gateway-XFCE-85e3ae26a1fa287badd3957b88fa03bbe1b7205a.Intel_AMD64.raw)
</code></pre>
</blockquote>
</aside>
<p>So I think the loop device is created by the build script. Unfortunately it seems unavoidable to create a loop device for the purpose of building a raw image which contains a bootable operating system.</p>
<p>Iâ€™ll create a build locally now and check if there are any stray / leftover loop devices. But I guess not.</p>
<p>Investigating the latest build log, it seems that build step <code>1300_create-raw-image</code> is already failing.</p>
<ul>
<li><code>build-steps.d/1300_create-raw-image</code></li>
</ul>
<aside class="quote no-group" data-username="bee" data-post="49" data-topic="14468">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/bee/40/2338_2.png" class="avatar"> bee:</div>
<blockquote>
<p>logs</p>
</blockquote>
</aside>
<p>Broken link. But I just found it under actions.</p>
<p><a href="../../../external.html?link=https://github.com/Mycobee/derivative-maker/actions">https://github.com/Mycobee/derivative-maker/actions</a></p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-03T21:15:38Z' class='post-time'>
                September 3, 2022,  9:15pm
              </time>
              <meta itemprop='dateModified' content='2022-09-03T21:15:38Z'>
          <span itemprop='position'>#55</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>A server reboot might be required to get rid of the stray loop device. Maybe itâ€™s from a previous bugged state of the build script and now fixed.</p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-03T21:18:00Z' class='post-time'>
                September 3, 2022,  9:18pm
              </time>
              <meta itemprop='dateModified' content='2022-09-03T21:18:00Z'>
          <span itemprop='position'>#56</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>The build script by the way isnâ€™t a big monolithic blob that always takes ages until some issue happens. To ease debugging, itâ€™s step based. Each step can be more or less independently from other steps.</p>
<p>(Of course some steps depend on others. For example 1300_create-raw-image cannot be done before 1700_install-packages.)</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://www.whonix.org/wiki/Dev/Source_Code_Intro">
  <header class="source">
      <img src="../../../external.html?link=https://www.whonix.org/w/images/a/a4/Whonix-home-favicon.ico" class="site-icon" width="32" height="32">

      <a href="../../../external.html?link=https://www.whonix.org/wiki/Dev/Source_Code_Intro" target="_blank" rel="noopener" title="12:27AM - 21 July 2022">Whonix â€“ 21 Jul 22</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:598/500;"><img src="../../../external.html?link=https://www.whonix.org/w/images/f/fa/Accept-47587640.png" class="thumbnail" width="598" height="500"></div>

<h3><a href="../../../external.html?link=https://www.whonix.org/wiki/Dev/Source_Code_Intro" target="_blank" rel="noopener">Whonix â„¢ Source Code Introduction</a></h3>

  <p>Introduction into Whonix â„¢ source code.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Would it help if Iâ€™d provide some easier test cases to reproduce this very issue faster so debugging gets faster and thereby hopefully easier?</p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-03T21:23:26Z' class='post-time'>
                September 3, 2022,  9:23pm
              </time>
              <meta itemprop='dateModified' content='2022-09-03T21:23:26Z'>
          <span itemprop='position'>#57</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>One thing is for sure: If a previous build failed, if there is already a stray loop device then a subsequent build has a high chance to fail. Iâ€™ll add a check to the build script now to test for such situations and abort early.</p>
<hr>
<p>As for build <a href="../../../external.html?link=https://github.com/Mycobee/derivative-maker/actions/runs/2982494928" class="inline-onebox">Add automated_builder ansible suite to CI Â· Mycobee/derivative-maker@85e3ae2 Â· GitHub</a> already <code>1300_create-raw-image</code> was failing. That is purely using grml-debootstrap. A standalone tool where we just pass environment variables and command line options.</p>
<p>At that point in time in the build script, we donâ€™t use any related help-steps such as mount-raw, unmount-raw, chroot-raw, unchroot-raw or umount_kill.sh. So chances are low that there is something wrong with the build scirpt logic to mount / unmount.</p>
<p>Iâ€™ll come up with instructions for a simplified test case to get to the bottom of the mount / umount soon.</p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-03T21:50:27Z' class='post-time'>
                September 3, 2022,  9:50pm
              </time>
              <meta itemprop='dateModified' content='2022-09-03T21:50:27Z'>
          <span itemprop='position'>#58</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Build script now check for stray loop devices and aborts if there are any as this would likely cause strange follow up issues.</p>
<p>So a primary development goal of mine for the build script is to avoid stray loop devices at all cost. But once they exist, the safest way to get rid of them is probably a reboot. Otherwise the build script attempting to unmount things which itself might not have created could lead to unexpected results by the user.</p>
<hr>
<p>Here are the simplified steps just to get to the <code>grml-deboostrap</code> base raw image creation step.<br>
(Skipping package creation. Therefore itâ€™s fast and probably saying a lot of time.)</p>
<pre><code class="lang-auto">args="--flavor whonix-gateway-xfce --target virtualbox --build --allow-untagged true"
./build-steps.d/1100_sanity-tests $args
./build-steps.d/1120_prepare-build-machine $args
./build-steps.d/1300_create-raw-image $args
</code></pre>
<p>This could even be run manually. No need to automate in CI (just yet). Just until we get closer to what is causing this. A build script issue (less likely since until this stage itâ€™s pretty simple build steps) or some other issue which even happens with relatively simpler tools such as grml-debootstrapâ€¦</p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-03T21:52:06Z' class='post-time'>
                September 3, 2022,  9:52pm
              </time>
              <meta itemprop='dateModified' content='2022-09-03T21:52:06Z'>
          <span itemprop='position'>#59</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="57" data-topic="14468">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>As for build <a href="../../../external.html?link=https://github.com/Mycobee/derivative-maker/actions/runs/2982494928">Add automated_builder ansible suite to CI Â· Mycobee/derivative-maker@85e3ae2 Â· GitHub</a> already <code>1300_create-raw-image</code> was failing.</p>
</blockquote>
</aside>
<p>From the build log:</p>
<pre><code class="lang-auto">+ grep -q /dev/mapper/loop0p1 /proc/mounts
+ eerror '/dev/mapper/loop0p1 already mounted, exiting to avoid possible damage. (Manually unmount /dev/mapper/loop0p1)'
</code></pre>
<p>So by the time grml-debootstrap was running, /dev/mapper/loop0p1 was already existing. So this could be a follow-up issue from a previous unclean run of the build script. In that case, this very error should be resolved after reboot.</p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/bee'><span itemprop='name'>bee</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="14468.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-04T02:41:09Z' class='post-time'>
                September 4, 2022,  2:41am
              </time>
              <meta itemprop='dateModified' content='2022-09-04T02:41:09Z'>
          <span itemprop='position'>#60</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>You are awesome <a class="mention" href="../../../external.html?link=https://forums.whonix.org/u/patrick">@Patrick</a></p>
<p>Thanks so much for the help. Just got back from a big day climbing in the mountains but will dive in to all of this when I have the energy</p>
        </div>

        <meta itemprop='headline' content='Derivative Maker Automated CI Builder'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="144684658.html?page=2">â† previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="14468fdb0.html?page=4">next page â†’</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

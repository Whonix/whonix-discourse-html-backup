<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Hardened Malloc - Hardened Memory Allocator - #113 by Patrick - Development - Whonix Forum</title>
    <meta name="description" content="Security researcher, Daniel Micay has created hardened_malloc which is a hardened memory allocator that protects against heap corruption vulnerabilities. 
It isn’t available in the Debian repos but is very easy to build &amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../7474c575.html?page=6" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Hardened Malloc - Hardened Memory Allocator&#39;" href="../7474.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/hardened-malloc-hardened-memory-allocator/7474/113" />
<meta name="twitter:url" content="https://forums.whonix.org/t/hardened-malloc-hardened-memory-allocator/7474/113" />
<meta property="og:title" content="Hardened Malloc - Hardened Memory Allocator" />
<meta name="twitter:title" content="Hardened Malloc - Hardened Memory Allocator" />
<meta property="og:description" content="glibc feature request: LD_ETC_IGNORE - environment variable to ignore /etc/ld.so.preload configuration file on a per-application basis" />
<meta name="twitter:description" content="glibc feature request: LD_ETC_IGNORE - environment variable to ignore /etc/ld.so.preload configuration file on a per-application basis" />
<meta property="article:published_time" content="2020-10-09T15:08:49+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="../7474af4d.html?page=5">
        <link rel="next" href="../7474235c.html?page=7">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../7474.html">Hardened Malloc - Hardened Memory Allocator</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-08T22:11:42Z' class='post-time'>
                October 8, 2020, 10:11pm
              </time>
              <meta itemprop='dateModified' content='2020-10-08T22:11:42Z'>
          <span itemprop='position'>#108</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>The Chromium issue appears to be a real bug in Debian’s old package. I’ve reported it here <a href="../../../../external.html?link=https://bugs.debian.org/971876" rel="nofollow noopener">https://bugs.debian.org/971876</a></p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-09T13:29:32Z' class='post-time'>
                October 9, 2020,  1:29pm
              </time>
              <meta itemprop='dateModified' content='2020-10-09T13:29:32Z'>
          <span itemprop='position'>#109</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><code>man</code> is functional when using <code>hardened-malloc-disable</code> but console output still showing errors.</p>
<pre><code>hardened-malloc-disable man nano
</code></pre>
<blockquote>
<p>ERROR: ld.so: object ‘/usr/lib/libhardened_malloc.so/libhardened_malloc_kicksecure.so’ from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.<br>
ERROR: ld.so: object ‘/usr/lib/libhardened_malloc.so/libhardened_malloc_kicksecure.so’ from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</p>
</blockquote>
<hr>
<pre><code>hardened-malloc-disable chromium
</code></pre>
<p>Still not starting. Similar error message. hardened-malloc-disable seems to not fully disable hardened malloc?</p>
<aside class="quote no-group" data-username="madaidan" data-post="108" data-topic="7474" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>The Chromium issue appears to be a real bug in Debian’s old package. I’ve reported it here <a href="../../../../external.html?link=https://bugs.debian.org/971876">https://bugs.debian.org/971876</a></p>
</blockquote>
</aside>
<p>I.e. newer versions of Chromium are functional? Then perhaps upstream Chromium already fixed it either knowingly or unknowingly (by refactoring / rewrite of the related code)?</p>
<hr>
<pre><code>sudo mandb -cq
</code></pre>
<p>(This is what happens during apt install / upgrade / dpkg mandb trigger.</p>
<blockquote>
<p>mandb: zcat: Bad system call (core dumped)<br>
tons of repetitions</p>
</blockquote>
<p>Maybe it would be fixed by the <code>man</code> wrapper. Perhaps both, <code>man</code> and <code>mandb</code> need to be wrapped with <code>hardened-malloc-disable</code>.</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-09T14:24:32Z' class='post-time'>
                October 9, 2020,  2:24pm
              </time>
              <meta itemprop='dateModified' content='2020-10-09T14:24:32Z'>
          <span itemprop='position'>#110</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="109" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p><code>man</code> is functional when using <code>hardened-malloc-disable</code> but console output still showing errors.</p>
</blockquote>
</aside>
<p>We could add <code>2&gt;/dev/null</code> but that would hide other, valid errors.</p>
<aside class="quote no-group" data-username="Patrick" data-post="109" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Still not starting. Similar error message. hardened-malloc-disable seems to not fully disable hardened malloc?</p>
</blockquote>
</aside>
<p>It’s not to do with hardened_malloc. It’s to do with the sandbox.</p>
<aside class="quote no-group" data-username="madaidan" data-post="93" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Make sure to enable unprivileged user namespaces or disable the browser sandbox though as bubblewrap sets <code>no_new_privs</code> which disables the setuid sandbox.</p>
</blockquote>
</aside>
<p>You need to enable unprivileged user namespaces or run Chromium without a sandbox (the <code>--no-sandbox</code> flag) as bubblewrap disables the setuid sandbox.</p>
<aside class="quote no-group" data-username="Patrick" data-post="109" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I.e. newer versions of Chromium are functional? Then perhaps upstream Chromium already fixed it either knowingly or unknowingly (by refactoring / rewrite of the related code)?</p>
</blockquote>
</aside>
<p>Yes, most likely. We could try Debian backports.</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-09T14:41:02Z' class='post-time'>
                October 9, 2020,  2:41pm
              </time>
              <meta itemprop='dateModified' content='2020-10-09T14:41:02Z'>
          <span itemprop='position'>#111</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="110" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>We could add <code>2&gt;/dev/null</code> but that would hide other, valid errors.</p>
</blockquote>
</aside>
<p>Yes. Much too intrusive.</p>
<aside class="quote no-group" data-username="madaidan" data-post="107" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>You could try using <code>hardened-malloc-disable</code> for <code>cryptsetup</code> ?</p>
</blockquote>
</aside>
<p>Still not solution for swap-file-creator on the horizon.</p>
<p>That fixes it but would add the <code>ERROR: ld.so: object '/usr/lib/libhardened_malloc.so/libhardened_malloc_kicksecure.so' from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</code> message to the boot process. Well, we could hide that, but then legitimate error which might happen in future (for some users) would be hidden from our view and fixing too.</p>
<p>Also cryptsetup luksFormat got slower by approximately factor 7.<br>
(5 seconds without; 35 seconds with.)<br>
Though, no errors reported with, except the performance regression.<br>
Worth reporting upstream or to be expected?</p>
<p>Wondering about other solutions…</p>
<p>To enable hardened malloc globally is there any other option than editing <code>/etc/ld.so.preload</code>?</p>
<p>Can systemd somehow ignore contents of <code>/etc/ld.so.preload</code>? Then that could fix swap-file-creator.</p>
<p>The man / mandb issue is currently breaking the package build. It somehow messes the man pages up a bit. Lintian will complain.</p>
<blockquote>
<p>genmkfile: manpage-has-bad-whatis-entry usr/share/man/man8/genmkfile.8.gz</p>
</blockquote>
<p>Didn’t try wrapping man / mandb with <code>hardened-malloc-disable</code> yet.</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-09T14:52:30Z' class='post-time'>
                October 9, 2020,  2:52pm
              </time>
              <meta itemprop='dateModified' content='2020-10-09T14:52:30Z'>
          <span itemprop='position'>#112</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="111" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Worth reporting upstream or to be expected?</p>
</blockquote>
</aside>
<p>Not sure. We’ll need to investigate what exactly in <code>cryptsetup</code> is causing this. For now, can you try rebuilding hardened_malloc but with a few more expensive security features disabled? <a href="../../../../external.html?link=https://github.com/GrapheneOS/hardened_malloc#configuration" rel="nofollow noopener">https://github.com/GrapheneOS/hardened_malloc#configuration</a></p>
<p>Try disabling <code>CONFIG_WRITE_AFTER_FREE_CHECK</code>, <code>CONFIG_SLOT_RANDOMIZE</code>, etc. and check if performance changes at all. See if you can narrow it down a bit.</p>
<p>Keep our custom config options though. Just append these ones to it.</p>
<aside class="quote no-group" data-username="Patrick" data-post="111" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>To enable hardened malloc globally is there any other option than editing <code>/etc/ld.so.preload</code> ?</p>
</blockquote>
</aside>
<p>We could build it into glibc but that would require maintaining a Whonix fork.</p>
<p>Side note: musl is developing another hardened malloc implementation inspired by hardened_malloc that will be built into it by default (although it’s not as hardened as hardened_malloc).</p>
<p><a href="../../../../external.html?link=https://www.openwall.com/lists/musl/2020/05/13/1" class="onebox" target="_blank" rel="nofollow noopener">https://www.openwall.com/lists/musl/2020/05/13/1</a></p>
<aside class="quote no-group" data-username="Patrick" data-post="111" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Can systemd somehow ignore contents of <code>/etc/ld.so.preload</code> ?</p>
</blockquote>
</aside>
<p>I don’t think so.</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-09T15:08:49Z' class='post-time'>
                October 9, 2020,  3:08pm
              </time>
              <meta itemprop='dateModified' content='2020-10-09T15:08:49Z'>
          <span itemprop='position'>#113</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>glibc feature request: <a href="../../../../external.html?link=https://sourceware.org/bugzilla/show_bug.cgi?id=26723">LD_ETC_IGNORE - environment variable to ignore /etc/ld.so.preload configuration file on a per-application basis</a></p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../eliminate-ld-preload-and-other-dangerous-environment-variables/10594/2.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../eliminate-ld-preload-and-other-dangerous-environment-variables/10594/2.html'>
                      <span itemprop='name'>Eliminate LD_PRELOAD and other Dangerous Environment Variables</span>
                    </a>
                    <meta itemprop='position' content='2'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-10T12:33:44Z' class='post-time'>
                October 10, 2020, 12:33pm
              </time>
              <meta itemprop='dateModified' content='2020-10-10T12:33:44Z'>
          <span itemprop='position'>#114</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I’ve made a summary of all open issues:<br>
<a href="../../../../external.html?link=https://www.whonix.org/wiki/Hardened_Malloc#Issues">https://www.whonix.org/wiki/Hardened_Malloc#Issues</a></p>
<aside class="quote no-group" data-username="Patrick" data-post="113" data-topic="7474" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>glibc feature request: <a href="../../../../external.html?link=https://sourceware.org/bugzilla/show_bug.cgi?id=26723">LD_ETC_IGNORE - environment variable to ignore /etc/ld.so.preload configuration file on a per-application basis</a></p>
</blockquote>
</aside>
<p>That did not go too well yet.</p>
<aside class="quote no-group" data-username="madaidan" data-post="112" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>We could build it into glibc but that would require maintaining a Whonix fork.</p>
</blockquote>
</aside>
<p>That still wouldn’t give us a way to disable hardened malloc on a per application basis without extraneous stderr error message?</p>
<p>( <code>ERROR: ld.so: object  ‘/usr/lib/libhardened_malloc.so/libhardened_malloc_kicksecure.so’ from  /etc/ld.so.preload cannot be preloaded (cannot open shared object file):  ignored.</code>)</p>
<aside class="quote no-group" data-username="madaidan" data-post="107" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>You could try using <code>hardened-malloc-disable</code> for <code>cryptsetup</code> ?</p>
</blockquote>
</aside>
<p>adding <code>hardened-malloc-disable</code> not appropriate as this would inject stderr output <code>ERROR:  ld.so: object  ‘/usr/lib/libhardened_malloc.so/libhardened_malloc_kicksecure.so’ from  /etc/ld.so.preload cannot be preloaded (cannot open shared object file):  ignored.</code> during early boot process (swap-file-creator) and not appropriate to silence stderr either as this would hide legitimate error messages too.</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-10T13:06:02Z' class='post-time'>
                October 10, 2020,  1:06pm
              </time>
              <meta itemprop='dateModified' content='2020-10-10T13:06:02Z'>
          <span itemprop='position'>#115</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Here is a new approach for disabling hardened malloc on a per-application basis without extraneous console stderr output.</p>
<p>Why hide folder <code>/usr/lib/libhardened_malloc.so</code> from application if we can hide <code>/etc/ld.so.preload</code> configuration file?</p>
<pre><code>sudo touch /etc/empty
bwrap --dev-bind / / --ro-bind /etc/empty /etc/ld.so.preload man nano
</code></pre>
<p>That would be an <code>ld-system-preload-disable</code> tool.<br>
(But not a global <code>ld-disable-tool</code> because it would not modify <code>LD_PRELOAD</code> environment variable. We could invent such a tool easily too if needed.)</p>
<p>That would be good enough?</p>
<p>It would not be an <code>hardened-malloc-disable</code> tool because other entries (unrelated user specific preloads) in <code>/etc/ld.so.preload</code> configuration file would be excluded too. A  <code>hardened-malloc-disable</code> could copy <code>/etc/ld.so.preload</code> to a (temporary?) file, use</p>
<pre><code>str_replace /usr/lib/libhardened_malloc.so/libhardened_malloc_kicksecure.so "" /path/to/other-ld.so.preload-file
</code></pre>
<p>and then use brwap to point the application to that file instead.</p>
<p>Should could added to <code>helper-scripts</code> package. (Previously my mistake directing <code>hardened-malloc-disable</code> at <code>usablity-misc</code> package.) Is an <code>hardened-malloc-disable</code> tool worth the effort or is <code>ld-system-preload-disable</code> tool sufficient?</p>
<p>Is it a security issue that users (non-root) can disable <code>/etc/ld.so.preload</code>? Is that something only root should be able to configure?</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="3" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-11T15:24:11Z' class='post-time'>
                October 11, 2020,  3:24pm
              </time>
              <meta itemprop='dateModified' content='2020-10-11T15:24:11Z'>
          <span itemprop='position'>#116</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="115" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>That would be good enough?</p>
</blockquote>
</aside>
<p>Yes, that would be great. Verified with <code>/proc/self/maps</code> that hardened_malloc is not loaded.</p>
<aside class="quote no-group" data-username="Patrick" data-post="115" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Is an <code>hardened-malloc-disable</code> tool worth the effort or is <code>ld-system-preload-disable</code> tool sufficient?</p>
</blockquote>
</aside>
<p><code>ld-system-preload-disable</code> should be sufficient for now.</p>
<aside class="quote no-group" data-username="Patrick" data-post="115" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Is it a security issue that users (non-root) can disable <code>/etc/ld.so.preload</code> ?</p>
</blockquote>
</aside>
<p>No. An attacker can only disable it for new processes that they create which there isn’t any point in. They can’t disable it for already existing processes. E.g. a malicious site can’t just disable hardened_malloc for Firefox and exploit it.</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-11T15:27:20Z' class='post-time'>
                October 11, 2020,  3:27pm
              </time>
              <meta itemprop='dateModified' content='2020-10-11T15:27:20Z'>
          <span itemprop='position'>#117</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="115" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<pre><code class="lang-auto">sudo touch /etc/empty
bwrap --dev-bind / / --ro-bind /etc/empty /etc/ld.so.preload man nano
</code></pre>
</blockquote>
</aside>
<p>Is there any reason to create a new file instead of:</p>
<pre><code class="lang-auto">bwrap --dev-bind / / --ro-bind /dev/null /etc/ld.so.preload man nano
</code></pre>
<p>?</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-11T16:05:40Z' class='post-time'>
                October 11, 2020,  4:05pm
              </time>
              <meta itemprop='dateModified' content='2020-10-11T16:05:40Z'>
          <span itemprop='position'>#118</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="110" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>We could try Debian backports.</p>
</blockquote>
</aside>
<p>I tried Chromium from Debian backports and still got the same error so the error could be from Debian’s patches or the backport isn’t a recent enough version.</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://salsa.debian.org/uploads/-/system/appearance/favicon/1/gitlabian_32.png" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://salsa.debian.org/chromium-team/chromium/-/tree/master/debian/patches" target="_blank" rel="nofollow noopener">GitLab</a>
  </header>
  <article class="onebox-body">
    <img src="../../../../external.html?link=https://salsa.debian.org/assets/gitlab_logo-7ae504fe4f68fdebb3c2034e36621930cd36ea87924c11ff65dbcb8ed50dca58.png" class="thumbnail onebox-avatar" width="128" height="128">

<h3><a href="../../../../external.html?link=https://salsa.debian.org/chromium-team/chromium/-/tree/master/debian/patches" target="_blank" rel="nofollow noopener">debian/patches · master · chromium / chromium</a></h3>

<p>Chromium packaging</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>I’ll look over the patches and see if I can find anything. Looking at these has also made me realize just how terrible the Debian Chromium package is (they disable important mitigations like CFI, automatic variable initialization, etc.)</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-11T16:10:29Z' class='post-time'>
                October 11, 2020,  4:10pm
              </time>
              <meta itemprop='dateModified' content='2020-10-11T16:10:29Z'>
          <span itemprop='position'>#119</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I just tried the same version of Chromium as in the Debian repos but on a different distro (Arch) and the error wasn’t there. It’s most likely Debian’s patches.</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-11T16:20:26Z' class='post-time'>
                October 11, 2020,  4:20pm
              </time>
              <meta itemprop='dateModified' content='2020-10-11T16:20:26Z'>
          <span itemprop='position'>#120</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>madaidan via Whonix Forum:</p>
<blockquote>
<aside class="quote no-group" data-username="Patrick" data-post="115" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<pre><code class="lang-auto">sudo touch /etc/empty
bwrap --dev-bind / / --ro-bind /etc/empty /etc/ld.so.preload man nano
</code></pre>
</blockquote>
</aside>
<p>Is there any reason to create a new file instead of:</p>
<pre><code class="lang-auto">bwrap --dev-bind / / --ro-bind /dev/null /etc/ld.so.preload man nano
</code></pre>
<p>?</p>
</blockquote>
<p>While not tested by me yet, using /dev/null seems much better.</p>
<p>Will add the new wrapper soon and remove the old one (wrong package, my<br>
mistake, and probably no need to reintroduce).</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-11T16:38:10Z' class='post-time'>
                October 11, 2020,  4:38pm
              </time>
              <meta itemprop='dateModified' content='2020-10-11T16:38:10Z'>
          <span itemprop='position'>#121</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Implemented that.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/helper-scripts/commit/d13cd5aeedfc09f5a811b05c95ef059065091380" target="_blank">github.com/Whonix/helper-scripts</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/helper-scripts/commit/d13cd5aeedfc09f5a811b05c95ef059065091380" target="_blank">add ld-system-preload-disable</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-10-11" data-time="16:31:04" data-timezone="UTC">04:31PM - 11 Oct 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 3 files with 41 additions and 1 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/helper-scripts/commit/d13cd5aeedfc09f5a811b05c95ef059065091380" target="_blank">
          <span class="added">+41</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">https://forums.whonix.org/t/hardened-malloc-hardened-memory-allocator/7474/116
Thanks to @madaidan for the suggestion!</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>There is one issue.</p>
<p>This fails if file /etc/ld.so.preload does not exists.</p>
<blockquote>
<p>bwrap: Can’t create file at /etc/ld.so.preload: Permission denied</p>
</blockquote>
<p>Can this be fixed at <code>bwrap</code> level? Or must I make sure at packaging level that file <code>/etc/ld.so.preload</code> always exists?<br>
(That is for systems with hardened-malloc-kicksecure-enable not installed.)</p>
<hr>
<p>Could you please report your chromium related findings to Debian? I guess replying again to<br>
<a href="../../../../external.html?link=https://bugs.debian.org/971876">https://bugs.debian.org/971876</a> for the hardened malloc issue? (i.e. Debian patches are probably responsible for introducing the issue.)</p>
<p>And a separate ticket about CFI etc.?</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-11T16:41:11Z' class='post-time'>
                October 11, 2020,  4:41pm
              </time>
              <meta itemprop='dateModified' content='2020-10-11T16:41:11Z'>
          <span itemprop='position'>#122</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="121" data-topic="7474">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Can this be fixed at <code>bwrap</code> level?</p>
</blockquote>
</aside>
<p>Not really unless it’s run as root.</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-11-13T14:26:16Z' class='post-time'>
                November 13, 2020,  2:26pm
              </time>
              <meta itemprop='dateModified' content='2020-11-13T14:26:16Z'>
          <span itemprop='position'>#123</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://github.githubassets.com/favicons/favicon.svg" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://github.com/GrapheneOS/hardened_malloc/releases/tag/4" target="_blank">GitHub</a>
  </header>
  <article class="onebox-body">
    <img src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/48847184?s=400&amp;v=4" class="thumbnail onebox-avatar" width="400" height="400">

<h3><a href="../../../../external.html?link=https://github.com/GrapheneOS/hardened_malloc/releases/tag/4" target="_blank">Release 4 · GrapheneOS/hardened_malloc</a></h3>

<p>Full list of changes from the previous release (version 3).

See the README for this release for an overview of the project and many details about the design goals and implementation.
These integer...</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Uploaded to developers and testers repository just now.</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-11-13T14:34:46Z' class='post-time'>
                November 13, 2020,  2:34pm
              </time>
              <meta itemprop='dateModified' content='2020-11-13T14:34:46Z'>
          <span itemprop='position'>#124</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/swap-file-creator/commit/c65edf17f952ac4a296ae6a0aac5a10541579ff6" target="_blank">github.com/Whonix/swap-file-creator</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/swap-file-creator/commit/c65edf17f952ac4a296ae6a0aac5a10541579ff6" target="_blank">use cryptsetup_pre_wrapper ld-system-preload-disable</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-11-13" data-time="14:33:23" data-timezone="UTC">02:33PM - 13 Nov 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 5 files with 12 additions and 5 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/swap-file-creator/commit/c65edf17f952ac4a296ae6a0aac5a10541579ff6" target="_blank">
          <span class="added">+12</span>
          <span class="removed">-5</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">to work around issue with hardened malloc slowing down cryptsetup
https://forums.whonix.org/t/hardened-malloc-hardened-memory-allocator/7474/106</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-11-14T19:25:54Z' class='post-time'>
                November 14, 2020,  7:25pm
              </time>
              <meta itemprop='dateModified' content='2020-11-14T19:31:25Z'>
          <span itemprop='position'>#125</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Daniel has told me that this release may fix some of the issues we’ve been facing. Will test.</p>
<p>Edit: Doesn’t seem to fix anything.</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-13T17:24:24Z' class='post-time'>
                December 13, 2020,  5:24pm
              </time>
              <meta itemprop='dateModified' content='2020-12-13T17:24:24Z'>
          <span itemprop='position'>#126</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I have discovered a way to disable the <code>man</code> seccomp filter. You can set the <code>MAN_DISABLE_SECCOMP=1</code> environment variable.</p>
<p><a href="../../../../external.html?link=https://git.savannah.nongnu.org/cgit/man-db.git/tree/lib/sandbox.c#n142" rel="noopener nofollow ugc">https://git.savannah.nongnu.org/cgit/man-db.git/tree/lib/sandbox.c#n142</a></p>
<p>The hardened-malloc package can simply create <code>/etc/X11/Xsession.d/50hardened-malloc</code> with contents:</p>
<pre><code class="lang-auto">#!/bin/sh

## Copyright (C) 2012 - 2020 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions.

export MAN_DISABLE_SECCOMP=1
</code></pre>
<p>I doubt there will be any practical security disadvantages with this. Man pages aren’t exactly untrusted input and a seccomp filter is not a complete sandbox by itself anyway (e.g. it’s not like it can provide proper filesystem restrictions).</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7474.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-12-15T10:34:48Z' class='post-time'>
                December 15, 2020, 10:34am
              </time>
              <meta itemprop='dateModified' content='2020-12-15T10:34:48Z'>
          <span itemprop='position'>#127</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Awesome!</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/hardened_malloc/commit/98b00ee79094a3b4213797e3d49ba26de36b4b5b" target="_blank" rel="noopener">github.com/Whonix/hardened_malloc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/hardened_malloc/commit/98b00ee79094a3b4213797e3d49ba26de36b4b5b" target="_blank" rel="noopener">hardened-malloc-kicksecure: add `export MAN_DISABLE_SECCOMP=1`</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2020-12-15" data-time="09:38:18" data-timezone="UTC">09:38AM - 15 Dec 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 7 additions and 0 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/hardened_malloc/commit/98b00ee79094a3b4213797e3d49ba26de36b4b5b" target="_blank" rel="noopener">
          <span class="added">+7</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">/etc/X11/Xsession.d/50hardened-malloc
Thanks to @madaidan for the problem solution!
https://forums.whonix.org/t/hardened-malloc-hardened-memory-allocator/7474/125</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox githubblob">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/hardened_malloc/blob/master/debian/50hardened-malloc" target="_blank" rel="noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="../../../../external.html?link=https://github.com/Whonix/hardened_malloc/blob/master/debian/50hardened-malloc" target="_blank" rel="noopener">Whonix/hardened_malloc/blob/master/debian/50hardened-malloc</a></h4>
<pre><code class="lang-">#!/bin/sh

## Copyright (C) 2020 - 2020 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions.

## https://savannah.nongnu.org/bugs/index.php?56767
## https://forums.whonix.org/t/hardened-malloc-hardened-memory-allocator/7474/105
## https://forums.whonix.org/t/hardened-malloc-hardened-memory-allocator/7474/109
## https://git.savannah.nongnu.org/cgit/man-db.git/tree/lib/sandbox.c#n142
## TODO: Debian bullseye
## Fixed in `man` upstream. Fix will probably arrive and can be removed in
## Debian bullseye and above.

if [ "$MAN_DISABLE_SECCOMP" = "" ]; then
   export MAN_DISABLE_SECCOMP=1
fi
</code></pre>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Much better solution than config-package-dev wrappers. Btw…</p>
<p>Fixed in <code>man</code> upstream. Fix will probably arrive and can be removed in Debian <code>bullseye</code> and above.</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://savannah.nongnu.org/images/Savannah.theme/icon.png" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://savannah.nongnu.org/bugs/index.php?56767" target="_blank" rel="noopener">savannah.nongnu.org</a>
  </header>
  <article class="onebox-body">
    <img src="#" class="thumbnail" width="20" height="20">

<h3><a href="../../../../external.html?link=https://savannah.nongnu.org/bugs/index.php?56767" target="_blank" rel="noopener">Database-driven manual pager suite - Bugs: bug #56767, add `getrandom` to...</a></h3>



  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Not yet tested…</p>
<hr>
<p>All untested… Another major issue. Breaks <code>sshd</code>.</p>
<aside class="onebox githubissue">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/GrapheneOS/hardened_malloc/issues/97" target="_blank" rel="noopener">github.com/GrapheneOS/hardened_malloc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue">
	  <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/GrapheneOS/hardened_malloc/issues/97" target="_blank" rel="noopener">seccomp-bpf filter violation in sshd</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2019-08-22" data-time="17:12:10" data-timezone="UTC">05:12PM - 22 Aug 19 UTC</span>
      </div>

        <div class="date">
          closed <span class="discourse-local-date" data-format="ll" data-date="2019-10-09" data-time="23:25:19" data-timezone="UTC">11:25PM - 09 Oct 19 UTC</span>
        </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/mike2307" target="_blank" rel="noopener">
          <img alt="mike2307" src="../../../../external.html?link=https://avatars2.githubusercontent.com/u/29705161?v=4" class="onebox-avatar-inline" width="20" height="20">
          mike2307
        </a>
      </div>
    </div>
  </div>
</div>

<div class="github-row">
  <p class="github-content">After enabling the preload of the libhardened_malloc.so, I'm not able to login any more via SSH. This is the case for...</p>
</div>

<div class="labels">
    <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">upstream</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Also fixed upstream in <code>sshd</code>, but Debian <code>buster</code> version still has this issue. Killing <code>sshd</code> on servers is a very high impact issue. Also probably fixed in Debian <code>bullseye</code>. This speaks against installation by default before Debian <code>bullseye</code>. Got any workaround for that?</p>
        </div>

        <meta itemprop='headline' content='Hardened Malloc - Hardened Memory Allocator'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="../7474af4d.html?page=5">← previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="../7474235c.html?page=7">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Apply systemd sandboxing by default to some services - Development - Whonix Forum</title>
    <meta name="description" content="Systemd has a few features that allow you to sandbox systemd services to prevent the damage that a compromised service could do. 
It would be good to apply some sandboxing by default to some services. A lot of settings l&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="75904658.html?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Apply systemd sandboxing by default to some services&#39;" href="7590.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/apply-systemd-sandboxing-by-default-to-some-services/7590?page=2" />
<meta name="twitter:url" content="https://forums.whonix.org/t/apply-systemd-sandboxing-by-default-to-some-services/7590?page=2" />
<meta property="og:title" content="Apply systemd sandboxing by default to some services" />
<meta name="twitter:title" content="Apply systemd sandboxing by default to some services" />
<meta property="og:description" content="No, PrivateHome=true and PrivateTmp=true both work fine. Everything else doesn’t. Even things that are very unlikely to break things.  I found the issue. The way the service is configured seemed to be hiding the actual  error message which was  sudo: effective uid is not 0  So I added user=root and now it works. All the sandboxing seems fine except the syscall filter which I’ll work on now." />
<meta name="twitter:description" content="No, PrivateHome=true and PrivateTmp=true both work fine. Everything else doesn’t. Even things that are very unlikely to break things.  I found the issue. The way the service is configured seemed to be hiding the actual  error message which was  sudo: effective uid is not 0  So I added user=root and now it works. All the sandboxing seems fine except the syscall filter which I’ll work on now." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="11 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="82 ❤" />
<meta property="article:published_time" content="2019-06-26T14:13:26+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="7590.html">
        <link rel="next" href="75909ba9.html?page=3">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="7590.html">Apply systemd sandboxing by default to some services</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-06-26T14:13:26Z' class='post-time'>
                June 26, 2019,  2:13pm
              </time>
              <meta itemprop='dateModified' content='2019-06-26T14:13:26Z'>
          <span itemprop='position'>#21</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="20" data-topic="7590">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>It’s maybe because folder ~/ is open when typing in terminal.</p>
</blockquote>
</aside>
<p>No, <code>PrivateHome=true</code> and <code>PrivateTmp=true</code> both work fine. Everything else doesn’t. Even things that are very unlikely to break things.</p>
<p>I found the issue. The way the service is configured seemed to be hiding the actual  error message which was</p>
<pre><code>sudo: effective uid is not 0
</code></pre>
<p>So I added <code>user=root</code> and now it works. All the sandboxing seems fine except the syscall filter which I’ll work on now.</p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-06-26T16:37:04Z' class='post-time'>
                June 26, 2019,  4:37pm
              </time>
              <meta itemprop='dateModified' content='2019-06-26T16:37:04Z'>
          <span itemprop='position'>#22</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><a href="../../../external.html?link=https://github.com/madaidan/whonixcheck/blob/patch-2/lib/systemd/system/whonixcheck.service" rel="nofollow noopener">This</a> should work fine. The system call filter breaks the control port test so that’s commented out. Can anyone else test this? It works fine on my machine.</p>
<p>To test it, edit the service to run whonixcheck directly as root.</p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-06-27T07:35:00Z' class='post-time'>
                June 27, 2019,  7:35am
              </time>
              <meta itemprop='dateModified' content='2019-06-27T07:35:00Z'>
          <span itemprop='position'>#23</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>madaidan via Whonix Forum:</p>
<blockquote>
<p>So I added <code>user=root</code> and now it works.</p>
</blockquote>
<p>whonixcheck should not run as <code>root</code>. It is supposed to always run under<br>
user <code>whonixcheck</code> (<code>/usr/bin/whonixcheck</code> does that) and to run <code>sudo</code><br>
by having <code>/etc/sudoers.d/whonixcheck</code> exceptions.</p>
<p>Running as root fortifies advice given<br>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../external.html?link=https://www.whonix.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="../../../external.html?link=https://www.whonix.org/wiki/Operating_System_Software_and_Updates#GUI_Applications_with_Root_Rights" target="_blank" rel="nofollow noopener">Whonix</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:640/452;"><img src="../../../external.html?link=https://www.whonix.org/w/images/3/34/Operatingsystemupdated234234.jpg" class="thumbnail"></div>

<h3><a href="../../../external.html?link=https://www.whonix.org/wiki/Operating_System_Software_and_Updates#GUI_Applications_with_Root_Rights" target="_blank" rel="nofollow noopener">Operating System Software and Updates</a></h3>

<p>Operating System Software and Updates</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-06-27T15:53:12Z' class='post-time'>
                June 27, 2019,  3:53pm
              </time>
              <meta itemprop='dateModified' content='2019-06-27T15:53:12Z'>
          <span itemprop='position'>#24</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="23" data-topic="7590">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>whonixcheck should not run as <code>root</code> . It is supposed to always run under user <code>whonixcheck</code> ( <code>/usr/bin/whonixcheck</code> does that) and to run <code>sudo</code> by having <code>/etc/sudoers.d/whonixcheck</code> exceptions.</p>
</blockquote>
</aside>
<p>Yes, I know. Running it as root is only for testing as running it directly with a systemd service as a user fails.</p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-06-27T16:23:26Z' class='post-time'>
                June 27, 2019,  4:23pm
              </time>
              <meta itemprop='dateModified' content='2019-06-27T16:23:26Z'>
          <span itemprop='position'>#25</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../external.html?link=https://security.stackexchange.com/questions/212557/is-it-possible-to-use-systemd-seccomp-filtering-for-running-applications-from-co" target="_blank" rel="nofollow noopener">security.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../external.html?link=https://security.stackexchange.com/users/54240/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../external.html?link=https://www.gravatar.com/avatar/83f6805262f0dcc117814487c5b2d1c4?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="../../../external.html?link=https://security.stackexchange.com/questions/212557/is-it-possible-to-use-systemd-seccomp-filtering-for-running-applications-from-co" target="_blank" rel="nofollow noopener">Is it possible to use systemd seccomp filtering for running applications from command line?</a>
</h4>

<div class="tags">
  <strong>seccomp, systemd</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../external.html?link=https://security.stackexchange.com/users/54240/adrelanos" target="_blank" rel="nofollow noopener">
    adrelanos
  </a>
  on <a href="../../../external.html?link=https://security.stackexchange.com/questions/212557/is-it-possible-to-use-systemd-seccomp-filtering-for-running-applications-from-co" target="_blank" rel="nofollow noopener">04:23PM - 27 Jun 19 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../virtualbox-cant-boot-new-whonix-vms-but-old-ones-boot-fine/9531/5.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../virtualbox-cant-boot-new-whonix-vms-but-old-ones-boot-fine/9531/5.html'>
                      <span itemprop='name'>Virtualbox can&#39;t boot new Whonix VMs (but old ones boot fine)</span>
                    </a>
                    <meta itemprop='position' content='3'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-06-28T21:54:46Z' class='post-time'>
                June 28, 2019,  9:54pm
              </time>
              <meta itemprop='dateModified' content='2019-06-28T21:54:46Z'>
          <span itemprop='position'>#26</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I guess you could probably create a systemd service to start that application then create a wrapper that runs <code>systemctl start (application)</code> that would then execute the program in a systemd sandbox. At this point though, it’d probably be better to use an alternative sandboxing method designed for applications like this.</p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-01T08:15:43Z' class='post-time'>
                July 1, 2019,  8:15am
              </time>
              <meta itemprop='dateModified' content='2019-07-01T08:15:43Z'>
          <span itemprop='position'>#27</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>
<p>Jul 01 08:11:15 host systemd[1]: /lib/systemd/system/whonixcheck.service:36: Failed to parse system call, ignoring: getresgud</p>
</blockquote>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/whonixcheck/commit/d8804493701e03f77398586582912c8a5608f745" target="_blank" rel="nofollow noopener">github.com/Whonix/whonixcheck</a>
  </header>
  <article class="onebox-body">
      <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../external.html?link=https://github.com/Whonix/whonixcheck/commit/d8804493701e03f77398586582912c8a5608f745" target="_blank" rel="nofollow noopener">fix system call name</a>
</h4>


<div class="date">
  by <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="../../../external.html?link=https://github.com/Whonix/whonixcheck/commit/d8804493701e03f77398586582912c8a5608f745" target="_blank" rel="nofollow noopener">08:15AM - 01 Jul 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>1 files</strong>
  with <strong>1 additions</strong>
  and <strong>1 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-02T23:10:31Z' class='post-time'>
                July 2, 2019, 11:10pm
              </time>
              <meta itemprop='dateModified' content='2019-07-02T23:10:31Z'>
          <span itemprop='position'>#28</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Now, in Whonix 15, we have some really useful tools like <code>systemd-analyze security</code> which gives you an exposure score of systemd services. The lower the score, the better the sandboxing. You’ll see that the sandboxed services get really low scores (sdwdate is around 2 - 3) and the non-sandboxed services get really high scores (around 8 or 9).</p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/TNT_BOM_BOM'><span itemprop='name'>TNT_BOM_BOM</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-03T08:30:50Z' class='post-time'>
                July 3, 2019,  8:30am
              </time>
              <meta itemprop='dateModified' content='2019-07-03T08:33:27Z'>
          <span itemprop='position'>#29</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>brilliant tool, this is the test runs on whonix 15 ws in Qubes:</p>
<pre><code>UNIT                                                                                                 EXPOSURE PREDICATE
anon-ws-disable-stacked-tor.service                                                                       9.1 UNSAFE   
anon-ws-disable-stacked-tor_autogen__var_run_anon-ws-disable-stacked-tor_127.0.0.1_9050.sock.service      9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen__var_run_anon-ws-disable-stacked-tor_127.0.0.1_9051.sock.service      9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen__var_run_anon-ws-disable-stacked-tor_127.0.0.1_9150.sock.service      9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen__var_run_anon-ws-disable-stacked-tor_127.0.0.1_9151.sock.service      9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen__var_run_anon-ws-disable-stacked-tor_127.0.0.1_9152.sock.service      9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen__var_run_anon-ws-disable-stacked-tor_127.0.0.1_9153.sock.service      9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen__var_run_tor_control.service                                          9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen__var_run_tor_socks.service                                            9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen_port_11109.service                                                    9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen_port_9050.service                                                     9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen_port_9051.service                                                     9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen_port_9150.service                                                     9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen_port_9151.service                                                     9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen_port_9152.service                                                     9.2 UNSAFE   
anon-ws-disable-stacked-tor_autogen_port_9153.service                                                     9.2 UNSAFE   
cron.service                                                                                              9.5 UNSAFE   
dbus.service                                                                                              9.5 UNSAFE   
emergency.service                                                                                         9.5 UNSAFE   
getty@tty1.service                                                                                        9.5 UNSAFE   
getty@ttyUSB0.service                                                                                     9.5 UNSAFE   
haveged.service                                                                                           5.6 MEDIUM   
jitterentropy.service                                                                                     9.5 UNSAFE   
polkit.service                                                                                            9.5 UNSAFE   
qubes-db.service                                                                                          9.5 UNSAFE   
qubes-firewall.service                                                                                    9.5 UNSAFE   
qubes-gui-agent.service                                                                                   9.5 UNSAFE   
qubes-meminfo-writer.service                                                                              9.5 UNSAFE   
qubes-qrexec-agent.service                                                                                9.5 UNSAFE   
qubes-sync-time.service                                                                                   9.5 UNSAFE   
qubes-updates-proxy.service                                                                               9.5 UNSAFE   
qubes-whonix-redirect-9050.service                                                                        9.2 UNSAFE   
rc-local.service                                                                                          9.5 UNSAFE   
rescue.service                                                                                            9.5 UNSAFE   
rsync.service                                                                                             9.5 UNSAFE   
rsyslog.service                                                                                           9.5 UNSAFE   
sdwdate.service                                                                                           2.8 OK       
serial-getty@hvc0.service                                                                                 9.5 UNSAFE   
serial-getty@ttyAMA0.service                                                                              9.5 UNSAFE   
serial-getty@ttyO0.service                                                                                9.5 UNSAFE   
serial-getty@ttyO2.service                                                                                9.5 UNSAFE   
serial-getty@ttyS0.service                                                                                9.5 UNSAFE   
serial-getty@ttymxc0.service                                                                              9.5 UNSAFE   
serial-getty@ttymxc3.service                                                                              9.5 UNSAFE   
sysfsutils.service                                                                                        9.5 UNSAFE   
systemd-ask-password-console.service                                                                      9.3 UNSAFE   
systemd-ask-password-wall.service                                                                         9.3 UNSAFE   
systemd-fsckd.service                                                                                     9.5 UNSAFE   
systemd-initctl.service                                                                                   9.3 UNSAFE   
systemd-journald.service                                                                                  4.3 OK       
systemd-logind.service                                                                                    4.1 OK       
systemd-networkd.service                                                                                  2.8 OK       
systemd-timesyncd.service                                                                                 2.0 OK       
systemd-udevd.service                                                                                     8.3 EXPOSED  
tinyproxy.service                                                                                         8.7 EXPOSED  
tor@default.service                                                                                       6.3 MEDIUM   
udisks2.service                                                                                           9.5 UNSAFE   
user@1000.service                                                                                         9.1 UNSAFE   
virtualbox-guest-utils.anondist.service                                                                   9.5 UNSAFE   
whonix-firewall-restarter.service                                                                         9.5 UNSAFE   
whonixcheck.service                                                                                       9.1 UNSAFE   
wpa_supplicant.service                                                                                    9.5 UNSAFE   
xendriverdomain.service                                                                                   9.5 UNSAFE   
user@host:~$</code></pre>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-11T07:16:46Z' class='post-time'>
                July 11, 2019,  7:16am
              </time>
              <meta itemprop='dateModified' content='2019-07-11T07:16:46Z'>
          <span itemprop='position'>#30</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Advice to debug <code>SystemCallFilter=</code>:</p>
<p>From <a href="../../../external.html?link=https://github.com/systemd/systemd/issues/12974" rel="nofollow noopener">https://github.com/systemd/systemd/issues/12974</a></p>
<pre><code>sudo systemd-analyze log-level debug</code></pre>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-13T20:11:04Z' class='post-time'>
                July 13, 2019,  8:11pm
              </time>
              <meta itemprop='dateModified' content='2019-07-13T20:11:04Z'>
          <span itemprop='position'>#31</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>The pam related changes most likely broke whonixcheck systemd hardening.</p>
<blockquote>
<p>Jul 13 19:46:53 host whonixcheckdaemon[25502]: sudo: effective uid is not 0, is /usr/bin/sudo on a file system with the ‘nosuid’ option set or an NFS file system without root privileges?</p>
</blockquote>
<p>To test:</p>
<pre><code>sudo systemctl daemon-reload &amp;&amp; sudo systemctl restart whonixcheck &amp;&amp; sleep 1 &amp;&amp; sudo systemctl status whonixcheck.service | cat
</code></pre>
<hr>
<p>Again “most” of them don’t work. List below.</p>
<pre><code>## Copyright (C) 2012 - 2018 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions.

[Unit]
Description=whonixcheck
Documentation=https://www.whonix.org/wiki/whonixcheck

After=network.target
Wants=network.target

After=rinetd.service
After=tor.service
After=tor@default.service
After=onion-grater.service
After=whonix-firewall.service
After=whonix-firewall-sdwdate-watcher.service

Requires=msgcollector.service

[Service]
Type=simple
User=user
Group=user
ExecStart=/usr/lib/whonixcheckdaemon
SuccessExitStatus=143
#KillMode=process
TimeoutSec=30
Restart=always

# Hardening.
#ProtectSystem=strict

## ok
ProtectHome=true

## fail
#ProtectKernelTunables=true

## fail
#ProtectKernelModules=true

## ok
ProtectControlGroups=true

## ok
PrivateTmp=true

## ok
PrivateMounts=true

## fail
#PrivateDevices=true

## fail
#MemoryDenyWriteExecute=true

## fail
#NoNewPrivileges=true

## fail
#RestrictRealtime=true

## fail
#SystemCallArchitectures=native

## fail
#RestrictNamespaces=true

## fail
#RestrictAddressFamilies=AF_UNIX AF_INET

## fail
#SystemCallFilter=wait4 read close execve open write rt_sigprocmask stat munmap mprotect clone mmap fstat access brk poll rt_sigaction select ioctl recvfrom getuid getgid getegid pipe getpid futex arch_prctl lseek rt_sigreturn geteuid fcntl getdents dup2 readlink sync getsid unlink sysinfo uname connect setresuid lstat newfstatat sendto getrlimit statfs faccessat sendmsg getppid setgroups bind umask fchmod writev mremap msync madvise dup alarm socket recvmsg shutdown getsockname getpeername socketpair getsockopt setsockopt kill getcwd chdir fchdir rename mkdir chmod chown lchown getrusage setuid setgid setpgid getpgrp setsid getgroups getresuid setresgid getresgid getpgid capget sigaltstack fstatfs prctl setrlimit gettid getxattr sched_getaffinity set_tid_address fadvise64 timer_create timer_settime openat unlinkat fchmodat ppoll set_robust_list utimensat getrandom

[Install]
WantedBy=multi-user.target
</code></pre>
<p>But even with the few enabled ones there is still an error message.</p>
<blockquote>
<p>Jul 13 20:05:54 host PAM-CGFS[634]: cgroupfs v1: Failed to escape to init’s cgroup<br>
Jul 13 20:05:54 host PAM-CGFS[634]: cgroupfs v1: Failed to enter cgroups<br>
Jul 13 20:05:54 host PAM-CGFS[634]: Failed to enter user cgroup /user/root/0 for user root</p>
</blockquote>
<p>I don’t think systemd hardening for whonixcheck is very important. It runs under user <code>whonixcheck</code> automatically anyhow. (/user/bin/whonixcheck does that.) And once users run whonixcheck manually it would not have systemd seccomp protections anyhow.</p>
<p>Therefore disabled in git master. Please retest and fix if you like.</p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-14T12:27:08Z' class='post-time'>
                July 14, 2019, 12:27pm
              </time>
              <meta itemprop='dateModified' content='2019-07-14T12:27:08Z'>
          <span itemprop='position'>#32</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="31" data-topic="7590">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>The pam related changes most likely broke whonixcheck systemd hardening.</p>
<blockquote>
<p>Jul 13 19:46:53 host whonixcheckdaemon[25502]: sudo: effective uid is not 0, is /usr/bin/sudo on a file system with the ‘nosuid’ option set or an NFS file system without root privileges?</p>
</blockquote>
</blockquote>
</aside>
<p>The pam related changes didn’t do anything with <code>sudo</code> so I find it unlikely that they’re the reason for this.</p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-14T22:52:33Z' class='post-time'>
                September 14, 2019, 10:52pm
              </time>
              <meta itemprop='dateModified' content='2019-09-14T22:52:33Z'>
          <span itemprop='position'>#33</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/vmonaco/kloak/pull/18" target="_blank" rel="nofollow noopener">github.com/vmonaco/kloak</a>
  </header>
  <article class="onebox-body">
      <a href="../../../external.html?link=https://github.com/madaidan" target="_blank" rel="nofollow noopener">
    <img alt="madaidan" src="../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../external.html?link=https://github.com/vmonaco/kloak/pull/18" target="_blank" rel="nofollow noopener">Add systemd sandboxing</a>
</h4>

<div class="date">
  by <a href="../../../external.html?link=https://github.com/madaidan" target="_blank" rel="nofollow noopener">madaidan</a>
  on <a href="../../../external.html?link=https://github.com/vmonaco/kloak/pull/18" target="_blank" rel="nofollow noopener">10:49PM - 14 Sep 19 UTC</a>
</div>

<div class="github-commit-stats">
  <strong>1 commits</strong>
  changed <strong>1 files</strong>
  with <strong>20 additions</strong>
  and <strong>0 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-15T01:10:06Z' class='post-time'>
                September 15, 2019,  1:10am
              </time>
              <meta itemprop='dateModified' content='2019-09-15T01:10:06Z'>
          <span itemprop='position'>#34</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Doesn’t kloak already run as a privleged process? By definition of its function it needs to access the input device.</p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-15T01:20:16Z' class='post-time'>
                September 15, 2019,  1:20am
              </time>
              <meta itemprop='dateModified' content='2019-09-15T01:20:16Z'>
          <span itemprop='position'>#35</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="34" data-topic="7590">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Doesn’t kloak already run as a privleged process?</p>
</blockquote>
</aside>
<p>That doesn’t mean it can’t be sandboxed. It’s actually more of a reason to sandbox it.</p>
<aside class="quote no-group" data-post="34" data-topic="7590">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>By definition of its function it needs to access the input device.</p>
</blockquote>
</aside>
<p>The sandboxing doesn’t restrict access to any devices.</p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-15T05:56:42Z' class='post-time'>
                September 15, 2019,  5:56am
              </time>
              <meta itemprop='dateModified' content='2019-09-15T11:16:55Z'>
          <span itemprop='position'>#36</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Yeah. The original systemd unit file has certainly room for improvement.</p>
<p>Maybe it could/should even run under a limited user account <code>kloak</code>.</p>
<p>If you want to do that too…</p>
<p>Btw please consider <a href="../port-to-sysusers-d-mechanism/8120.html" class="inline-onebox">Port to sysusers.d mechanism?</a></p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-15T13:35:01Z' class='post-time'>
                September 15, 2019,  1:35pm
              </time>
              <meta itemprop='dateModified' content='2019-09-15T13:35:01Z'>
          <span itemprop='position'>#37</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="36" data-topic="7590">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/p/898d66/40.png" class="avatar"> Patrick_mobile:</div>
<blockquote>
<p>Maybe it could/should even run under a limited user account <code>kloak</code> .</p>
</blockquote>
</aside>
<p>I’m not sure that would be a good idea. The sandboxing removes all capabilities from kloak and it only works because the root user owns the devices kloak needs access to. Running it under a different user will make it so it doesn’t have permission to access those devices and we’ll need to give it the CAP_DAC_OVERRIDE capability which is dangerous as it allows it to bypass any DAC permission check. Any possible advantage to running it as a different user would mostly be lost.</p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-15T16:44:20Z' class='post-time'>
                September 15, 2019,  4:44pm
              </time>
              <meta itemprop='dateModified' content='2019-09-15T16:44:20Z'>
          <span itemprop='position'>#38</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Members of group <code>input</code> are allowed to write to <code>/dev/input</code> devices. So user <code>kloak</code> could be a member of group <code>/dev/input</code>.</p>
<pre><code>ls -la /dev/input/
</code></pre>
<blockquote>
<p>crw-rw----  1 root input<br>
crw-rw----  1 root input</p>
</blockquote>
<p>By being a member of the <code>input</code> group no CAP_DAC_OVERRIDE capability would be required?</p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-15T17:14:36Z' class='post-time'>
                September 15, 2019,  5:14pm
              </time>
              <meta itemprop='dateModified' content='2019-09-15T17:14:36Z'>
          <span itemprop='position'>#39</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="38" data-topic="7590">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Members of group <code>input</code> are allowed to write to <code>/dev/input</code> devices. So user <code>kloak</code> could be a member of group <code>/dev/input</code> .</p>
</blockquote>
</aside>
<p>Kloak doesn’t actually write to <code>/dev/input</code>. It writes to <code>/dev/uinput</code>.</p>
<p>At least, that’s what it says when starting it</p>
<pre><code>* Started kloak : Keystroke-level Online Anonymizing Kernel
* Reading from  : /dev/input/event5 (dakai PS/2+USB Keyboard)
* Writing to    : /dev/uinput
* Maximum delay : 100 ms
</code></pre>
<p><code>/dev/uinput</code> isn’t owned by the <code>input</code> group. It’s owned by the <code>root</code> group.</p>
<pre><code>ls -la /dev/uinput
</code></pre>
<blockquote>
<p>crw------- 1 root root</p>
</blockquote>
<p>It seems like we can change what group it’s owned by with a udev rule so we can probably make it owned by the <code>kloak</code> group.</p>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../external.html?link=https://stackoverflow.com/questions/11939255/writing-to-dev-uinput-on-ubuntu-12-04" target="_blank" rel="nofollow noopener">stackoverflow.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../external.html?link=https://stackoverflow.com/users/1461208/ferry" target="_blank" rel="nofollow noopener">
    <img alt="ferry" src="../../../external.html?link=https://www.gravatar.com/avatar/edabcf1f7afa37af332ef130b4887a8c?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="60" height="60">
  </a>
<h4>
  <a href="../../../external.html?link=https://stackoverflow.com/questions/11939255/writing-to-dev-uinput-on-ubuntu-12-04" target="_blank" rel="nofollow noopener">writing to /dev/uinput (on ubuntu 12.04)</a>
</h4>

<div class="tags">
  <strong>linux, input, ubuntu-12.04</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../external.html?link=https://stackoverflow.com/users/1461208/ferry" target="_blank" rel="nofollow noopener">
    ferry
  </a>
  on <a href="../../../external.html?link=https://stackoverflow.com/questions/11939255/writing-to-dev-uinput-on-ubuntu-12-04" target="_blank" rel="nofollow noopener">05:25PM - 13 Aug 12 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7590.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-15T17:25:07Z' class='post-time'>
                September 15, 2019,  5:25pm
              </time>
              <meta itemprop='dateModified' content='2019-09-15T17:25:07Z'>
          <span itemprop='position'>#40</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Another thing I think we should look into is creating device policies for our sandboxes so the service can only access a limited number of devices.</p>
<p><code>PrivateDevices=true</code> sets up a new /dev mount and adds a few necessary devices like /dev/null and /dev/random but some services need access to more than just those (e.g. kloak needs access to input devices) so we can either just leave out <code>PrivateDevices</code> (less secure) or create a device policy so only the needed devices are in the sandbox (more secure).</p>
<p>Currently, we just leave out <code>PrivateDevices</code> but that isn’t great.</p>
<p>I haven’t had much luck with creating device policies though. The documentation is <a href="../../../external.html?link=https://www.freedesktop.org/software/systemd/man/systemd.resource-control.html#DevicePolicy=auto%7Cclosed%7Cstrict" rel="nofollow noopener">here</a>.</p>
<p>Debian doesn’t seem to use this much. Running</p>
<pre><code>grep "DeviceAllow" /lib/systemd/system/*.service
</code></pre>
<p>only shows OpenVPN stuff.</p>
        </div>

        <meta itemprop='headline' content='Apply systemd sandboxing by default to some services'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="7590.html">← previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="75909ba9.html?page=3">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Improve Onion Service Usability by Script / GUI - Development - Whonix Forum</title>
    <meta name="description" content="Question about a variable utility for Whonix:  tor_hiddenserviceport_target_addr  For debian, HiddenServicePort defaults to 127.0.0.1.  For anon-gateway, onionjuggler-cli blocks setting 127.0.0.1 as HiddenServicePort unless --gateway is specified, this is to avoid making an onion service targeting the gateway when it is better to target the workstation, if that is understandable, then using the gateway option the service can be created for the gateway.  But how to easily set a HiddenServicePort ...">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="91179ba9.html?page=3" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Improve Onion Service Usability by Script / GUI&#39;" href="9117.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/improve-onion-service-usability-by-script-gui/9117?page=3" />
<meta name="twitter:url" content="https://forums.whonix.org/t/improve-onion-service-usability-by-script-gui/9117?page=3" />
<meta property="og:title" content="Improve Onion Service Usability by Script / GUI" />
<meta name="twitter:title" content="Improve Onion Service Usability by Script / GUI" />
<meta property="og:description" content="Question about a variable utility for Whonix:  tor_hiddenserviceport_target_addr  For debian, HiddenServicePort defaults to 127.0.0.1.  For anon-gateway, onionjuggler-cli blocks setting 127.0.0.1 as HiddenServicePort unless --gateway is specified, this is to avoid making an onion service targeting the gateway when it is better to target the workstation, if that is understandable, then using the gateway option the service can be created for the gateway.  But how to easily set a HiddenServicePort ..." />
<meta name="twitter:description" content="Question about a variable utility for Whonix:  tor_hiddenserviceport_target_addr  For debian, HiddenServicePort defaults to 127.0.0.1.  For anon-gateway, onionjuggler-cli blocks setting 127.0.0.1 as HiddenServicePort unless --gateway is specified, this is to avoid making an onion service targeting the gateway when it is better to target the workstation, if that is understandable, then using the gateway option the service can be created for the gateway.  But how to easily set a HiddenServicePort ..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="18 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="42 ❤" />
<meta property="article:published_time" content="2022-08-18T17:32:01+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="91174658.html?page=2">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="9117.html">Improve Onion Service Usability by Script / GUI</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nyxnor'><span itemprop='name'>nyxnor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-18T17:32:01Z' class='post-time'>
                August 18, 2022,  5:32pm
              </time>
              <meta itemprop='dateModified' content='2022-08-18T17:32:01Z'>
          <span itemprop='position'>#41</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Question about a variable utility for Whonix:</p>
<p><code>tor_hiddenserviceport_target_addr</code></p>
<p>For debian, HiddenServicePort defaults to 127.0.0.1.<br>
For anon-gateway, onionjuggler-cli blocks setting 127.0.0.1 as HiddenServicePort unless <code>--gateway</code> is specified, this is to avoid making an onion service targeting the gateway when it is better to target the workstation, if that is understandable, then using the gateway option the service can be created for the gateway.</p>
<p>But how to easily set a HiddenServicePort TARGET_ADDR targeting the workstation?<br>
On Qubes-Whonix, it asks for the variable <code>tor_hiddenserviceport_target_addr</code> to be set.<br>
On other virtualizers, it defaults to <code>10.152.152.11</code>.</p>
<p>If <code>tor_hiddenserviceport_target_addr</code> is set, you only need to specify the virtual port and the target port, the target_addr will be set by that variable.</p>
<p>But if it is more secure to host different application servers on different workstation, is it really useful to have <code>tor_hiddenserviceport_target_addr</code>?</p>
<p>First thing is that option needs to be set once on the configuration else it needs to be specified everytime on the command line.</p>
<p><strong>For services targeting the workstation:</strong><br>
If variable is not set:</p>
<ul>
<li><code>--port 80:10.137.0.10:5000 22:10.137.0.10:22</code></li>
</ul>
<p>If variable is set:</p>
<ul>
<li><code>--port 80:5000 22:22</code></li>
</ul>
<p>If variable is set to <code>10.137.0.10</code> and you want to target another ws <code>10.137.0.11</code>, target set by command line overrides the configuration option as expected:</p>
<ul>
<li><code>--port 80:10.137.0.11:5000 22:10.137.0.11:22</code></li>
</ul>
<p>Is that really a helper or you feel it will be an underused variable is for every server it is set to target a different workstation?</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-19T08:35:23Z' class='post-time'>
                August 19, 2022,  8:35am
              </time>
              <meta itemprop='dateModified' content='2022-08-19T08:35:23Z'>
          <span itemprop='position'>#42</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Does it use Tor configuration drop-in folder <code>/etc/tor/torrc.d</code>? In Qubes-Whonix, <code>/usr/local/etc/tor/torrc.d</code> would be required so for consistency for all Whonix platforms <code>/usr/local/etc/tor/torrc.d</code>.</p>
<p>torrc.d support is now very stable. Only config files matching <code>*.conf</code> are parsed. (<code>*.conf.dpkg-old</code>, <code>~</code>, etc. are not parsed).</p>
<p>No need compete with the user editing <code>/etc/tor/torrc</code> file.</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nyxnor'><span itemprop='name'>nyxnor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-19T08:41:11Z' class='post-time'>
                August 19, 2022,  8:41am
              </time>
              <meta itemprop='dateModified' content='2022-08-19T08:41:11Z'>
          <span itemprop='position'>#43</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Y</p>
<aside class="quote no-group" data-username="Patrick" data-post="42" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Does it use Tor configuration drop-in folder <code>/etc/tor/torrc.d</code>? In Qubes-Whonix, <code>/usr/local/etc/tor/torrc.d</code> would be required so for consistency for all Whonix platforms <code>/usr/local/etc/tor/torrc.d</code>.</p>
</blockquote>
</aside>
<p>Yes <a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/efb585ddc89549b7f0ddab6994b7d206ce6c170b/etc/onionjuggler/anon.conf#L39" rel="noopener nofollow ugc">https://github.com/nyxnor/onionjuggler/blob/efb585ddc89549b7f0ddab6994b7d206ce6c170b/etc/onionjuggler/anon.conf#L39</a><br>
but that is unrelated to the above question.</p>
<p>When creating an onion service:</p>
<p>In short, do you think setting a defaut WS as target for the onion services would be useful or it is better to explictly set on the command line every time?</p>
<p>On every other system, the default is 127.0.0.1.<br>
But on whonix, is purposefully block 127.0.0.1 (service targeting the GW) unless <code>--gateway</code> option is given.<br>
But if service should target the WS, is it useful to set a default target address or explictly set it on the cli?</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nyxnor'><span itemprop='name'>nyxnor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-19T08:43:06Z' class='post-time'>
                August 19, 2022,  8:43am
              </time>
              <meta itemprop='dateModified' content='2022-08-19T08:43:06Z'>
          <span itemprop='position'>#44</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>If you don’t understand, that is okay, maybe it is difficult to grasp in the beginning.</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-19T08:59:19Z' class='post-time'>
                August 19, 2022,  8:59am
              </time>
              <meta itemprop='dateModified' content='2022-08-19T08:59:19Z'>
          <span itemprop='position'>#45</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I haven’t looked deep enough yet. Hence, skipped this question for now. I didn’t find <code>--gateway</code> in the man page. Therefore not sure I understand the question good enough.</p>
<aside class="quote no-group" data-username="nyxnor" data-post="41" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p>But if it is more secure to host different application servers on different workstation,</p>
</blockquote>
</aside>
<p>More secure probably but that really depends on user preferences, effort vs security.</p>
<aside class="quote no-group" data-username="nyxnor" data-post="41" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p>But how to easily set a HiddenServicePort TARGET_ADDR targeting the workstation?</p>
</blockquote>
</aside>
<p>For a cli tool, I don’t know any easy option. In the default setup without multiple workstation, that’s easier, since IP could be hardcoded. So a low level CLI tool probably shouldn’t have a hardcoded default. But any higher level usability tools on top could guide through that by asking that as a question (“Do you use multiple Whonix-Workstation behind the same Whonix-Gateway?” or “Did you change Whonix-Workstation internal IP address? In doubt, say no”)</p>
<aside class="quote no-group" data-username="nyxnor" data-post="41" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p><strong>For services targeting the workstation:</strong><br>
If variable is not set:</p>
<ul>
<li><code>--port 80:10.137.0.10:5000 22:10.137.0.10:22</code></li>
</ul>
<p>If variable is set:</p>
<ul>
<li><code>--port 80:5000 22:22</code></li>
</ul>
<p>If variable is set to <code>10.137.0.10</code> and you want to target another ws <code>10.137.0.11</code>, target set by command line overrides the configuration option as expected:</p>
<ul>
<li><code>--port 80:10.137.0.11:5000 22:10.137.0.11:22</code></li>
</ul>
<p>Is that really a helper or you feel it will be an underused variable is for every server it is set to target a different workstation?</p>
</blockquote>
</aside>
<p>Seems rather complex. I guess best is to keep the code simple and a low level CLI tool should always require everything mandatory. A higher level usability tool could help the user in the easy cases. For very advanced users, these could use the command line parameters and/or environment variables.</p>
<aside class="quote no-group" data-username="nyxnor" data-post="41" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<ul>
<li><code>--port 80:10.137.0.10:5000 22:10.137.0.10:22</code></li>
</ul>
</blockquote>
</aside>
<p>That syntax seems a bit weird. <code>--port</code> might be too generic a name here? Hidden service virtual port or local port? But then the parameter is not a simple port. It’s port:ip:port ip:port.</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nyxnor'><span itemprop='name'>nyxnor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-19T09:00:58Z' class='post-time'>
                August 19, 2022,  9:00am
              </time>
              <meta itemprop='dateModified' content='2022-08-19T09:00:58Z'>
          <span itemprop='position'>#46</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="42" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Does it use Tor configuration drop-in folder <code>/etc/tor/torrc.d</code>? In Qubes-Whonix, <code>/usr/local/etc/tor/torrc.d</code> would be required so for consistency for all Whonix platforms <code>/usr/local/etc/tor/torrc.d</code>.</p>
</blockquote>
</aside>
<p>On that note, I noticed something yesterday.</p>
<p><code>onionjuggler --list</code> to print service information only list services that are managed by onionjuggler.conf, which is kinda expected, but on the other hand, it will mist services created by other files and  other programs. Maybe I should list all services on the system and indicate which ones are managed by each files…</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nyxnor'><span itemprop='name'>nyxnor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-19T09:14:22Z' class='post-time'>
                August 19, 2022,  9:14am
              </time>
              <meta itemprop='dateModified' content='2022-08-19T09:36:37Z'>
          <span itemprop='position'>#47</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="45" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I haven’t looked deep enough yet. Hence, skipped this question for now. I didn’t find <code>--gateway</code> in the man page. Therefore not sure I understand the question good enough.</p>
</blockquote>
</aside>
<aside class="onebox githubblob" data-onebox-src="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/man/onionjuggler-cli.8.md">
  <header class="source">

      <a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/man/onionjuggler-cli.8.md" target="_blank" rel="noopener nofollow ugc">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/man/onionjuggler-cli.8.md" target="_blank" rel="noopener nofollow ugc">nyxnor/onionjuggler/blob/main/man/onionjuggler-cli.8.md</a></h4>


      <pre><code class="lang-md">% ONIONJUGGLER-CLI(8) Dinamically juggle with onion services with a POSIX compliant shell
% Written by nyxnor (nyxnor@protonmail.com)
% default_date

# NAME

onionjuggler-cli - Dinamically juggle with onion services with a POSIX compliant shell


# SYNOPSIS

**onionjuggler-cli** [**--option**&lt;=*ARGUMENT*&gt;]\
**onionjuggler-cli --on** [**--service** &lt;*SERVICE*&gt;] [**--version** &lt;*VERSION*&gt;] [**--socket** &lt;*tcp*&gt;] [**--port** &lt;*VIRTPORT*[:*TARGET*],[*VIRTPORTn*][:*TARGETn*]&gt;] [**--gateway**]\
**onionjuggler-cli --on**  [**--service** &lt;*SERVICE*&gt;] [**--version** &lt;*VERSION*&gt;] [**--socket** &lt;*unix*&gt;] [**--port** [*VIRTPORT*,[*VIRTPORT2*]&gt;]\
**onionjuggler-cli --off** [**--service** &lt;*SERV1*,*SERV2*,*...*&gt;] [**--purge**]\
**onionjuggler-cli --list** [**--service** &lt;*@all*|*SERV1*,*SERV2*,*...*&gt;] [**--quiet**]\
**onionjuggler-cli --renew** [**--service** &lt;*@all*|*SERV1*,*SERV2*,*...*&gt;]\
**onionjuggler-cli [-V|--version]**\
**onionjuggler-cli [--getconf]**\
**onionjuggler-cli [--getopt]** [**--service** &lt;*SERVICE*&gt;]\
</code></pre>



  This file has been truncated. <a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/man/onionjuggler-cli.8.md" target="_blank" rel="noopener nofollow ugc">show original</a>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-username="Patrick" data-post="45" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>For a cli tool, I don’t know any easy option. In the default setup without multiple workstation, that’s easier, since IP could be hardcoded. So a low level CLI tool probably shouldn’t have a hardcoded default. But any higher level usability tools on top could guide through that by asking that as a question (“Do you use multiple Whonix-Workstation behind the same Whonix-Gateway?” or “Did you change Whonix-Workstation internal IP address? In doubt, say no”)</p>
</blockquote>
</aside>
<p>It doesn’t have that, for now, if Qubes-Whonix user doesn’t modify the target on the onionjuggler configuration or on the cli, it will error out.</p>
<pre><code class="lang-auto">$ sudo ./onionjuggler-cli --on --service abc --port 6000
Saving a copy of /usr/local/etc/torrc.d/40_onionjuggler.conf to /usr/local/etc/torrc.d/40_onionjuggler.conf.afaqv.conf
Moving original file /usr/local/etc/torrc.d/40_onionjuggler.conf to /usr/local/etc/torrc.d/.40_onionjuggler.conf-orig
Including Hidden Service configuration to /usr/local/etc/torrc.d/40_onionjuggler.conf.afaqv.conf

HiddenServiceDir /var/lib/tor/services/abc
HiddenServiceVersion 3
error: Option '--gateway' was not specified but target was set to 127.0.0.1. Either set the Workstation Qube IP address using the option 'tor_hiddenserviceport_target_addr' on /etc/onionjuggler/conf.d/*.conf to target a WS or use the gateway option to enforce a service to be run on the GW

Restoring /usr/local/etc/torrc.d/.40_onionjuggler.conf-orig to /usr/local/etc/torrc.d/40_onionjuggler.conf
removed '/usr/local/etc/torrc.d/40_onionjuggler.conf.afaqv.conf'
</code></pre>
<p>but giving the target on cli or conf works</p>
<pre><code class="lang-auto">sudo ./onionjuggler-cli --on --service abc --port 80:10.137.0.10:6000
Saving a copy of /usr/local/etc/torrc.d/40_onionjuggler.conf to /usr/local/etc/torrc.d/40_onionjuggler.conf.gMjNp.conf
Moving original file /usr/local/etc/torrc.d/40_onionjuggler.conf to /usr/local/etc/torrc.d/.40_onionjuggler.conf-orig
Including Hidden Service configuration to /usr/local/etc/torrc.d/40_onionjuggler.conf.gMjNp.conf

HiddenServiceDir /var/lib/tor/services/abc
HiddenServiceVersion 3
HiddenServicePort 80 10.137.0.10:6000

Verifying tor configuration
Aug 19 09:04:19.649 [warn] Option 'DisableNetwork' used more than once; all but the last value will be ignored.
Configuration OK
File /usr/local/etc/torrc.d/40_onionjuggler.conf.gMjNp.conf differs from /usr/local/etc/torrc.d/.40_onionjuggler.conf-orig
Moving temporary /usr/local/etc/torrc.d/40_onionjuggler.conf.gMjNp.conf back to its original location /usr/local/etc/torrc.d/40_onionjuggler.conf
Removing original file that was made hidden /usr/local/etc/torrc.d/.40_onionjuggler.conf-orig
</code></pre>
<p>The problem here is usability, mentioning the target every time if not configured otherwise.</p>
<aside class="quote no-group" data-username="Patrick" data-post="45" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Seems rather complex. I guess best is to keep the code simple and a low level CLI tool should always require everything mandatory. A higher level usability tool could help the user in the easy cases. For very advanced users, these could use the command line parameters and/or environment variables.</p>
</blockquote>
</aside>
<p>So I will remove the default target address for hiddenservices, which does not have a default for qubes-whonix.<br>
The target will be mandary on the cli.</p>
<aside class="quote no-group" data-username="Patrick" data-post="45" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>That syntax seems a bit weird. <code>--port</code> might be too generic a name here? Hidden service virtual port or local port? But then the parameter is not a simple port. It’s port:ip:port ip:port.</p>
</blockquote>
</aside>
<aside class="onebox githubblob" data-onebox-src="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/man/onionjuggler-cli.8.md#options">
  <header class="source">

      <a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/man/onionjuggler-cli.8.md#options" target="_blank" rel="noopener nofollow ugc">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/man/onionjuggler-cli.8.md#options" target="_blank" rel="noopener nofollow ugc">nyxnor/onionjuggler/blob/main/man/onionjuggler-cli.8.md#options</a></h4>


      <pre><code class="lang-md">% ONIONJUGGLER-CLI(8) Dinamically juggle with onion services with a POSIX compliant shell
% Written by nyxnor (nyxnor@protonmail.com)
% default_date

# NAME

onionjuggler-cli - Dinamically juggle with onion services with a POSIX compliant shell


# SYNOPSIS

**onionjuggler-cli** [**--option**&lt;=*ARGUMENT*&gt;]\
**onionjuggler-cli --on** [**--service** &lt;*SERVICE*&gt;] [**--version** &lt;*VERSION*&gt;] [**--socket** &lt;*tcp*&gt;] [**--port** &lt;*VIRTPORT*[:*TARGET*],[*VIRTPORTn*][:*TARGETn*]&gt;] [**--gateway**]\
**onionjuggler-cli --on**  [**--service** &lt;*SERVICE*&gt;] [**--version** &lt;*VERSION*&gt;] [**--socket** &lt;*unix*&gt;] [**--port** [*VIRTPORT*,[*VIRTPORT2*]&gt;]\
**onionjuggler-cli --off** [**--service** &lt;*SERV1*,*SERV2*,*...*&gt;] [**--purge**]\
**onionjuggler-cli --list** [**--service** &lt;*@all*|*SERV1*,*SERV2*,*...*&gt;] [**--quiet**]\
**onionjuggler-cli --renew** [**--service** &lt;*@all*|*SERV1*,*SERV2*,*...*&gt;]\
**onionjuggler-cli [-V|--version]**\
**onionjuggler-cli [--getconf]**\
**onionjuggler-cli [--getopt]** [**--service** &lt;*SERVICE*&gt;]\
</code></pre>



  This file has been truncated. <a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/man/onionjuggler-cli.8.md#options" target="_blank" rel="noopener nofollow ugc">show original</a>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Actually, I experimented with a lot of syntax options before, and this seemed the better  so far, but contributions can be received.<br>
The syntax is <code>--port VIRTPORT[:TARGET_ADDR[:TARGET_PORT]] VIRTPORTn[:TARGET_ADDRn[:TARGET_PORTn]]</code></p>
<p>Virtport is the onion service virtual port.<br>
Target address and port is the local address and port.</p>
<p>Any number of HiddenServicePort lines can be used, it loops.<br>
So you can set <code>--port="80 22" --gateway</code> or <code>--port="80:127.0.0.1 22:127.0.0.1" --gateway</code> or <code>--port="80:127.0.0.1:80 22:127.0.0.1:22" --gateway</code> and both will produce:</p>
<pre><code class="lang-auto">HiddenServicePort 80
HiddenServicePort 22
</code></pre>
<p>or</p>
<pre><code class="lang-auto">HiddenServicePort 80 127.0.0.1
HiddenServicePort 22 127.0.0.1
</code></pre>
<p>But for uniformity I make the script only create full explict options</p>
<pre><code class="lang-auto">HiddenServicePort 80 127.0.0.1:80
HiddenServicePort 22 127.0.0.1:22
</code></pre>
<p>as these options are equal.</p>
<p>Actualy, my syntax is following tor defaults.<br>
If only VIRTPORT is set but TARGET is not, bind the VIRTPORT port to 127.0.0.1:VIRTPORT<br>
If VIRTPORT is set but TARGET_PORT is not set, bind the same port to TARGET_ADDR:VIRTPORT.</p>
<p>This can be read on <code>man torrc</code> and <code>man onionjuggler-cli</code></p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nyxnor'><span itemprop='name'>nyxnor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-19T09:26:23Z' class='post-time'>
                August 19, 2022,  9:26am
              </time>
              <meta itemprop='dateModified' content='2022-08-19T09:26:23Z'>
          <span itemprop='position'>#48</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>The port syntax is the same as SSH tunnel handler and qvm-connect-tcp</p>
<p>Examples of the same syntax:</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://www.whonix.org/wiki/File_Transfer#Setup_Host">
  <header class="source">
      <img src="../../../external.html?link=https://www.whonix.org/w/images/a/a4/Whonix-home-favicon.ico" class="site-icon" width="32" height="32">

      <a href="../../../external.html?link=https://www.whonix.org/wiki/File_Transfer#Setup_Host" target="_blank" rel="noopener nofollow ugc" title="02:51PM - 12 August 2022">Whonix – 12 Aug 22</a>
  </header>

  <article class="onebox-body">
    <img src="../../../external.html?link=https://www.whonix.org/w/images/2/2c/Filetransfer-2126883640.png" class="thumbnail onebox-avatar" width="500" height="500">

<h3><a href="../../../external.html?link=https://www.whonix.org/wiki/File_Transfer#Setup_Host" target="_blank" rel="noopener nofollow ugc">File Transfer</a></h3>

  <p>Copying files into and out of Whonix ™ Virtual Machines.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://www.qubes-os.org/doc/firewall/#opening-a-single-tcp-port-to-other-network-isolated-qube">
  <header class="source">
      <img src="../../../external.html?link=https://www.qubes-os.org/attachment/icons/512x512/apps/qubes-logo-icon.png" class="site-icon" width="500" height="500">

      <a href="../../../external.html?link=https://www.qubes-os.org/doc/firewall/#opening-a-single-tcp-port-to-other-network-isolated-qube" target="_blank" rel="noopener nofollow ugc">Qubes OS</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/362;"><img src="../../../external.html?link=https://www.qubes-os.org/attachment/icons/qubes-logo-icon-name-slogan-fb.png" class="thumbnail" width="690" height="362"></div>

<h3><a href="../../../external.html?link=https://www.qubes-os.org/doc/firewall/#opening-a-single-tcp-port-to-other-network-isolated-qube" target="_blank" rel="noopener nofollow ugc">Firewall</a></h3>

  <p>Understanding firewalling in Qubes Every qube in Qubes is connected to the network via a FirewallVM, which is used to enforce network-level policies. By default there is one default FirewallVM, but the user is free to create more, if needed. For more...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-22T10:59:10Z' class='post-time'>
                August 22, 2022, 10:59am
              </time>
              <meta itemprop='dateModified' content='2022-08-22T10:59:10Z'>
          <span itemprop='position'>#49</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubpullrequest" data-onebox-src="../../../external.html?link=https://github.com/Whonix/anon-apps-config/pull/2">
  <header class="source">

      <a href="../../../external.html?link=https://github.com/Whonix/anon-apps-config/pull/2" target="_blank" rel="noopener">github.com/Whonix/anon-apps-config</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/anon-apps-config/pull/2" target="_blank" rel="noopener">add onionjuggler whonix conf</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> ← <code>nyxnor:onionjuggler-inclusion</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2022-08-17" data-time="20:08:34" data-timezone="UTC">08:08PM - 17 Aug 22 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/nyxnor" target="_blank" rel="noopener">
          <img alt="nyxnor" src="../../../external.html?link=https://avatars.githubusercontent.com/u/69700936?v=4" class="onebox-avatar-inline" width="20" height="20">
          nyxnor
        </a>
      </div>

      <div class="lines" title="1 commits changed 1 files with 63 additions and 0 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/anon-apps-config/pull/2/files" target="_blank" rel="noopener">
          <span class="added">+63</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">This is the only command that needs to be done to update the conf if ever change<span class="show-more-container"><a href="../../../external.html?link=https://github.com/Whonix/anon-apps-config/pull/2" target="_blank" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">d upstream:
```sh
cp onionjuggler/etc/onionjuggler/anon.conf anon-apps-config/etc/onionjuggler/conf.d/30_whonix.conf
```</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-22T10:59:17Z' class='post-time'>
                August 22, 2022, 10:59am
              </time>
              <meta itemprop='dateModified' content='2022-08-22T10:59:17Z'>
          <span itemprop='position'>#50</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Merged, thanks!</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nyxnor'><span itemprop='name'>nyxnor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-24T09:59:11Z' class='post-time'>
                August 24, 2022,  9:59am
              </time>
              <meta itemprop='dateModified' content='2022-08-24T11:56:02Z'>
          <span itemprop='position'>#51</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>With the auto complete feature, it can list enabled servers with TABTAB</p><aside class="onebox githubissue" data-onebox-src="../../../external.html?link=https://github.com/nyxnor/onionjuggler/issues/10">
  <header class="source">

      <a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/issues/10" target="_blank" rel="noopener nofollow ugc">github.com/nyxnor/onionjuggler</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue">
	  <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/issues/10" target="_blank" rel="noopener nofollow ugc">[FEATURE REQUEST] - shell completion</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2021-11-18" data-time="19:23:38" data-timezone="UTC">07:23PM - 18 Nov 21 UTC</span>
      </div>


      <div class="user">
        <a href="../../../external.html?link=https://github.com/nyxnor" target="_blank" rel="noopener nofollow ugc">
          <img alt="nyxnor" src="../../../external.html?link=https://avatars.githubusercontent.com/u/69700936?v=4" class="onebox-avatar-inline" width="20" height="20">
          nyxnor
        </a>
      </div>
    </div>

    <div class="labels">
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          enhancement
        </span>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">**Is your feature request related to a problem? Please describe.**

Those are <span class="show-more-container"><a href="#" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">the most used shells and known to me that have completion (more to come if someone helps), I want that to be improved.
* https://github.com/nyxnor/onionservice/blob/main/etc/bash_completion/onionservice-cli
* https://github.com/nyxnor/onionservice/tree/main/etc/zsh_completion

**Describe the solution you'd like**

* Bash completion [official package](https://github.com/scop/bash-completion/) and [debian guide](http://web.archive.org/web/20200507173259/https://debian-administration.org/article/317/An_introduction_to_bash_completion_part_2)

**Additional context**

Low priority, it will be very useful but not intrinsic required.

- only bash, https://unix.stackexchange.com/a/158523
- https://maskedbyte.com/how-to-create-a-custom-bash-completion-script/</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Just to give an overview of the project:</p>
<ul>
<li>I didn’t have a basis for the project as I don’t see any prominent tor related project trying to handle the torrc, they normally interact with the controller that has expected responses, and onion services created on the controller don’t have to deal with the file system, but they disappear on every tor start, which then the user would have to load the private key of the service every time tor is restarted. You can test this as instructed in <a href="../../../external.html?link=https://github.com/nyxnor/tor-ctrl/issues/17" rel="noopener nofollow ugc">https://github.com/nyxnor/tor-ctrl/issues/17</a>
</li>
<li>So there may be a simpler an easier way to do what onionjuggler is doing and not break the torrc with an invalid configuration, but I don’t know how.</li>
<li>onionjuggler tries its best to filter user input to avoid special characters, avoid wrong paths, avoid wrong ports, wrong client keys, because even though there is a fail mechanism that if tor fails to --verify-config, it will restore the original file, it is a last resort and sometimes not informative of the problem, so I prefer the method fail fast, so the user is informed about the problem.</li>
</ul>
<h2>
<a name="design-1" class="anchor" href="#design-1"></a>Design</h2>
<ul>
<li>check if tor configuration is valid before running anything
<ul>
<li>if not, warn about it and exit</li>
<li>if not but you believe you know the problem and want to restore with onionjuggler, then there is an env variable for it documented on the manual.</li>
</ul>
</li>
<li>check user input
<ul>
<li>if service configuration already exist when creating one with the same name, warn and error out</li>
<li>if ports are not valid, warn and error out</li>
<li>if client keys, config or onion is not valid, warn and error out</li>
</ul>
</li>
<li>safe_edit():
<ul>
<li>copy the orignal torrc (/usr/loca/etc/torrc.d/40_onionjuggler.conf) to the same path under the name <code>.40_onionjuggler.conf-orig</code> (it needs to have a dot to be hidden and tor not parse it twice.</li>
<li>move the original file to the same path under the name <code>40_onionjuggler.conf.XXXXXX.tmp.conf</code>. The suffix <code>.conf</code> is dynamic, it works for client files with <code>.auth</code> and <code>.auth_private</code>. This temporary file will be parsed.</li>
</ul>
</li>
<li>echo user input to temporary file.</li>
<li>verify_config_tor():
<ul>
<li>verify configuration including all configuraitons so it can be valid, with debian and derived including whonix, it runs <code>tor -f /etc/tor/torrc --defaults-torrc /usr/share/tor/tor-service-defaults-torrc --verify-config hush</code>, so the <code>.tmp.conf</code> is included and is parsed because it ends with <code>.conf</code>.</li>
<li>if verification fails, move <code>-orig</code> to orignal location, remove <code>.tmp.conf</code>.</li>
<li>if  verification succeeds, move <code>.tmp.conf</code> to original location, remove <code>-orig</code>.</li>
</ul>
</li>
<li>safe_edit save:
<ul>
<li>now that it didn’t exit on the verify config, save modified temp file to original location and remove <code>.file-orig</code>.</li>
</ul>
</li>
<li>signal_tor:
<ul>
<li>signal tor to reload (default), restart, none. The <code>reload</code> is all you normally need. The <code>restart</code> is only if the config was previously broken and you need to restart it. The <code>none</code> is for when running a lot of time and you don’t want to reload tor because it will signal newnym tons of times and will overload the guards and you will loose connection.</li>
</ul>
</li>
<li>ending with info:
<ul>
<li>at the end, important info will be printed, to which file the data was inserted, the full data that was inserted, how to connect etc.</li>
</ul>
</li>
</ul>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-24T10:21:51Z' class='post-time'>
                August 24, 2022, 10:21am
              </time>
              <meta itemprop='dateModified' content='2022-08-24T10:21:51Z'>
          <span itemprop='position'>#52</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="nyxnor" data-post="51" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p><code>.40_onionjuggler.conf-orig</code> (it needs to have a dot to be hidden and tor not parse it twice.</p>
</blockquote>
</aside>
<p>Tor parses <code>*.conf</code>. I didn’t test if that would also match <code>*.conf-orig</code> but if it does, perhaps best to avoid <code>.conf</code> inside temporary or backup files altogether?</p>
<aside class="quote no-group" data-username="nyxnor" data-post="51" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p>move the original file to the same path under the name <code>40_onionjuggler.conf.XXXXXX.tmp.conf</code>.</p>
</blockquote>
</aside>
<p>This file extension <code>.conf</code> should with certainty be avoided for temporary files.</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nyxnor'><span itemprop='name'>nyxnor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-24T11:53:04Z' class='post-time'>
                August 24, 2022, 11:53am
              </time>
              <meta itemprop='dateModified' content='2022-08-24T11:53:04Z'>
          <span itemprop='position'>#53</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="52" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Tor parses <code>*.conf</code>. I didn’t test if that would also match <code>*.conf-orig</code></p>
</blockquote>
</aside>
<p>It does not match <code>*.conf-orig</code>. It would match if the include line was <code>%include *.conf*</code>, with an extra <code>*</code> as the end, but that would be wrong anyway and the correct is <code>*.conf</code>.</p>
<aside class="quote no-group" data-username="Patrick" data-post="52" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>best to avoid <code>.conf</code> inside temporary or backup files altogether?</p>
</blockquote>
</aside>
<p>Tor doesn’t parse hidden files unless explictly set to:<br>
man torrc</p>
<pre><code class="lang-auto">       The supported wildcards are * meaning any number of characters including none and ? meaning exactly one character.
       These characters can be escaped by preceding them with a backslash, except on Windows. Files starting with a dot are
       not matched when expanding wildcards unless the starting dot is explicitly in the pattern, except on Windows.
</code></pre>
<p>So unless the include pattern is <code>%include .*.conf</code> (notice the dot in the beginning, it won’t parse hidden files because whonix include is <code>%include *.conf</code>.</p>
<p>Then tor wouldn’t parse that file and it would be verified, and that is the problem, what is why it needs <code>.conf</code>.<br>
Previously I was not using that for the temporary file and the verify config was not working because of that, the temporary file was not being included.<br>
Anyway, to reasons not to worry about that:</p>
<ul>
<li>there is a fail safe trap for all possible signals EXIT INT QUIT TERM</li>
</ul>
<aside class="onebox githubblob" data-onebox-src="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/usr/share/onionjuggler/defaults.sh#L312">
  <header class="source">

      <a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/usr/share/onionjuggler/defaults.sh#L312" target="_blank" rel="noopener nofollow ugc">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/usr/share/onionjuggler/defaults.sh#L312" target="_blank" rel="noopener nofollow ugc">nyxnor/onionjuggler/blob/main/usr/share/onionjuggler/defaults.sh#L312</a></h4>



    <pre class="onebox">      <code class="lang-sh">
        <ol class="start lines" start="302" style="counter-reset: li-counter 301 ;">
            <li>          notice "File ${file_name_tmp} differs from ${file_tmp_orig}"</li>
            <li>          notice "Moving temporary ${file_name_tmp} back to its original location ${file}"</li>
            <li>          mv "${file_name_tmp}" "${file}"</li>
            <li>          notice "Removing original file that was made hidden ${file_tmp_orig}"</li>
            <li>          rm -f "${file_tmp_orig}"</li>
            <li>        fi</li>
            <li>      done</li>
            <li>    ;;</li>
            <li>  esac</li>
            <li>
            </li>
<li class="selected">  trap 'trap_exit_all' EXIT INT QUIT TERM</li>
            <li>}</li>
            <li>
            </li>
<li>
            </li>
<li># shellcheck disable=SC2086</li>
            <li>trap_exit_all(){</li>
            <li>  trap_exit_restore ${exit_restore_file}</li>
            <li>  notice "Removing temporary files"</li>
            <li>  rm -fv ${exit_remove_file}</li>
            <li>}</li>
            <li>
        </li>
</ol>
      </code>
    </pre>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<ul>
<li>
<p>It is not possible to trap KILL signal, so unless you get the onionjuggler pid of a script that takes less than 2 seconds to run and kill it, certainly improbable.</p>
</li>
<li>
<p>if for whatever reason, the trap fails (if you can make it fail, let me know, I already tried), the temporary file has a distinctive name <code>ORIGINALFILENAME.XXXXXX.tmp.conf</code>, where XXXXXX is generated by mktemp a random string. And the original file name will be hidden  with name <code>.ORIGINALFILENAME-orig</code> but can be found with <code>ls -a</code>.</p>
</li>
</ul>
<p>But again, this is never necessary because the trap works.</p>
<aside class="quote no-group" data-username="Patrick" data-post="52" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>This file extension <code>.conf</code> should with certainty be avoided for temporary files.</p>
</blockquote>
</aside>
<p>The same way tor wouldn’t include files without <code>*.conf</code>, it wouldn’t verify the temporary file without the <code>*.conf</code>, so it is necessary.</p>
<p>Modify this line to remove the file suffix and see what happens  with <code>set -x</code></p><aside class="onebox githubblob" data-onebox-src="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/usr/share/onionjuggler/defaults.sh#L274">
  <header class="source">

      <a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/usr/share/onionjuggler/defaults.sh#L274" target="_blank" rel="noopener nofollow ugc">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/blob/main/usr/share/onionjuggler/defaults.sh#L274" target="_blank" rel="noopener nofollow ugc">nyxnor/onionjuggler/blob/main/usr/share/onionjuggler/defaults.sh#L274</a></h4>



    <pre class="onebox">      <code class="lang-sh">
        <ol class="start lines" start="264" style="counter-reset: li-counter 263 ;">
            <li>## create an empty file if not existent</li>
            <li>if test -f "${file}"; then</li>
            <li>  file_tmp_orig_suffix="orig"</li>
            <li>else</li>
            <li>  file_tmp_orig_suffix="new"</li>
            <li>  notice "Creating empty file on ${file}"</li>
            <li>  touch "${file}"</li>
            <li>fi</li>
            <li>file_tmp_orig="${file_dir}/.${file_name}-${file_tmp_orig_suffix}"</li>
            <li>file_tmp_pattern="${file_name}.XXXXX.tmp"</li>
            <li class="selected">test -n "${file_suffix}" &amp;&amp; file_tmp_pattern="${file_tmp_pattern}.${file_suffix}"</li>
            <li>file_name_tmp="$(mktemp "${file_dir}/${file_tmp_pattern}")"</li>
            <li>notice "Saving a copy of ${file} to ${file_name_tmp}"</li>
            <li>chown "${tor_conf_user_group}" "${file_name_tmp}"</li>
            <li>## copy preserving mode</li>
            <li>cp -p "${file}" "${file_name_tmp}"</li>
            <li>## tor won't parse a hidden file</li>
            <li>notice "Moving original file ${file} to ${file_tmp_orig}"</li>
            <li>mv "${file}" "${file_tmp_orig}"</li>
            <li>## delete temp file. Also, if the hidden file still exists, means it wasn't saved,</li>
            <li>## so move it back to original location.</li>
        </ol>
      </code>
    </pre>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Also read <a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/issues/66#issuecomment-1212480961" rel="noopener nofollow ugc">https://github.com/nyxnor/onionjuggler/issues/66#issuecomment-1212480961</a></p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nyxnor'><span itemprop='name'>nyxnor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-08-24T11:56:45Z' class='post-time'>
                August 24, 2022, 11:56am
              </time>
              <meta itemprop='dateModified' content='2022-08-24T11:56:45Z'>
          <span itemprop='position'>#54</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>updated the design above to explain about saving files and signaling tor.</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nyxnor'><span itemprop='name'>nyxnor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-15T16:03:40Z' class='post-time'>
                September 15, 2022,  4:03pm
              </time>
              <meta itemprop='dateModified' content='2022-09-15T16:03:40Z'>
          <span itemprop='position'>#55</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>fixed issue with qube whonix file persistence to support <code>/usr/local/etc</code>.</p>
<p>Patrick,<br>
Is there a plan to include onionjuggler to Whonix packages or is something you feel the advantages vs disadvantages of packaging and guiding?</p>
<p>I only tested on qube-whonix and plain debian, but it might be function on non-qubes-whonix.</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-19T15:19:34Z' class='post-time'>
                September 19, 2022,  3:19pm
              </time>
              <meta itemprop='dateModified' content='2022-09-19T15:19:34Z'>
          <span itemprop='position'>#56</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>That’s quite a big contribution and will take some time to review.</p>
<p>Non-Qubes-Whonix would need at least some basic support. In worst case it would say it doesn’t work on Non-Qubes-Whonix but I guess Non-Qubes-Whonix will already have similar functionality to Qubes-Whonix wrt to onionjuggler.</p>
<p>Quote <a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler" class="inline-onebox">GitHub - nyxnor/onionjuggler: Manage your Onion Services via CLI or TUI on Unix-like operating system with a POSIX compliant shell.</a></p>
<blockquote>
<p>WARNING: do not trust this repo yet, backup your hs keys in another location. This project has not been released and should be considered for development only.</p>
</blockquote>
<p>Does this still apply?</p>
<p><a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/raw/main/images/tui-whiptail.png">https://github.com/nyxnor/onionjuggler/raw/main/images/tui-whiptail.png</a> looks nice.</p>
<p><a href="../../../external.html?link=https://github.com/nyxnor/onionjuggler/raw/main/images/cli.png">https://github.com/nyxnor/onionjuggler/raw/main/images/cli.png</a> looks also nice.</p>
<p>Does the command <code>backup</code> work in Whonix?</p>
<p>What would the <code>vanguards</code> command do inside Whonix?</p>
<p>What about other commands?</p>
<p>Always with the question in mind for each command, what if the user runs that command in the wrong VM? WIll onionjuggler bail out with an error message?</p>
<p>Also helpful would be a wiki page in Whonix wiki. Should I create one and could you document some examples please?</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nyxnor'><span itemprop='name'>nyxnor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-19T16:46:09Z' class='post-time'>
                September 19, 2022,  4:46pm
              </time>
              <meta itemprop='dateModified' content='2022-09-19T16:46:09Z'>
          <span itemprop='position'>#57</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I have to update the readme…</p>
<aside class="quote no-group quote-modified" data-username="Patrick" data-post="56" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<blockquote>
<p>WARNING: do not trust this repo yet, backup your hs keys in another location. This project has not been released and should be considered for development only.</p>
</blockquote>
<p>Does this still apply?</p>
</blockquote>
</aside>
<p>No, the problem was that the TUI was buggy when the dialog was missing options, making the service name appear wrong, and could lead to wrong purging of keys.</p>
<p>This passed but I didn’t remove the warning because, well, it is better if someone else then me test, because developers are normally blind on the code they see everyday.</p>
<p>Using onionjuggler on Whonix made I improve onionjuggler usability overall by separating scripts and manuals to different files instead of one big file as it was in the beginning. So I’d say it is running smoothly for me, but if you find any problems, comment.</p>
<aside class="quote no-group" data-username="Patrick" data-post="56" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Does the command <code>backup</code> work in Whonix?</p>
<p>What would the <code>vanguards</code> command do inside Whonix?</p>
</blockquote>
</aside>
<p>Photos need to be updated also, it still looks like that, but without the <code>vanguards</code> and <code>backup</code>. I removed them</p>
<ul>
<li>vanguards had no recently signed git tag</li>
<li>backup was too difficult to manage, to reintegrate mostly without overwriting files.</li>
</ul>
<aside class="quote no-group" data-username="Patrick" data-post="56" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>What about other commands?</p>
<p>Always with the question in mind for each command, what if the user runs that command in the wrong VM? WIll onionjuggler bail out with an error message?</p>
</blockquote>
</aside>
<p>Yes, <a href="../../../external.html?link=https://github.com/Whonix/anon-apps-config/blob/master/etc/onionjuggler/conf.d/30_whonix.conf#L29" class="inline-onebox" rel="noopener nofollow ugc">anon-apps-config/30_whonix.conf at master · Whonix/anon-apps-config · GitHub</a><br>
<a href="../../../external.html?link=https://github.com/Whonix/anon-apps-config/blob/master/etc/onionjuggler/conf.d/30_whonix.conf#L54" class="inline-onebox" rel="noopener nofollow ugc">anon-apps-config/30_whonix.conf at master · Whonix/anon-apps-config · GitHub</a></p>
<p>Only the enabled plugins will be able to run, if not, exit with error message that plugin is deactivated.</p>
<p>onion authentication via files can’t be run from the workstation, just the gateway.</p>
<p>web (nginx) script is enforced via that config to only run on the workstation, because as it is a simple script to create a webserver, if user really wants to create it on the gateway, then that is their task to do it manually.</p>
<aside class="quote no-group" data-username="Patrick" data-post="56" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>What about other commands?</p>
</blockquote>
</aside>
<p>Everything that can be run from the cli, can be run from the tui.<br>
This is a design goal and is actually difficult to make because the TUI  has to adapt depending on what scripts are available, which services, files, authorizations exist.</p>
<p>I’d say the the CLI is pumping but the TUI needs some work on the code, although it is working, it needs to use more functions to return instead of large if else statements.</p>
<aside class="quote no-group" data-username="Patrick" data-post="56" data-topic="9117">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Also helpful would be a wiki page in Whonix wiki. Should I create one and could you document some examples please?</p>
</blockquote>
</aside>
<p>Yes, I can document all examples.<br>
The commands are almost the same as on plain debian, except the target host that is most of the times the workstation or enforce to run service on the gateway with the <code>--gateway</code> option.</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-19T17:13:38Z' class='post-time'>
                September 19, 2022,  5:13pm
              </time>
              <meta itemprop='dateModified' content='2022-09-19T17:13:38Z'>
          <span itemprop='position'>#58</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Now on a second thought, once review is done and onionjugger is installed by default, would it be better to edit <a href="../../../external.html?link=https://www.whonix.org/wiki/Onion_Services" class="inline-onebox">Onion Services - Whonix</a> instead? Then the current manual instructions could be moved to wiki/Deprecated/Onion_Services.</p>
<p>That is only if onionjugger could completely (and reliably) replace the manual onion setup instructions currently on wiki/Onion_Services. (Not a problem is not.)</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nyxnor'><span itemprop='name'>nyxnor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="9117.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2022-09-19T17:35:36Z' class='post-time'>
                September 19, 2022,  5:35pm
              </time>
              <meta itemprop='dateModified' content='2022-09-19T17:35:36Z'>
          <span itemprop='position'>#59</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Hm.</p>
<p>I think it should be on the <code>Onion Services</code> whonix page, but not get rid of it.</p>
<p>It can reliably and completely do all of the steps shown on that page.</p>
<p>But that guide is useful if someone wants to learn how to do it, instead of just running a script that does every step.</p>
<p>So I think it is best to add a section of <code>automated onion service management</code> instead of replacing the manual steps.</p>
        </div>

        <meta itemprop='headline' content='Improve Onion Service Usability by Script / GUI'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="91174658.html?page=2">← previous page</a></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>kernel.deny_new_usb sysctl to deny new USB devices</title>
    <link>http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928</link>
    <description>linux-hardened exposes a `kernel.deny_new_usb` sysctl to deny new USB devices. This defaults to being disabled but we might want to enable this to block any USB-based attacks.

There&#39;s multiple ways we can go about this.

1) Enable it normally in /etc/sysctl.d.

2) Patch it so the default is enabled (this would just change a single number, not a big change). This is better than (1) as it&#39;d prevent attacks that happen before the sysctl is set.

3) Tie it into the lockscreen so whenever the lockscreen is being used, new USB devices are denied. This would prevent anyone from inserting a malicious USB as soon as the user leaves their device. This is what GrapheneOS does and seems to be the most user-friendly approach. https://github.com/AndroidHardeningArchive/documentation/blob/master/technical_overview.md#attack-surface-reduction</description>
    <language>en</language>
    <lastBuildDate>Sat, 15 Feb 2020 20:51:31 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>kernel.deny_new_usb sysctl to deny new USB devices</title>
        <dc:creator><![CDATA[madaidan]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="9" data-topic="8928">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>It is only used in function <code>hub_port_connect</code> which, correct me if I am wrong, is probably parsed at every boot for every port. By booting with <code>deny_new_usb</code> we would effectively block all USB.</p>
</blockquote>
</aside>
<p><code>hub_port_connect</code> is only called by <code>hub_port_connect_change</code> which is only called if something <em>changes</em>. In <code>port_event</code>:</p>
<pre><code class="lang-auto">if (connect_change)
                hub_port_connect_change(hub, port1, portstatus, portchange);
</code></pre>
<p>i.e. if a new device is removed/added which wasn’t there to begin with (I think). Although I’m not entirely sure on this. We’d need to test.</p>
          <p><a href="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/10</link>
        <pubDate>Sat, 15 Feb 2020 20:51:31 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8928-10</guid>
        <source url="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928.rss">kernel.deny_new_usb sysctl to deny new USB devices</source>
      </item>
      <item>
        <title>kernel.deny_new_usb sysctl to deny new USB devices</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Looks really good overall.</p>
<p>Though a bit far in future (after <a href="https://phabricator.whonix.org/T961">https://phabricator.whonix.org/T961</a> and <a href="https://phabricator.whonix.org/T960">https://phabricator.whonix.org/T960</a>).</p>
<aside class="quote no-group" data-username="madaidan" data-post="1" data-topic="8928">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Patch it so the default is enabled (this would just change a single number, not a big change). This is better than (1) as it’d prevent attacks that happen before the sysctl is set.</p>
</blockquote>
</aside>
<p>Not sure that would be a trivial patch. I like the initiative of deny_new_usb but does not seem to have a complex state new vs old USB. (I am not suggesting it should.)</p>
<pre><code>kernel/sysctl.c:int deny_new_usb __read_mostly = 0;
kernel/sysctl.c:EXPORT_SYMBOL(deny_new_usb);
kernel/sysctl.c:                .procname       = "deny_new_usb",
kernel/sysctl.c:                .data           = &amp;deny_new_usb,
drivers/usb/core/hub.c:extern int deny_new_usb;
drivers/usb/core/hub.c: if (deny_new_usb) {
</code></pre>
<p>It is only used in function <code>hub_port_connect</code> which, correct me if I am wrong, is probably parsed at every boot for every port. By booting with <code>deny_new_usb</code> we would effectively block all USB.</p>
<aside class="quote no-group" data-username="madaidan" data-post="1" data-topic="8928">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Enable it normally in /etc/sysctl.d.</p>
</blockquote>
</aside>
<p>Also when reading about <code>deny_new_usb</code> suggests that init scripts (systemd) should set this.</p>
<hr>
<p>Proposal:</p>
<ul>
<li>
<code>deny_new_usb</code> after boot completed</li>
<li>set <code>deny_new_usb</code> when lockscreen</li>
<li>This could use a systray to indicate status and to easily toggle (left click) new USB disable/enable.</li>
<li>Enable action should have a timeout and notification how long until auto disable and timeout.</li>
</ul>
<p>There is a systray for i3 here:</p>
<p><a href="https://blog.lizzie.io/preventing-usb-attacks-with-linux-hardened.html" class="onebox" target="_blank">https://blog.lizzie.io/preventing-usb-attacks-with-linux-hardened.html</a></p>
<p>But we’d need a systray for XFCE.</p>
<p>Example XFCE systray (although that does not have clickable actions).</p>
<ul>
<li><a href="https://github.com/Whonix/whonix-xfce-desktop-config/blob/master/etc/skel/.config/xfce4/panel/genmon-12.rc">https://github.com/Whonix/whonix-xfce-desktop-config/blob/master/etc/skel/.config/xfce4/panel/genmon-12.rc</a></li>
<li><a href="https://github.com/Whonix/whonix-xfce-desktop-config/blob/master/usr/share/livecheck/livecheck.sh">https://github.com/Whonix/whonix-xfce-desktop-config/blob/master/usr/share/livecheck/livecheck.sh</a></li>
</ul>
<p>Related:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://github.githubassets.com/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://github.com/anthraxx/usbctl" target="_blank">GitHub</a>
  </header>
  <article class="onebox-body">
    <img src="https://avatars2.githubusercontent.com/u/203012?s=400&amp;v=4" class="thumbnail" width="" height="">

<h3><a href="https://github.com/anthraxx/usbctl" target="_blank">anthraxx/usbctl</a></h3>

<p>Linux-hardened deny_new_usb control. Contribute to anthraxx/usbctl development by creating an account on GitHub.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p><a href="https://www.whonix.org/wiki/FAQ#Patches_are_Welcome">Patches welcome.</a></p>
          <p><a href="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/9</link>
        <pubDate>Sat, 15 Feb 2020 20:22:59 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8928-9</guid>
        <source url="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928.rss">kernel.deny_new_usb sysctl to deny new USB devices</source>
      </item>
      <item>
        <title>kernel.deny_new_usb sysctl to deny new USB devices</title>
        <dc:creator><![CDATA[madaidan]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="7" data-topic="8928">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>What about those users who only have keyboards / mice which are internally connected by USB? At first boot they would be presented with a broken system?</p>
</blockquote>
</aside>
<p>All devices connected at boot should be allowed. Any connected after boot should be denied.</p>
<aside class="quote no-group" data-username="Patrick" data-post="7" data-topic="8928">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Could a sysctl still undo this? I.e. we could boot with this kernel boot parameter and then users could switch the sysctl to allow new USB devices?</p>
</blockquote>
</aside>
<p>Yes.</p>
          <p><a href="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/8</link>
        <pubDate>Sat, 15 Feb 2020 17:37:21 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8928-8</guid>
        <source url="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928.rss">kernel.deny_new_usb sysctl to deny new USB devices</source>
      </item>
      <item>
        <title>kernel.deny_new_usb sysctl to deny new USB devices</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>What about those users who only have keyboards / mice which are internally connected by USB? At first boot they would be presented with a broken system?</p>
<aside class="quote no-group" data-username="madaidan" data-post="1" data-topic="8928">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Patch it so the default is enabled (this would just change a single number, not a big change). This is better than (1) as it’d prevent attacks that happen before the sysctl is set.</p>
</blockquote>
</aside>
<p>Could a sysctl still undo this? I.e. we could boot with this kernel boot parameter and then users could switch the sysctl to allow new USB devices?</p>
          <p><a href="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/7</link>
        <pubDate>Sat, 15 Feb 2020 12:57:34 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8928-7</guid>
        <source url="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928.rss">kernel.deny_new_usb sysctl to deny new USB devices</source>
      </item>
      <item>
        <title>kernel.deny_new_usb sysctl to deny new USB devices</title>
        <dc:creator><![CDATA[madaidan]]></dc:creator>
        <description><![CDATA[
            <p>If you’re asking whether they can exploit the underlying hardware/firmware, then the answer is probably yes but that’s out of our reach and the only mitigation at that point is ripping out your USB ports.</p>
<p>I also find it really unlikely they’d even attempt to exploit that when the kernel USB stack is a far more promising target as it has plenty of vulnerabilities found regularly (syzbot found over 80 vulns soon after it started fuzzing the USB stack and that was just the start).</p>
<p>If you’re asking whether they can still exploit the kernel, then no. The kernel attack surface is only really exposed once the USB is recognized by the kernel.</p>
          <p><a href="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/6</link>
        <pubDate>Fri, 14 Feb 2020 19:11:36 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8928-6</guid>
        <source url="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928.rss">kernel.deny_new_usb sysctl to deny new USB devices</source>
      </item>
      <item>
        <title>kernel.deny_new_usb sysctl to deny new USB devices</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Question is if malicious USBs can exploit the underlying USB PCI bus without ever being acknowledged/seen/loaded by the kernel.</p>
          <p><a href="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/5</link>
        <pubDate>Fri, 14 Feb 2020 19:02:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8928-5</guid>
        <source url="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928.rss">kernel.deny_new_usb sysctl to deny new USB devices</source>
      </item>
      <item>
        <title>kernel.deny_new_usb sysctl to deny new USB devices</title>
        <dc:creator><![CDATA[madaidan]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="3" data-topic="8928">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>An USB device gets attached which then exploits a vulnerability in the kernel?</p>
</blockquote>
</aside>
<p>Yes. USB adds a lot of local attack surface and are commonly used in attacks. See e.g. <a href="https://en.wikipedia.org/wiki/Stuxnet">Stuxnet</a> or <a href="https://arstechnica.com/information-technology/2014/07/this-thumbdrive-hacks-computers-badusb-exploit-makes-devices-turn-evil/">BadUSB</a></p>
<aside class="quote no-group" data-username="Patrick" data-post="3" data-topic="8928">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Or <a href="https://shop.hak5.org/products/usb-rubber-ducky-deluxe">USB Rubber Ducky</a>?</p>
</blockquote>
</aside>
<p>Rubber duckies automatically exploit a vulnerability once plugged in. It’s not an “or”, it’s the same thing.</p>
<aside class="quote no-group" data-username="Patrick" data-post="3" data-topic="8928">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Implies that there is some kind of per VM filtering? How does that work?</p>
</blockquote>
</aside>
<p>Qubes requires you to specifically passthrough USBs to a VM.</p>
<aside class="quote no-group" data-username="Patrick" data-post="3" data-topic="8928">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>It denies “new USB”. How are “old USB” configured?</p>
</blockquote>
</aside>
<p>“old USB” means before the sysctl is set and “new USB” is after the sysctl is set.</p>
<aside class="quote no-group" data-username="Patrick" data-post="3" data-topic="8928">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>How would users allow an USB device?</p>
</blockquote>
</aside>
<p>They can temporarily disable deny_new_usb and re-enable it after plugging their USB in.</p>
          <p><a href="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/4</link>
        <pubDate>Fri, 14 Feb 2020 17:19:01 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8928-4</guid>
        <source url="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928.rss">kernel.deny_new_usb sysctl to deny new USB devices</source>
      </item>
      <item>
        <title>kernel.deny_new_usb sysctl to deny new USB devices</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Blockers before this can be worked at:</p>
<ul>
<li>fixing USB (auto) mounting generally as per <a href="https://forums.whonix.org/t/disk-usb-automount-in-kicksecure/8728/23" class="inline-onebox">Disk &amp; USB Automount in Kicksecure</a>
</li>
</ul>
<p>Things which can be done before this gets important:</p>
<ul>
<li><a href="https://phabricator.whonix.org/T960">T960: hardened kernel Debian packaging and APT integration - hkapt</a></li>
</ul>
<aside class="quote no-group" data-username="madaidan" data-post="1" data-topic="8928">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>This is better than (1) as it’d prevent attacks that happen before the sysctl is set.</p>
</blockquote>
</aside>
<p>Could you please describe what kind of attack you mean or give an example?</p>
<p>An USB device gets attached which then exploits a vulnerability in the kernel?</p>
<p>Quote <a href="https://www.qubes-os.org/doc/device-handling-security/#usb-security">https://www.qubes-os.org/doc/device-handling-security/#usb-security</a></p>
<blockquote>
<p>USB Security</p>
<p>The connection of an untrusted USB device to dom0 is a security risk since the device can attack an arbitrary USB driver (which are included in the linux kernel), exploit bugs during partition-table-parsing or simply pretend to be a keyboard. There are many ready-to-use implementations of such attacks, e.g. a <a href="https://shop.hak5.org/products/usb-rubber-ducky-deluxe">USB Rubber Ducky</a>. The whole USB stack is put to work to parse the data presented by the USB device in order to determine if it is a USB mass storage device, to read its configuration, etc. This happens even if the drive is then assigned and mounted in another qube.</p>
<p>To avoid this risk, use a <a href="https://www.qubes-os.org/doc/usb-qubes/">USB qube</a>.</p>
<p>Attaching a USB device to a VM (USB passthrough) will <strong>expose your target qube</strong> to most of the <a href="https://blog.invisiblethings.org/2011/05/31/usb-security-challenges.html">security issues</a> associated with the USB-stack. If possible, use a method specific for particular device type (for example, block devices described above), instead of this generic one.</p>
</blockquote>
<p>Or <a href="https://shop.hak5.org/products/usb-rubber-ducky-deluxe">USB Rubber Ducky</a>?</p>
<p>Which classes of attack is this supposed to prevent?</p>
<p>Implies that there is some kind of per VM filtering? How does that work?</p>
<p>It denies “new USB”. How are “old USB” configured? How would users allow an USB device?</p>
<aside class="quote no-group" data-username="HulaHoop" data-post="2" data-topic="8928" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Much easier to manage than the annoyaning restrictions we have</p>
</blockquote>
</aside>
<p>No, not necessarily.<br>
There is no such thing as “restrictions we have” related to USB. The only conscious change was thunar USB auto mounting disabling.</p>
<p>Otherwise “restrictions we have” is technically undefined. It’s not yet clear what causes these issues. Therefore “don’t do what we do now” and “do it as in this thread” isn’t possible because “don’t do what we do now” prerequisites knowledge of “what do we do now?”.</p>
<p>“don’t do what we do now” also mixes together security hardening changes which were applied for reason totally unrelated to USB such as proc-hidepid.</p>
<p>There is no way to skip the details of this forum thread <a href="https://forums.whonix.org/t/disk-usb-automount-in-kicksecure/8728/23" class="inline-onebox">Disk &amp; USB Automount in Kicksecure</a> and to generally say “doing as in this thread is better”.</p>
<p>I wouldn’t underestimate the difficulty of what is proposed in this forum thread either. I haven’t used this yet but looking at the documentation here (says “As of Jan 31, 2019, the information in this section has been deprecated. It may or may not be relevant for contemporary usage. Handle with care!”) does not look trivial either:</p>
<p><a href="https://wiki.gentoo.org/wiki/Allow_only_known_usb_devices" class="onebox" target="_blank">https://wiki.gentoo.org/wiki/Allow_only_known_usb_devices</a></p>
          <p><a href="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/3</link>
        <pubDate>Fri, 14 Feb 2020 04:33:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8928-3</guid>
        <source url="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928.rss">kernel.deny_new_usb sysctl to deny new USB devices</source>
      </item>
      <item>
        <title>kernel.deny_new_usb sysctl to deny new USB devices</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Much easier to manage than the annoyaning restrictions we have</p>
          <p><a href="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/2</link>
        <pubDate>Thu, 13 Feb 2020 23:24:01 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8928-2</guid>
        <source url="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928.rss">kernel.deny_new_usb sysctl to deny new USB devices</source>
      </item>
      <item>
        <title>kernel.deny_new_usb sysctl to deny new USB devices</title>
        <dc:creator><![CDATA[madaidan]]></dc:creator>
        <description><![CDATA[
            <p>linux-hardened exposes a <code>kernel.deny_new_usb</code> sysctl to deny new USB devices. This defaults to being disabled but we might want to enable this to block any USB-based attacks.</p>
<p>There’s multiple ways we can go about this.</p>
<ol>
<li>
<p>Enable it normally in /etc/sysctl.d.</p>
</li>
<li>
<p>Patch it so the default is enabled (this would just change a single number, not a big change). This is better than (1) as it’d prevent attacks that happen before the sysctl is set.</p>
</li>
<li>
<p>Tie it into the lockscreen so whenever the lockscreen is being used, new USB devices are denied. This would prevent anyone from inserting a malicious USB as soon as the user leaves their device. This is what GrapheneOS does and seems to be the most user-friendly approach. <a href="https://github.com/AndroidHardeningArchive/documentation/blob/master/technical_overview.md#attack-surface-reduction">https://github.com/AndroidHardeningArchive/documentation/blob/master/technical_overview.md#attack-surface-reduction</a></p>
</li>
</ol>
          <p><a href="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928/1</link>
        <pubDate>Wed, 12 Feb 2020 19:41:22 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8928-1</guid>
        <source url="http://forums.whonix.org/t/kernel-deny-new-usb-sysctl-to-deny-new-usb-devices/8928.rss">kernel.deny_new_usb sysctl to deny new USB devices</source>
      </item>
  </channel>
</rss>

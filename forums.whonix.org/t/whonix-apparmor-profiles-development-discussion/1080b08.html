<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Whonix AppArmor Profiles Development Discussion - AppArmor - Whonix Forum</title>
    <meta name="description" content="This thread is a continuation of https://www.whonix.org/forum/index.php/topic,24.0.html, with a more appropriate subject description. The profiles are in https://www.whonix.org/wiki/AppArmor. Anyone ready to use them for&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="1080b08.html?page=9" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Whonix AppArmor Profiles Development Discussion&#39;" href="108.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/whonix-apparmor-profiles-development-discussion/108?page=9" />
<meta name="twitter:url" content="https://forums.whonix.org/t/whonix-apparmor-profiles-development-discussion/108?page=9" />
<meta property="og:title" content="Whonix AppArmor Profiles Development Discussion" />
<meta name="twitter:title" content="Whonix AppArmor Profiles Development Discussion" />
<meta property="og:description" content="Further simplified packaging. Updated my post above." />
<meta name="twitter:description" content="Further simplified packaging. Updated my post above." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="154 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="50 ❤" />
<meta property="article:published_time" content="2014-04-26T10:26:33+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="108fdfa.html?page=8">
        <link rel="next" href="1081448.html?page=10">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="108.html">Whonix AppArmor Profiles Development Discussion</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/apparmor/14.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #12A89D'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>AppArmor</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-26T10:26:33Z' class='post-time'>
                April 26, 2014, 10:26am
              </time>
              <meta itemprop='dateModified' content='2014-04-26T10:26:33Z'>
          <span itemprop='position'>#161</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Further simplified packaging. Updated my post above.</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-29T19:34:05Z' class='post-time'>
                April 29, 2014,  7:34pm
              </time>
              <meta itemprop='dateModified' content='2014-04-29T19:34:05Z'>
          <span itemprop='position'>#162</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Tested again <a href="../../../external.html?link=https://github.com/Whonix/apparmor-profile-torbrowser">https://github.com/Whonix/apparmor-profile-torbrowser</a>. Works very well for me. Maybe soon we can call for wider testing?</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/troubadour'><span itemprop='name'>troubadour</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-29T21:19:35Z' class='post-time'>
                April 29, 2014,  9:19pm
              </time>
              <meta itemprop='dateModified' content='2014-04-29T21:19:35Z'>
          <span itemprop='position'>#163</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Works well for me too. One missing piece though.</p>
<p>I did the following:</p>
<ul>
<li>
<p>./build -us -uc      #  ./build - <a href="mailto:mymail@mail.com">mymail@mail.com</a> does not work.<br>
The profile  is in the the source etc/</p>
</li>
<li>
<p>dpkg -i apparmor-profile-torbrowser_0.1-1_all.deb<br>
dpkg reports an apparmor_parser error, not finding abstractions/whonix<br>
The profile is in /etc/apparmor.d</p>
</li>
</ul>
<p>But before delving further into the intricacies of debian packaging,  one important question: How do you update the profiles? In the earlier version, there was a file home.user.tor-browser… that I could edit.</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="3" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-29T21:38:42Z' class='post-time'>
                April 29, 2014,  9:38pm
              </time>
              <meta itemprop='dateModified' content='2014-04-29T21:38:42Z'>
          <span itemprop='position'>#164</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Answering the easy question first.</p>
<aside class="quote" data-post="163" data-topic="108">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/t/d9b06d/40.png" class="avatar"> troubadour:</div>
<blockquote>
<p>But before delving further into the intricacies of debian packaging,  one important question: How do you update the profiles? In the earlier version, there was a file home.user.tor-browser… that I could edit.</p>
</blockquote>
</aside>
<p>It’s here.</p>
<p><code>apparmor-profile-torbrowser/etc/apparmor.d/home.user.tor-browser_en-US.Browser.firefox
apparmor-profile-torbrowser/etc/apparmor.d/local/home.user.tor-browser_en-US.Browser.firefox</code></p>
<p>And gets installed to.</p>
<p><code>/etc/apparmor.d/home.user.tor-browser_en-US.Browser.firefox
/etc/apparmor.d/local/home.user.tor-browser_en-US.Browser.firefox</code></p>
<p>Isn’t that awesome? Minimal overhead for packaging.  <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-29T21:42:00Z' class='post-time'>
                April 29, 2014,  9:42pm
              </time>
              <meta itemprop='dateModified' content='2014-04-29T21:42:00Z'>
          <span itemprop='position'>#165</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="163" data-topic="108">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/t/d9b06d/40.png" class="avatar"> troubadour:</div>
<blockquote>
<p>#  ./build - <a href="mailto:mymail@mail.com">mymail@mail.com</a> does not work.</p>
</blockquote>
</aside>
<p>The syntax is a bit weird (not my idea, using what Debian provides). It is “-m” directly followed without space by your e-mail address. Try this. Note the bold part.</p>
<p><span class="bbcode-b">./build -m</span><a href="mailto:mymail@mail.com">mymail@mail.com</a></p>
<p>[And you need a gpg key with that e-mail address in ~/.gnupg [configurable].]</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-29T21:51:41Z' class='post-time'>
                April 29, 2014,  9:51pm
              </time>
              <meta itemprop='dateModified' content='2014-04-29T21:51:41Z'>
          <span itemprop='position'>#166</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“troubadour, post:163, topic:108”]- dpkg -i apparmor-profile-torbrowser_0.1-1_all.deb<br>
dpkg reports an apparmor_parser error, not finding abstractions/whonix<br>
The profile is in /etc/apparmor.d[/quote]</p>
<p>I guess this is a problem with the AppArmor profile apparmor-profile-torbrowser/etc/apparmor.d/home.user.tor-browser_en-US.Browser.firefox because it does “<span class="hashtag">#include</span> &lt;abstractions/whonix&gt;”.</p>
<p>Are you sure you have a /etc/apparmor.d/abstractions/whonix file?</p>
<p>If I don’t have one, I get your error.</p>
<p>[code]sudo mv /etc/apparmor.d/abstractions/whonix /etc/apparmor.d/abstractions/whonix_</p>
<p>ls /etc/apparmor.d/abstractions/whonix<br>
ls: cannot access /etc/apparmor.d/abstractions/whonix: No such file or directory</p>
<p>sudo dpkg -i apparmor-profile-torbrowser_0.1-1_all.deb<br>
(Reading database … 136023 files and directories currently installed.)<br>
Preparing to replace apparmor-profile-torbrowser 0.1-1 (using apparmor-profile-torbrowser_0.1-1_all.deb) …<br>
Unpacking replacement apparmor-profile-torbrowser …<br>
Setting up apparmor-profile-torbrowser (0.1-1) …<br>
AppArmor parser error for /etc/apparmor.d/home.user.tor-browser_en-US.Browser.firefox in /etc/apparmor.d/home.user.tor-browser_en-US.Browser.firefox at line 14: Could not open ‘abstractions/whonix’[/code]</p>
<p>But if I have one, it works for me.</p>
<p>[code]sudo mv /etc/apparmor.d/abstractions/whonix_ /etc/apparmor.d/abstractions/whonix</p>
<p>ls /etc/apparmor.d/abstractions/whonix<br>
/etc/apparmor.d/abstractions/whonix</p>
<p>sudo dpkg -i apparmor-profile-torbrowser_0.1-1_all.deb<br>
(Reading database … 136023 files and directories currently installed.)<br>
Preparing to replace apparmor-profile-torbrowser 0.1-1 (using apparmor-profile-torbrowser_0.1-1_all.deb) …<br>
Unpacking replacement apparmor-profile-torbrowser …<br>
Setting up apparmor-profile-torbrowser (0.1-1) …<br>
[/code]</p>
<p>I guess this problem with be temporarily solved when you re-create /etc/apparmor.d/abstractions/whonix or when apparmor-profile-torbrowser/etc/apparmor.d/home.user.tor-browser_en-US.Browser.firefox no longer sources abstractions/whonix, when the whonix specific thing became it’s own profile (the old idea, you know, the one we discussed earlier).</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/troubadour'><span itemprop='name'>troubadour</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-29T22:09:26Z' class='post-time'>
                April 29, 2014, 10:09pm
              </time>
              <meta itemprop='dateModified' content='2014-04-29T22:09:26Z'>
          <span itemprop='position'>#167</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>Isn't that awesome? Minimal overhead for packaging.  :)</blockquote>
<p>Yes, awesome! It’s making life much easier, and I will be able to package the other profiles, too.<br>
And ./build -m… works, so the package is signed with my key. I thought the ‘m’ was a typo in your first post.</p>
<p>Very encouraging.</p>
<blockquote>Are you sure you have a /etc/apparmor.d/abstractions/whonix file?</blockquote>
<p>No, my mistake. I am running with a fresh workstation because I had a strange problem with a Python IDE (eric), and after trying everything I could think of, I reinstalled the whole workstation, and had not reinstalled the apparmor profiles.</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/troubadour'><span itemprop='name'>troubadour</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-30T16:39:26Z' class='post-time'>
                April 30, 2014,  4:39pm
              </time>
              <meta itemprop='dateModified' content='2014-04-30T16:39:26Z'>
          <span itemprop='position'>#168</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>I guess this problem with be temporarily solved when you re-create /etc/apparmor.d/abstractions/whonix or when apparmor-profile-torbrowser/etc/apparmor.d/home.user.tor-browser_en-US.Browser.firefox no longer sources abstractions/whonix, when the whonix specific thing became it's own profile (the old idea, you know, the one we discussed earlier).</blockquote>
<p>I realize that the big problem with abstractions/whonix is that if the file is not included in the distribution, apparmor_parser replace will fail. I will try to include the whonix profile as a child profile in TBB first. As far as I know, apparmor_parser does not care whether the allowed/denied files exist or not, as long as the masks are understood. It will still show in the profile to advanced or curious users, but it should be packaged transparently.</p>
<p>In the meantime, I have tried to package apparmor-profile-torbrowser with abstractions/whonix, adding it to the source etc. Not possible. This is for my own enlightement  :), correct me where I’m wrong. The postinst part is managed by dh_apparmor, including the folders where to install the files (/etc/apparmor.d and /etc/apparmor.d/local), and they are the only folders we should allow to update. Realistically, we cannot tamper with the abstractions, because they are written upstream.<br>
Conclusion: abstractions/whonix is definitely out.</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/troubadour'><span itemprop='name'>troubadour</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-30T21:04:03Z' class='post-time'>
                April 30, 2014,  9:04pm
              </time>
              <meta itemprop='dateModified' content='2014-04-30T21:04:03Z'>
          <span itemprop='position'>#169</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“troubadour, post:168, topic:108”][quote]<br>
I will try to include the whonix profile as a child profile in TBB first. As far as I know, apparmor_parser does not care whether the allowed/denied files exist or not, as long as the masks are understood. It will still show in the profile to advanced or curious users, but it should be packaged transparently.<br>
[/quote][/quote]</p>
<p>The latter is true, but as to include a child profile, why not use the local profile.</p>
<p>Digest. abstractions/whonix is no longer an alternative. Nor is the whonix profile. At best, with ‘/*’, it has no effect. At worst, if i push it to ‘/**’, it has a regrettable tendency to crash the workstation beyond recoverability.</p>
<p>I have moved the content of local/home.user.tor-browser_en-US.Browser.firefox back into the main profile and pasted the content of abstractions/whonix in the local profile, then removed the line ‘<span class="hashtag">#include</span> &lt;abstractions/whonix&gt;’.</p>
<p>With hindsight, that is probably what I should have done from the beginning.</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/troubadour'><span itemprop='name'>troubadour</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-30T22:07:51Z' class='post-time'>
                April 30, 2014, 10:07pm
              </time>
              <meta itemprop='dateModified' content='2014-04-30T22:07:51Z'>
          <span itemprop='position'>#170</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Now, trying to build the modified profile package. Following debian/gain-root-command:</p>
<pre><code class="lang-auto">make clean
make[1]: Entering directory `/home/user/apparmor-profile-torbrowser'
make[1]: Warning: File `Makefile' has modification time 0.44 s in the future
git clean -df
make[1]: warning:  Clock skew detected.  Your build may be incomplete.
make[1]: Leaving directory `/home/user/apparmor-profile-torbrowser'
 dpkg-source -b apparmor-profile-torbrowser
dpkg-source: info: using source format `3.0 (quilt)'
dpkg-source: info: building apparmor-profile-torbrowser using existing ./apparmor-profile-torbrowser_0.1.orig.tar.gz
dpkg-source: info: local changes detected, the modified files are:
 apparmor-profile-torbrowser/etc/apparmor.d/home.user.tor-browser_en-US.Browser.firefox
 apparmor-profile-torbrowser/etc/apparmor.d/local/home.user.tor-browser_en-US.Browser.firefox
dpkg-source: error: aborting due to unexpected upstream changes, see /tmp/apparmor-profile-torbrowser_0.1-1.diff.zg6_wB
dpkg-source: info: you can integrate the local changes with dpkg-source --commit
dpkg-buildpackage: error: dpkg-source -b apparmor-profile-torbrowser gave error exit status 2
debuild: fatal error at line 1357:
dpkg-buildpackage -rdebian/gain-root-command -D -us -uc -sa -mtrobador@riseup.net failed
+ '[' '!' 29 = 0 ']'
+ exit 1</code></pre>
<p>There is “aborting due to unexpected upstream changes”.<br>
If I try to modify changelog with dch according to the literature in  /tmp/apparmor-profile-torbrowser_0.1-1.diff.hGsTAX, it results in a parsing error.</p>
<p>Should I commit first, without modifications?</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-30T23:44:33Z' class='post-time'>
                April 30, 2014, 11:44pm
              </time>
              <meta itemprop='dateModified' content='2014-04-30T23:44:33Z'>
          <span itemprop='position'>#171</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="170" data-topic="108">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/t/d9b06d/40.png" class="avatar"> troubadour:</div>
<blockquote>
<p>There is “aborting due to unexpected upstream changes”.</p>
</blockquote>
</aside>
<p>After making changes to any files in the source folder, you need to commit them before you can use ./build again. Otherwise you get this error.</p>
<p>Background:<br>
Debian wants an upstream tarball. This is quite messy imho nowadays. The upstream tarball is created deterministically using git archive in the build script (you won’t notice). It’s all a bit messy, but that’s it. I wouldn’t know how to make it any less messy than it currently is. Already tried to make it as generic as possible. You get used to it.</p>
<p>Slightly advanced git stuff:<br>
To clean the history, for testing, I usually create a temporary branch. Ex:<br>
git branch test<br>
git checkout test<br>
git status<br>
git commit -a -m .<br>
./build<br>
git commit -a -m .<br>
./build<br>
git checkout master<br>
git merge --squash test<br>
git status<br>
git commit<br>
git branch -D test</p>
<aside class="quote" data-post="170" data-topic="108">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/t/d9b06d/40.png" class="avatar"> troubadour:</div>
<blockquote>
<p>If I try to modify changelog with dch according to the literature in  /tmp/apparmor-profile-torbrowser_0.1-1.diff.hGsTAX, it results in a parsing error.</p>
</blockquote>
</aside>
<p>No need to edit any files in /tmp/.</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-04-30T23:57:32Z' class='post-time'>
                April 30, 2014, 11:57pm
              </time>
              <meta itemprop='dateModified' content='2014-04-30T23:57:32Z'>
          <span itemprop='position'>#172</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="168" data-topic="108">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/t/d9b06d/40.png" class="avatar"> troubadour:</div>
<blockquote>
<p>I realize that the big problem with abstractions/whonix is that if the file is not included in the distribution,</p>
</blockquote>
</aside>
<p>Yes. I’d prefer if we somehow manage to have nothing “whonix” inside apparmor-profile-torbrowser. [Otherwise we would have apparmor-profile-torbrowser to depend on a apparmor-profile-whonix profile, which would be bad, since then the profile wouldn’t be usable outside Whonix.] Souring abstractions/whonix from apparmor-profile-torbrowser is indeed bad.</p>
<blockquote>In the meantime, I have tried to package apparmor-profile-torbrowser with abstractions/whonix, adding it to the source etc. Not possible. This is for my own enlightement  :), correct me where I'm wrong.</blockquote>
Just for enlightenment: You could create a folder in apparmor-profile-torbrowser/etc/apparmor.d/abstractions and drop a file apparmor-profile-torbrowser/etc/apparmor.d/abstractions/whonix there. It should be installed just fine by dpkg.
<blockquote>The postinst part is managed by dh_apparmor, including the folders where to install the files (/etc/apparmor.d and /etc/apparmor.d/local), and they are the only folders we should allow to update.</blockquote>
I think /etc/apparmor.d is okay to be used by packages such as apparmor-profile-torbrowser, but /etc/apparmor.d/local/ is only for users. We should avoid the latter if possible.
<blockquote>Realistically, we cannot tamper with the abstractions, because they are written upstream.
Conclusion: abstractions/whonix is definitely out.</blockquote>
Yes.
<blockquote>why not use the local profile.</blockquote>
Because the latter is for the user. The user should be able to make local additions/changes, which won't conflict with any changes by us. If possible, we should avoid the local profile. As last resort, it would be in violation of debian policy but within the freedom of being a debian derivative to use the local folder.
<blockquote>At worst, if i push it to '/**', it has a regrettable tendency to crash the workstation beyond recoverability.</blockquote>
Are you sure this isn't happening by chance? I am willing to test this in one of my less important workstation VMs. Can you post the /etc/apparmor.d/whonix with '/**' that we would like to use?
<p>I will be deleting /etc/apparmor.d/abstractions/whonix and testing the following + apparmor-profile-torbrowser.</p>
<pre><code class="lang-auto">## This file is part of Whonix.
## Copyright (C) 2012 - 2014 Patrick Schleizer &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions.

## Whonix AppArmor Profile

## Workaround for: config-package-dev clashes with AppArmor profiles
## https://github.com/Whonix/Whonix/issues/66

/* {
   /etc/hosts.whonix r,
   /etc/resolv.conf.whonix r,

   @{HOME}/.whonix/* rwk,

   /etc/whonix.d/ r,
   /etc/whonix.d/* r,

   /etc/hosts.whonix r,
   /etc/resolv.conf.whonix r,

   /usr/bin/gpg.whonix rix,
   /usr/bin/gpg.whonix-orig rix,

   /usr/lib/whonix/confirm_open rix,
   /usr/lib/whonix/uwtwrapper rix,
   /var/lib/whonix/whonixblog/ r,

   /usr/share/whonix/kde/share/config/kdeglobals r,
}

## End of Whonix AppArmor Profile</code></pre>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-05-01T00:04:55Z' class='post-time'>
                May 1, 2014, 12:04am
              </time>
              <meta itemprop='dateModified' content='2014-05-01T00:04:55Z'>
          <span itemprop='position'>#173</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Okay, I changed to ‘/**’  and removed “@{HOME}/.whonix/* rwk,”…</p>
<p>Then I keep getting.</p>
<pre><code class="lang-auto"></code></pre>
<p>VM crashed. This is strange.</p>
<p>Is this a bug in AppArmor or something very wrong with the profile?</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-05-01T00:18:44Z' class='post-time'>
                May 1, 2014, 12:18am
              </time>
              <meta itemprop='dateModified' content='2014-05-01T00:18:44Z'>
          <span itemprop='position'>#174</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Could be recovered by booting in recovery mode and “aa-disable /etc/apparmor.d/whonix”.</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-05-01T00:20:49Z' class='post-time'>
                May 1, 2014, 12:20am
              </time>
              <meta itemprop='dateModified' content='2014-05-01T00:20:49Z'>
          <span itemprop='position'>#175</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Can you ask please on AppArmor list please if it’s possible to create a global profile? (For our /etc/apparmor.d/whonix /** use case?)</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/troubadour'><span itemprop='name'>troubadour</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-05-01T16:38:33Z' class='post-time'>
                May 1, 2014,  4:38pm
              </time>
              <meta itemprop='dateModified' content='2014-05-01T16:38:33Z'>
          <span itemprop='position'>#176</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>Can you post the /etc/apparmor.d/whonix with '/**' that we would like to use?</blockquote>
<p>I am using the content of abstractions/whonix, like you.</p>
<blockquote>Then I keep getting.
<pre><code class="lang-auto">error while loading shared libraries: libselinux.so.1: cannot open shared object file: No such file or directory</code></pre>
<p>VM crashed. This is strange.</p>
<p>Is this a bug in AppArmor or something very wrong with the profile?</p>
</blockquote>
<p>Same error here, and  VM crashing. I don’t think there is anything wrong with the profile. I have tried</p>
<pre><code class="lang-auto">/** { }</code></pre>
<p>with the same result.</p>
<p>May be a bug in AppArmor, but I doubt it. When declaring /** as profile name , we are trying to confine the whole disk, probably with unexpected consequences. Also, as far as I remember, the use of wildcards is not authorized in the profile name. We talked about it for home.user.tor-browser_*.Browser.firefox. Now, as the wildcard is not inserted inside the name, it seems to be accepted by apparmor_parser.</p>
<p>I did ask on the AppArmor list, but so far, I had zero success with my inquiries. I’m on the apparmor IRC channel, there is a better chance to get a reply there, I think (if someone shows up).</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/troubadour'><span itemprop='name'>troubadour</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-05-03T22:29:41Z' class='post-time'>
                May 3, 2014, 10:29pm
              </time>
              <meta itemprop='dateModified' content='2014-05-03T22:29:41Z'>
          <span itemprop='position'>#177</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Had chat with jjohansen on the apparmor IRC channel.</p>
<p>An excerpt.</p>
<blockquote> I thought about it and here is what I think is going on
 once /** is loaded just about everything is confined (early init may not be, unless you have it reexec it self, or explicitly change its profile)
 some programs will link to libselinux and use that to detect if selinux is available
 they will use it to change their behavior, examples would be
   dbus passing the security context through, and doing selinux policy modiation
   gnome displaying the security context in the file info dialog
   ls showing the security label on a file
 your profile (/**) isn't allowing access to libselinux, so these apps, die instead of continuing
   its likely they are just using the dynamic linker, and making the library a hard dependency (that is the symbol is required vs weak)
 the reason you need recovery mode is because the apparmor profile is being every time you reboot</blockquote>
<p>For the sake of trying, I have added ‘/lib/i386-linux-gnu/* mrix,’ in the profile. Then any command outputs ‘permission denied’. Allowed the whole /usr/bin/ and /usr/sbin without change.</p>
<p>I do not think we can push further in that direction as we would end up allowing the entire file system.</p>
<p>For the moment, the solution seems to be a local profile for each profile. I do not know what Debian’s position is, or how edgy they are when it comes to packaging for them, but they do package all the Ubuntu abstractions. We do not add an abstraction, we just call a local profile without any reference to Whonix in the main profile. The local profile may be empty, that won’t make a difference when running the profile outside Whonix.</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-05-04T10:19:49Z' class='post-time'>
                May 4, 2014, 10:19am
              </time>
              <meta itemprop='dateModified' content='2014-05-04T10:19:49Z'>
          <span itemprop='position'>#178</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Debian is very picky. I am quite sure, they won’t allow shipping local profiles.</p>
<p>To keep the Whonix-specific stuff out of apparmor-profile-torbrowser I have another idea.</p>
<p>apparmor-profile-torbrowser profile does…</p>
<p><code>        #include &lt;abstractions/base&gt;
        #include &lt;abstractions/user-tmp&gt;
        #include &lt;abstractions/bash&gt;
        #include &lt;abstractions/fonts&gt;
        #include &lt;abstractions/kde&gt;
        #include &lt;abstractions/gnome&gt;
        #include &lt;abstractions/audio&gt;
        #include &lt;abstractions/freedesktop.org&gt;
        #include &lt;abstractions/user-download&gt;</code></p>
<p>Do all profiles created by you share a common abstractions/… file? abstractions/base perhaps?</p>
<p>We could displace abstractions/base using config-package-dev. A package apparmor-profile-whonix could take over ownership of abstractions/base. Then we add Whonix specific stuff to the bottom of abstractions/base.</p>
<p>Whonix is doing this with a few files already. See Whonix-Gateway “ls /usr/share/tor/tor-service-defaults-torrc*”.</p>
<ul>
<li>When Debian pushes an upgrade, it will go to /usr/share/tor/tor-service-defaults-torrc.whonix-orig.</li>
<li>When Whonix pushes and upgrade, it will go to /usr/share/tor/tor-service-defaults-torrc.whonix.</li>
<li>/usr/share/tor/tor-service-defaults-torrc is a symlink to /usr/share/tor/tor-service-defaults-torrc.whonix</li>
</ul>
<p>Very clean, simple and robust solution so far. Disadvantage: when Debian upgrades /usr/share/tor/tor-service-defaults-torrc.whonix-orig, it must be manually checked if these changes have to be added to /usr/share/tor/tor-service-defaults-torrc.whonix.</p>
<p>This is easy to package once you got the hang for it. I can easily do this if it looks like an okay solution. In case of apparmor-profile-whonix it would be even easier to maintain. /etc/apparmor.d/abstractions/base.whonix could include /etc/apparmor.d/abstractions/base.whonix-orig. So when Debian upgrades abstractions/base, we don’t have to update Whonix’s displaced version. If it sounds too theoretic, I can do a proof of concept.</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/troubadour'><span itemprop='name'>troubadour</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-05-05T21:19:51Z' class='post-time'>
                May 5, 2014,  9:19pm
              </time>
              <meta itemprop='dateModified' content='2014-05-05T21:19:51Z'>
          <span itemprop='position'>#179</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Updated the Tor Browser profile.</p>
<p>‘/etc/gai.conf’ required when setting transparent torification. I use a VPN when the Debian wiki bans Tor, once in a while. Have you experienced that?</p>
<p>Looking into your abstraction/base displacement. It looks sound. First of all, all the profiles use abstractions/base.</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="108.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-05-05T21:43:11Z' class='post-time'>
                May 5, 2014,  9:43pm
              </time>
              <meta itemprop='dateModified' content='2014-05-05T21:43:11Z'>
          <span itemprop='position'>#180</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="179" data-topic="108">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/t/d9b06d/40.png" class="avatar"> troubadour:</div>
<blockquote>
<p>I use a VPN when the Debian wiki bans Tor, once in a while. Have you experienced that?</p>
</blockquote>
</aside>
<p>Yes. I am using startpage proxy in that case.</p>
<aside class="quote" data-post="179" data-topic="108">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/t/d9b06d/40.png" class="avatar"> troubadour:</div>
<blockquote>
<p>Looking into your abstraction/base displacement. It looks sound. First of all, all the profiles use abstractions/base.</p>
</blockquote>
</aside>
<p>Good, will be done shortly.</p>
        </div>

        <meta itemprop='headline' content='Whonix AppArmor Profiles Development Discussion'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="108fdfa.html?page=8">← previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="1081448.html?page=10">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset - Support - Whonix Forum</title>
    <meta name="description" content="Hello everyone. 
I have some slight trouble getting Whonix with ‚ÄúVPN Before Tor‚Äù (User -&amp;gt; VPN -&amp;gt; Tor -&amp;gt; Internet) working. 
I have followed this guide https://www.whonix.org/wiki/Tunnels/Connecting_to_a_VPN_before_Tor ex&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="63384658.html?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset&#39;" href="6338.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/unable-to-get-vpn-before-tor-user-vpn-tor-internet-working-network-interfaces-are-reset/6338?page=2" />
<meta name="twitter:url" content="https://forums.whonix.org/t/unable-to-get-vpn-before-tor-user-vpn-tor-internet-working-network-interfaces-are-reset/6338?page=2" />
<meta property="og:title" content="Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset" />
<meta name="twitter:title" content="Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset" />
<meta property="og:description" content="Thanks for the help.  Comment out, granted, I meant comment in, of course, sorry about that.  I don‚Äôt understand the steps under ‚ÄúFirewall settings‚Äù:  First it says to edit: /etc/whonix_firewall.d/50_user.conf  Then it says to edit (when I expand it, I can‚Äôt believe I overlooked that): /etc/whonix_firewall.d/30_default.conf  Which file should I edit?  I tried removing /etc/whonix_firewall.d/50_user.conf and instead adding VPN_FIREWALL=1 to /etc/whonix_firewall.d/30_default.conf  Still not workin..." />
<meta name="twitter:description" content="Thanks for the help.  Comment out, granted, I meant comment in, of course, sorry about that.  I don‚Äôt understand the steps under ‚ÄúFirewall settings‚Äù:  First it says to edit: /etc/whonix_firewall.d/50_user.conf  Then it says to edit (when I expand it, I can‚Äôt believe I overlooked that): /etc/whonix_firewall.d/30_default.conf  Which file should I edit?  I tried removing /etc/whonix_firewall.d/50_user.conf and instead adding VPN_FIREWALL=1 to /etc/whonix_firewall.d/30_default.conf  Still not workin..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="16 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="26 ‚ù§" />
<meta property="article:published_time" content="2018-11-22T13:34:55+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="6338.html">
        <link rel="next" href="63389ba9.html?page=3">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="6338.html">Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/support/5.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #8C6238'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Support</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/rob75'><span itemprop='name'>rob75</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-22T13:34:55Z' class='post-time'>
                November 22, 2018,  1:34pm
              </time>
              <meta itemprop='dateModified' content='2018-11-22T13:34:55Z'>
          <span itemprop='position'>#22</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Thanks for the help.</p>
<p>Comment out, granted, I meant comment in, of course, sorry about that.</p>
<p>I don‚Äôt understand the steps under ‚ÄúFirewall settings‚Äù:</p>
<p>First it says to edit: /etc/whonix_firewall.d/50_user.conf<br>
Then it says to edit (when I expand it, I can‚Äôt believe I overlooked that): /etc/whonix_firewall.d/30_default.conf</p>
<p>Which file should I edit?</p>
<p>I tried removing /etc/whonix_firewall.d/50_user.conf and instead adding VPN_FIREWALL=1 to /etc/whonix_firewall.d/30_default.conf</p>
<p>Still not working, same problem.</p>
<p>Still working on the logs, sorry this takes a while.</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/rob75'><span itemprop='name'>rob75</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-22T14:54:49Z' class='post-time'>
                November 22, 2018,  2:54pm
              </time>
              <meta itemprop='dateModified' content='2018-11-22T15:19:25Z'>
          <span itemprop='position'>#23</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>This isn‚Äôt easy.</p>
<p>If I try just running openvpn manually, it doesn‚Äôt work. I get write UDP not allowed. I run it as sudo -u tunnel, then I get the ioctl TUNSETIFF error.</p>
<p>Note that it runs fine with systemctl start.</p>
<p>Then I tried editing the file /lib/systemd/system/openvpn@openvpn.service and adding a --log argument to the openvpn ExecStart line. I reload systemd and try executing openvpn through systemd start openvpn@openvpn.</p>
<p>However, this does nothing (no logging, and systemctl status shows it ran without even giving the --log argument ‚Ä¶). I‚Äôm not experienced enough with systemd to figure this out right off the bat.</p>
<p>Edits:</p>
<p>I can verify now that systemctl DOES run with the correct argument, and I‚Äôm logging under /tmp/logs/openvpn.log, however, there‚Äôs nothing there.</p>
<p>I check the process‚Äô file descriptors: /proc/4524/fd, and there‚Äôs nothing. No open descriptors to the /tmp/logs/openvpn.log</p>
<p>I can hardly believe the amount of work I have to put in to make this work.</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/rob75'><span itemprop='name'>rob75</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-22T15:28:20Z' class='post-time'>
                November 22, 2018,  3:28pm
              </time>
              <meta itemprop='dateModified' content='2018-11-22T17:36:01Z'>
          <span itemprop='position'>#24</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I think I‚Äôll just manually add in the capabilities required again with setcap.</p>
<p>Edits:</p>
<p>I need some more advice to make progress I think.</p>
<p>I cannot reproduce the problem when I run openvpn, tor, and sdwdate manually. I have logging working now, but I had to use setcap to manually change permissions, so I‚Äôm not sure of the validity of the test either.</p>
<p>As it is now, sdwdate gives:</p>
<p>sdwdate - WARNING - Tor Bootstrap Result: Tor‚Äôs Control Port could not be reached.</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/0brand'><span itemprop='name'>0brand</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-23T01:40:12Z' class='post-time'>
                November 23, 2018,  1:40am
              </time>
              <meta itemprop='dateModified' content='2018-11-23T01:40:12Z'>
          <span itemprop='position'>#25</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Instead of importing the Whonix images every time you want a clean VM, you can use <a href="../../../external.html?link=https://whonix.org/wiki/Whonix-Workstation_Security#VM_Snapshots">VM snapshots</a>. Take a snapshot before configuring your VPN. If you want to start over, just revert to the last snapshot.</p>
<p><a href="../../../external.html?link=https://www.howtogeek.com/150258/how-to-save-time-by-using-snapshots-in-virtualbox/">https://www.howtogeek.com/150258/how-to-save-time-by-using-snapshots-in-virtualbox/</a></p>
<hr>
<aside class="quote no-group" data-post="22" data-topic="6338">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/r/d6d6ee/40.png" class="avatar"> rob75:</div>
<blockquote>
<p>First it says to edit: /etc/whonix_firewall.d/50_user.conf</p>
</blockquote>
</aside>
<p><code>sudo nano /etc/whonix_firewall.d/50_user.conf</code></p>
<p>Add.</p>
<p><code>VPN_FIREWALL=1</code></p>
<p>Next, reload Firewall</p>
<p><code>sudo whonix_firewall</code></p>
<p>For you can run the following commads for VPN (<a href="../../../external.html?link=https://whonix.org/wiki/Tunnels/Connecting_to_a_VPN_before_Tor#debug_start">debug</a>) The last command will give you the log output. (Does this work for you?)</p>
<p><code>sudo /usr/sbin/openvpn --rmtun --dev tun0</code></p>
<p><code>sudo /usr/sbin/openvpn --mktun --dev tun0 --dev-type tun --user tunnel --group tunnel</code></p>
<p><code>cd /etc/openvpn/</code></p>
<p><code>sudo -u tunnel openvpn /etc/openvpn/openvpn.conf</code></p>
<hr>
<p>Thought it would be a good idea to make sure you are not missing anything and we are on the same page) When you get to the end, or you come across a problem, <strong>Stop</strong> don‚Äôt make <strong>any</strong> changes.  A fix early on can bread something later. Lets debug from that point. Logs will be needed. The commands for VPN debug (above) will be Ok if the VPN does not function. If the VPN <strong>is</strong> functional move on to Enable Tor (step 9).</p>
<p>For Tor logs.</p>
<p><code>cat /var/run/tor/log</code></p>
<p>For sdwdate logs</p>
<p><code>cat /var/log/sdwdate.log</code></p>
<p><strong>Note:</strong> Reinstalling Whonix is not necessary.But remove any settings not provided in the instructions</p>
<p><strong>1.</strong> Firewall settings</p>
<p><code>sudo nano /etc/whonix_firewall.d/50_user.conf</code></p>
<p>add</p>
<p><code>VPN_FIREWALL=1</code></p>
<p><strong>2.</strong> Reload firewall</p>
<p><code>sudo whonix_firewall</code></p>
<p><strong>3.</strong> Sudoers configuration</p>
<p><code>sudo nano /etc/sudoers.d/tunnel_unpriv</code></p>
<p>Add</p>
<p><code>tunnel ALL=(ALL) NOPASSWD: /bin/ip</code><br>
<code>tunnel ALL=(ALL) NOPASSWD: /usr/sbin/openvpn *</code><br>
<code>Defaults:tunnel !requiretty</code></p>
<p><strong>4.</strong> Create VPN secrets file.</p>
<p><code>sudo nano /etc/openvpn/auth.txt</code></p>
<p>Add</p>
<p>user_name<br>
password</p>
<p><strong>5.</strong> Set up VPN configuration file.</p>
<p><code>sudo nano /etc/openvpn/openvpn.conf</code></p>
<p>Add your config file.</p>
<p><strong>6.</strong> Set folder permissions</p>
<p><code>sudo chown -R tunnel:tunnel /etc/openvpn</code></p>
<p><code>sudo chown -R tunnel:tunnel /var/run/openvpn</code></p>
<p><strong>7.</strong> Create the OpenVPN systemd service file.</p>
<p><code>sudo cp /lib/systemd/system/openvpn@.service /lib/systemd/system/openvpn@openvpn.service</code></p>
<p><strong>Enable</strong> the OpenVPN systemd service file.</p>
<p><code>sudo systemctl enable openvpn@openvpn</code></p>
<p><strong>Start</strong> the OpenVPN systemd service.</p>
<p><code>sudo systemctl start openvpn@openvpn</code></p>
<p><strong>Check</strong> the OpenVPN systemd service status.</p>
<p><code>sudo systemctl status openvpn@openvpn</code></p>
<p><strong>8.</strong> Enable Tor</p>
<p><code>sudo whonixsetup</code></p>
<p><strong>9.</strong> (optional)Force Tor to wait for OpenVPN.</p>
<p><strong>Create</strong> a folder /etc/systemd/system/tor.service.d.</p>
<p><code>sudo mkdir /etc/systemd/system/tor.service.d</code></p>
<p><strong>Create</strong> a file /etc/systemd/system/tor.service.d/50_user.conf.</p>
<p><code>sudo nano /etc/systemd/system/tor.service.d/50_user.conf</code></p>
<p>Add</p>
<p><code>[Unit] After=openvpn.service</code></p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/rob75'><span itemprop='name'>rob75</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-23T06:10:01Z' class='post-time'>
                November 23, 2018,  6:10am
              </time>
              <meta itemprop='dateModified' content='2018-11-23T06:10:01Z'>
          <span itemprop='position'>#26</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I‚Äôm now using snapshots, thanks.</p>
<p>I will stop at the first problem I encounter now.</p>
<p>I might actually be encountering a problem very early on.</p>
<aside class="quote no-group">
<blockquote>
<p><code>sudo nano /etc/whonix_firewall.d/50_user.conf</code></p>
<p>Add.</p>
<p><code>VPN_FIREWALL=1</code></p>
<p>Next, reload Firewall</p>
<p><code>sudo whonix_firewall</code></p>
</blockquote>
</aside>
<p>Should this now be blocking traffic, since the VPN is not up yet? I can still browse through the Whonix gateway even after reloading the firewall. This doesn‚Äôt seem right.</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/0brand'><span itemprop='name'>0brand</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-23T21:51:01Z' class='post-time'>
                November 23, 2018,  9:51pm
              </time>
              <meta itemprop='dateModified' content='2018-11-23T21:51:01Z'>
          <span itemprop='position'>#27</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="26" data-topic="6338">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/r/d6d6ee/40.png" class="avatar"> rob75:</div>
<blockquote>
<p>Should this now be blocking traffic, since the VPN is not up yet? I can still browse through the Whonix gateway even after reloading the firewall. This doesn‚Äôt seem right.</p>
</blockquote>
</aside>
<p>Thats OK. Your VPN is not configured yet (no tun0 interface).</p>
<p>Might be of interest : <a href="../../../external.html?link=https://github.com/Whonix/whonix-firewall">https://github.com/Whonix/whonix-firewall</a></p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/rob75'><span itemprop='name'>rob75</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-24T20:17:38Z' class='post-time'>
                November 24, 2018,  8:17pm
              </time>
              <meta itemprop='dateModified' content='2018-11-24T20:17:38Z'>
          <span itemprop='position'>#28</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I‚Äôve gathered the logs now.</p>
<p>But now I‚Äôm faced with a new problem, how to get the logs off of the Whonix gateway.</p>
<p>I thought I would scp them over to a box on my LAN, I apt-get ssh, stop openvpn, stop tor, stop sdwdate, cleaned out all the iptables logs, I verify I can ping the machine, great, but then, when I ssh:</p>
<p>connection refused.</p>
<p>Works fine from other machines, there are no rules in iptables. What is blocking the access?</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/0brand'><span itemprop='name'>0brand</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-24T22:31:21Z' class='post-time'>
                November 24, 2018, 10:31pm
              </time>
              <meta itemprop='dateModified' content='2018-11-24T22:31:21Z'>
          <span itemprop='position'>#29</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Hi <code>rob75</code></p>
<p>You can use VirtualBox shared folders. Whonix-Gateway -&gt; Host -&gt; Whonix-Workstation</p>
<p><a href="../../../external.html?link=https://whonix.org/wiki/VirtualBox/Guest_Additions#For_Whonix_14_and_above">https://whonix.org/wiki/VirtualBox/Guest_Additions#For_Whonix_14_and_above</a></p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/rob75'><span itemprop='name'>rob75</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-25T07:32:07Z' class='post-time'>
                November 25, 2018,  7:32am
              </time>
              <meta itemprop='dateModified' content='2018-11-25T07:32:07Z'>
          <span itemprop='position'>#30</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I have now obtained the logs, thank you for your assistance so far.</p>
<p>Please note that after OpenVPN and Tor has started, I am online, everything works. I know I said this before but I just want to stress it. Again, if sdwdate is masked and never start, my problem never occurs.</p>
<p>I have tried setting the clock manually with date and hwclock --systohc, this doesn‚Äôt seem to change anything.</p>
<p>After sdwdate finishes, I get these:</p>
<p>pcnet32 0000:00:03.0 eth0: link up, 100Mbps, full-duplex<br>
pcnet32 0000:00:08.0 eth1: link up, 100Mbps, full-duplex</p>
<p>But they are not present in the logs, they are in dmesg and written to the console.</p>
<p>OpenVPN log: <a href="../../../external.html?link=https://pastebin.com/6h08zVWY" rel="nofollow noopener">https://pastebin.com/6h08zVWY</a><br>
Tor log: <a href="../../../external.html?link=https://pastebin.com/t1TLA1c9" rel="nofollow noopener">https://pastebin.com/t1TLA1c9</a><br>
sdwdate log: <a href="../../../external.html?link=https://pastebin.com/5emX9cbP" rel="nofollow noopener">https://pastebin.com/5emX9cbP</a></p>
<p>I‚Äôve allowed it to run for a while after it fails.</p>
<p>After 15:27:50 is when it fails and I get the pcnet32 dmesg problem.</p>
<p>sdwdate claims that:</p>
<p>2018-11-24 16:37:50 - sdwdate - WARNING - Clock got changed by something other than sdwdate. seconds_to_sleep: 4200 time_delta: 4201</p>
<p>Is it possible the network interfaces are forcibly reset (like ifconfig down/up or similar) when this warning is detected? Why the clock would get changed like, I have no idea.</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-25T10:43:00Z' class='post-time'>
                November 25, 2018, 10:43am
              </time>
              <meta itemprop='dateModified' content='2018-11-25T11:26:08Z'>
          <span itemprop='position'>#31</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>rob75:</p>
<blockquote>
<p>I‚Äôve gathered the logs now.</p>
<p>But now I‚Äôm faced with a new problem, how to get the logs off of the Whonix gateway.</p>
<p>I thought I would scp them over to a box on my LAN, I apt-get ssh, stop openvpn, stop tor, stop sdwdate, cleaned out all the iptables logs, I verify I can ping the machine, great, but then, when I ssh:</p>
<p>connection refused.</p>
<p>Works fine from other machines, there are no rules in iptables. What is blocking the access?</p>
</blockquote>
<p>Stream isolation. (See <a href="../../../external.html?link=https://www.whonix.org/wiki/Stream_Isolation">https://www.whonix.org/wiki/Stream_Isolation</a> .)</p>
<p>In short, to deactivate stream isolation, i.e. to prevent forcing<br>
through Tor (needed for local LAN connections) use:</p>
<pre><code>ssh.anondist-orig
</code></pre>
<p>Also you most likely need to run under user ‚Äúclearnet‚Äù, otherwise<br>
connection would be blocked by firewall.</p>
<pre><code>sudo -u clearnet ssh.anondist-orig
</code></pre>
<p>I wonder if we have this documented in the wiki somewhere? Some wiki<br>
entry to just quickly answer this very question?</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/0brand'><span itemprop='name'>0brand</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-25T11:18:00Z' class='post-time'>
                November 25, 2018, 11:18am
              </time>
              <meta itemprop='dateModified' content='2018-11-25T11:18:00Z'>
          <span itemprop='position'>#32</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="30" data-topic="6338">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/r/d6d6ee/40.png" class="avatar"> rob75:</div>
<blockquote>
<p>I have now obtained the logs, thank you for your assistance so far</p>
</blockquote>
</aside>
<p>No problem. Thanks for all the efforts with the logs and debugging. When I have something I will let you know. (see if I can reproduce behavior)</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/0brand'><span itemprop='name'>0brand</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-27T11:19:11Z' class='post-time'>
                November 27, 2018, 11:19am
              </time>
              <meta itemprop='dateModified' content='2018-11-27T11:19:11Z'>
          <span itemprop='position'>#33</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Hi <code>rob75</code></p>
<p>Do you have a firewall on you host?</p>
<p>Could you please provide VPN logs from when sdwdate is disabled. Meaning disable sdwdate then restart Whonix-Gateway then get the logs. Sorry, I know this is a PITA.</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/rob75'><span itemprop='name'>rob75</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-27T15:28:56Z' class='post-time'>
                November 27, 2018,  3:28pm
              </time>
              <meta itemprop='dateModified' content='2018-11-27T15:28:56Z'>
          <span itemprop='position'>#34</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>If by host you mean the Whonix gateway, then not that I‚Äôm aware of. It is just a standard Whonix gateway install.</p>
<p>My Whonix gateway is connected to a typical wireless router, my Whonix gateway is on the LAN side of this, so the whonix gateway performs standard NAT as needed.</p>
<p>There are no issues with multiple other systems using the same Internet connection.</p>
<p>I will get the logs you‚Äôre asking for.</p>
<p>I will do it by doing systemctl mask sdwdate, mask tor, mask openvpn, then reboot the system.</p>
<p>Then I will start openvpn manually as you described before, and then systemctl unmask and start tor.</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/rob75'><span itemprop='name'>rob75</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-27T23:51:35Z' class='post-time'>
                November 27, 2018, 11:51pm
              </time>
              <meta itemprop='dateModified' content='2018-11-27T23:51:35Z'>
          <span itemprop='position'>#35</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Here are the new logs.</p>
<p>OpenVPN: <a href="../../../external.html?link=https://pastebin.com/AVDPFuq9" rel="nofollow noopener">https://pastebin.com/AVDPFuq9</a><br>
Tor: <a href="../../../external.html?link=https://pastebin.com/SS4hKFWm" rel="nofollow noopener">https://pastebin.com/SS4hKFWm</a></p>
<p>sdwdate is disabled/masked.</p>
<p>Nothing happens. I‚Äôve verified with the Whonix gateway that everything is working as it should.</p>
<p>I let it run for a while just to show that the VPN connection rekeys itself but this is normal behavior.</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/0brand'><span itemprop='name'>0brand</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-28T01:31:35Z' class='post-time'>
                November 28, 2018,  1:31am
              </time>
              <meta itemprop='dateModified' content='2018-11-28T01:31:35Z'>
          <span itemprop='position'>#36</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="34" data-topic="6338">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/r/d6d6ee/40.png" class="avatar"> rob75:</div>
<blockquote>
<p>If by host you mean the Whonix gateway, then not that I‚Äôm aware of. It is just a standard Whonix gateway install.</p>
</blockquote>
</aside>
<p><a href="../../../external.html?link=https://www.techopedia.com/definition/15763/host-operating-system">Host</a> OS. Such as Ubuntu,Debian, Windows.</p>
<p><a href="../../../external.html?link=https://www.techopedia.com/definition/16576/guest-operating-system-guest-os">Guest </a> OS. Such as Whonix-Gateway,Whonix-Workstation.</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/rob75'><span itemprop='name'>rob75</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-28T08:39:54Z' class='post-time'>
                November 28, 2018,  8:39am
              </time>
              <meta itemprop='dateModified' content='2018-11-28T08:39:54Z'>
          <span itemprop='position'>#37</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Ah of course, no, there is no firewall on the host.</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/0brand'><span itemprop='name'>0brand</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-29T00:16:46Z' class='post-time'>
                November 29, 2018, 12:16am
              </time>
              <meta itemprop='dateModified' content='2018-11-29T00:16:46Z'>
          <span itemprop='position'>#38</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Hi <code>rob75</code></p>
<p>Just to recap:</p>
<p><strong>1.</strong> OpenVPN and Tor connect when Whonix-Gateway first starts.<br>
<strong>2.</strong> ~ 120 to 240 seconds later you see this in <code>dmesg</code> and at the same time the OpenVPN connection goes down.</p>
<blockquote>
<p>pcnet32 0000:00:03.0 eth0: link up, 100Mbps, full-duplex<br>
pcnet32 0000:00:08.0 eth1: link up, 100Mbps, full-duplex</p>
</blockquote>
<p><strong>3.</strong> You are able to reconnect the VPN but disconnection continues to happen at the same time interval.<br>
<strong>4.</strong> This problem is remedied by disabling <code>sdwdate</code></p>
<hr>
<p>I wasn‚Äôt able to produce any of the same behavior until I saw this.</p>
<aside class="quote no-group" data-post="17" data-topic="6338">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/r/d6d6ee/40.png" class="avatar"> rob75:</div>
<blockquote>
<p><strong>I do:</strong></p>
<p><strong>ifconfig</strong>, and see tun0 is up and has an IP.</p>
</blockquote>
</aside>
<p>When I run <code>sudo ifconfig</code> I get interesting results.</p>
<p><a href="../../../external.html?link=https://pastebin.com/RXDJ0ynn">https://pastebin.com/RXDJ0ynn</a></p>
<p>While I didn‚Äôt produce the exact behavior i.e. No VPN connected issue. This issue continued to be a problem on concurrent VM boots.This might be causing an problem with time sync and/or whonix_firewall.</p>
<p>To be clear, ifconfig shouldn‚Äôt cause an issue. But possible running before whonix_firewall is loaded is interfering somehow.</p>
<p>I‚Äôll have to test more.</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/rob75'><span itemprop='name'>rob75</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-11-29T22:11:28Z' class='post-time'>
                November 29, 2018, 10:11pm
              </time>
              <meta itemprop='dateModified' content='2018-11-29T22:11:28Z'>
          <span itemprop='position'>#39</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Thanks for your patience and taking the time to help me.</p>
<p>Your summary is largely accurate.</p>
<p>1: Yes.</p>
<p>2: Yes.</p>
<p>3: Not really, after the pcnet32 issue, then it doesn‚Äôt reconnect, at all to my knowledge. However, if I do systemctl restart for both openvpn@openvpn and tor, a few times (back and forth), then things start working again.</p>
<p>4: Yes.</p>
<p>Ah, this happens regardless of me running ifconfig or not (between reboots and even between reinstalls of Whonix gateway).</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/rob75'><span itemprop='name'>rob75</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-12-05T18:13:46Z' class='post-time'>
                December 5, 2018,  6:13pm
              </time>
              <meta itemprop='dateModified' content='2018-12-05T18:13:46Z'>
          <span itemprop='position'>#40</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I want to say thanks for all the help so far.</p>
<p>However, I still have this problem. Should I file a bug report?</p>
<p>Could someone else, perhaps, please verify that what I‚Äôm doing works on their system?</p>
<p>I cannot believe that I‚Äôm still missing some simple step, which is the cause of all my issues with sdwdate. If I was, and I keep making the same mistake over and over when reinstalling the Whonix gateway, I would say it makes sense to assume others also have made the same mistake as I did.</p>
<p>It is probably in the interest of the community to point out this crucial step (if this is indeed the problem) that I‚Äôm making in the documentation so that others can avoid the same problem.</p>
<p>I can imagine that many simply give up when they encounter the problem.</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/0brand'><span itemprop='name'>0brand</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="6338.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-12-06T03:05:54Z' class='post-time'>
                December 6, 2018,  3:05am
              </time>
              <meta itemprop='dateModified' content='2018-12-06T03:05:54Z'>
          <span itemprop='position'>#41</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Hi <code>rob75</code></p>
<p>Could you try unloading the Apparmor sdwdate profile and see if that helps.  <a href="../../../external.html?link=https://whonix.org/wiki/AppArmor#Profile_Unloading">Apparmor profile unload</a>.</p>
<p>List the apparmor profiles</p>
<p><code>ls /etc/apparmor.d/</code></p>
<p>You should see output similar to this:</p>
<pre><code class="lang-auto">abstractions    local                usr.bin.whonixcheck.dpkg-old
cache           system_tor           usr.lib.onion-grater
disable         tunables             usr.lib.sdwdate.url_to_unixtime
force-complain  usr.bin.whonixcheck  usr.sbin.haveged
</code></pre>
<p>Using the  file above, this would unload the <code>sdwdate</code> profile.</p>
<p><code>sudo aa-disable /etc/apparmor.d/user.lib.sdwdate.url_to_unixtime</code></p>
<p>Now try running VPN with sdwate enabled.</p>
        </div>

        <meta itemprop='headline' content='Unable to get VPN Before Tor (User -&gt; VPN -&gt; Tor -&gt; Internet) working, network interfaces are reset'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="6338.html">‚Üê previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="63389ba9.html?page=3">next page ‚Üí</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>ClientOnionAuthDir in DispVM</title>
    <link>http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528</link>
    <description>How I can setup `ClientOnionAuthDir` in whonix DispVM in Qubes?

That I follow tor documentation for customer authorization in v3 hidden service, I to add this line to `/home/user/.tb/tor-browser/Browser/TorBrowser/Data/Tor/torrc`

```
ClientOnionAuthDir /home/user/keys
```

And I to key of customer to `/home/user/keys/`

Then I test to connect my service hidden. It not work. I test click New Identity for tor browser restarts. It not work. What I missing?

I notice I *can* connect my service hidden if I put configuration in `sys-whonix`. If I to add this to `/usr/local/etc/torrc.d/50_user.conf`

```
ClientOnionAuthDir /var/lib/tor/keys
```

And I to key of customer to `/var/lib/tor/keys/client.auth_private`. I confirm this work. I can connect my service hidden after restart tor.

What needed for to add `ClientOnionAuthDir` and key direct to whonix DispVM in Tor Browser config and no `sys-whonix`?</description>
    <language>en</language>
    <lastBuildDate>Sat, 23 Nov 2019 10:18:42 +0000</lastBuildDate>
    <category>Qubes-Whonix</category>
    <atom:link href="http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>ClientOnionAuthDir in DispVM</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="3" data-topic="8528">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/j/77aa72/40.png" class="avatar"> jhspyyrgxv:</div>
<blockquote>
<p>Why workstation have <code>torrc</code> file in directory of tor browser?</p>
</blockquote>
</aside>
<p>Technical reasons. To avoid modifications, because, see below…</p>
<aside class="quote no-group" data-post="3" data-topic="8528">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/j/77aa72/40.png" class="avatar"> jhspyyrgxv:</div>
<blockquote>
<p>If <code>/home/user/.tb/tor-browser/Browser/TorBrowser/Data/Tor/torrc</code> is 100% useless, the possible to not release whonix-ws with this file?</p>
</blockquote>
</aside>
<p>Possible in theory but better to keep modifications to Tor Browser as minimal as possible for better stability and easier review since lots of Tor Browser issues are already falsely attributed to Whonix.</p>
<ul>
<li><a href="https://www.whonix.org/wiki/FAQ#Tor_Browser">https://www.whonix.org/wiki/FAQ#Tor_Browser</a></li>
<li><a href="https://www.whonix.org/wiki/Tor_Browser#Whonix_.E2.84.A2_Tor_Browser_Differences">https://www.whonix.org/wiki/Tor_Browser#Whonix_.E2.84.A2_Tor_Browser_Differences</a></li>
<li><a href="https://www.whonix.org/wiki/Tor_Browser/Advanced_Users#Tor_Browser_Update:_Technical_Details">https://www.whonix.org/wiki/Tor_Browser/Advanced_Users#Tor_Browser_Update:_Technical_Details</a></li>
</ul>
<p>Modification of Tor Browser would further add to the confusion.</p>
<p>Messing with any files inside Tor Browser has potential to break it or break its internal updater. At very least, consequences would take time to research. More stable and time efficient o just keep it as is.</p>
<aside class="quote no-group" data-post="3" data-topic="8528">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/j/77aa72/40.png" class="avatar"> jhspyyrgxv:</div>
<blockquote>
<p>Why workstation have <code>torrc</code> file in directory of tor browser? It 100% useless?</p>
</blockquote>
</aside>
<p>Yes, Tor doesn’t run on Whonix-Workstation. Therefore that file has no effect.</p>
<aside class="quote no-group" data-post="3" data-topic="8528">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/j/77aa72/40.png" class="avatar"> jhspyyrgxv:</div>
<blockquote>
<p>Possible to keys running in whonix-workstation?</p>
</blockquote>
</aside>
<p>“Ephemeral” Tor onion services. Creation (and re-creation) of such onion services is started from inside Whonix-Workstation. A Tor aware application will use Tor control protocol commands to create it. The key is either discarded (temporary onion services) or retained by the application (restartable onion service with stable onion domain name). An example application is OnionShare.</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/OnionShare" target="_blank" title="11:57AM - 17 November 2019">Whonix – 17 Nov 19</a>
  </header>
  <article class="onebox-body">
    <img src="https://www.whonix.org/w/images/d/de/Onionshare_logo.png" class="thumbnail onebox-avatar" width="60" height="60">

<h3><a href="https://www.whonix.org/wiki/OnionShare" target="_blank">OnionShare</a></h3>

<p>Using OnionShare in Whonix ™.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-post="3" data-topic="8528">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/j/77aa72/40.png" class="avatar"> jhspyyrgxv:</div>
<blockquote>
<p>The possible has <code>ClientOnionAuthDir</code> configuration in <code>whonix-ws</code> at all?</p>
</blockquote>
</aside>
<p>Should be, because…</p>
<aside class="quote no-group" data-post="3" data-topic="8528">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/j/77aa72/40.png" class="avatar"> jhspyyrgxv:</div>
<blockquote>
<p>Unfortunately, whonix the documentation does not show how use <code>ClientOnionAuthDir</code> v3 hidden service.</p>
</blockquote>
</aside>
<p>Whonix does not modify Tor.<br>
<a href="https://www.whonix.org/wiki/Tor#Does_Whonix_.E2.84.A2_Modify_Tor.3F">https://www.whonix.org/wiki/Tor#Does_Whonix_.E2.84.A2_Modify_Tor.3F</a><br>
Should function the same.</p>
<p><a href="https://www.whonix.org/wiki/Onion_Services">https://www.whonix.org/wiki/Onion_Services</a> documents <code>HiddenServiceDir</code>.<br>
<code>ClientOnionAuthDir</code> should function similarly.</p>
<p>See <a href="https://www.whonix.org/wiki/Free_Support_Principle">https://www.whonix.org/wiki/Free_Support_Principle</a> - i.e. find out how to use this in an easier environment first. For example on non-Whonix, non Qubes. For example on Debian <code>buster</code>. If it works there, replicating the same in Whonix should be simple.</p>
<aside class="quote no-group" data-post="3" data-topic="8528">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/j/77aa72/40.png" class="avatar"> jhspyyrgxv:</div>
<blockquote>
<p>The very important that laptop not persisting for the key. This why I need in DispVM. Any ideas?</p>
</blockquote>
</aside>
<p>I don’t think <code>ClientOnionAuthDir</code> can be used in Whonix-Workstation.<br>
Whonix-Gateway only. Because it is a Tor config file based configuration.</p>
<p>See also:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Qubes/DisposableVM" target="_blank" title="09:36AM - 18 August 2019">Whonix – 18 Aug 19</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:101/109;"><img src="https://www.whonix.org/w/images/5/55/Qubes-logo-icon.png" class="thumbnail"></div>

<h3><a href="https://www.whonix.org/wiki/Qubes/DisposableVM" target="_blank">Qubes/DisposableVM</a></h3>

<p>How to use DisposableVMs in [[Qubes-Whonix|Qubes-Whonix ™]].</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>There, read:</p>
<blockquote>
<p>Ephemeral Whonix-Gateway ™ ProxyVMs</p>
</blockquote>
<aside class="quote no-group" data-post="3" data-topic="8528">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/j/77aa72/40.png" class="avatar"> jhspyyrgxv:</div>
<blockquote>
<p>The very important that laptop not persisting for the key. This why I need in DispVM. Any ideas?</p>
</blockquote>
</aside>
<p>Use ephemeral Tor onion services using Tor control protocol.</p>
<p>But still notice the forensics related warnings on <a href="https://www.whonix.org/wiki/Qubes/DisposableVM">https://www.whonix.org/wiki/Qubes/DisposableVM</a>.</p>
          <p><a href="http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528/4</link>
        <pubDate>Sat, 23 Nov 2019 10:18:42 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8528-4</guid>
        <source url="http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528.rss">ClientOnionAuthDir in DispVM</source>
      </item>
      <item>
        <title>ClientOnionAuthDir in DispVM</title>
        <dc:creator><![CDATA[jhspyyrgxv]]></dc:creator>
        <description><![CDATA[
            <blockquote>
<blockquote>
<p>/home/user/keys</p>
</blockquote>
</blockquote>
<blockquote>
<p>That won’t work out of the box due to mandatory access control.</p>
</blockquote>
<p>Yes! Thank you! I test movement to <code>/home/user/.tb/tor-browser/Browser/TorBrowser/Data/Tor/keys</code>. It do not work.</p>
<p>Possible to keys running in whonix-workstation?</p>
<p>It understands tor the service run in gateway no workstation. l work the configuration add to gateway. Now I want to work in workstation. Why workstation have <code>torrc</code> file in directory of tor browser? It 100% useless?</p>
<p>If <code>/home/user/.tb/tor-browser/Browser/TorBrowser/Data/Tor/torrc</code> is 100% useless, the possible to not release whonix-ws with this file? Otherwise, it appear this <code>torrc</code> file in whonix-ws provides configuration additional and override whonix-gw <code>torrc</code>.</p>
<blockquote>
<p>Also see the usual onion services documentation for seeing what does usually work how:</p>
</blockquote>
<p>Unfortunately, whonix the documentation does not show how use <code>ClientOnionAuthDir</code> v3 hidden service.</p>
<p>The possible has <code>ClientOnionAuthDir</code> configuration in <code>whonix-ws</code> at all? The very important that laptop not persisting for the key. This why I need in DispVM. Any ideas? Thank you.</p>
          <p><a href="http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528/3</link>
        <pubDate>Sat, 23 Nov 2019 06:34:19 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8528-3</guid>
        <source url="http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528.rss">ClientOnionAuthDir in DispVM</source>
      </item>
      <item>
        <title>ClientOnionAuthDir in DispVM</title>
        <dc:creator><![CDATA[Patrick_mobile]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="1" data-topic="8528">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/j/77aa72/40.png" class="avatar"> jhspyyrgxv:</div>
<blockquote>
<p>/home/user/.tb/tor-browser/Browser/TorBrowser/Data/Tor/torrc</p>
</blockquote>
</aside>
<p>That won’t work. No Tor running in workstation.</p>
<aside class="quote no-group" data-post="1" data-topic="8528">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/j/77aa72/40.png" class="avatar"> jhspyyrgxv:</div>
<blockquote>
<p>/home/user/keys</p>
</blockquote>
</aside>
<p>That won’t work out of the box due to mandatory access control.</p>
<p>First simplification for learning: try in non-disp, persistent VM first.</p>
<p>Also see the usual onion services documentation for seeing what does usually work how:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Onion_Services" target="_blank" title="05:55AM - 10 September 2019" rel="nofollow noopener">Whonix – 10 Sep 19</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:640/480;"><img src="https://www.whonix.org/w/images/1/12/Fly-agaric808110640.jpg" class="thumbnail"></div>

<h3><a href="https://www.whonix.org/wiki/Onion_Services" target="_blank" rel="nofollow noopener">Onion Services</a></h3>

<p>Anonymously host any server with Whonix ™ and Tor onion services</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528/2</link>
        <pubDate>Fri, 22 Nov 2019 16:26:32 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8528-2</guid>
        <source url="http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528.rss">ClientOnionAuthDir in DispVM</source>
      </item>
      <item>
        <title>ClientOnionAuthDir in DispVM</title>
        <dc:creator><![CDATA[jhspyyrgxv]]></dc:creator>
        <description><![CDATA[
            <p>How I can setup <code>ClientOnionAuthDir</code> in whonix DispVM in Qubes?</p>
<p>That I follow tor documentation for customer authorization in v3 hidden service, I to add this line to <code>/home/user/.tb/tor-browser/Browser/TorBrowser/Data/Tor/torrc</code></p>
<pre><code class="lang-auto">ClientOnionAuthDir /home/user/keys
</code></pre>
<p>And I to key of customer to <code>/home/user/keys/</code></p>
<p>Then I test to connect my service hidden. It not work. I test click New Identity for tor browser restarts. It not work. What I missing?</p>
<p>I notice I <em>can</em> connect my service hidden if I put configuration in <code>sys-whonix</code>. If I to add this to <code>/usr/local/etc/torrc.d/50_user.conf</code></p>
<pre><code class="lang-auto">ClientOnionAuthDir /var/lib/tor/keys
</code></pre>
<p>And I to key of customer to <code>/var/lib/tor/keys/client.auth_private</code>. I confirm this work. I can connect my service hidden after restart tor.</p>
<p>What needed for to add <code>ClientOnionAuthDir</code> and key direct to whonix DispVM in Tor Browser config and no <code>sys-whonix</code>?</p>
          <p><a href="http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528/1</link>
        <pubDate>Fri, 22 Nov 2019 15:26:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-8528-1</guid>
        <source url="http://forums.whonix.org/t/clientonionauthdir-in-dispvm/8528.rss">ClientOnionAuthDir in DispVM</source>
      </item>
  </channel>
</rss>

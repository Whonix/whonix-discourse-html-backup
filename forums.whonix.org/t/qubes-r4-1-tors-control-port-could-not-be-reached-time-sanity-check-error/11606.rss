<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</title>
    <link>http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606</link>
    <description>I have the latest packages installed in my GW and WS VM templates on Qubes 4.1, and I keep hitting this error in the WS VM:

    2021-05-05 14:53:15 - sdwdate - INFO - PREPARATION:
    2021-05-05 14:53:15 - sdwdate - INFO -
    /usr/lib/helper-scripts/onion-time-pre-script: Start.
    Static Time Sanity Check: Within minimum time &#39;Sun Jan 17 00:00:00 UTC 2021&#39; and expiration timestamp &#39;Tue May 17 10:00:00 UTC 2033&#39;, ok.
    Tor Bootstrap Result:    ERROR (124).
     Please report this bug!
    /usr/lib/helper-scripts/onion-time-pre-script: END: Exiting with exit_code &#39;1&#39; indicating &#39;wait, show error icon and retry.&#39;.
    2021-05-05 14:53:15 - sdwdate - INFO - PREPARATION RESULT: (known) ERROR.
    2021-05-05 14:53:15 - sdwdate - INFO -

`systemcheck` says that the gateway is running fine, but running it in the workstation says:

    [INFO] [systemcheck] Tor Connection Result:
    Tor&#39;s Control Port could not be reached. Attempt 1 of 5. Could be temporary due to a Tor restart. Trying again...</description>
    <language>en</language>
    <lastBuildDate>Fri, 28 May 2021 12:11:12 +0000</lastBuildDate>
    <category>Qubes-Whonix</category>
    <atom:link href="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p>Here’s why Whonix wasn’t working in Qubes R4.1 - some update set IPv6 to “1”. Unsetting that makes it work again FYI <a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a></p>
<aside class="onebox githubissue">
  <header class="source">

      <a href="https://github.com/QubesOS/qubes-issues/issues/6597" target="_blank" rel="noopener">github.com/QubesOS/qubes-issues</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue">
	  <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/QubesOS/qubes-issues/issues/6597" target="_blank" rel="noopener">4.1: Whonix WS failing</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2021-05-11" data-time="11:33:05" data-timezone="UTC">11:33AM - 11 May 21 UTC</span>
      </div>


      <div class="user">
        <a href="https://github.com/jpds" target="_blank" rel="noopener">
          <img alt="jpds" src="https://avatars.githubusercontent.com/u/29158971?v=4" class="onebox-avatar-inline" width="20" height="20">
          jpds
        </a>
      </div>
    </div>

    <div class="labels">
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">C: Whonix</span>
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">P: default</span>
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">T: bug</span>
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">diagnosed</span>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">**Qubes OS version**

4.1, all updates applied.

**Affected component(s) or <span class="show-more-container"><a href="http://forums.whonix.org" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">functionality**

Whonix Workstation.

**Brief summary**

I applied updates to my 4.1 system a couple of weeks ago, and ever since then, I've not been able to use my Whonix Workstation DVMs, running `systemcheck` in the DVM gives:

```
$ systemcheck 
[INFO] [systemcheck] disp891 | Whonix-Workstation | whonix-ws-15-dvm DispVM AppVM | Tue 11 May 2021 11:30:05 AM UTC
[INFO] [systemcheck] Tor Connection Result:
Tor's Control Port could not be reached. Attempt 1 of 5. Could be temporary due to a Tor restart. Trying again...

[ERROR] [systemcheck] Tor Connection Result:
Tor's Control Port could not be reached!
...
```

The gateway itself is fine:

```
$ systemcheck 
[INFO] [systemcheck] sys-whonix | Whonix-Gateway | whonix-gw-15 TemplateBased ProxyVM | Tue 11 May 2021 11:31:20 AM UTC
[INFO] [systemcheck] Connected to Tor.
...
```

I've also tried reinstalling both templates, same result.

**How Reproducible**

Always</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<blockquote>
<p>Hi there, I have had the exact same problem and have been trying to resolve it for the last 4 days or so. It also occured for me after a dom0 update, i had also updated to kernel-latest and kernel-latest-qubes-vm (5.12.4-1).</p>
<p>I tried booting off the other kernels, and i tried setting as default all versions I had of qubes-vm kernel, which made no difference at all, I tried restoring all whonix related templates and appVM’s from a backup where they all previously worked and spent countless hours looking up what the problem might be.</p>
<p>I finally found what fixed the issue for me with the information on this page: <span class="hashtag">#5110</span> . I issued in dom0 as su the commands:<br>
qvm-features sys-whonix ipv6 ‘’ and<br>
qvm-features anon-whonix ipv6 ‘’</p>
<p>I do not know if the second command was needed as I issued both at the same time.</p>
<p>I shutdown anon-whonix, restarted sys-whonix and ran anon-whonix tor browser and the issue was gone (kernel-qubes-vm 5.10.37-1). I started a whonix-ws-15-dvm and was able to connect without issue. I decided to check the kernel-latest and rebooted qubes after setting kernel-latest-qubes-vm 5.12.4-1 to default and booted at grub with kernel 5.12.4-1 and the issue was still gone. I also tried running a fedora-33-dvm through sys-whonix and this also had tor connectivity.</p>
<p>I am guessing that one of the updates enabled ipv6 in the whonix templates somehow, I am very new to github so I don’t claim to have technically diagnosed this in anyway, but hope this information will be of use to <span class="mention">@jpds</span> and maybe to <span class="mention">@adrelanos</span> and <a class="mention" href="http://forums.whonix.org/u/marmarek">@marmarek</a> with fixing it.</p>
</blockquote>
          <p><a href="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/8</link>
        <pubDate>Mon, 24 May 2021 10:01:14 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-11606-8</guid>
        <source url="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606.rss">Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</source>
      </item>
      <item>
        <title>Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="tihor" data-post="1" data-topic="11606">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/t/6f9a4e/40.png" class="avatar"> tihor:</div>
<blockquote>
<p>Qubes 4.1</p>
</blockquote>
</aside>
<p>Unsupported. Not yet supported.</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Unsupported" target="_blank" rel="noopener" title="03:46PM - 28 April 2021">Whonix – 28 Apr 21</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:93/62;"><img src="https://www.whonix.org/w/images/0/0a/Unsupported.jpg" class="thumbnail" width="93" height="62"></div>

<h3><a href="https://www.whonix.org/wiki/Unsupported" target="_blank" rel="noopener">Unsupported</a></h3>

<p>This feature is either undocumented, untested, or unsupported. Options: Become a Contributor / Apply Free Support Principle / Purchase Professional Support.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>I didn’t look into Qubes R4.1 yet. Qubes-Whonix works fine in R4.0. No reports of breakage through Whonix upgrades. Possibly some Qubes R4.1 upgrade has broken it.</p>
<hr>
<ul>
<li><a href="https://www.whonix.org/wiki/About#Support_Schedule">https://www.whonix.org/wiki/About#Support_Schedule</a></li>
</ul>
          <p><a href="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/7</link>
        <pubDate>Wed, 05 May 2021 16:17:59 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-11606-7</guid>
        <source url="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606.rss">Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</source>
      </item>
      <item>
        <title>Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</title>
        <dc:creator><![CDATA[tihor]]></dc:creator>
        <description><![CDATA[
            <p>Yes, and the dvm too.</p>
          <p><a href="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/6</link>
        <pubDate>Wed, 05 May 2021 16:13:36 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-11606-6</guid>
        <source url="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606.rss">Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</source>
      </item>
      <item>
        <title>Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Networking of <code>anon-whonix</code> is set to <code>sys-whonix</code> in Qubes VM Manger (QVMM)?</p>
          <p><a href="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/5</link>
        <pubDate>Wed, 05 May 2021 16:13:12 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-11606-5</guid>
        <source url="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606.rss">Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</source>
      </item>
      <item>
        <title>Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</title>
        <dc:creator><![CDATA[tihor]]></dc:creator>
        <description><![CDATA[
            <p>I’m using the <code>whonix-ws-15-dvm</code>, which was created using:</p>
<pre><code class="lang-auto">sudo qubesctl state.sls qvm.anon-whonix
</code></pre>
<p>EDIT: Just checked <code>anon-whonix</code> and it shows the same error. This was working a week ago before it broke after I applied updates.</p>
          <p><a href="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/4</link>
        <pubDate>Wed, 05 May 2021 16:10:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-11606-4</guid>
        <source url="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606.rss">Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</source>
      </item>
      <item>
        <title>Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Totally unrelated to timesanitycheck / sdwdate.</p>
<aside class="quote no-group" data-username="tihor" data-post="1" data-topic="11606">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/t/6f9a4e/40.png" class="avatar"> tihor:</div>
<blockquote>
<p><code>systemcheck</code> says that the gateway is running fine, but running it in the workstation says:</p>
<pre><code class="lang-auto">[INFO] [systemcheck] Tor Connection Result:
Tor's Control Port could not be reached. 
</code></pre>
</blockquote>
</aside>
<p>That is the only worthwhile symptom. Everything else are follow up issues.</p>
<p>Quite likely some dom0 settings are wrong.</p>
<p>Properly installed?</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Qubes/Install" target="_blank" rel="noopener" title="10:02AM - 26 December 2020">Whonix – 26 Dec 20</a>
  </header>
  <article class="onebox-body">
    <img src="https://www.whonix.org/w/images/e/e2/Qubesinstall12312123.png" class="thumbnail onebox-avatar" width="60" height="60">

<h3><a href="https://www.whonix.org/wiki/Qubes/Install" target="_blank" rel="noopener">Qubes/Install</a></h3>

<p>How to Install Qubes-Whonix ™ 15</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Using <code>anon-whonix</code> default VM?</p>
<p>How did you create that workstation?</p>
<p>If additional workstation, did you create it as per instructions?</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Multiple_Whonix-Workstation" target="_blank" rel="noopener" title="03:01PM - 01 March 2021">Whonix – 1 Mar 21</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:93/62;"><img src="https://www.whonix.org/w/images/0/01/Petunia-14052640.jpg" class="thumbnail" width="93" height="62"></div>

<h3><a href="https://www.whonix.org/wiki/Multiple_Whonix-Workstation" target="_blank" rel="noopener">Multiple Whonix-Workstation</a></h3>

<p>Compartmentalization. Better separation of different tasks and/or pseudonyms by using multiple Whonix-Workstation ™.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/3</link>
        <pubDate>Wed, 05 May 2021 16:06:42 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-11606-3</guid>
        <source url="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606.rss">Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</source>
      </item>
      <item>
        <title>Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</title>
        <dc:creator><![CDATA[tihor]]></dc:creator>
        <description><![CDATA[
            <p>Found this (while going through the <code>onion-time-pre-script</code> checks):</p>
<pre><code>user@host:~$ /usr/bin/tor-circuit-established-check
Unable to authenticate: socket connection failed ([Errno 104] Connection reset by peer)</code></pre>
          <p><a href="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/2</link>
        <pubDate>Wed, 05 May 2021 16:06:31 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-11606-2</guid>
        <source url="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606.rss">Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</source>
      </item>
      <item>
        <title>Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</title>
        <dc:creator><![CDATA[tihor]]></dc:creator>
        <description><![CDATA[
            <p>I have the latest packages installed in my GW and WS VM templates on Qubes 4.1, and I keep hitting this error in the WS VM:</p>
<pre><code>2021-05-05 14:53:15 - sdwdate - INFO - PREPARATION:
2021-05-05 14:53:15 - sdwdate - INFO -
/usr/lib/helper-scripts/onion-time-pre-script: Start.
Static Time Sanity Check: Within minimum time 'Sun Jan 17 00:00:00 UTC 2021' and expiration timestamp 'Tue May 17 10:00:00 UTC 2033', ok.
Tor Bootstrap Result:    ERROR (124).
 Please report this bug!
/usr/lib/helper-scripts/onion-time-pre-script: END: Exiting with exit_code '1' indicating 'wait, show error icon and retry.'.
2021-05-05 14:53:15 - sdwdate - INFO - PREPARATION RESULT: (known) ERROR.
2021-05-05 14:53:15 - sdwdate - INFO -
</code></pre>
<p><code>systemcheck</code> says that the gateway is running fine, but running it in the workstation says:</p>
<pre><code>[INFO] [systemcheck] Tor Connection Result:
Tor's Control Port could not be reached. Attempt 1 of 5. Could be temporary due to a Tor restart. Trying again...</code></pre>
          <p><a href="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606/1</link>
        <pubDate>Wed, 05 May 2021 14:59:23 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-11606-1</guid>
        <source url="http://forums.whonix.org/t/qubes-r4-1-tors-control-port-could-not-be-reached-time-sanity-check-error/11606.rss">Qubes R4.1 - Tor&#39;s Control Port could not be reached. - Time sanity check error</source>
      </item>
  </channel>
</rss>

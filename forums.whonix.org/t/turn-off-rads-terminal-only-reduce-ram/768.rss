<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Turn off rads? / terminal only? / reduce RAM?</title>
    <link>http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768</link>
    <description>Can Qubes use VMs that have no X server?

How does Qubes decide how much RAM to assign to a VM?

Can you reduce RAM a VM gets?

Depending on that, you might wish to disable rads. For info on rads, see:
- https://www.whonix.org/wiki/Desktop#RAM_Adjusted_Desktop_Starter
- https://github.com/Whonix/rads

Disabling rads could speed up booting.

For disabling it, see:
https://github.com/Whonix/rads/blob/master/etc/rads.d/30_desktop_default#L13

Eventually you might wish to add a config snippet for disabling rads + enabling kdm (harder + fastest) or reduce rads timeout (easy + not as big boot spedup gain).</description>
    <language>en</language>
    <lastBuildDate>Mon, 05 Jan 2015 17:18:11 +0000</lastBuildDate>
    <category>Qubes-Whonix</category>
    <atom:link href="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Turn off rads? / terminal only? / reduce RAM?</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="7" data-topic="768">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Looks like rads doesn’t interfere with Qubes then. Great. rads is a useless then, but that looks like a minor issue. Perhaps for Qubes even kdm / X does not even have to be installed.</p>
</blockquote>
</aside>
<p>Yes. Perhaps kdm / X does not.</p>
          <p><a href="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/8</link>
        <pubDate>Mon, 05 Jan 2015 17:18:11 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-768-8</guid>
        <source url="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768.rss">Turn off rads? / terminal only? / reduce RAM?</source>
      </item>
      <item>
        <title>Turn off rads? / terminal only? / reduce RAM?</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Looks like rads doesn’t interfere with Qubes then. Great. rads is a useless then, but that looks like a minor issue. Perhaps for Qubes even kdm / X does not even have to be installed.</p>
          <p><a href="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/7</link>
        <pubDate>Sat, 03 Jan 2015 19:55:55 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-768-7</guid>
        <source url="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768.rss">Turn off rads? / terminal only? / reduce RAM?</source>
      </item>
      <item>
        <title>Turn off rads? / terminal only? / reduce RAM?</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <p>[quote=“Patrick, post:5, topic:768”]To make sure it doesn’t add up boot time with default settings, please revert to default settings and add.</p>
<pre><code class="lang-auto"></code></pre>
<p>Reverted to defaults and then changed this setting to 60 seconds…</p>
<pre><code class="lang-auto">rads_wait_seconds=60</code></pre>
<p>Testing Whonix-Gateway ProxyVM:</p>
<p>With RADS rads_wait_seconds=60 and dynamic memory, startup time was ~9-10 seconds.</p>
<p>With RADS rads_wait_seconds=60 and fixed 128MB memory, startup time was ~10-12 seconds.</p>
<p>Same startup results as before.</p>
          <p><a href="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/6</link>
        <pubDate>Sat, 03 Jan 2015 18:52:40 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-768-6</guid>
        <source url="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768.rss">Turn off rads? / terminal only? / reduce RAM?</source>
      </item>
      <item>
        <title>Turn off rads? / terminal only? / reduce RAM?</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Or it’s ignored for some reason due to Qubes boot implementation, that I don’t know yet very well.</p>
<p>To make sure it doesn’t add up boot time with default settings, please revert to default settings and add.</p>
<pre><code class="lang-auto"></code></pre>
<p>I guess it’s ignored.</p>
<p>Well, what rads is essentially doing after all the conditional checks is “sudo service kdm start”. (Or other display manager.) I guess in Qubes is does not matter if or when to run “sudo service kdm start” because of how Qubes implements VMs being able to use X. This hypothesis is strengthened by that you can run “sudo service kdm stop” (try this command in some usual KDE distro - or nevermind - it simply stops the graphical login session and mostly depending on settings it asks for a password for a virtual console) at infinitum without any effect.</p>
          <p><a href="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/5</link>
        <pubDate>Sat, 03 Jan 2015 11:12:57 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-768-5</guid>
        <source url="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768.rss">Turn off rads? / terminal only? / reduce RAM?</source>
      </item>
      <item>
        <title>Turn off rads? / terminal only? / reduce RAM?</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="3" data-topic="768">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Did it boot up faster already?</p>
</blockquote>
</aside>
<p>Set configuration file “/etc/rads.d/50_desktop_default” with the following settings:</p>
<pre><code class="lang-auto">rads_autostart_decision_feature=0
rads_start_display_manager=0
rads_minium_ram=480
rads_skip_ram_test=1
rads_wait=0
rads_wait_seconds=0
rads_debug=0
rads_disable_rc_d_remove=0
x_default_dm_config_file="/etc/X11/default-display-manager"
rads_display_manager=""</code></pre>
<p>Testing Whonix-Gateway ProxyVM:</p>
<p>With normal enabled RADS settings and dynamic memory, startup time was ~9-10 seconds.</p>
<p>With normal enabled RADS settings and fixed 128MB memory, startup time was ~10-12 seconds.</p>
<p>With modified disabled RADS settings and dynamic memory, startup time was ~9-10 seconds.</p>
<p>With modified disabled RADS settings and fixed 128MB memory, startup time was ~10-14 seconds.</p>
<p>If RADS wait time of 10 seconds is default set to on, then RADS doesn’t seem to be invoked in any case.</p>
<p>Whonix startup is similarly fast in Qubes for me under all tested conditions.</p>
<p>And I tested using HDD (non-SSD). So Qubes is fast at VM startup.</p>
<p>Maybe <a class="mention" href="http://forums.whonix.org/u/nrgaway">@nrgaway</a> did something special regarding Whonix startup / RADS?</p>
<p>[hr]</p>
<aside class="quote" data-post="3" data-topic="768">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Maybe rads was still starting KDM, that started the kde desktop environment that includes X? We’ll figure out…</p>
</blockquote>
</aside>
<p>[hr]</p>
<aside class="quote" data-post="3" data-topic="768">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Maybe even after reducing RAM, Qubes was still reporting “more than 512 available” due to this dynamic thing.</p>
</blockquote>
</aside>
<p>Don’t think so. Only reporting 113MB based on the tests, when I set to 128MB fixed RAM.</p>
<p>[hr]</p>
<p>[quote=“Patrick, post:3, topic:768”]Please post the output of.</p>
<pre><code class="lang-auto"></code></pre>
<p>Output with 128MB fixed RAM set:</p>
<pre><code class="lang-auto">echo "$(free -m | sed -n -e '/^Mem:/s/^[^0-9]*\([0-9]*\) .*/\1/p')"

113</code></pre>
<p>[hr]</p>
<p>[quote=“Patrick, post:3, topic:768”]As well as the output of.</p>
<pre><code class="lang-auto"></code></pre>
<p>Output with 128MB fixed RAM set:</p>
<pre><code class="lang-auto">free -m

             total       used       free     shared    buffers     cached
Mem:           113        111          2          0          1         20
-/+ buffers/cache:         89         23
Swap:         1023         10       1013</code></pre>
<p>[hr]</p>
<p>[quote=“Patrick, post:3, topic:768”]Another way to make sure KDM (X) isn’t running.</p>
<pre><code class="lang-auto"></code></pre>
<p>Not sure if this had any affect. Repeated command multiple times in a row, got same output each time:</p>
<pre><code class="lang-auto">sudo service kdm stop

[ ok ] Stopping kdm (via systemctl): kdm.service.</code></pre>
<p>[hr]</p>
<aside class="quote" data-post="3" data-topic="768">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Maybe due the how Qubes is implemented, individual VM’s don’t even need their own X server, because it’s (securely) using a shared one.</p>
</blockquote>
</aside>
<p>I believe this is the case, based on memory of reading something like this. Also, I remember something like Joanna mentioning there was no X server trusted by Qubes (VMs?). I think GUI components are isolated to Dom0 and shared by VMs. I think Qubes R3 is supposed to be further isolating GUI components to their own domain.</p>
          <p><a href="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/4</link>
        <pubDate>Sat, 03 Jan 2015 03:01:14 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-768-4</guid>
        <source url="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768.rss">Turn off rads? / terminal only? / reduce RAM?</source>
      </item>
      <item>
        <title>Turn off rads? / terminal only? / reduce RAM?</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Did it boot up faster already?</p>
<p>Maybe rads was still starting KDM, that started the kde desktop environment that includes X? We’ll figure out…</p>
<p>Maybe even after reducing RAM, Qubes was still reporting “more than 512 available” due to this dynamic thing.</p>
<p>This is how rads detects available RAM:<br>
</p><aside class="onebox githubblob">
  <header class="source">
      <a href="https://github.com/Whonix/rads/blob/master/usr/lib/ram_adjusted_desktop_starter/ram_adjusted_desktop_starter#L204" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="https://github.com/Whonix/rads/blob/master/usr/lib/ram_adjusted_desktop_starter/ram_adjusted_desktop_starter#L204" target="_blank" rel="nofollow noopener">Whonix/rads/blob/master/usr/lib/ram_adjusted_desktop_starter/ram_adjusted_desktop_starter#L204</a></h4>
<pre class="onebox"><code class="lang-"><ol class="start lines" start="194" style="counter-reset: li-counter 193 ;">
<li>   if [ "$total_ram" -lt "$rads_minium_ram" ]; then</li>
<li>      echo "[${green}INFO${reset}] Not starting login manager \</li>
<li>(graphical desktop environment) ($rads_display_manager), \</li>
<li>because there is only $total_ram MB total RAM. (A minimum of \</li>
<li>$rads_minium_ram MB total RAM is configured in /etc/rads.d/ \</li>
<li>configuration folder.)"</li>
<li>      create_status_file_no_start_x</li>
<li>      exit 0</li>
<li>   fi</li>
<li>fi</li>
<li class="selected">
</li>
<li>if [ -e "/usr/share/anon-gw-base-files/gateway" ]; then</li>
<li>   ## Whonix specific info message. Feel free to implement your own.</li>
<li>   if [ -f "/usr/share/whonix/marker" ]; then</li>
<li>      echo "[${green}INFO${reset}] If your \</li>
<li>host has little RAM, you are advised to reduce Gateway \</li>
<li>RAM to 256 MB. No graphical desktop environment will be started in that case. \</li>
<li>A Gateway without graphical desktop environment works as good as one with, \</li>
<li>it's just not that convenient. If you want, you can sometimes start a graphical \</li>
<li>desktop environment by toggling how much RAM is available to Gateway. \</li>
<li>Documentation about this feature can be found here: \</li>
</ol></code></pre>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<p></p>
<pre><code class="lang-auto"> ## Check how much RAM the system has in total.
## Thanks to:
## http://stackoverflow.com/a/10277712
total_ram="$(free -m | sed -n -e '/^Mem:/s/^[^0-9]*\([0-9]*\) .*/\1/p')"</code></pre>
<p>Please post the output of.</p>
<pre><code class="lang-auto"></code></pre>
<p>As well as the output of.</p>
<pre><code class="lang-auto"></code></pre>
<p>Another way to make sure KDM (X) isn’t running.</p>
<pre><code class="lang-auto"></code></pre>
<p>Maybe due the how Qubes is implemented, individual VM’s don’t even need their own X server, because it’s (securely) using a shared one.</p>
          <p><a href="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/3</link>
        <pubDate>Fri, 02 Jan 2015 16:31:29 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-768-3</guid>
        <source url="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768.rss">Turn off rads? / terminal only? / reduce RAM?</source>
      </item>
      <item>
        <title>Turn off rads? / terminal only? / reduce RAM?</title>
        <dc:creator><![CDATA[WhonixQubes]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="1" data-topic="768">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Can Qubes use VMs that have no X server?</p>
</blockquote>
</aside>
<p>Not sure.</p>
<p>Just ran a test by creating a new Whonix-Gateway ProxyVM with 128MB fixed RAM.</p>
<p>After bootup, I was able to successfully launch and use GUI apps, such as KWrite, etc.</p>
<p>So GUI apps (using X server?) are working with Whonix VMs using minimal fixed RAM well under the RADS threshold.</p>
<aside class="quote" data-post="1" data-topic="768">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>How does Qubes decide how much RAM to assign to a VM?</p>
</blockquote>
</aside>
<p>There is an “Initial memory” setting to set the base amount of RAM.</p>
<p>Then there is a (on by default) checkbox “Include in memory balancing” which allows you to set a “Max memory” setting. With this, Qubes automatically manages and balances memory amounts across VMs in real-time.</p>
<p>Default settings for memory amounts:</p>
<p>ProxyVMs: 300MB initial; 3000MB max</p>
<p>AppVMs: 400MB initial; 4000MB max</p>
<aside class="quote" data-post="1" data-topic="768">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Can you reduce RAM a VM gets?</p>
</blockquote>
</aside>
<p>Yes. See above examples.</p>
<p>[quote=“Patrick, post:1, topic:768”]Depending on that, you might wish to disable rads. For info on rads, see:</p>
<ul>
<li><a href="https://www.whonix.org/wiki/Desktop#RAM_Adjusted_Desktop_Starter" rel="nofollow noopener">https://www.whonix.org/wiki/Desktop#RAM_Adjusted_Desktop_Starter</a></li>
<li><a href="https://github.com/Whonix/rads" rel="nofollow noopener">https://github.com/Whonix/rads</a></li>
</ul>
<p>Disabling rads could speed up booting.</p>
<p>For disabling it, see:<br>
<a href="https://github.com/Whonix/rads/blob/master/etc/rads.d/30_desktop_default#L13" class="onebox" target="_blank" rel="nofollow noopener">https://github.com/Whonix/rads/blob/master/etc/rads.d/30_desktop_default#L13</a></p>
<p>Eventually you might wish to add a config snippet for disabling rads + enabling kdm (harder + fastest) or reduce rads timeout (easy + not as big boot spedup gain).[/quote]</p>
<p>Yeah. Based on my test, it seems Qubes might not even be able to take advantage of RADS.</p>
<p>So this seems like a good idea. Faster startup is always nice to have.</p>
<p>Thanks Patrick! <img src="//forums.whonix.org/images/emoji/twitter/smiley.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
          <p><a href="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/2</link>
        <pubDate>Thu, 01 Jan 2015 22:21:50 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-768-2</guid>
        <source url="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768.rss">Turn off rads? / terminal only? / reduce RAM?</source>
      </item>
      <item>
        <title>Turn off rads? / terminal only? / reduce RAM?</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Can Qubes use VMs that have no X server?</p>
<p>How does Qubes decide how much RAM to assign to a VM?</p>
<p>Can you reduce RAM a VM gets?</p>
<p>Depending on that, you might wish to disable rads. For info on rads, see:</p>
<ul>
<li><a href="https://www.whonix.org/wiki/Desktop#RAM_Adjusted_Desktop_Starter">https://www.whonix.org/wiki/Desktop#RAM_Adjusted_Desktop_Starter</a></li>
<li><a href="https://github.com/Whonix/rads">https://github.com/Whonix/rads</a></li>
</ul>
<p>Disabling rads could speed up booting.</p>
<p>For disabling it, see:<br>
<a href="https://github.com/Whonix/rads/blob/master/etc/rads.d/30_desktop_default#L13" class="onebox" target="_blank">https://github.com/Whonix/rads/blob/master/etc/rads.d/30_desktop_default#L13</a></p>
<p>Eventually you might wish to add a config snippet for disabling rads + enabling kdm (harder + fastest) or reduce rads timeout (easy + not as big boot spedup gain).</p>
          <p><a href="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768/1</link>
        <pubDate>Thu, 01 Jan 2015 16:13:10 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-768-1</guid>
        <source url="http://forums.whonix.org/t/turn-off-rads-terminal-only-reduce-ram/768.rss">Turn off rads? / terminal only? / reduce RAM?</source>
      </item>
  </channel>
</rss>

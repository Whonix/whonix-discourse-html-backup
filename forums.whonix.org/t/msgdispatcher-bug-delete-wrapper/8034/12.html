<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[msgdispatcher] bug: &quot;$delete_wrapper&quot; - #12 by Patrick - Qubes-Whonix - Whonix Forum</title>
    <meta name="description" content="I am experiencing the following problem with Whonix 15 (buster-proposed-updates repo enabled), specifically with whonix-ws template. Everytime I start a VM based on it, the following message appears. 

##################&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../8034.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[msgdispatcher] bug: &quot;$delete_wrapper&quot;&#39;" href="../8034.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/msgdispatcher-bug-delete-wrapper/8034/12" />
<meta name="twitter:url" content="https://forums.whonix.org/t/msgdispatcher-bug-delete-wrapper/8034/12" />
<meta property="og:title" content="[msgdispatcher] bug: &quot;$delete_wrapper&quot;" />
<meta name="twitter:title" content="[msgdispatcher] bug: &quot;$delete_wrapper&quot;" />
<meta property="og:description" content="Removing user user from group sudo will break /etc/sudoers.d/msgcollector  Described here:" />
<meta name="twitter:description" content="Removing user user from group sudo will break /etc/sudoers.d/msgcollector  Described here:" />
<meta property="article:published_time" content="2019-09-09T10:14:27+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../8034.html">[msgdispatcher] bug: &quot;$delete_wrapper&quot;</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/qubes-whonix/12.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #63a0ff'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Qubes-Whonix</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/minimal'><span itemprop='name'>minimal</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-06T12:05:42Z' class='post-time'>
                September 6, 2019, 12:05pm
              </time>
              <meta itemprop='dateModified' content='2019-09-06T12:05:42Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I am experiencing the following problem with Whonix 15 (buster-proposed-updates repo enabled), specifically with whonix-ws template. Everytime I start a VM based on it, the following message appears.</p>
<blockquote>
<p>###############################################################################<br>
msgdispatcher script bug.<br>
No panic. Nothing is broken. Just some rare condition has been hit.<br>
Try again later. There is likely a solution for this problem.<br>
Please see Whonix News, Whonix Blog and Whonix User Help Forum.<br>
Please report this bug!<br>
who_ami: user<br>
msgdispatcher_identifier: whonixcheck<br>
error_text: sudo --non-interactive msgdisptacher_username="$msgdisptacher_username" msgdispatcher_identifier="$msgdispatcher_identifier" msgdispatcher_appendix=“messagex_done” “$delete_wrapper”<br>
last exit_code: 1<br>
###############################################################################</p>
</blockquote>
<p>I run tasket’s Qubes-VM-Hardening script v 0.9.3. Disabling vm-boot-protect does not change the situation.</p>
<p>Cheers.</p>
        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../msgcollector-security-hardening/7625/9.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../msgcollector-security-hardening/7625/9.html'>
                      <span itemprop='name'>msgcollector security hardening</span>
                    </a>
                    <meta itemprop='position' content='1'>
                  </div>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../msgdisptcher-error-in-sys-whonix-anon-whonix-as-well-as-a-one-time-whonix/9146/2.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../msgdisptcher-error-in-sys-whonix-anon-whonix-as-well-as-a-one-time-whonix/9146/2.html'>
                      <span itemprop='name'>Msgdisptcher error in sys-whonix, anon-whonix, as well as a one-time whonix.</span>
                    </a>
                    <meta itemprop='position' content='2'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-06T12:42:32Z' class='post-time'>
                September 6, 2019, 12:42pm
              </time>
              <meta itemprop='dateModified' content='2019-09-06T12:42:32Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Improved error handler just now to ease debugging this.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/msgcollector/commit/3b29acd0d00411f8f1ea314b3c8714997d169b3a" target="_blank" rel="nofollow noopener">github.com/Whonix/msgcollector</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../../external.html?link=https://github.com/Whonix/msgcollector/commit/3b29acd0d00411f8f1ea314b3c8714997d169b3a" target="_blank" rel="nofollow noopener">improve error_handler</a>
</h4>


<div class="date">
  by <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="../../../../external.html?link=https://github.com/Whonix/msgcollector/commit/3b29acd0d00411f8f1ea314b3c8714997d169b3a" target="_blank" rel="nofollow noopener">12:38PM - 06 Sep 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>1 files</strong>
  with <strong>5 additions</strong>
  and <strong>0 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>If you like to debug this, please replace the existing script <code>/usr/lib/msgcollector/msgdispatcher</code> with the newer script.</p>
<p><a href="../../../../external.html?link=https://github.com/Whonix/msgcollector/blob/master/usr/lib/msgcollector/msgdispatcher" rel="nofollow noopener">https://github.com/Whonix/msgcollector/blob/master/usr/lib/msgcollector/msgdispatcher</a></p>
<p>(Press “raw”.)</p>
<p>That would provider better debug output.</p>
<p>Please also run the following command and post the output here:</p>
<pre><code>sudo find /var/run/msgcollector</code></pre>
        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-06T12:47:33Z' class='post-time'>
                September 6, 2019, 12:47pm
              </time>
              <meta itemprop='dateModified' content='2019-09-06T12:47:33Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Another enhancment which makes this easier to debug but not the solution yet.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/msgcollector/commit/699311b03c15782d5c610dcb5b3e20d728e12b3a" target="_blank" rel="nofollow noopener">github.com/Whonix/msgcollector</a>
  </header>
  <article class="onebox-body">
      <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="../../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="../../../../external.html?link=https://github.com/Whonix/msgcollector/commit/699311b03c15782d5c610dcb5b3e20d728e12b3a" target="_blank" rel="nofollow noopener">clean up duplicate variables</a>
</h4>


<div class="date">
  by <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="../../../../external.html?link=https://github.com/Whonix/msgcollector/commit/699311b03c15782d5c610dcb5b3e20d728e12b3a" target="_blank" rel="nofollow noopener">12:46PM - 06 Sep 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>1 files</strong>
  with <strong>4 additions</strong>
  and <strong>4 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-06T13:40:43Z' class='post-time'>
                September 6, 2019,  1:40pm
              </time>
              <meta itemprop='dateModified' content='2019-09-06T13:40:43Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>This is now also in buster-proposed-updates repo.</p>
        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/minimal'><span itemprop='name'>minimal</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-06T14:45:33Z' class='post-time'>
                September 6, 2019,  2:45pm
              </time>
              <meta itemprop='dateModified' content='2019-09-06T14:45:33Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Ok, thanks for your answer.<br>
I updated msgcollector and the message error when I start a whonix-ws based VM is:</p>
<blockquote>
<p>###############################################################################<br>
msgdispatcher script bug.<br>
No panic. Nothing is broken. Just some rare condition has been hit.<br>
Try again later. There is likely a solution for this problem.<br>
Please see Whonix News, Whonix Blog and Whonix User Help Forum.<br>
Please report this bug!<br>
who_ami: user<br>
msgdisptacher_username: whonixcheck<br>
msgdispatcher_identifier: whonixcheck<br>
msgdispatcher_appendix:<br>
delete_wrapper: /usr/lib/msgcollector/msgdispatcher_delete_wrapper<br>
error_text: sudo --non-interactive msgdisptacher_username="$msgdisptacher_username" msgdispatcher_identifier="$msgdispatcher_identifier" msgdispatcher_appendix=“messagex_done” “$delete_wrapper”<br>
last exit_code: 1<br>
#######################################################</p>
</blockquote>
<p>and</p>
<blockquote>
<p>sudo find /var/run/msgcollector<br>
/var/run/msgcollector<br>
/var/run/msgcollector/user<br>
/var/run/msgcollector/user/msgdispatcher_x_subshell_fifo<br>
/var/run/msgcollector/user/msgdispatcher_pidx<br>
/var/run/msgcollector/user/msgdispatcher_x_lock<br>
/var/run/msgcollector/whonixcheck<br>
/var/run/msgcollector/whonixcheck/whonixcheck_messagecli_done<br>
/var/run/msgcollector/whonixcheck/whonixcheck_messagex_done<br>
/var/run/msgcollector/whonixcheck/whonixcheck_lefttop<br>
/var/run/msgcollector/whonixcheck/whonixcheck_titlex<br>
/var/run/msgcollector/whonixcheck/whonixcheck_parenttty<br>
/var/run/msgcollector/whonixcheck/whonixcheck_typex<br>
/var/run/msgcollector/whonixcheck/whonixcheck_icon<br>
/var/run/msgcollector/init_done</p>
</blockquote>
<p>Just for the record: I tried to change the template for these VMs with a whonix-ws-15 where tasket’s VM-hardening script is not installed. In this case, no problems detected when a VM is started.</p>
<p>Thanks for your help.</p>
        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-07T07:29:33Z' class='post-time'>
                September 7, 2019,  7:29am
              </time>
              <meta itemprop='dateModified' content='2019-09-07T07:29:33Z'>
          <span itemprop='position'>#6</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubissue">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/tasket/Qubes-VM-hardening/issues/43" target="_blank" rel="nofollow noopener">github.com/tasket/Qubes-VM-hardening</a>
  </header>
  <article class="onebox-body">
    <a href="../../../../external.html?link=https://github.com/adrelanos" rel="nofollow noopener">
<img src="../../../../external.html?link=https://avatars1.githubusercontent.com/u/1985040?v=2&amp;s=96" class="thumbnail onebox-avatar" width="60" height="60">
</a>

<h4><a href="../../../../external.html?link=https://github.com/tasket/Qubes-VM-hardening/issues/43" target="_blank" rel="nofollow noopener">Issue: Qubes-VM-hardening breaks msgcollector / msgdispatcher</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
	on <a href="../../../../external.html?link=https://github.com/tasket/Qubes-VM-hardening/issues/43" target="_blank" rel="nofollow noopener">2019-09-07</a>
	</div>
	<div class="user">
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">https://forums.whonix.org/t/msgdispatcher-bug-delete-wrapper/8034/1
Related source files:
https://github.com/Whonix/msgcollector/blob/master/usr/lib/msgcollector/msgdispatcher
https://github.com/Whonix/msgcollector/blob/master/usr/lib/msgcollector/msgdispatcher_delete_wrapper
https://github.com/Whonix/msgcollector/blob/master/etc/xdg/autostart/msgdispatcher.desktop
https://github.com/Whonix/msgcollector/blob/master/lib/systemd/system/msgcollector.service
https://github.com/Whonix/msgcollector/blob/master/usr/lib/msgcollector/msgdispatcher_init
https://github.com/Whonix/msgcollector/blob/master/etc/xdg/autostart/msgdispatcher.desktop</pre>

<div class="labels">
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/tasket'><span itemprop='name'>tasket</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T03:11:08Z' class='post-time'>
                September 8, 2019,  3:11am
              </time>
              <meta itemprop='dateModified' content='2019-09-08T03:11:08Z'>
          <span itemprop='position'>#7</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I got the identical error message… but none of my Whonix 15 templates currently have Qubes-VM-hardening installed.</p>
<p>And the error is not very repeatable.</p>
<p>At first glance, the main variables may be startup timing (race condition?) and the fact that qubes-rpc VMAuth is set to “ask” in dom0, as per the qvmh installation procedure. (I am getting VMAuth popups for sys-whonix when starting a terminal or browser for a whonix-ws based appvm, but not when starting a terminal in the whonix-ws template.)</p>
<p>Also, I recall using Whonix about a month ago and didn’t experience these issues.</p>
<p>I would prefer addressing the issues sans qvmh before troubleshooting with qvmh, but I’ll try installing it in a whonix-ws-15 clone for now to see if the error message becomes more predictable, VMAuth prompts are affected, etc.</p>
        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/tasket'><span itemprop='name'>tasket</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T03:47:45Z' class='post-time'>
                September 8, 2019,  3:47am
              </time>
              <meta itemprop='dateModified' content='2019-09-08T03:47:45Z'>
          <span itemprop='position'>#8</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Installing qvmh makes the error occur consistently. But I already see a probable cause in the error message: “msgdispatcher_identifier: whonixcheck error_text: sudo…”</p>
<p>Its my understanding that ‘sudo’ should not be used in system or application scripts bc its a user invocation tool. The appropriate command for switching users in scripts would be ‘su’ (both qvmh and Qubes-VPN-Support have examples of displaying user messages via ‘su’); also note its generally only workable when invoking it as root to switch to a less privileged user.</p>
<p>Even if this weren’t the case, scripting with sudo doesn’t appear to be compatible with this type of “vm-sudo” Qubes configuration (even though it seems fine with the permissive Qubes default config for obvious reasons).</p>
        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T04:06:07Z' class='post-time'>
                September 8, 2019,  4:06am
              </time>
              <meta itemprop='dateModified' content='2019-09-08T08:02:02Z'>
          <span itemprop='position'>#9</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>We actually limited su for security as per:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://www.whonix.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://www.whonix.org/wiki/Root" target="_blank" rel="nofollow noopener">Whonix</a>
  </header>
  <article class="onebox-body">
    

<h3><a href="../../../../external.html?link=https://www.whonix.org/wiki/Root" target="_blank" rel="nofollow noopener">Root</a></h3>

<p>Tips on using sudo / root (privileged) commands safely</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>msgdispatcher should not cause any sudoers prompt. If it does, it would require fixing its /etc/sudoers.d/ exception file. Can you try without Qubes-VM-hardening and sudo requirement only?</p>
<p>Also good to change exit code of delete wrapper to know if delete wrapper or sudo is failing.</p>
<p>sudo has a switch --noninteractive. Using this a lot in Whonix. Works great.</p>
<p>“sudo should not be used non-interactive”: citation required.</p>
        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T04:08:11Z' class='post-time'>
                September 8, 2019,  4:08am
              </time>
              <meta itemprop='dateModified' content='2019-09-08T04:08:11Z'>
          <span itemprop='position'>#10</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubblob">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/msgcollector/blob/master/etc/sudoers.d/msgcollector" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="../../../../external.html?link=https://github.com/Whonix/msgcollector/blob/master/etc/sudoers.d/msgcollector" target="_blank" rel="nofollow noopener">Whonix/msgcollector/blob/master/etc/sudoers.d/msgcollector</a></h4>
<pre><code class="lang-d/msgcollector">## Copyright (C) 2019 - 2019 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions.

Defaults:ALL env_keep += "msgdisptacher_username"
Defaults:ALL env_keep += "msgdispatcher_identifier"
Defaults:ALL env_keep += "msgdispatcher_appendix"
%sudo ALL=NOPASSWD: /usr/lib/msgcollector/msgdispatcher_delete_wrapper
</code></pre>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/tasket'><span itemprop='name'>tasket</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-08T13:50:05Z' class='post-time'>
                September 8, 2019,  1:50pm
              </time>
              <meta itemprop='dateModified' content='2019-09-08T13:50:05Z'>
          <span itemprop='position'>#11</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Right, the VMAuth prompts come from sys-whonix, and this seems to be the result of an appvm connecting or disconnecting with the sys-whonix proxyvm. So maybe no direct relation to what whonix-ws is doing (although that is an issue in itself).</p>
<p>Re: su vs sudo in scripts… It may not matter here if you are always running sudo as root or have a sudoers.d config as you indicated. But su appears to be the convention as its usually a core command in Linux distros, while sudo may be optional on some (such as fedora). Never saw sudo in init.d/cron scripts for example, and the sudo --non-interactive option was added relatively recently in 2011. I think Qubes scripts only use su. But I digress…</p>
<p>I didn’t activate the vm-boot-protect* service after installing it, so my prediction is that it will behave the same when only sudo is reconfigured. I’ll have to test a bit more to be sure.</p>
        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-09T10:14:27Z' class='post-time'>
                September 9, 2019, 10:14am
              </time>
              <meta itemprop='dateModified' content='2019-09-09T10:14:27Z'>
          <span itemprop='position'>#12</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Removing user <code>user</code> from group <code>sudo</code> will break <a href="../../../../external.html?link=https://github.com/Whonix/msgcollector/blob/master/etc/sudoers.d/msgcollector" rel="nofollow noopener">/etc/sudoers.d/msgcollector</a></p>
<p>Described here:</p>
<aside class="quote quote-modified" data-post="9" data-topic="7625">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="../../msgcollector-security-hardening/7625/9.html">msgcollector security hardening</a> <a class="badge-wrapper  bullet" href="../../../c/development/8.html"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    <a href="../../../../external.html?link=https://github.com/Whonix/msgcollector" rel="nofollow noopener">https://github.com/Whonix/msgcollector</a> is still weird. 
whonixcheck runs under user whonixcheck for better hardening (linux user account separation). It’s auto started as a daemon: 
<a href="../../../../external.html?link=https://github.com/Whonix/whonixcheck/blob/master/lib/systemd/system/whonixcheck.service" rel="nofollow noopener">https://github.com/Whonix/whonixcheck/blob/master/lib/systemd/system/whonixcheck.service</a> 
Usually daemons don’t send GUI notifications. 
msgdispatcher (part of msgcollector package) is started by: 


<a href="../../../../external.html?link=https://github.com/Whonix/msgcollector/blob/master/etc/xdg/autostart/msgdispatcher.desktop" rel="nofollow noopener">https://github.com/Whonix/msgcollector/blob/master/etc/xdg/autostart/msgdispatcher.desktop</a> for X, and

<a href="../../../../external.html?link=https://github.com/Whonix/msgcollector/blob/master/etc/profile.d/40_msgdispatcher.sh" rel="nofollow noopener">https://github.…</a>
  </blockquote>
</aside>

        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/tasket'><span itemprop='name'>tasket</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-09-10T22:17:59Z' class='post-time'>
                September 10, 2019, 10:17pm
              </time>
              <meta itemprop='dateModified' content='2019-09-10T22:17:59Z'>
          <span itemprop='position'>#13</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Update: I’m continuing to experience this msgdispatcher error with unmodified templates. The last time was today when sys-whonix displayed it when beginning template updates (sys-whonix had just started). However, the system was under a bit of stress as it was also updating dom0 and playing music at the same time.</p>
        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/kelman'><span itemprop='name'>kelman</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-17T23:57:40Z' class='post-time'>
                March 17, 2020, 11:57pm
              </time>
              <meta itemprop='dateModified' content='2020-03-17T23:57:40Z'>
          <span itemprop='position'>#14</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Msgdisptcher error in sys-whonix, anon-whonix, as well as a one-time whonix.</p>
<pre><code>############################################################################### 
## msgdispatcher script bug. 
## No panic. Nothing is broken. Just some rare condition has been hit. 
## Try again later. There is likely a solution for this problem. 
## Please see Whonix News, Whonix Blog and Whonix User Help Forum. 
## Please report this bug! 
## 
## who_ami: user 
## 
## msgdisptacher_username: whonixcheck 
## msgdispatcher_identifier: whonixcheck 
## msgdispatcher_appendix: 
## delete_wrapper: /usr/lib/msgcollector/msgdispatcher_delete_wrapper 
## 
## error_text: sudo --non-interactive msgdisptacher_username="$msgdisptacher_username" msgdispatcher_identifier="$msgdispatcher_identifier" msgdispatcher_appendix="messagex_done" "$delete_wrapper" 
## last exit_code: 1 
###############################################################################
</code></pre>
<p>The problem arose after installing Qubes-VM-hardening.</p>
<p>My actions for whonix-gw-15 and whonix-ws-15:</p>
<ol>
<li>Download Qubes-VM-Hardening</li>
<li>
</li>
</ol>
<pre><code>cd Qubes-VM-hardening
sudo bash install
sudo bash configure-sudo-prompt
</code></pre>
<ol start="3">
<li>Added vm-boot-protect service (without root) for sys-whonix and anon-whonix</li>
</ol>
<p>Also, after running anon-whonix or whonix-dispVM in dom0 from sys-whonix, an invitation is sent. The specified solution in (qubes-os .org/doc/vm-sudo/)</p>
<pre><code>```
ALL ALL=NOPASSWD: /usr/sbin/virt-what
ALL ALL=NOPASSWD: /usr/sbin/service whonixcheck restart
ALL ALL=NOPASSWD: /usr/sbin/service whonixcheck start
ALL ALL=NOPASSWD: /usr/sbin/service whonixcheck stop
ALL ALL=NOPASSWD: /usr/sbin/service whonixcheck status
```
</code></pre>
<p>Did not help.</p>
        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/kelman'><span itemprop='name'>kelman</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-18T12:01:56Z' class='post-time'>
                March 18, 2020, 12:01pm
              </time>
              <meta itemprop='dateModified' content='2020-03-18T12:01:56Z'>
          <span itemprop='position'>#15</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote quote-modified" data-post="1" data-topic="8034">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/d2c977/40.png" class="avatar">
    <a href="../8034.html">[msgdispatcher] bug: "$delete_wrapper"</a> <a class="badge-wrapper  bullet" href="../../../c/qubes-whonix/12.html"><span class="badge-category-bg" style="background-color: #63a0ff;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Everything specific to Qubes-Whonix. (devs)">Qubes-Whonix</span></a>
  </div>
  <blockquote>
    I am experiencing the following problem with Whonix 15 (buster-proposed-updates repo enabled), specifically with whonix-ws template. Everytime I start a VM based on it, the following message appears. 

############################################################################### 
msgdispatcher script bug. 
No panic. Nothing is broken. Just some rare condition has been hit. 
Try again later. There is likely a solution for this problem. 
Please see Whonix News, Whonix Blog and Whonix User Help F…
  </blockquote>
</aside>

<p>In fact, I have the same problem as the tasket described in this thread. And since the problem has not yet been resolved, it is obvious that me should not enable VMAuth and vm-boot-protect for Whonix. I think it’s worth adding to the documentation that these functions are experimental for Whonix and cause errors.</p>
        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../8034.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-18T13:23:47Z' class='post-time'>
                March 18, 2020,  1:23pm
              </time>
              <meta itemprop='dateModified' content='2020-03-18T13:23:47Z'>
          <span itemprop='position'>#16</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Added more debugging code in Whonix developers repository (will flow to other repositories as per usual) if anyone likes to test this. We’ll now probably get an exact error message why it is failing.</p>
        </div>

        <meta itemprop='headline' content='[msgdispatcher] bug: &quot;$delete_wrapper&quot;'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

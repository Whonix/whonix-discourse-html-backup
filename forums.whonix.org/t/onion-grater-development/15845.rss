<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>onion-grater development</title>
    <link>http://forums.whonix.org/t/onion-grater-development/15845</link>
    <description>Tor Controller is not on the list but this https://www.whonix.org/wiki/Dev/Control_Port_Filter_Proxy#Talking_to_the_real_Tor_Control_Port should be moved entirely to https://www.whonix.org/wiki/Tor_Controller#Talking_to_the_real_Tor_Control_Port

The Control Proxy, or onion-grater should only have documentation related to its filter, the controller page should have the controller commands, the filter page should have explanation on how to filter, how to allow via profile etc, but not on how to connect.

Also, I fixed a bug recently on tor-ctrl to be able to run from the Workstation, so if you wish to test if a command is filtered or not, you can do through the command line to see what onion-grater lets through.

---

## Simple plan

https://www.whonix.org/wiki/Onion-grater
- will be the last one to be done so after the Dev wording is done for the
  other pages, the simpler version can contain everything important for the
  user in an easy vocabulary
- most important to mention onion-grater-add and onion-grater-remove and
  onion-grater-list, this is what an user faces with already compatible
  applications
- source code not so important in the user facing page, maybe just keep it on
  the Dev/onio-grater page.
- make the footnotes a topic, they are too big to be on the footnotes

https://www.whonix.org/wiki/Dev/onion-grater
- maybe merge this page with Dev/Control_Port_Filter_Proxy because the only
  filter proxy is onion-grater

https://www.whonix.org/wiki/Dev/Control_Port_Filter_Proxy
- improve debugging of onion-grater
- improve description of what commands do
- separate onion-grater to a distinct section
- s/qubes-netvm-gateway/qubes-gateway/
- remove mentions of Tor Control such as https://www.whonix.org/wiki/Dev/Control_Port_Filter_Proxy#connect_to_onion-grater_from_workstation
  because this is already done on
  https://www.whonix.org/wiki/Tor_Controller#Talking_to_the_real_Tor_Control_Port

https://www.whonix.org/wiki/Dev/Control_Port_Filter_Proxy#connect_to_onion-grater_from_workstation
- merge this page with Dev/Control_Port_Filter_Proxy
- this page is difficult to find
- it should be on its own section of its parent page

---

Also, to each page, a good introduction.

I will do the changes to the Control_Port_Filter_Proxy but I believe it should be renamed to Dev/Onion-Grater as it is the only control proxy we have.</description>
    <language>en</language>
    <lastBuildDate>Fri, 09 Dec 2022 08:19:29 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/onion-grater-development/15845.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Note to self: I still need to look into this.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/54">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/54</link>
        <pubDate>Fri, 09 Dec 2022 08:19:29 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-54</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>Branch I am using <a href="https://github.com/nyxnor/onion-grater/tree/enhance" class="inline-onebox">GitHub - nyxnor/onion-grater at enhance</a></p>
<ul>
<li>allow to match multiple profiles and merge them together per matcher basis</li>
<li>allow to set restrict-stream-events for remote hosts</li>
<li>allow alternative directories to be parsed</li>
</ul>
<p>after review, I will pr upstream.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/53">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/53</link>
        <pubDate>Tue, 01 Nov 2022 20:28:58 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-53</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>Remember to separate the profiles per application, <code>newnym</code> is for TBB, <code>bootstrap-phase</code> for sdwdate etc, much better to understand which application needs what.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/52">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/52</link>
        <pubDate>Tue, 01 Nov 2022 18:35:57 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-52</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group quote-modified" data-username="nyxnor" data-post="50" data-topic="15845">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p>Broken links across the wiki because of wide search and replace.</p>
<p><a href="https://www.whonix.org/wiki/Tor_Browser/Advanced_Users#Open_Network_Settings" class="inline-onebox">Tor Browser Advanced Topics</a></p>
<blockquote>
<p>In Whonix ™, there is only limited access to Tor’s control port (see [[Dev/onion-grater<br>
|Control Port Filter Proxy]] for more information).</p>
</blockquote>
</blockquote>
</aside>
<p>Fixed.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/51">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/51</link>
        <pubDate>Wed, 26 Oct 2022 09:35:34 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-51</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>Broken links across the wiki because of wide search and replace.</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.whonix.org/wiki/Tor_Browser/Advanced_Users#Open_Network_Settings">
  <header class="source">
      <img src="https://www.whonix.org/w/images/a/a4/Whonix-home-favicon.ico" class="site-icon" width="32" height="32">

      <a href="https://www.whonix.org/wiki/Tor_Browser/Advanced_Users#Open_Network_Settings" target="_blank" rel="noopener" title="10:10AM - 22 October 2022">Whonix – 22 Oct 22</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:640/425;"><img src="https://www.whonix.org/w/images/e/ed/Toradvanced.jpg?version=639fe403f053c1f9fc48344a315dedaa" class="thumbnail" width="640" height="425"></div>

<h3><a href="https://www.whonix.org/wiki/Tor_Browser/Advanced_Users#Open_Network_Settings" target="_blank" rel="noopener">Tor Browser Advanced Topics</a></h3>

  <p>Tor Browser Adversary Model and Torbutton Design. Custom homepage, configurations and proxy settings. Tor Browser update technical details. Platform-specific issues.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<blockquote>
<p>In Whonix ™, there is only limited access to Tor’s control port (see [[Dev/onion-grater<br>
|Control Port Filter Proxy]] for more information).</p>
</blockquote>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/50">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/50</link>
        <pubDate>Tue, 25 Oct 2022 19:51:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-50</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox githubblob" data-onebox-src="https://github.com/Whonix/onion-grater/blob/master/usr/lib/onion-grater-merger#L23">
  <header class="source">

      <a href="https://github.com/Whonix/onion-grater/blob/master/usr/lib/onion-grater-merger#L23" target="_blank" rel="noopener">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/Whonix/onion-grater/blob/master/usr/lib/onion-grater-merger#L23" target="_blank" rel="noopener">Whonix/onion-grater/blob/master/usr/lib/onion-grater-merger#L23</a></h4>



    <pre class="onebox">      <code class="lang-">
        <ol class="start lines" start="13" style="counter-reset: li-counter 12 ;">
            <li>## Creates &lt;code&gt;/etc/onion-grater.d/30_autogenerated.yml&lt;/code&gt;.</li>
            <li>##</li>
            <li>## Only known use so far is by Whonix.</li>
            <li>#### meta end</li>
            <li>
            </li>
<li>import glob</li>
            <li>import yaml</li>
            <li>import os</li>
            <li>
            </li>
<li># Override elements</li>
            <li class="selected">no_merge_elements = ['suppress','match-hosts']</li>
            <li># Override elements with fixed value</li>
            <li>fixed_value_elements = {'match-exe-paths':'*','match-users':'*'}</li>
            <li>
            </li>
<li>def merge_yml(final_obj, parsing_obj):</li>
            <li>   # Inputs - 2 dictionaries/list from YML/YAML file</li>
            <li>   # "parsing_obj" is parsed and merged into "final_obj" and returned back</li>
            <li>   if isinstance(final_obj,dict) and isinstance(parsing_obj,dict):</li>
            <li>      for k,v in parsing_obj.items():</li>
            <li>         if k not in final_obj:</li>
            <li>            final_obj[k] = v</li>
        </ol>
      </code>
    </pre>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
<aside class="onebox githubblob" data-onebox-src="https://github.com/Whonix/onion-grater/blob/master/usr/lib/onion-grater-merger#L25">
  <header class="source">

      <a href="https://github.com/Whonix/onion-grater/blob/master/usr/lib/onion-grater-merger#L25" target="_blank" rel="noopener">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/Whonix/onion-grater/blob/master/usr/lib/onion-grater-merger#L25" target="_blank" rel="noopener">Whonix/onion-grater/blob/master/usr/lib/onion-grater-merger#L25</a></h4>



    <pre class="onebox">      <code class="lang-">
        <ol class="start lines" start="15" style="counter-reset: li-counter 14 ;">
            <li>## Only known use so far is by Whonix.</li>
            <li>#### meta end</li>
            <li>
            </li>
<li>import glob</li>
            <li>import yaml</li>
            <li>import os</li>
            <li>
            </li>
<li># Override elements</li>
            <li>no_merge_elements = ['suppress','match-hosts']</li>
            <li># Override elements with fixed value</li>
            <li class="selected">fixed_value_elements = {'match-exe-paths':'*','match-users':'*'}</li>
            <li>
            </li>
<li>def merge_yml(final_obj, parsing_obj):</li>
            <li>   # Inputs - 2 dictionaries/list from YML/YAML file</li>
            <li>   # "parsing_obj" is parsed and merged into "final_obj" and returned back</li>
            <li>   if isinstance(final_obj,dict) and isinstance(parsing_obj,dict):</li>
            <li>      for k,v in parsing_obj.items():</li>
            <li>         if k not in final_obj:</li>
            <li>            final_obj[k] = v</li>
            <li>         else:</li>
            <li>            if(k in fixed_value_elements):</li>
        </ol>
      </code>
    </pre>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Match prefix is outdated for the merger, better to remove it.<br>
And change exe-paths for apparmor profile.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/49">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/49</link>
        <pubDate>Tue, 25 Oct 2022 15:51:40 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-49</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>From code comments</p>
<blockquote>
<p>A filter is matched if for each of the relevant qualifiers at least one of the elements match the client. For local (loopback) clients the following qualifiers are relevant:</p>
</blockquote>
<p>Upon tests:</p>
<pre><code class="lang-auto">Matchers: [('hosts', '10.137.0.44')]

Matched_filter: {'exe-paths': ['/usr/bin/onionshare'], 'users': ['amnesia'], 'hosts': ['*'], .........
</code></pre>
<p>So any qualifier matching, onion-grater will happily accept that. You won’t harden the profile by setting all three.</p>
<p>Profiles that accept every host should be merged with profiles accepting any host.<br>
Profiles that have the same host, should be merged together.</p>
<p>On the other hand, by not specifying a qualifier, it will never match by that qualifier.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/48">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/48</link>
        <pubDate>Tue, 25 Oct 2022 13:50:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-48</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>This pr is not good enough in terms or merging profiles.</p>
<p>Multiple dirs is working fine.</p>
<p>Multiple matches is not, it is more difficult than what I expected.</p>
<p>Sorting files in lexical order does not make sense because onion-grater stops at the first, even it make in reverse, the first match could not be enough for all cases.</p>
<p>If for example the a file containing <code>hosts: '*'</code> is matched, every host will only use that file, and no other even if it contains <code>hosts: '*'</code> in the other files.</p>
<p>The same apply even if hosts are specified such as <code>hosts: '10.137.0.15'</code> and the host match, it will not use any other file even if the host could match, it stops at the first file.</p>
<p>Unfortunately this is not done already on the onion-grater side because it was not written with that in mind.</p>
<p>What could be better done is transforming onion-grater-merger to separate files per hosts.<br>
Lets take for example these files:</p>
<ul>
<li>a.yml - hosts: ‘10.10.10.10’</li>
<li>b.yml - hosts: ‘*’</li>
<li>c.yml - hosts ‘10.10.5.5’, ‘10.10.10.10’</li>
</ul>
<p>The file <code>b</code> needs to be merged to all profiles.<br>
The file <code>a</code> needs to be merged to the <code>c</code> profile<br>
The file <code>c</code> needs to receive all profiles that either have all hosts or the matching hosts.</p>
<p>But this is just one aspect, the hosts, Tails uses apparmor-profiles and users, which lead to all sort of combinations of the qualifiers <code>apparmor-profiles</code>, <code>users</code>, <code>hosts</code>.</p>
<p>This means that there need to be a good way to merge in memory per the qualifiers, which gets more difficult with more qualifiers.<br>
Lets take a bigger example know.</p>
<ul>
<li>a.yml
<ul>
<li>apparmor-profiles:
<ul>
<li>‘/usr/bin/onionshare’</li>
<li>‘/usr/bin/onionshare-gui’</li>
</ul>
</li>
<li>users:
<ul>
<li>‘amnesia’</li>
<li>‘user’</li>
</ul>
</li>
<li>hosts:
<ul>
<li>‘10.10.10.10’</li>
<li>‘10.10.5.5’</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The three qualifiers are lists, they can hold multiple values. And this is only one profile, if you have to merge them in a way that it always results well.</p>
<p>From my tests, this was accepted by onion-grater:</p>
<pre><code class="lang-auto">- apparmor-profiles:
    - '/usr/bin/onionshare'
  users:
    - 'amnesia'
  hosts:
    - '*'
</code></pre>
<p>it matched only the hosts.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/47">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/47</link>
        <pubDate>Tue, 25 Oct 2022 13:17:15 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-47</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Maybe no longer needed in context of onion-grater but I’d like to migrate the <code>.d</code> config explanations on some other page (more generic, unrelated to onion-grater).</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/46">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/46</link>
        <pubDate>Mon, 24 Oct 2022 16:10:08 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-46</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>In my view, this could be deleted, <a href="https://www.whonix.org/wiki/Dev/Control_Port_Filter_Proxy/tor-controlport-filter/config" class="inline-onebox">Dev/Control Port Filter Proxy/tor-controlport-filter/config - Whonix</a></p>
<p>important information already ported to dev page.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/45">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/45</link>
        <pubDate>Mon, 24 Oct 2022 15:29:11 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-45</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox githubpullrequest" data-onebox-src="https://github.com/Whonix/onion-grater/pull/3">
  <header class="source">

      <a href="https://github.com/Whonix/onion-grater/pull/3" target="_blank" rel="noopener">github.com/Whonix/onion-grater</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Whonix/onion-grater/pull/3" target="_blank" rel="noopener">Reborn</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> ← <code>nyxnor:reborn</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2022-10-24" data-time="15:23:42" data-timezone="UTC">03:23PM - 24 Oct 22 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/nyxnor" target="_blank" rel="noopener">
          <img alt="nyxnor" src="https://avatars.githubusercontent.com/u/69700936?v=4" class="onebox-avatar-inline" width="20" height="20">
          nyxnor
        </a>
      </div>

      <div class="lines" title="3 commits changed 10 files with 81 additions and 13 deletions">
        <a href="https://github.com/Whonix/onion-grater/pull/3/files" target="_blank" rel="noopener">
          <span class="added">+81</span>
          <span class="removed">-13</span>
        </a>
      </div>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">https://forums.whonix.org/t/onion-grater-wiki-improvements/15845/43

Note that<span class="show-more-container"><a href="https://github.com/Whonix/onion-grater/pull/3" target="_blank" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden"> I am replacing [30_cpfpy.conf](https://github.com/nyxnor/whonix-gw-network-conf/blob/master/lib/systemd/system/onion-grater.service.d/30_cpfpy.conf) from another repo with `30_whonix.conf`.

Remains to delete `/etc/onion-grater.d/30_autogenerated.yml`

Upstream did not implement this yet: https://gitlab.tails.boum.org/tails/tails/-/issues/19218</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>This is what I am currently using to set different hosts and deprecate onion-grater-merger.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/44">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/44</link>
        <pubDate>Mon, 24 Oct 2022 15:24:44 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-44</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="nyxnor" data-post="40" data-topic="15845">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p>There are four possible directories to be used, slow migration or no migration?</p>
</blockquote>
</aside>
<p>Slow migration or even no migration. Maybe we’ll do the migration in the <a href="https://github.com/Kicksecure/legacy-dist/blob/master/usr/sbin/release-upgrade">release-upgrade</a> script to Whonix 17</p>
<aside class="quote no-group" data-username="nyxnor" data-post="40" data-topic="15845">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p>Should we just use with 3 and 4?</p>
</blockquote>
</aside>
<p>Yes. Seems easiest. And easiest to revert should something unexpected happen and make this impossible.</p>
<aside class="quote no-group" data-username="nyxnor" data-post="40" data-topic="15845">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p>meger</p>
</blockquote>
</aside>
<p>merger (just in case it gets copy/pasted from here to git)</p>
<aside class="quote no-group" data-username="nyxnor" data-post="40" data-topic="15845">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p>Can I stop supporting the non-merger dir from the apparmor profile perspective?</p>
</blockquote>
</aside>
<p>I guess that directory doesn’t hurt and makes the script easier to upstream.</p>
<aside class="quote no-group" data-username="nyxnor" data-post="42" data-topic="15845" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p>Also, <code>/etc/onion-grater.d/30_autogenerated.yml</code> needs to be removed by some script to avoid leaving that extraneous file</p>
</blockquote>
</aside>
<p>That should be quite easy to do in the postinst script at the end when all of this has been implemented.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/43">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/43</link>
        <pubDate>Mon, 24 Oct 2022 14:15:36 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-43</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>Also, <code>/etc/onion-grater.d/30_autogenerated.yml</code> needs to be removed by some script to avoid leaving that extraneous file</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/42">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/42</link>
        <pubDate>Mon, 24 Oct 2022 14:14:49 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-42</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="nyxnor" data-post="40" data-topic="15845">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p>Can I stop supporting the non-merger dir from the apparmor profile perspective?</p>
</blockquote>
</aside>
<p>Because the directories are just used by the program anyway, so maybe not troubling to allow all that directories</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/41">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/41</link>
        <pubDate>Mon, 24 Oct 2022 14:08:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-41</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>There are four possible directories to be used, slow migration or no migration?</p>
<ol>
<li><code>/etc/onion-grater.d</code></li>
<li>
<code>/usr/local/etc/onion-grater.d</code> (never used)</li>
<li>
<code>/etc/onion-grater-meger.d</code> (system)</li>
<li>
<code>/usr/local/etc/onion-grater-meger.d</code> (users)</li>
</ol>
<p>Does it make sense to ever migrate to non <code>-merger</code> directory because  of problems of moving user configuration?</p>
<p>Should we just use with 3 and 4?</p>
<p>I will need to include the merger on the apparmor configuration, because onion-grater was not reading it, instead it was reading only the /etc/onion-grater.d dir with the 30_autogenerated.yml file.</p>
<p>Can I stop supporting the non-merger dir from the apparmor profile perspective?</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/40">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/40</link>
        <pubDate>Mon, 24 Oct 2022 14:07:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-40</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="nyxnor" data-post="37" data-topic="15845">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p>The purpose for me is that <code>anon-gw-anonymizer-config</code> exists, so I though other packages were to follow the same pattern.</p>
</blockquote>
</aside>
<p>That package is also a bit imperfect. It has some enhancements that would be useful for Kicksecure too such as the default /etc/torrc.d parsing and some helper scripts such as anon-verify etc. One day it has to be re-organized.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/39">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/39</link>
        <pubDate>Mon, 24 Oct 2022 14:07:38 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-39</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p><a href="https://github.com/Whonix/anon-gw-anonymizer-config/pull/4" class="inline-onebox">add onion-grater-list manpage by nyxnor · Pull Request #4 · Whonix/anon-gw-anonymizer-config · GitHub</a> - Thanks, merged!</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/38">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/38</link>
        <pubDate>Mon, 24 Oct 2022 14:02:38 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-38</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>The purpose for me is that <code>anon-gw-anonymizer-config</code> exists, so I though other packages were to follow the same pattern.</p>
<p>But yes, very whonix specific, I just prefer patterns.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/37">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/37</link>
        <pubDate>Mon, 24 Oct 2022 14:00:23 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-37</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="nyxnor" data-post="35" data-topic="15845" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/nyxnor/40/2874_2.png" class="avatar"> nyxnor:</div>
<blockquote>
<p>Patrick, maybe rename <a href="https://github.com/Whonix/whonix-gw-network-conf">GitHub - Whonix/whonix-gw-network-conf</a> to <code>anon-gw-network-conf</code> ?</p>
</blockquote>
</aside>
<p>Not sure. In theory it could be done but in practice the meaning of <code>anon-</code> isn’t clearly defined. Does it mean any anonymizing Linux distribution so that in theory Tails could re-use it? There doesn’t seem to be any interest in <code>anon-</code> anyhow. Or use <code>anon-</code> for stuff that is generic and <code>whonix-</code> for things that are really only for Whonix with its split-VM design? Or is it for the purpose of being fork friendly?</p>
<p>That package seems very Whonix specific. Not easy for other distributions to benefit form it unless they fork Whonix.</p>
<p>Due to the effort and unclear benefit, I guess it’s not worth renaming.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/36">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/36</link>
        <pubDate>Mon, 24 Oct 2022 13:57:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-36</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>Patrick, maybe rename <a href="https://github.com/Whonix/whonix-gw-network-conf" class="inline-onebox">GitHub - Whonix/whonix-gw-network-conf</a> to <code>anon-gw-network-conf</code> ?</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/35">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/35</link>
        <pubDate>Mon, 24 Oct 2022 12:50:01 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-35</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>Passed the relevant information of <a href="https://www.whonix.org/wiki/Dev/Control_Port_Filter_Proxy/tor-controlport-filter/config" class="inline-onebox">Dev/Control Port Filter Proxy/tor-controlport-filter/config - Whonix</a>  to <a href="https://www.whonix.org/wiki/Dev/onion-grater#Profile_format">ttps://www.whonix.org/wiki/Dev/onion-grater#Profile_format</a>.</p>
<p>Most of the information was outdated and not relevant (relevant to onion-grater-merger that is going to be deprecated).</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/34">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/34</link>
        <pubDate>Mon, 24 Oct 2022 12:08:54 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-34</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>update example profiles directive:</p>
<p><code>s/exe-paths/apparmor-profiles/</code></p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/33">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/33</link>
        <pubDate>Mon, 24 Oct 2022 10:20:50 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-33</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p><code>restrict-stream-events</code> is set to <code>False</code> for non-local clients</p><aside class="onebox allowlistedgeneric" data-onebox-src="https://gitlab.tails.boum.org/tails/tails/-/blob/master/config/chroot_local-includes/usr/local/lib/onion-grater#L710-L716">
  <header class="source">
      <img src="https://gitlab.tails.boum.org/uploads/-/system/appearance/favicon/1/gitlab.png" class="site-icon" width="32" height="32">

      <a href="https://gitlab.tails.boum.org/tails/tails/-/blob/master/config/chroot_local-includes/usr/local/lib/onion-grater#L710-L716" target="_blank" rel="noopener">GitLab</a>
  </header>

  <article class="onebox-body">
    <img src="https://gitlab.tails.boum.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" class="thumbnail onebox-avatar" width="500" height="500">

<h3><a href="https://gitlab.tails.boum.org/tails/tails/-/blob/master/config/chroot_local-includes/usr/local/lib/onion-grater#L710-L716" target="_blank" rel="noopener">config/chroot_local-includes/usr/local/lib/onion-grater · master · tails /...</a></h3>

  <p>GitLab Community Edition</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>We could restrict stream per client ip if that is fixed.</p>
<p>Commented on the existing thread <a href="https://gitlab.tails.boum.org/tails/tails/-/issues/18123#note_197565">Tails bug tracker</a></p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/32">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/32</link>
        <pubDate>Mon, 24 Oct 2022 10:16:34 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-32</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>Another benefit of the approach above, getting rid of onion-grater-merger means that onion-grater does not need to restart, as no autogenerated files needs to be generated. Instead, onion-grater evaluates the files on the fly without needing to restart. Means that changes on onion-grater-add and onion-grater-remote to restart onion-grater is not necessary anymore.</p>
<p>This is better because the only reason to restart onion-grater is for testing when enabling --debug or --complain mode, less disconnections for workstations that need a profile added on their gateway and onion-grater could ignore the bitcoind ADD_ONION because it was constantly restarted.</p>
          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/31">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/31</link>
        <pubDate>Sun, 23 Oct 2022 18:06:38 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-31</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
      <item>
        <title>onion-grater development</title>
        <dc:creator><![CDATA[nyxnor]]></dc:creator>
        <description><![CDATA[
            <p>In favor to allow setting <code>hosts</code> and using alternative parsing directories, I opened</p><aside class="onebox allowlistedgeneric" data-onebox-src="https://gitlab.tails.boum.org/tails/tails/-/issues/19218">
  <header class="source">
      <img src="https://gitlab.tails.boum.org/uploads/-/system/appearance/favicon/1/gitlab.png" class="site-icon" width="32" height="32">

      <a href="https://gitlab.tails.boum.org/tails/tails/-/issues/19218" target="_blank" rel="noopener">GitLab</a>
  </header>

  <article class="onebox-body">
    <img src="https://gitlab.tails.boum.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" class="thumbnail onebox-avatar" width="500" height="500">

<h3><a href="https://gitlab.tails.boum.org/tails/tails/-/issues/19218" target="_blank" rel="noopener">onion-grater downstream support - multi parsing directories and multi matches...</a></h3>

  <p>Introduction Greeetings. Vocab: profile = rules file *.yml I want to use onion-grater on downstream.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/onion-grater-development/15845/30">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/onion-grater-development/15845/30</link>
        <pubDate>Sun, 23 Oct 2022 15:05:34 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15845-30</guid>
        <source url="http://forums.whonix.org/t/onion-grater-development/15845.rss">onion-grater development</source>
      </item>
  </channel>
</rss>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>TCP linux-hardened fingerprinting</title>
    <link>http://forums.whonix.org/t/tcp-linux-hardened-fingerprinting/15992</link>
    <description>[quote=&quot;HulaHoop, post:8, topic:15973&quot;]
The fact we disable TCP timestamps and remove TCP ISNs is readily apparent.
[/quote]

The negatives of having TCP timestamps disabled (and other default TCP kernel options), especially in Gateway, is fingerprinting of linux-hardened users.

This is mainly problematic in Gateway since it is able to tie IPs to Whonix users by time sources, guard node or apt mirrors, but is also able to fingerprint Workstation to a lesser degree

This should be re-enabled but I would love to be proven wrong</description>
    <language>en</language>
    <lastBuildDate>Mon, 21 Nov 2022 09:33:58 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/tcp-linux-hardened-fingerprinting/15992.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>TCP linux-hardened fingerprinting</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="2" data-topic="15992">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>It’s an optimization goal.</p>
</blockquote>
</aside>
<p>Typo. Edited above. Meant to write:<br>
It’s an optimization conflict.<br>
It’s not possible to optimize for both at the same time.</p>
          <p><a href="http://forums.whonix.org/t/tcp-linux-hardened-fingerprinting/15992/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/tcp-linux-hardened-fingerprinting/15992/3</link>
        <pubDate>Mon, 21 Nov 2022 09:33:58 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15992-3</guid>
        <source url="http://forums.whonix.org/t/tcp-linux-hardened-fingerprinting/15992.rss">TCP linux-hardened fingerprinting</source>
      </item>
      <item>
        <title>TCP linux-hardened fingerprinting</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group quote-modified" data-username="HulaHoop" data-post="8" data-topic="15973" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"><a href="//forums.whonix.org/t/whonix-kvm-dnsmasq-listen-port-on-host-operating-system-attack-surface-reduction/15973/8">Whonix KVM dnsmasq - listen port on host operating system - attack surface reduction</a>
</div>
<blockquote>
<aside class="quote no-group" data-username="anon12802191" data-post="7" data-topic="15973">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/a/f0a364/40.png" class="avatar"><a href="//forums.whonix.org/t/whonix-kvm-dnsmasq-listen-port-on-host-operating-system-attack-surface-reduction/15973/7">Whonix KVM dnsmasq - listen port on host operating system - attack surface reduction</a>
</div>
<blockquote>
<p>Some tight dictatorship countries, especially during times of unrest <strong>will</strong> arrest you incase they suspect even slightest of “above average technical ability” e.g. running Linux host and running virtual machines on it.</p>
</blockquote>
</aside>
<p>I hate to be the bearer of bad news, but our security choices and improvements do have a unique fingerprint on the network for those who want to look. The fact we disable TCP timestamps and remove TCP ISNs is readily apparent. Rather than stick to the less secure defaults that can endanger users in other ways, we have chosen to move ahead and adopt these improvements.<br>
.<br>
If having a firewall solves this - which I think Patrick said, then the solution is easy enough to apply and I hope satisfactory</p>
</blockquote>
</aside>
<aside class="quote no-group quote-modified" data-username="anon12802191" data-post="9" data-topic="15973">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/a/f0a364/40.png" class="avatar"><a href="//forums.whonix.org/t/whonix-kvm-dnsmasq-listen-port-on-host-operating-system-attack-surface-reduction/15973/9">Whonix KVM dnsmasq - listen port on host operating system - attack surface reduction</a>
</div>
<blockquote>
<p>The TCP timestamps being disabled is only <strong>inside</strong> of the VM, however the dnsmasq is on the <strong>host</strong> so it should still be considered. Just because Whonix has some obvious fingerprint able properties in exchange for security, does not mean you should allow <strong>more</strong> fingerprints, […]</p>
</blockquote>
</aside>
<p>And what’s the point of this?</p>
<aside class="quote no-group" data-username="anon12802191" data-post="9" data-topic="15973">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/a/f0a364/40.png" class="avatar"><a href="//forums.whonix.org/t/whonix-kvm-dnsmasq-listen-port-on-host-operating-system-attack-surface-reduction/15973/9">Whonix KVM dnsmasq - listen port on host operating system - attack surface reduction</a>
</div>
<blockquote>
<p>This is interesting because AFAIK Whonix disables these in linux-harden kernel which I thought is in use only in Workstation and not Gateway and I assumed that means no fingerprint (at least outside of tor) or does Gateway and workstation both use same kernel with same options?</p>
</blockquote>
</aside>
<p><a href="https://www.whonix.org/wiki/Fingerprint#ISP_or_Local_Network_Administrators">Network, Browser and Website Fingerprint chapter ISP or Local Network Administrators in Whonix wiki</a></p>
<aside class="quote no-group" data-username="anon12802191" data-post="9" data-topic="15973">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/a/f0a364/40.png" class="avatar"><a href="//forums.whonix.org/t/whonix-kvm-dnsmasq-listen-port-on-host-operating-system-attack-surface-reduction/15973/9">Whonix KVM dnsmasq - listen port on host operating system - attack surface reduction</a>
</div>
<blockquote>
<p>if so that could be an improvement to disable some hardening kernel features in Gateway, no?</p>
</blockquote>
</aside>
<p>No.</p>
<hr>
<p>It’s an optimization conflict.</p>
<ul>
<li>A) Either the main goal can be to emulate being a Windows 10 / 11 or whatever the currently most popular Windows version is network fingerprint. And this is very most likely impossible without using the actual Windows code which we stay away from for many reasons.</li>
<li>B) Optimize security, anonymity at the expense of ISP level network fingerprinting, which is already a lost cause.</li>
</ul>
<p>You cannot be anonymous without being secure. Project decision was made to prefer security over ISP level network fingerprinting obfuscation attempts.</p>
<p>The related wiki page is this one:</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.whonix.org/wiki/Hide_Tor_from_your_Internet_Service_Provider">
  <header class="source">
      <img src="https://www.whonix.org/w/images/a/a4/Whonix-home-favicon.ico" class="site-icon" width="32" height="32">

      <a href="https://www.whonix.org/wiki/Hide_Tor_from_your_Internet_Service_Provider" target="_blank" rel="noopener" title="05:52PM - 22 October 2022">Whonix – 22 Oct 22</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:640/426;"><img src="https://www.whonix.org/w/images/c/c4/Cat-1040815640.jpg?version=2e757c17af16cd29e835953c58ba1f7e" class="thumbnail" width="640" height="426"></div>

<h3><a href="https://www.whonix.org/wiki/Hide_Tor_from_your_Internet_Service_Provider" target="_blank" rel="noopener">Hide Tor use from the Internet Service Provider</a></h3>

  <p>Prevent the Internet Service Provider from discovering you are a Tor user.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>There are at least two categories of projects.</p>
<ul>
<li>A) Anonymity: Projects that prioritize to anonymize internet traffic.</li>
<li>B) Circumvention: Projects that prioritize to hide internet traffic, circumvent ISP level censorship, resist ISP level network fingerprinting.</li>
</ul>
<p>Whonix is primarily in category A).</p>
<p>A) is already a hard problem to tackle<br>
B) is even harder if not impossible.</p>
<p>I am not even aware of any projects in category B). Such a software could even be developed independently from Whonix, Tor.</p>
<aside class="quote no-group quote-modified" data-username="anon12802191" data-post="7" data-topic="15973" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/a/f0a364/40.png" class="avatar"><a href="//forums.whonix.org/t/whonix-kvm-dnsmasq-listen-port-on-host-operating-system-attack-surface-reduction/15973/7">Whonix KVM dnsmasq - listen port on host operating system - attack surface reduction</a>
</div>
<blockquote>
<aside class="quote no-group quote-modified" data-username="HulaHoop" data-post="5" data-topic="15973">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"><a href="//forums.whonix.org/t/whonix-kvm-dnsmasq-listen-port-on-host-operating-system-attack-surface-reduction/15973/5">Whonix KVM dnsmasq - listen port on host operating system - attack surface reduction</a>
</div>
<blockquote>
<aside class="quote no-group quote-modified" data-username="Patrick" data-post="4" data-topic="15973">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/2848_2.png" class="avatar"><a href="//forums.whonix.org/t/whonix-kvm-dnsmasq-listen-port-on-host-operating-system-attack-surface-reduction/15973/4">Whonix KVM dnsmasq - listen port on host operating system - attack surface reduction</a>
</div>
<blockquote>
<blockquote>
<p>Even the information “port 53 tcpwrapped” should not be leaked over the LAN or internet. Could even be deducted “Maybe it’s a Whonix KVM user”.<br>
[/quote]</p>
<p>Note this is not specific to Whonix and could be interpreted as Linux host running libvirt, This is already discoverable and hard to hide the type of OS running on a network because of the different ways they react.</p>
</blockquote>
</blockquote>
</aside>
<p>I see your point of view but I agree with <a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a> on this one.<br>
Your point heavily assumes “Linux machine running a KVM machine is not that suspicious” is entirely in context of specific countries in specific times.</p>
<p>Some tight dictatorship countries, especially during times of unrest <strong>will</strong> arrest you incase they suspect even slightest of “above average technical ability” e.g. running Linux host and running virtual machines on it.</p>
<p>Their mindset would be “this person or group is running Linux, people run Linux because they have something to hide! oh and on top of that he is running a virtual machine! what is he scared of so much”</p>
<p>This sounds comical but There are countless arrests or interrogations based solely on this “logic” and I should mention that “arrests” in those countries means torture to death</p>
<p>A more tangible issue for other countries is fingerprinting. They don’t have to be sure that a Whonix VM was started or is installed, they just have to know that a VM is there and it is enough to narrow down the search considerably</p>
<p>Do not undermine value of metadata, a lot of people die every day because of it. <a href="https://www.youtube.com/watch?v=tL8_caB35Pg">We kill people based on metadata</a></p>
<p>So, optimally the host should not leak information on whether or not they have VMs/dnsmasq or anything out of ordinary</p>
</blockquote>
</aside>
</blockquote>
</aside>
<p>I am not aware of any software solutions provided for such extreme threat models. The sad hard truth is that at some point non-technical issues cannot be worked around with technical products.</p>
<p>I’ve seen it being discussed a few times to use Tor in such threat models and I can understand why anyone would get the idea but it’s conjecture. If you have a look at the following ticket, you’ll see that neither The Tor Project is prioritizing to work under such a threat model:</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://gitlab.torproject.org/legacy/trac/-/issues/7197">
  <header class="source">
      <img src="https://gitlab.torproject.org/uploads/-/system/appearance/favicon/1/favicon.ico" class="site-icon" width="32" height="32">

      <a href="https://gitlab.torproject.org/legacy/trac/-/issues/7197" target="_blank" rel="noopener">GitLab</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:416/500;"><img src="https://gitlab.torproject.org/uploads/-/system/project/avatar/414/trac.png" class="thumbnail" width="416" height="500"></div>

<h3><a href="https://gitlab.torproject.org/legacy/trac/-/issues/7197" target="_blank" rel="noopener">Adapt Tor installer to allow users to avoid connecting to the public tor...</a></h3>

  <p>We need a way to avoid touching the public network for deb/rpm users, in a way that doesn't clutter the installer, scare users, and/or subject users to warning...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/tcp-linux-hardened-fingerprinting/15992/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/tcp-linux-hardened-fingerprinting/15992/2</link>
        <pubDate>Sun, 20 Nov 2022 07:57:34 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15992-2</guid>
        <source url="http://forums.whonix.org/t/tcp-linux-hardened-fingerprinting/15992.rss">TCP linux-hardened fingerprinting</source>
      </item>
      <item>
        <title>TCP linux-hardened fingerprinting</title>
        <dc:creator><![CDATA[anon12802191]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="HulaHoop" data-post="8" data-topic="15973">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/h/edb3f5/40.png" class="avatar"><a href="//forums.whonix.org/t/whonix-kvm-dnsmasq-listen-port-on-host-operating-system-attack-surface-reduction/15973/8">Whonix KVM dnsmasq - listen port on host operating system - attack surface reduction</a>
</div>
<blockquote>
<p>The fact we disable TCP timestamps and remove TCP ISNs is readily apparent.</p>
</blockquote>
</aside>
<p>The negatives of having TCP timestamps disabled (and other default TCP kernel options), especially in Gateway, is fingerprinting of linux-hardened users.</p>
<p>This is mainly problematic in Gateway since it is able to tie IPs to Whonix users by time sources, guard node or apt mirrors, but is also able to fingerprint Workstation to a lesser degree</p>
<p>This should be re-enabled but I would love to be proven wrong</p>
          <p><a href="http://forums.whonix.org/t/tcp-linux-hardened-fingerprinting/15992/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/tcp-linux-hardened-fingerprinting/15992/1</link>
        <pubDate>Sat, 19 Nov 2022 22:17:52 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15992-1</guid>
        <source url="http://forums.whonix.org/t/tcp-linux-hardened-fingerprinting/15992.rss">TCP linux-hardened fingerprinting</source>
      </item>
  </channel>
</rss>

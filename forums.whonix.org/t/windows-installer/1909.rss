<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Windows Installer</title>
    <link>http://forums.whonix.org/t/windows-installer/1909</link>
    <description>Hi folks!

I met Patrick at the 32c3 and he asked me about how I would implement a Windows installer for Whonix. I&#39;m currently involved in a rather complex install package creation for a commercial p2p cloud storage software, so I got some excercise.

I would recommend InnoSetup because some scripting is needed i.e. for downloading files.

https://github.com/jrsoftware/issrc

This is a rather liberal open source license, mainly about attribution.

For downloading external files I&#39;d use this extension:

www sherlocksoftware.org/page.php?id=50 (link crippled due to forum restrictions)

Just http and ftp supported, not https. Just means one has to do a hash test manually. The extension is released under public domain.

I really would recommend InnoSetup for the unconventional tasks that have to be provided. But I should note the more dogmatic Windows Installer API based options:

* Advanced Installer -- this is a very sofisticated and user-friendly software, I have worked with; closed source, though it offers a free license for open source projects
* WiX Toolset -- an open XML-based approach for accessing the Windows Installer API; quite cumbersome... I won&#39;t be available to help, should you opt for this B)

I hope, this gives you a little guidance. Feel free to ask, if any questions should arise.</description>
    <language>en</language>
    <lastBuildDate>Mon, 26 Aug 2019 11:44:25 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/windows-installer/1909.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>More recent discussion:</p>
<aside class="quote" data-post="196" data-topic="2987">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/letter_avatar_proxy/v4/letter/0/ec9cab/40.png" class="avatar">
    <a href="https://forums.whonix.org/t/testing-whonix-installer-for-windows/2987/196">Testing Whonix-Installer for Windows</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/development"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    I know the files that need to be altered to change the installer name. Tested by have not createed a PR yet 
Currently 'Install Whonix.exe' 
Any preference for file names? I prefer the first one. 
whonix-installer.exe 
install-whonix.exe 
anything else?
  </blockquote>
</aside>

          <p><a href="http://forums.whonix.org/t/windows-installer/1909/96">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/96</link>
        <pubDate>Mon, 26 Aug 2019 11:44:25 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-96</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Build documentation updated as well. Untested.</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Dev/Building_Whonix-UI_for_Windows" target="_blank" rel="nofollow noopener">Whonix</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:104/55;"><img src="https://www.whonix.org/w/images/4/47/Whonix_Facebook_Social_Share.png" class="thumbnail"></div>

<h3><a href="https://www.whonix.org/wiki/Dev/Building_Whonix-UI_for_Windows" target="_blank" rel="nofollow noopener">Dev/Building Whonix-UI for Windows</a></h3>

<p>How to build the Whonix ™ Windows User Interface from source code.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<hr>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Dev/Building_the_Whonix-Installer_for_Windows" target="_blank" rel="nofollow noopener">Whonix</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:104/55;"><img src="https://www.whonix.org/w/images/4/47/Whonix_Facebook_Social_Share.png" class="thumbnail"></div>

<h3><a href="https://www.whonix.org/wiki/Dev/Building_the_Whonix-Installer_for_Windows" target="_blank" rel="nofollow noopener">Dev/Building the Whonix-Installer for Windows</a></h3>

<p>How to build the Whonix ™-Windows-Installer from source code.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/windows-installer/1909/95">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/95</link>
        <pubDate>Sun, 05 May 2019 08:38:56 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-95</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Updated project for unified ova and dropped x86 support.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/Whonix-Windows-Installer/commit/4d103af54cc050ed6474344bcfa605b929dc1070" target="_blank" rel="nofollow noopener">github.com/Whonix/Whonix-Windows-Installer</a>
  </header>
  <article class="onebox-body">
      <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="https://github.com/Whonix/Whonix-Windows-Installer/commit/4d103af54cc050ed6474344bcfa605b929dc1070" target="_blank" rel="nofollow noopener">port to unified ova</a>
</h4>


<div class="date">
  by <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="https://github.com/Whonix/Whonix-Windows-Installer/commit/4d103af54cc050ed6474344bcfa605b929dc1070" target="_blank" rel="nofollow noopener">08:17AM - 05 May 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>1 files</strong>
  with <strong>2 additions</strong>
  and <strong>5 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/Whonix-Windows-Installer/commit/55bfb837c145f40dd42f51b1a97f88681bacf98d" target="_blank" rel="nofollow noopener">github.com/Whonix/Whonix-Windows-Installer</a>
  </header>
  <article class="onebox-body">
      <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="https://github.com/Whonix/Whonix-Windows-Installer/commit/55bfb837c145f40dd42f51b1a97f88681bacf98d" target="_blank" rel="nofollow noopener">drop x86 support</a>
</h4>


<div class="date">
  by <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="https://github.com/Whonix/Whonix-Windows-Installer/commit/55bfb837c145f40dd42f51b1a97f88681bacf98d" target="_blank" rel="nofollow noopener">08:19AM - 05 May 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>1 files</strong>
  with <strong>0 additions</strong>
  and <strong>7 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Untested. Has a good chance of working though.</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/94">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/94</link>
        <pubDate>Sun, 05 May 2019 08:37:56 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-94</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Volunteer. Unlikely indeed but not impossible.</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/93">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/93</link>
        <pubDate>Mon, 24 Dec 2018 05:52:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-93</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[TNT_BOM_BOM]]></dc:creator>
        <description><![CDATA[
            <p>This is volunteer or paid postion?</p>
<p>(because i dont think anybody would be interested in working on vbox installer for Windows (at least volunteerly).)</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/92">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/92</link>
        <pubDate>Sun, 23 Dec 2018 14:30:02 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-92</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox twitterstatus">
  <header class="source">
      <a href="https://twitter.com/Whonix/status/1076735414315216897" target="_blank">twitter.com</a>
  </header>
  <article class="onebox-body">
    <img src="https://pbs.twimg.com/profile_images/747394861549162496/q6YdTSix_400x400.jpg" class="thumbnail onebox-avatar" width="60" height="60">
<h4>
  <a href="https://twitter.com/Whonix/status/1076735414315216897" target="_blank">
    Whonix (Whonix)
  </a>
</h4>

<div class="tweet">Looking for Whonix Windows Installer maintainer! <a target="_blank" href="https://github.com/Whonix/Whonix-Windows-Installer">github.com/Whonix/Whonix-…</a>
</div>

<div class="date">
  <a href="https://twitter.com/Whonix/status/1076735414315216897" target="_blank">7:05 AM - 23 Dec 2018</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/windows-installer/1909/91">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/91</link>
        <pubDate>Sun, 23 Dec 2018 07:05:52 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-91</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://github.githubassets.com/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://github.com/Whonix/Whonix-Windows-Installer" target="_blank">GitHub</a>
  </header>
  <article class="onebox-body">
    <img src="https://avatars3.githubusercontent.com/u/4500165?s=400&amp;v=4" class="thumbnail" width="" height="">

<h3><a href="https://github.com/Whonix/Whonix-Windows-Installer" target="_blank">Whonix/Whonix-Windows-Installer</a></h3>

<p>Maintained, InnoSetup and 7-Zip based version of a simple automated installer, setting up Whonix, Whonix-UI and accompanying software. - Whonix/Whonix-Windows-Installer</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://github.githubassets.com/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://github.com/Whonix/Whonix-Windows-UI" target="_blank">GitHub</a>
  </header>
  <article class="onebox-body">
    <img src="https://avatars3.githubusercontent.com/u/4500165?s=400&amp;v=4" class="thumbnail" width="" height="">

<h3><a href="https://github.com/Whonix/Whonix-Windows-UI" target="_blank">Whonix/Whonix-Windows-UI</a></h3>

<p>Contribute to Whonix/Whonix-Windows-UI development by creating an account on GitHub.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/windows-installer/1909/90">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/90</link>
        <pubDate>Sun, 23 Dec 2018 07:03:23 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-90</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://github.githubassets.com/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://github.com/Whonix/Whonix-Windows-Installer-deprecated" target="_blank">GitHub</a>
  </header>
  <article class="onebox-body">
    <img src="https://avatars3.githubusercontent.com/u/4500165?s=400&amp;v=4" class="thumbnail" width="" height="">

<h3><a href="https://github.com/Whonix/Whonix-Windows-Installer-deprecated" target="_blank">Whonix/Whonix-Windows-Installer-deprecated</a></h3>

<p>A simple, NSIS based Installer for Whonix, Whonix-UI and all accompanying files. - Whonix/Whonix-Windows-Installer-deprecated</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://github.githubassets.com/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://github.com/EgoBits1" target="_blank">GitHub</a>
  </header>
  <article class="onebox-body">
    <img src="https://avatars3.githubusercontent.com/u/14236982?s=400&amp;v=4" class="thumbnail" width="" height="">

<h3><a href="https://github.com/EgoBits1" target="_blank">EgoBits1 - Overview</a></h3>

<p>EgoBits1 has 7 repositories available. Follow their code on GitHub.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/windows-installer/1909/89">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/89</link>
        <pubDate>Sun, 23 Dec 2018 06:55:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-89</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Ego]]></dc:creator>
        <description><![CDATA[
            <p>Good day,</p>
<p>after having (irregularily) worked on this for quite some time now, it seems that I’ve been able to get as far as possible at the moment. Have created a coherent installer, which doesn’t necessitate additional downloading or any other actions by the user outside of itself for importing, etc. I still need to finish testing, though at the moment, there seem to be no bigger issues, had a rather big bug to deal with, which put developement almost completley to a halt. However, there is one problem I still couldn’t solve, which I want to get rid of:</p>
<p>The installer for VirtualBox. You see, under Windows, VBox isn’t designed to be installed via a commandline but only per GUI. That’s why, at the moment, I have to call the VBox-Installer externally and let the user go through that process there. While it is integrated in my installer, it is still input on the site of the user, I want to remove. That however, means that I’ll have to somehow recode parts of the VBox Installer to automate it. It’ll certainly take some additional time, though I think it is worth it.</p>
<p>Anyway, will upload the current version in the next days, once I’m fairly certain that everything works under any Windows.</p>
<p>Have  a nice day,</p>
<p>Ego</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/86">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/86</link>
        <pubDate>Fri, 05 Feb 2016 23:15:10 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-86</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Ego]]></dc:creator>
        <description><![CDATA[
            <p>Good day,</p>
<p>ok, thanks for the input, I’ll try that.</p>
<p>Have a nice day,</p>
<p>Ego</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/85">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/85</link>
        <pubDate>Mon, 25 Jan 2016 15:50:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-85</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[thomiel]]></dc:creator>
        <description><![CDATA[
            <p>Ok then, try with escaped " this way:</p>
<p><code>startInfo.Arguments = "/K \"7za e C:\\My\\Unzip\\Folder\\Whonix_Images.7z\"";</code></p>
<p>The /K option wants the command as a single parameter, so you need to use quotation marks.</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/84">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/84</link>
        <pubDate>Mon, 25 Jan 2016 09:05:54 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-84</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Ego]]></dc:creator>
        <description><![CDATA[
            <p>Good day,</p>
<p>mainly because I don’t know a way of hiding the window which 7za.exe opens, but I know a way of hiding the commandline. That happens like this:</p>
<pre><code>System.Diagnostics.Process process = new System.Diagnostics.Process();
System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();
startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
startInfo.FileName = "cmd.exe";
startInfo.Arguments = "/K 7za e Whonix_Images.7z";
process.StartInfo = startInfo;
process.Start();
</code></pre>
<p>This was just not included in the code above, because currently, I want to have some viewable feedback when debuging. I’ll see, wether I can hide 7za.exe using a similar method, don’t see why this shouldn’t work actually.</p>
<p>Have a nice day,</p>
<p>P.S.: Sorry, forgoth answering this before:</p>
<p>Ego[quote=“thomiel, post:80, topic:1909”]<br>
You really do this with .NET 1.0?<br>
[/quote]</p>
<p>Yes, as at the moment I’ve only used commands which are compatible with the very first version of C#.</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/83">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/83</link>
        <pubDate>Sun, 24 Jan 2016 17:40:11 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-83</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[thomiel]]></dc:creator>
        <description><![CDATA[
            <p>Escaping CMD.EXE can be a tricky thing. Consider the /S switch.</p>
<p>Why not calling 7za directly?</p>
<p><code>System.Diagnostics.Process.Start("7za.exe", "e Whonix_Images.7z");</code></p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/82">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/82</link>
        <pubDate>Sun, 24 Jan 2016 17:15:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-82</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Ego]]></dc:creator>
        <description><![CDATA[
            <p>Good day,</p>
<p>Ok, let me just explain with a snippet of my code (have included the necessary explanations with //):</p>
<pre><code>using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Diagnostics;

namespace Whonix_Installer
{
    public partial class Form3 : Form
    {
        public Form3()
        {
            InitializeComponent();
        }

        private void Next_Click(object sender, EventArgs e)
        {
            string strCmdText;
            //Here, I tell the programm to open a command line and run the comment in the quotes. However, this doesn't include the destination from the file dialog below.
            strCmdText = "/K 7za e Whonix_Images.7z";
            System.Diagnostics.Process.Start("CMD.exe", strCmdText);
            this.Hide();
            var form4 = new Form4();
            form4.Show();
        }

        private void textBox1_TextChanged(object sender, EventArgs e)
        {

        }

        private void openFileDialog1_FileOk(object sender, CancelEventArgs e)
        {
               
        }

        private void button1_Click(object sender, EventArgs e)
        {
            FolderBrowserDialog fbd = new FolderBrowserDialog();
            fbd.Description = "Please select a path for the installation";
            fbd.RootFolder = Environment.SpecialFolder.Desktop;
            if (fbd.ShowDialog() == System.Windows.Forms.DialogResult.OK)
                textBox1.Text = fbd.SelectedPath;
        }

        private void folderBrowserDialog1_HelpRequest(object sender, EventArgs e)
        {
               //Here, the user may choose a destination. This needs to somehow be included in the string where the problem lies.
        }
    }
}
</code></pre>
<p>The problem is, that I am unable to mix a string and the code from the folder dialog. Think I have found a solution though.</p>
<p>Have a nice day,</p>
<p>Ego</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/81">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/81</link>
        <pubDate>Sun, 24 Jan 2016 13:15:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-81</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[thomiel]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="79" data-topic="1909">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/ego/40/45_1.png" class="avatar"> Ego:</div>
<blockquote>
<p>The issue is, that I am unable to find out, how I can mix normal “text” (or string, if you like), with C# code (or any code for that matter).</p>
</blockquote>
</aside>
<p>Can you explain a bit more what you mean? The three lines of code seem to show that you know how to handle strings in C#…</p>
<p>You really do this with .NET 1.0?</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/80">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/80</link>
        <pubDate>Sun, 24 Jan 2016 08:13:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-80</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Ego]]></dc:creator>
        <description><![CDATA[
            <p>Good day,</p>
<p>so, after having spent the last few hours on it, here a status update:</p>
<p>First of all, the base is finished. I’ve got a concept (which is very similar to the one I’ve propose in post <span class="hashtag">#51</span>) and was able to overcome all problems, but two. To accomplish all this, I was forced to leave my “SFX-comfort-zone” and move to a (to the user invisible) comand line based approach, using the 7za.exe, offerd by 7-Zip (the project, I mean) as well.</p>
<p>Currently, the installer works in the following way: After showing the usual “disclaimer” and “introduction” pages, the user may (or may not) select, a path for the extraction of both the virtual HDD for the Gateway, as well as for the Workstation (more on that latter). After that, I start cmd.exe in the background. What this does is run the following command: “/K 7za e Whonix_Images.7z Destination”. This runs the 7za.exe found in the /bin folder of my project, which in turn starts to execute the Whonix_Images.7z, which is in the same folder. The destination is set (or should be set) through a “openfiledialog” which is shown to the user prior. While this all happens, all the user see is a nice progress bar, filling with some tastefull green.</p>
<p>Now, at this point I have to take two paths, so bear with me for a moment: What I want to happen in the final version is that, after the GW and WS are extracted, the installation of VBox starts automatically and the user sees no transition whatsoever between the two seperate methods of installation. This is something which seemingly can be done, though I still need to find a way of running the entirety of the VBox installer in cmd for this to work.</p>
<p>For the time beeing though, I was forced to call the installer at this point and go through it by hand. In the final version, I also would like to use the installation destination from before for both VBox and the VHDDs, just with different “Sub-folders”.</p>
<p>After VBox is installed (either way) I simply run vboxmanage (again, with cmd) to create the necessary Debian-VMs and link the VHDDs. While this happens, I (again) show a progress bar. Like I’ve said, in the final “version”, there should really only be one progress bar, as everything else appears unprofessional. While this progress bar fills, I also extract an alternative GUI for VBox, more to that though, when the design is ready in the thread regarding it (the GUI, I mean).</p>
<p>Now, as you may or may not have noticed from how I talked about it, I currently have a problem with setting the destination manually (i.e. by the user). You see, I use this command to run cmd.exe with the needed command:</p>
<p><code>string strCmdText; strCmdText = "/K 7za e Whonix_Images.7z Insert_Destination"; System.Diagnostics.Process.Start("CMD.exe", strCmdText);</code></p>
<p>The issue is, that I am unable to find out, how I can mix normal “text” (or string, if you like), with C# code (or any code for that matter). If someone knows something in that direction, I would really apreciate it. Doesn’t even have to be for C#, anything to get me on the right track would be great. The same issue (of course), also plaques the “vboxmanage part”, which is why I manually set fixed locations, to test both of them.</p>
<p>Have a nice day,</p>
<p>Ego</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/79">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/79</link>
        <pubDate>Sat, 23 Jan 2016 23:49:57 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-79</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Thomas:</p>
<blockquote>
<p>Just a hint: The native way in Windows would be to use a X.509 code<br>
signing certificates instead of GPG. After signing an exe, Windows<br>
will no longer show the “unknown publisher” warning but your name,<br>
which gives Windows users a warm feeling.</p>
</blockquote>
<p>Very much worthwhile. Additional gpg signatures however would be good<br>
since those do not depend on certificate authorities.</p>
<p>Another very “low priority” goal for now are deterministic builds. [It’s<br>
very worthwhile to have, but it will take a long time until<br>
deterministic images will be available and until then its usefulness is<br>
smaller. Just something to keep in mind - not adding purposely variable<br>
stuff (when building the same version twice) such as timestamps.]</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/78">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/78</link>
        <pubDate>Thu, 21 Jan 2016 17:03:38 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-78</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[thomiel]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="76" data-topic="1909">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/ego/40/45_1.png" class="avatar"> Ego:</div>
<blockquote>
<p>If you’ve got an idea you may want to persue, I’d recommend you not to wait for me. I won’t have time finishing what I “produced” today, nor tomorrow (maths test), so I’ll be able to finish it on saturday, earliest.</p>
</blockquote>
</aside>
<p>No need to waste time, if we both work on competing approches. My concept is finished. If we should opt for yours, there is no point in doing detail work on the InnoSetup script now.</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/77">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/77</link>
        <pubDate>Thu, 21 Jan 2016 08:06:30 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-77</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Ego]]></dc:creator>
        <description><![CDATA[
            <p>Good day,</p>
<aside class="quote" data-post="75" data-topic="1909">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/thomiel/40/193_1.png" class="avatar"> thomiel:</div>
<blockquote>
<p>Anyhow, I’ll wait what Ego will come up with.</p>
</blockquote>
</aside>
<p>If you’ve got an idea you may want to persue, I’d recommend you not to wait for me. I won’t have time finishing what I “produced” today, nor tomorrow (maths test), so I’ll be able to finish it on saturday, earliest.</p>
<p>Have a nice day,</p>
<p>Ego</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/76">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/76</link>
        <pubDate>Thu, 21 Jan 2016 07:35:42 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-76</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[thomiel]]></dc:creator>
        <description><![CDATA[
            <aside class="quote" data-post="73" data-topic="1909">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>No need for a dll. No need for VirtualBox API. Would be a lot easier to<br>
use the vboxmanage command line utility which already comes with VirtualBox.[/quote]</p>
<p>This would be for sure an alternative and can be done using scripting in InnoSetup.</p>
<p>Anyhow, I’ll wait what Ego will come up with.</p>
<p>[quote]The Windows maintainer would download these, gpg verify these, quickly test<br>
these, and then build the Whonix installer exe. Test it. Sign it. Upload it.</p>
</blockquote>
</aside>
<p>Just a hint: The native way in Windows would be to use a X.509 code signing certificates instead of GPG. After signing an exe, Windows will no longer show the “unknown publisher” warning but your name, which gives Windows users a warm feeling.</p>
<p>Cheapest certificate possible (17.22€ / year) is this:</p>
<p><a href="https://en.sklep.certum.pl/data-safety/code-signing-certificates/open-source-code-signing.html" class="onebox" target="_blank">https://en.sklep.certum.pl/data-safety/code-signing-certificates/open-source-code-signing.html</a></p>
<p>‘Limitation’ is, that “OPEN SOURCE DEVELOPER” is being added to your name.</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/75">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/75</link>
        <pubDate>Thu, 21 Jan 2016 06:54:43 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-75</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Ego]]></dc:creator>
        <description><![CDATA[
            <p>Good day,</p>
<aside class="quote" data-post="73" data-topic="1909">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Test it. Sign it. Upload it.</p>
</blockquote>
</aside>
<p>That was actually how I’ve envisioned it from the start. Is also the reason why my current “programming attempt” tries to stay as modular as possible, to make updates as simple as possible.</p>
<p>Have a nice day,</p>
<p>Ego</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/74">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/74</link>
        <pubDate>Wed, 20 Jan 2016 14:38:22 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-74</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Thomas:</p>
<blockquote>
<p>That would be a one-liner in the [Tasks] section.</p>
<aside class="quote" data-post="62" data-topic="1909">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I would really hope an import instructions can be avoided and would be<br>
automated in the final version.</p>
</blockquote>
</aside>
<p>This could be done by scripting. But I, as a user, would prefer to have control about actually import an .ova. Maybe first time installation I imported the gateway but ran our of space with the workstation. On the next try, after cleaning up my disk, I could skip the gateway and only import the workstation.</p>
<p>Sure, we could write a helper dll that can access the VirtualBox API and do all this automatically.</p>
</blockquote>
<p>No need for a dll. No need for VirtualBox API. Would be a lot easier to<br>
use the vboxmanage command line utility which already comes with VirtualBox.</p>
<p><code>VBoxManage import</code></p>
<p><a href="https://www.virtualbox.org/manual/ch08.html#vboxmanage-import">https://www.virtualbox.org/manual/ch08.html#vboxmanage-import</a></p>
<p><a href="https://www.virtualbox.org/manual/ch08.html">https://www.virtualbox.org/manual/ch08.html</a></p>
<p>And <code>VBoxManage showvminfo</code>'s exit codes could be used to check if such<br>
a VM already exists - so it would be automatically skipped.</p>
<p>Users who want special stuff could still download and import the ova’s<br>
separately; manually.</p>
<p>The way I envision this at the moment is that probably I would keep<br>
building VirtualBox ova’s. Not something I am specifically eager to.<br>
Anyhow. As long I have this not so great task, I would keep uploading<br>
ova’s images with accompanying gpg signatures to the usual location. The<br>
Windows maintainer would download these, gpg verify these, quickly test<br>
these, and then build the Whonix installer exe. Test it. Sign it. Upload it.</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/73">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/73</link>
        <pubDate>Wed, 20 Jan 2016 14:19:56 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-73</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Ego]]></dc:creator>
        <description><![CDATA[
            <p>Good day,</p>
<p>don’t worry, version 1.1 is just the lowest version necessary, C# 1.0 of course also works with .net 4.5. Furthermore, C# 6.0 is backwards compatible, unless some exotic new feature is used, which I don’t plan on doing. I’ll however still test my “experiment” with VMs of XP, Vista, 7 and 10, just to be safe.</p>
<p>Have a nice day,</p>
<p>Ego</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/72">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/72</link>
        <pubDate>Wed, 20 Jan 2016 07:34:03 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-72</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[thomiel]]></dc:creator>
        <description><![CDATA[
            <p>But on my Windows 10 I don’t have a .NET Framework 1 installed. Seriously: Nobody uses this version any more. You can’t expect a single .NET framework to be preinstalled on all Windows versions since XP.</p>
<p>Anyway, I’ll then wait what results your experimentation will create…</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/71">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/71</link>
        <pubDate>Wed, 20 Jan 2016 07:16:49 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-71</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
      <item>
        <title>Windows Installer</title>
        <dc:creator><![CDATA[Ego]]></dc:creator>
        <description><![CDATA[
            <p>Good day,</p>
<p>I’d need “.NET Framework 1” to get C# running which according to this: <a href="http://blogs.msdn.com/b/astebner/archive/2007/03/14/mailbag-what-version-of-the-net-framework-is-included-in-what-version-of-the-os.aspx">http://blogs.msdn.com/b/astebner/archive/2007/03/14/mailbag-what-version-of-the-net-framework-is-included-in-what-version-of-the-os.aspx</a> is shipped with all versions of XP with at least SP1 and directly integrated since Vista.</p>
<p>Your table only talks about 4.5 and higher, which isn’t necessary.</p>
<p>Have a nice day,</p>
<p>Ego</p>
          <p><a href="http://forums.whonix.org/t/windows-installer/1909/70">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/windows-installer/1909/70</link>
        <pubDate>Wed, 20 Jan 2016 06:28:18 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1909-70</guid>
        <source url="http://forums.whonix.org/t/windows-installer/1909.rss">Windows Installer</source>
      </item>
  </channel>
</rss>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>SUID Disabler and Permission Hardener - Development - Whonix Forum</title>
    <meta name="description" content="https://github.com/QubesOS/qubes-issues/issues/2695 has interesting ideas. 
Quote Solar Designer (someone that Joanna Rutkowska respects): 

Ideally, there should be no SUID binaries reachable from the user account, as o&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="77064658.html?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;SUID Disabler and Permission Hardener&#39;" href="7706.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/suid-disabler-and-permission-hardener/7706?page=2" />
<meta name="twitter:url" content="https://forums.whonix.org/t/suid-disabler-and-permission-hardener/7706?page=2" />
<meta property="og:title" content="SUID Disabler and Permission Hardener" />
<meta name="twitter:title" content="SUID Disabler and Permission Hardener" />
<meta property="og:description" content="I want to add a usability feature.  As user user.  stat -c &quot;%n %a %U %G&quot; /bin/su /bin/su 755 root root which su   /bin/su   I.e. su is still executable by user user even though it has suid removed. This is bad because su fails open, i.e. in weird ways. It does not report â€œmissing suidâ€. What I preferred:  sudo chmod o-x /bin/su stat -c &quot;%n %a %U %G&quot; /bin/su   /bin/su 754 root root   which su   su   bash: /bin/su: Permission denied   Now user user cannot execute su anymore. It is failing closed." />
<meta name="twitter:description" content="I want to add a usability feature.  As user user.  stat -c &quot;%n %a %U %G&quot; /bin/su /bin/su 755 root root which su   /bin/su   I.e. su is still executable by user user even though it has suid removed. This is bad because su fails open, i.e. in weird ways. It does not report â€œmissing suidâ€. What I preferred:  sudo chmod o-x /bin/su stat -c &quot;%n %a %U %G&quot; /bin/su   /bin/su 754 root root   which su   su   bash: /bin/su: Permission denied   Now user user cannot execute su anymore. It is failing closed." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="25 mins ğŸ•‘" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="80 â¤" />
<meta property="article:published_time" content="2019-12-20T11:20:50+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="7706.html">
        <link rel="next" href="77069ba9.html?page=3">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="7706.html">SUID Disabler and Permission Hardener</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/component_security.html' class='discourse-tag' rel="tag">component_security</a>, 
            <a href='../../tag/status_open_issue_todo.html' class='discourse-tag' rel="tag">status_open_issue_todo</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T11:20:50Z' class='post-time'>
                December 20, 2019, 11:20am
              </time>
              <meta itemprop='dateModified' content='2019-12-20T11:20:50Z'>
          <span itemprop='position'>#21</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I want to add a usability feature.</p>
<p>As user <code>user</code>.</p>
<pre><code>stat -c "%n %a %U %G" /bin/su
/bin/su 755 root root
which su
</code></pre>
<blockquote>
<p>/bin/su</p>
</blockquote>
<p>I.e. <code>su</code> is still executable by user <code>user</code> even though it has suid removed. This is bad because <code>su</code> fails open, i.e. in weird ways. It does not report â€œmissing suidâ€. What I preferred:</p>
<pre><code>sudo chmod o-x /bin/su
stat -c "%n %a %U %G" /bin/su
</code></pre>
<blockquote>
<p>/bin/su 754 root root</p>
</blockquote>
<pre><code>which su
</code></pre>
<blockquote></blockquote>
<pre><code>su
</code></pre>
<blockquote>
<p>bash: /bin/su: Permission denied</p>
</blockquote>
<p>Now user <code>user</code> cannot execute <code>su</code> anymore. It is failing closed.</p>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>
          <meta itemprop='keywords' content='component_security, status_open_issue_todo'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T11:31:33Z' class='post-time'>
                December 20, 2019, 11:31am
              </time>
              <meta itemprop='dateModified' content='2019-12-20T11:31:33Z'>
          <span itemprop='position'>#22</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>This is the script output as of now.</p>
<blockquote>
<p>run: dpkg-statoverride --add --update root root 0755 /home<br>
run: dpkg-statoverride --add --update user user 0700 /home/user<br>
run: dpkg-statoverride --add --update root root 0700 /root<br>
run: dpkg-statoverride --add --update root root 0700 /boot<br>
run: dpkg-statoverride --add --update root root 0600 /etc/permission-hardening.d<br>
INFO: fso: â€˜/usr/local/etc/permission-hardening.dâ€™ - does not exist. This is likely normal.<br>
INFO: set-user-id  found - file_name: â€˜/bin/fusermountâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /bin/fusermount<br>
INFO: set-user-id  found - file_name: â€˜/bin/suâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /bin/su<br>
INFO: set-user-id  found - file_name: â€˜/bin/ntfs-3gâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /bin/ntfs-3g<br>
INFO: set-user-id  found - file_name: â€˜/usr/bin/sudoâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/sudo<br>
INFO: set-user-id  found - file_name: â€˜/usr/bin/chshâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/chsh<br>
INFO:  set-group-id found - file_name: â€˜/usr/bin/crontabâ€™ | existing_mode: â€˜2755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --remove /usr/bin/crontab<br>
run: dpkg-statoverride --add --update root crontab 755 /usr/bin/crontab<br>
INFO: set-user-id  found - file_name: â€˜/usr/bin/chfnâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/chfn<br>
INFO:  set-group-id found - file_name: â€˜/usr/bin/ssh-agentâ€™ | existing_mode: â€˜2755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root ssh 755 /usr/bin/ssh-agent<br>
INFO: set-user-id  found - file_name: â€˜/usr/bin/newuidmapâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/newuidmap<br>
INFO: set-user-id  found - file_name: â€˜/usr/bin/pkexec.security-misc-origâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/pkexec.security-misc-orig<br>
INFO: set-user-id  found - file_name: â€˜/usr/bin/bwrapâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/bwrap<br>
INFO:  set-group-id found - file_name: â€˜/usr/bin/chageâ€™ | existing_mode: â€˜2755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root shadow 755 /usr/bin/chage<br>
INFO: fso: â€˜/usr/local/bin/â€™ - does not exist. This is likely normal.<br>
INFO: set-user-id  found - file_name: â€˜/sbin/mount.nfsâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /sbin/mount.nfs<br>
INFO: fso: â€˜/usr/local/sbin/â€™ - does not exist. This is likely normal.<br>
INFO: set-user-id  found - file_name: â€˜/usr/lib/policykit-1/polkit-agent-helper-1â€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/policykit-1/polkit-agent-helper-1<br>
INFO: set-user-id  found - file_name: â€˜/usr/lib/eject/dmcrypt-get-deviceâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/eject/dmcrypt-get-device<br>
INFO: set-user-id set-group-id found - file_name: â€˜/usr/lib/virtualbox/VBoxNetDHCPâ€™ | existing_mode: â€˜6755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/virtualbox/VBoxNetDHCP<br>
INFO: set-user-id set-group-id found - file_name: â€˜/usr/lib/virtualbox/VBoxNetNATâ€™ | existing_mode: â€˜6755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/virtualbox/VBoxNetNAT<br>
INFO: set-user-id set-group-id found - file_name: â€˜/usr/lib/virtualbox/VBoxHeadlessâ€™ | existing_mode: â€˜6755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/virtualbox/VBoxHeadless<br>
INFO: set-user-id  found - file_name: â€˜/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nicâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic<br>
INFO: set-user-id  found - file_name: â€˜/usr/lib/dbus-1.0/dbus-daemon-launch-helperâ€™ | existing_mode: â€˜4754â€™ | new_mode: â€˜754â€™<br>
run: dpkg-statoverride --remove /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>
run: dpkg-statoverride --add --update root messagebus 754 /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>
INFO: set-user-id  found - file_name: â€˜/usr/lib/kde4/libexec/filesharesetâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/kde4/libexec/fileshareset<br>
INFO:  set-group-id found - file_name: â€˜/usr/lib/kde4/libexec/kdesudâ€™ | existing_mode: â€˜2755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root nogroup 755 /usr/lib/kde4/libexec/kdesud<br>
INFO: set-user-id  found - file_name: â€˜/usr/lib/chromium/chrome-sandboxâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/chromium/chrome-sandbox<br>
INFO: set-user-id  found - file_name: â€˜/usr/lib/qubes/qfile-unpackerâ€™ | existing_mode: â€˜4755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/qubes/qfile-unpacker<br>
INFO:  set-group-id found - file_name: â€˜/usr/lib/evolution/camel-lock-helper-1.2â€™ | existing_mode: â€˜2755â€™ | new_mode: â€˜755â€™<br>
run: dpkg-statoverride --add --update root mail 755 /usr/lib/evolution/camel-lock-helper-1.2<br>
INFO: fso: â€˜/usr/lib64/â€™ - does not exist. This is likely normal.<br>
INFO: fso: â€˜/usr/local/lib/â€™ - does not exist. This is likely normal.<br>
INFO: fso: â€˜/usr/local/lib32/â€™ - does not exist. This is likely normal.<br>
INFO: fso: â€˜/usr/local/lib64/â€™ - does not exist. This is likely normal.<br>
run: dpkg-statoverride --add --update root root 4755 /usr/bin/sudo<br>
run: dpkg-statoverride --add --update root root 4755 /usr/bin/bwrap<br>
run: dpkg-statoverride --add --update root root 4755 /usr/lib/policykit-1/polkit-agent-helper-1<br>
INFO: fso: â€˜/usr/lib/spice-gtk/spice-client-glib-usb-acl-helperâ€™ - does not exist. This is likely normal.<br>
run: dpkg-statoverride --add --update root utmp 2755 /usr/lib/x86_64-linux-gnu/utempter/utempter</p>
</blockquote>
<p>new_mode is either <code>755</code> or <code>754</code>. I.e. has still execution permission for <code>others</code> or <code>group</code>.</p>
<p>For config entries stating <code>nosuid</code> only: Would it be a good idea to hardcode / change <code>newmode</code> of these to <code>744</code>? I.e. to remove exeution permission for <code>others</code> and `group?</p>
<pre><code>  if [ "$new_mode" = "755" ]; then
    new_mode=744
  fi
  if [ "$new_mode" = "754" ]; then
    new_mode=744
  fi
  if [ "$new_mode" = "745" ]; then
    new_mode=744
  fi
</code></pre>
<p>I guess the question is:</p>
<p><strong>Are there suid or guid binaries which are still useful if suid / guid has been removed from these?</strong></p>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T12:05:52Z' class='post-time'>
                December 20, 2019, 12:05pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T12:05:52Z'>
          <span itemprop='position'>#23</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Could you please review if it is sane to remove suid / guid from the following binaries? <a class="mention" href="../../../external.html?link=https://forums.whonix.org/u/madaidan">@madaidan</a></p>
<blockquote>
<p>run: dpkg-statoverride --add --update root root 755 /bin/fusermount<br>
run: dpkg-statoverride --add --update root root 755 /bin/su<br>
run: dpkg-statoverride --add --update root root 755 /bin/ntfs-3g<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/sudo<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/chsh<br>
run: dpkg-statoverride --remove /usr/bin/crontab<br>
run: dpkg-statoverride --add --update root crontab 755 /usr/bin/crontab<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/chfn<br>
run: dpkg-statoverride --add --update root ssh 755 /usr/bin/ssh-agent<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/newuidmap<br>
run: dpkg-statoverride --add --update root root 755 /usr/bin/pkexec.security-misc-orig<br>
run: dpkg-statoverride --add --update root shadow 755 /usr/bin/chage<br>
run: dpkg-statoverride --add --update root root 755 /sbin/mount.nfs<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/policykit-1/polkit-agent-helper-1<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/eject/dmcrypt-get-device<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/virtualbox/VBoxNetDHCP<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/virtualbox/VBoxNetNAT<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/virtualbox/VBoxHeadless<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic<br>
run: dpkg-statoverride --add --update root messagebus 754 /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/kde4/libexec/fileshareset<br>
run: dpkg-statoverride --add --update root nogroup 755 /usr/lib/kde4/libexec/kdesud<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/chromium/chrome-sandbox<br>
run: dpkg-statoverride --add --update root root 755 /usr/lib/qubes/qfile-unpacker<br>
run: dpkg-statoverride --add --update root mail 755 /usr/lib/evolution/camel-lock-helper-1.2<br>
run: dpkg-statoverride --add --update root root 4755 /usr/lib/policykit-1/polkit-agent-helper-1<br>
run: dpkg-statoverride --add --update root utmp 2755 /usr/lib/x86_64-linux-gnu/utempter/utempter</p>
</blockquote>
<p>Does the suid default whitelist need to be expanded?<br>
Specifically, letâ€™s not break chromium and virtualbox.</p>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T12:58:38Z' class='post-time'>
                December 20, 2019, 12:58pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T12:58:38Z'>
          <span itemprop='position'>#24</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Found some issue.</p>
<blockquote>
<p>Dec 20 07:54:47 disp3633 permission-hardening[26043]: + seq -w 000 4777<br>
Dec 20 07:54:47 disp3633 permission-hardening[26043]: + grep -qw 2755<br>
Dec 20 07:54:47 disp3633 permission-hardening[26043]: seq: write error: Broken pipe</p>
</blockquote>
<p>Need to use a better regex here.</p>
<p>Another issue.</p>
<blockquote>
<p>user@disp3633:~$ sudoedit /usr/lib/security-misc/permission-hardening<br>
sudoedit: /usr/bin/sudoedit must be owned by uid 0 and have the setuid bit set<br>
user@disp3633:~$ sudo test<br>
sudo: /usr/bin/sudo must be owned by uid 0 and have the setuid bit set</p>
</blockquote>
<p>That is because there is a significant time gap between suid removal from <code>/usr/bin</code> and re-adding the whitelist of <code>/usr/bin/sudo</code>. Therefore we need to implement the whitelist another way. Not by first removing suid and then re-adding. Better to not modify file permissions of <code>sudo</code> (and other white listed ones) at all. Otherwise this can cause a lot bugs which are timing dependent (when other scripts use <code>sudo</code>).</p>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T13:03:16Z' class='post-time'>
                December 20, 2019,  1:03pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T13:03:16Z'>
          <span itemprop='position'>#25</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="13" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Found some issue.</p>
<blockquote>
<p>Dec 20 07:54:47 disp3633 permission-hardening[26043]: + seq -w 000 4777<br>
Dec 20 07:54:47 disp3633 permission-hardening[26043]: + grep -qw 2755<br>
Dec 20 07:54:47 disp3633 permission-hardening[26043]: seq: write error: Broken pipe</p>
</blockquote>
<p>Need to use a better regex here.</p>
</blockquote>
</aside>
<p>Not perfect but functional.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/d5f1bd8dd29a4f9e1ccb6fed82a255f7b7abfe6f" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/d5f1bd8dd29a4f9e1ccb6fed82a255f7b7abfe6f" target="_blank">fix mode sanity check</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-20" data-time="13:02:30" data-timezone="UTC">01:02PM - 20 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 6 additions and 1 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/d5f1bd8dd29a4f9e1ccb6fed82a255f7b7abfe6f" target="_blank">
          <span class="added">+6</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">no longer use seq due to issue
https://forums.whonix.org/t/permission-hardening/8655/13</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T13:14:19Z' class='post-time'>
                December 20, 2019,  1:14pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T13:14:19Z'>
          <span itemprop='position'>#26</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="13" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Another issue.</p>
<blockquote>
<p>user@disp3633:~$ sudoedit /usr/lib/security-misc/permission-hardening<br>
sudoedit: /usr/bin/sudoedit must be owned by uid 0 and have the setuid bit set<br>
user@disp3633:~$ sudo test<br>
sudo: /usr/bin/sudo must be owned by uid 0 and have the setuid bit set</p>
</blockquote>
<p>That is because there is a significant time gap between suid removal from <code>/usr/bin</code> and re-adding the whitelist of <code>/usr/bin/sudo</code> . Therefore we need to implement the whitelist another way. Not by first removing suid and then re-adding. Better to not modify file permissions of <code>sudo</code> (and other white listed ones) at all. Otherwise this can cause a lot bugs which are timing dependent (when other scripts use <code>sudo</code> ).</p>
</blockquote>
</aside>
<p>Now also fixed:</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/6d30e3b4a2c0e5cf53d88b4a033511aa49b8f227" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/6d30e3b4a2c0e5cf53d88b4a033511aa49b8f227" target="_blank">do not remove suid from whitelisted binaries ever</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-20" data-time="13:13:23" data-timezone="UTC">01:13PM - 20 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 2 files with 28 additions and 8 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/6d30e3b4a2c0e5cf53d88b4a033511aa49b8f227" target="_blank">
          <span class="added">+28</span>
          <span class="removed">-8</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">https://forums.whonix.org/t/permission-hardening/8655/13</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T13:59:10Z' class='post-time'>
                December 20, 2019,  1:59pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T13:59:10Z'>
          <span itemprop='position'>#27</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="6" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<blockquote>
<blockquote>
<p>fso: /lib/<br>
usr/lib/security-misc/permission-hardening: line 19: /usr/bin/stat: Argument list too long</p>
</blockquote>
<p>Can reproduce manually too.</p>
<pre><code class="lang-auto">shopt -s globstar
</code></pre>
</blockquote>
<p>stat -c â€œ%n %a %U %Gâ€ /lib/**</p>
<blockquote>
<pre><code class="lang-auto">&gt; bash: /usr/bin/stat: Argument list too long
</code></pre>
</blockquote>
<p>We are hitting <code>ARG_MAX</code></p>
<pre><code class="lang-auto">getconf ARG_MAX
</code></pre>
<p>more info:<br>
<a href="../../../external.html?link=https://www.linuxjournal.com/article/6060">https://www.linuxjournal.com/article/6060</a></p>
<p><a href="../../../external.html?link=https://unix.stackexchange.com/questions/318470/how-can-i-prevent-arguments-to-xargs-from-being-prefixed-with-spaces">https://unix.stackexchange.com/questions/318470/how-can-i-prevent-arguments-to-xargs-from-being-prefixed-with-spaces</a> said <code>xargs</code> can split it up.</p>
<p>Will use</p>
<pre><code class="lang-auto">done &lt; &lt;( find "${fso_without_trailing_slash}/" -print0 | xargs -I{} -0 stat -c "%n %a %U %G" {} )
</code></pre>
<p>to fix it.</p>
</blockquote>
</aside>
<p>That does not work. It will â€œforgetâ€ to process some files.</p>
<pre><code>find /usr/bin | wc -l
</code></pre>
<blockquote>
<p>1149</p>
</blockquote>
<p>Added a counter.</p>
<blockquote>
<p>INFO: fso_to_process: â€˜/usr/bin/â€™ | counter: â€˜575â€™</p>
</blockquote>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T14:44:05Z' class='post-time'>
                December 20, 2019,  2:44pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T14:44:05Z'>
          <span itemprop='position'>#28</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="16" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>That does not work. It will â€œforgetâ€ to process some files.</p>
</blockquote>
</aside>
<p>Fixed.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/55faa7b9978df52bcb98a562554473f80db1f171" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/55faa7b9978df52bcb98a562554473f80db1f171" target="_blank">fix missing processing files bug</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-20" data-time="14:43:23" data-timezone="UTC">02:43PM - 20 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 23 additions and 2 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/55faa7b9978df52bcb98a562554473f80db1f171" target="_blank">
          <span class="added">+23</span>
          <span class="removed">-2</span>
        </a>
      </div>
    </div>

  </div>
</div>


  <div class="github-row">
    <pre class="github-content" style="white-space: normal;">https://forums.whonix.org/t/permission-hardening/8655/16</pre>
  </div>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T14:50:16Z' class='post-time'>
                December 20, 2019,  2:50pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T14:50:16Z'>
          <span itemprop='position'>#29</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <pre><code>sudo /usr/lib/security-misc/permission-hardening 
</code></pre>
<blockquote>
<p>sudo: /usr/bin/sudo must be owned by uid 0 and have the setuid bit set</p>
</blockquote>
<p>On Qubes there is also <code>/bin/sudo</code> and <code>/bin/brwap</code>. Fixed.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/e28da89253f646969cdc2b0b46617bd603f917a5" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 14 16" aria-hidden="true"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/e28da89253f646969cdc2b0b46617bd603f917a5" target="_blank">/bin/sudo whitelist / /bin/bwrap whitelist</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2019-12-20" data-time="14:48:06" data-timezone="UTC">02:48PM - 20 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank">
          <img alt="adrelanos" src="../../../external.html?link=https://avatars3.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
        
      </div>

      <div class="lines" title="changed 1 files with 2 additions and 0 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/security-misc/commit/e28da89253f646969cdc2b0b46617bd603f917a5" target="_blank">
          <span class="added">+2</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>




  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T15:28:39Z' class='post-time'>
                December 20, 2019,  3:28pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T15:28:39Z'>
          <span itemprop='position'>#30</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Found a way to crazy speed up things. Using <code>find</code> with <code>-perm /u=s,g=s</code>. Will add.</p>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T16:47:49Z' class='post-time'>
                December 20, 2019,  4:47pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T16:47:49Z'>
          <span itemprop='position'>#31</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="2" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Btw I make no claim that my code style is superior in any form but it is easier to grasp by my participial biased brain. Hope that is ok.</p>
</blockquote>
</aside>
<p>Itâ€™s fine. Do what you want. Youâ€™re better than me at writing bash scripts anyway.</p>
<aside class="quote no-group" data-post="10" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I.e. <code>su</code> is still executable by user <code>user</code> even though it has suid removed.</p>
</blockquote>
</aside>
<p>You can just add another rule for <code>su</code>:</p>
<pre><code>/bin/su 0700 root root
</code></pre>
<aside class="quote no-group" data-post="11" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Would it be a good idea to hardcode / change <code>newmode</code> of these to <code>744</code> ? I.e. to remove exeution permission for <code>others</code> and `group?</p>
</blockquote>
</aside>
<p>Whatâ€™s the point of reading binaries if it canâ€™t even be executed? Maybe just give a mode of <code>700</code>.</p>
<aside class="quote no-group" data-post="12" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Could you please review if it is sane to remove suid / guid from the following binaries?</p>
</blockquote>
</aside>
<p>Itâ€™s fine to remove it from most of them but whitelist sudo, virtualbox, polkit, dbus and chromium. Chromium only needs suid if unprivileged user namespaces are disabled which Debian does by default.</p>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T16:57:05Z' class='post-time'>
                December 20, 2019,  4:57pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T16:57:05Z'>
          <span itemprop='position'>#32</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Btw, I noticed in the script you refer to setgid as â€œguidâ€. Itâ€™s not â€œguidâ€ but â€œsgidâ€. GUID is <a href="../../../external.html?link=https://en.wikipedia.org/wiki/Universally_unique_identifier">different</a> and may cause confusion.</p>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T17:03:41Z' class='post-time'>
                December 20, 2019,  5:03pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T17:10:39Z'>
          <span itemprop='position'>#33</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="20" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<blockquote>
<p>Could you please review if it is sane to remove suid / guid from the following binaries?</p>
</blockquote>
<p>Itâ€™s fine to remove it from most of them but whitelist sudo, virtualbox, polkit, dbus and chromium. Chromium only needs suid if unprivileged user namespaces are disabled which Debian does by default.</p>
</blockquote>
</aside>
<p>VirtualBox has â€œplentyâ€. <code>6</code> at the moment.</p>
<p>In future, more/less might be added or paths might change. In that case, I would like to avoid hunting down bugs due to that.</p>
<p>Any reason not to add a nosuid whitelist matching feature? Could match for <code>/virtualbox/</code>.</p>
<p>I donâ€™t see how such a matching feature could be abused. Threat model:<br>
Any suid / sgid can only be abused by non-root as root does no longer need to escalate to root. Only only root (apt) and superroot can write to these folders anyhow. Therefore I see now way to create binaries which would match such names to gain access to a suid / sgid to be spared from suid removal. Well, there are ways, but those capable to to write to these folders do not need to bother with suid / sgid anymore.</p>
<aside class="quote no-group" data-post="21" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Btw, I noticed in the script you refer to setgid as â€œguidâ€. Itâ€™s not â€œguidâ€ but â€œsgidâ€. GUID is <a href="../../../external.html?link=https://en.wikipedia.org/wiki/Universally_unique_identifier">different</a> and may cause confusion.</p>
</blockquote>
</aside>
<p>Fixed in git master.</p>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T17:12:42Z' class='post-time'>
                December 20, 2019,  5:12pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T17:12:42Z'>
          <span itemprop='position'>#34</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="22" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>VirtualBox has â€œplentyâ€. 6 at the moment.</p>
</blockquote>
</aside>
<p>Are any of these actually used? Is there any breakage from removing their SUID bits? If not, then we can just ignore them.</p>
<p>I doubt VboxNetDHCP would be used seeing as Whonix doesnâ€™t even use DHCP at all.</p>
<aside class="quote no-group" data-post="22" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Could match for <code>/virtualbox/</code> .</p>
</blockquote>
</aside>
<p>Would be better to match for <code>/usr/lib/virtualbox/</code> in case some random directory that just happens to have the name â€œvirtualboxâ€ gets whitelisted.</p>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T17:39:46Z' class='post-time'>
                December 20, 2019,  5:39pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T17:39:46Z'>
          <span itemprop='position'>#35</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>
<p>set-user-id set-group-id found - file_name: â€˜/usr/lib/xorg/Xorg.wrapâ€™</p>
</blockquote>
<p>Needed?</p>
<ul>
<li><a href="../../../external.html?link=https://manpages.debian.org/buster/xserver-xorg-legacy/Xorg.wrap.1.en.html">https://manpages.debian.org/buster/xserver-xorg-legacy/Xorg.wrap.1.en.html</a></li>
<li><a href="../../../external.html?link=https://lwn.net/Articles/590315/">https://lwn.net/Articles/590315/</a></li>
</ul>
<p>At first sight looks important. But Debian / systemd might not use / need it.</p>
<aside class="quote no-group" data-post="23" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Are any of these actually used? Is there any breakage from removing their SUID bits? If not, then we can just ignore them.</p>
</blockquote>
</aside>
<p>Not yet tested. Canâ€™t find anything online what these are used for. Testing this can be future work.</p>
<aside class="quote no-group" data-post="23" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>I doubt VboxNetDHCP would be used seeing as Whonix doesnâ€™t even use DHCP at all.</p>
</blockquote>
</aside>
<p>security-misc isnâ€™t just used by Whonix. I donâ€™t want to break VirtualBox (hosts) for those who install security-misc or Kicksecure.</p>
<aside class="quote no-group" data-post="23" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Would be better to match for <code>/usr/lib/virtualbox/</code> in case some random directory that just happens to have the name â€œvirtualboxâ€ gets whitelisted.</p>
</blockquote>
</aside>
<p>Will add.</p>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T18:17:39Z' class='post-time'>
                December 20, 2019,  6:17pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T18:17:39Z'>
          <span itemprop='position'>#36</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="24" data-topic="8655">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Needed?</p>
</blockquote>
</aside>
<p>No, Debian and many other linux distros use Xorg rootless by default so thereâ€™s no need for the suid wrapper unless the user themselves has configured X to run as root for whatever reason (which is a security risk due to Xâ€™s large attack surface).</p>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T19:02:19Z' class='post-time'>
                December 20, 2019,  7:02pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T19:02:19Z'>
          <span itemprop='position'>#37</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>We can use this to remove capabilities of some unneeded binaries too by using the <code>none</code> capability rule.</p>
<pre><code>getcap -r / 2&gt;/dev/null
</code></pre>
<blockquote>
<p>/usr/lib/x86_64-linux-gnu/gstreamer1.0/grstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep<br>
/bin/ping = cap_net_raw+ep</p>
</blockquote>
<p>I think we should remove the capabilities of <code>/bin/ping</code> since it doesnâ€™t work with Tor anyway.</p>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T19:43:41Z' class='post-time'>
                December 20, 2019,  7:43pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T19:43:41Z'>
          <span itemprop='position'>#38</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>We can add Whonix specific things such as ping capability removal to anon-apps-config package as a drop- snippet.</p>
<p>Pull requests welcome.</p>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-20T20:04:13Z' class='post-time'>
                December 20, 2019,  8:04pm
              </time>
              <meta itemprop='dateModified' content='2019-12-20T20:04:13Z'>
          <span itemprop='position'>#39</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/anon-apps-config/pull/6" target="_blank">github.com/Whonix/anon-apps-config</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Whonix/anon-apps-config/pull/6" target="_blank">Remove ping capabilities</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> â† <code>madaidan:ping-capabilities</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2019-12-20" data-time="20:03:55" data-timezone="UTC">08:03PM - 20 Dec 19 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/madaidan" target="_blank">
          <img alt="madaidan" src="../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>

      <div class="lines" title="2 commits changed 2 files with 10 additions and 0 deletions">
        <a href="../../../external.html?link=https://github.com/Whonix/anon-apps-config/pull/6/files" target="_blank">
          <span class="added">+10</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>

  </div>
</div>
  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="7706.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-21T07:34:55Z' class='post-time'>
                December 21, 2019,  7:34am
              </time>
              <meta itemprop='dateModified' content='2020-01-01T20:10:32Z'>
          <span itemprop='position'>#40</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>This is now in the developers repository. Enabling it will be easy.</p>
<pre><code>sudo systemctl enable permission-hardening.service
</code></pre>
<p>It might be enabled by default one day (similar to <a href="../restrict-hardware-information-to-root-testers-wanted/8618.html" class="inline-onebox">Restrict Hardware Information to Root - Testers Wanted!</a>) but it needs a fair amount of testing as I am running into many issues here.</p>
<p>Weâ€™ll also need some way to record changes and to undo these.</p>
<hr>
<p>Breaks whonix-firewall.</p>
<blockquote>
<p>Dec 21 06:43:54 host enable-firewall[351]: iptables/1.8.2 Failed to initialize nft: Protocol not supported</p>
</blockquote>
        </div>

        <meta itemprop='headline' content='SUID Disabler and Permission Hardener'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="7706.html">â† previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="77069ba9.html?page=3">next page â†’</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

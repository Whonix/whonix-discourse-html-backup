<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>ProxyVM + AppVM Development - Qubes-Whonix - Whonix Forum</title>
    <meta name="description" content="I don&amp;#39;t know how far you have gotten in getting Whonix working as an appvm but I thought I would share my code to build it as a appvm / proxyvm if you were interested. 

I couldn&amp;#39;t figure out how to get the HVM to go ful&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="5129ba9.html?page=3" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;ProxyVM + AppVM Development&#39;" href="512.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/proxyvm-appvm-development/512?page=3" />
<meta name="twitter:url" content="https://forums.whonix.org/t/proxyvm-appvm-development/512?page=3" />
<meta property="og:title" content="ProxyVM + AppVM Development" />
<meta name="twitter:title" content="ProxyVM + AppVM Development" />
<meta property="og:description" content="[quote=“nrgaway, post:39, topic:512”]What stage was that within?  ./whonix-install sources  ./whonix-install build  ./whonix-install template whonix-gateway[/quote]  It was within: ./whonix-install build  [hr]   Yes. I believe so.  [hr]   Is this for Fedora AppVM or chroot-wheezy?  In the Fedora AppVM:  sudo ls -lsa /home/user/.gnupg total 24   4  drwx------   2 root  root 4096 .   4  drwx------ 17 user user 4096 .. 12 -rw-------      1 root root 9188 gpg.conf   0 -rw-------      1 root root    ..." />
<meta name="twitter:description" content="[quote=“nrgaway, post:39, topic:512”]What stage was that within?  ./whonix-install sources  ./whonix-install build  ./whonix-install template whonix-gateway[/quote]  It was within: ./whonix-install build  [hr]   Yes. I believe so.  [hr]   Is this for Fedora AppVM or chroot-wheezy?  In the Fedora AppVM:  sudo ls -lsa /home/user/.gnupg total 24   4  drwx------   2 root  root 4096 .   4  drwx------ 17 user user 4096 .. 12 -rw-------      1 root root 9188 gpg.conf   0 -rw-------      1 root root    ..." />
<meta property="article:published_time" content="2014-09-25T21:49:11+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="5124658.html?page=2">
        <link rel="next" href="512fdb0.html?page=4">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="512.html">ProxyVM + AppVM Development</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/qubes-whonix/12.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #63a0ff'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Qubes-Whonix</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-25T21:49:11Z' class='post-time'>
                September 25, 2014,  9:49pm
              </time>
              <meta itemprop='dateModified' content='2014-09-25T21:49:11Z'>
          <span itemprop='position'>#41</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“nrgaway, post:39, topic:512”]What stage was that within?</p>
<p>./whonix-install sources<br>
./whonix-install build<br>
./whonix-install template whonix-gateway[/quote]</p>
<p>It was within: ./whonix-install build</p>
<p>[hr]</p>
<aside class="quote" data-post="39" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/n/f17d59/40.png" class="avatar"> nrgaway:</div>
<blockquote>
<p>Also, are you sure you checked out the whonix branch?</p>
</blockquote>
</aside>
<p>Yes. I believe so.</p>
<p>[hr]</p>
<aside class="quote" data-post="39" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/n/f17d59/40.png" class="avatar"> nrgaway:</div>
<blockquote>
<p>I am wondering what the permissions of `/home/user/.gnupg/trustdb.gpg’ are and its parent directory?</p>
</blockquote>
</aside>
<p>Is this for Fedora AppVM or chroot-wheezy?</p>
<p>In the Fedora AppVM:</p>
<pre><code class="lang-auto">sudo ls -lsa /home/user/.gnupg</code></pre>
<blockquote>total 24
  4  drwx------   2 root  root 4096 .
  4  drwx------ 17 user user 4096 ..
12 -rw-------      1 root root 9188 gpg.conf
  0 -rw-------      1 root root        0 pubring.gpg
  4 -rw-------      1 root root    600 random_seed
  0 -rw-------      1 root root        0 secring.gpg</blockquote>
<p>In chroot-wheezy:</p>
<pre><code class="lang-auto">cd /home/user/qubes-builder/chroot-wheezy/home/user
sudo ls -lsa .gnupg</code></pre>
<blockquote>ls: cannot access .gnupg: No such file or directory</blockquote>
<p>[hr]</p>
<aside class="quote" data-post="39" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/n/f17d59/40.png" class="avatar"> nrgaway:</div>
<blockquote>
<p>Maybe check that and that the ‘trustdb.gpg’ actually exists.</p>
</blockquote>
</aside>
<p>Didn’t see it in above places: “/home/user/.gnupg” or “/home/user/qubes-builder/chroot-wheezy/home/user/.gnupg”</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-25T22:07:37Z' class='post-time'>
                September 25, 2014, 10:07pm
              </time>
              <meta itemprop='dateModified' content='2014-09-25T22:07:37Z'>
          <span itemprop='position'>#42</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="40" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Great explanation on the Qubes IPs, thanks!</p>
</blockquote>
</aside>
<p>You’re welcome, Patrick! After laying out my general understanding, let me know if you’d still like me to pose a specific question to qubes-devel.</p>
<p>[hr]</p>
<aside class="quote" data-post="40" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Dynamic IPs will make setting up Tor hidden services real cumbersome, I think. Because each time the workstation’s IP changes, /etc/tor/torrc has to be edited. How does TorVM solve this?</p>
</blockquote>
</aside>
<p>Yes. In general, TorVM seems to run a startup script (startup.sh) that auto generates a new /etc/tor/torrc file and dynamically populates variables.</p>
<p>See nrgaway’s post: <a href="../../../external.html?link=https://www.whonix.org/forum/index.php/topic,537.msg4376.html#msg4376" rel="nofollow noopener">https://www.whonix.org/forum/index.php/topic,537.msg4376.html#msg4376</a></p>
<p>[hr]</p>
<aside class="quote" data-post="40" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Perhaps since you’re discussing build issues here, should we start a separate topic about IPs?</p>
</blockquote>
</aside>
<p>Either way…</p>
<ul>
<li>Split off networking discussion.</li>
<li>Split off build discussion.</li>
<li>Or keep things integrated here until an initial ProxyVM + AppVM build is achieved.</li>
</ul>
<p>I don’t mind.</p>
<p>I’m guessing there will likely be other development issues beyond networking and code building for this initial ProxyVM + AppVM development work.</p>
<p>Whatever works for you guys.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-25T23:03:22Z' class='post-time'>
                September 25, 2014, 11:03pm
              </time>
              <meta itemprop='dateModified' content='2014-09-25T23:03:22Z'>
          <span itemprop='position'>#43</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Give me till the end of the weekend on the IP issue.  Now you have detailed what each package is used for in the Wiki I can manually make changes on my end and when it starts working where I can get a connection to outside world, etc I will have a better idea how to handle this.</p>
<p>As for the torrc, I will just set up a udev rule that will trigger a search and replace on the torrc file; that’s how torvm does it, so it may not be that difficult.  It looks like the udev rule is also responsible for activating the virtual interface.</p>
<p>Now, on to that build error.  I get it too with a fresh VM install.  I kind of remember I had to create a trust key when I first started out, so I will get back to you when I figure out what to do again <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-25T23:23:13Z' class='post-time'>
                September 25, 2014, 11:23pm
              </time>
              <meta itemprop='dateModified' content='2014-09-25T23:23:13Z'>
          <span itemprop='position'>#44</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“WhonixQubes, post:37, topic:512”]White trying to build, I got a fatal build error:</p>
<aside class="quote">
<blockquote>
<ul>
<li>echo main/binary-amd64/Packages</li>
<li>rm -f dists/wheezy/Release.gpg</li>
<li>gpg -abs --no-default-keyring --secret-keyring /home/user/qubes-builder/keys_debian/wheezy-secring.gpg --keyring /home/user/qubes-builder/keys_debian/wheezy-pubring.gpg -o dists/wheezy/Release.gpg dists/wheezy/Release<br>
gpg: can’t access `/home/user/.gnupg/trustdb.gpg’: Permission denied<br>
gpg: fatal: can’t init trustdb: trust database error<br>
secmem usage: 1408/1408 bytes in 2/2 blocks of pool 1408/32768<br>
make[2]: *** [dist-build-dep] Error 2<br>
–&gt; build failed!<br>
make[1]: *** [packages] Error 1<br>
make: *** [core-vchan-xen-vm] Error 1<br>
[user@fedoravm qubes-builder]$</li>
</ul>
</blockquote>
</aside>
<p>I will try running through it again and see if this fatal error reoccurs.[/quote]</p>
<p>Looks like .gnupg is owned by root, so change permissions to user and it will work</p>
<pre><code class="lang-auto">sudo chown -R user.user ~/.gnupg</code></pre>
<p>I added this to the whonix-install script; not sure when that directory gets created so if you get error on build, just run build again and the problem should be resolved.</p>
<p>But since you have older version of whonix-install, just run the command</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-25T23:32:28Z' class='post-time'>
                September 25, 2014, 11:32pm
              </time>
              <meta itemprop='dateModified' content='2014-09-25T23:32:28Z'>
          <span itemprop='position'>#45</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="43" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/n/f17d59/40.png" class="avatar"> nrgaway:</div>
<blockquote>
<p>Give me till the end of the weekend on the IP issue.  Now you have detailed what each package is used for in the Wiki I can manually make changes on my end and when it starts working where I can get a connection to outside world, etc I will have a better idea how to handle this.</p>
</blockquote>
</aside>
<p>Great.</p>
<aside class="quote" data-post="43" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/n/f17d59/40.png" class="avatar"> nrgaway:</div>
<blockquote>
<p>As for the torrc, I will just set up a udev rule that will trigger a search and replace on the torrc file; that’s how torvm does it, so it may not be that difficult.  It looks like the udev rule is also responsible for activating the virtual interface.</p>
</blockquote>
</aside>
<p>Ok.</p>
<aside class="quote" data-post="43" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/n/f17d59/40.png" class="avatar"> nrgaway:</div>
<blockquote>
<p>Now, on to that build error.  I get it too with a fresh VM install.  I kind of remember I had to create a trust key when I first started out, so I will get back to you when I figure out what to do again <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</blockquote>
</aside>
<p>Good to know it wasn’t specific to my machine.</p>
<p>[quote=“nrgaway, post:44, topic:512”]Looks like .gnupg is owned by root, so change permissions to user and it will work</p>
<pre><code class="lang-auto">sudo chown -R user.user ~/.gnupg</code></pre>
<p>I added this to the whonix-install script; not sure when that directory gets created so if you get error on build, just run build again and the problem should be resolved.</p>
<p>But since you have older version of whonix-install, just run the command[/quote]</p>
<p>Yup. Will do! Thanks for your awesome work on this project! <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-26T03:08:41Z' class='post-time'>
                September 26, 2014,  3:08am
              </time>
              <meta itemprop='dateModified' content='2014-09-26T03:08:41Z'>
          <span itemprop='position'>#46</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Sounds good on the IP topic.</p>
<p>[hr]</p>
<p>Reading user’s ~/.gnupg in a build script sounds like a bug anyhow.</p>
<p>For Whonix something like this is in use…</p>
<pre><code class="lang-auto">gpg \
   --no-options \
   --no-default-keyring \
   --homedir "$some_folder_variable" \
   ...</code></pre>
<p>Depending on what you are doing, you may need a temporary/empty/non-empty folder.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-26T17:21:17Z' class='post-time'>
                September 26, 2014,  5:21pm
              </time>
              <meta itemprop='dateModified' content='2014-09-26T17:21:17Z'>
          <span itemprop='position'>#47</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="43" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/n/f17d59/40.png" class="avatar"> nrgaway:</div>
<blockquote>
<p>As for the torrc, I will just set up a udev rule that will trigger a search and replace on the torrc file; that’s how torvm does it, so it may not be that difficult.  It looks like the udev rule is also responsible for activating the virtual interface.</p>
</blockquote>
</aside>
<p>Interesting idea!</p>
<p>Three things coming to my mind, you probably know this already, just in case:</p>
<ul>
<li>When IP changes again after you searched and replaced it, then next time you have to search the one you set last time before replacing it with the even never value.</li>
<li>Therefore it’s probably most robust if your script is idempotent*.</li>
<li>When the <a href="../../../external.html?link=https://github.com/Whonix/anon-gw-anonymizer-config">https://github.com/Whonix/anon-gw-anonymizer-config</a> package gets upgraded, it might ship a new <a href="../../../external.html?link=https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/usr/share/tor/tor-service-defaults-torrc.anondist">https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/usr/share/tor/tor-service-defaults-torrc.anondist</a>. Then you’d be back to Whonix’s IP default 10.152.152.10. Also the postinst script (<a href="../../../external.html?link=https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/debian/anon-gw-anonymizer-config.postinst#L33">https://github.com/Whonix/anon-gw-anonymizer-config/blob/master/debian/anon-gw-anonymizer-config.postinst#L33</a>) will force-reload Tor (if Tor is running). So we should run your search and replace script from the postinst script as well before it force-reloads Tor. [+checking condition that we are running in Qubes.] Adding such a hook is simple and fun, happy to help.</li>
</ul>
<p>*idempotent is defined here as per debian policy (<a href="../../../external.html?link=https://www.debian.org/doc/debian-policy/ch-maintainerscripts.html">https://www.debian.org/doc/debian-policy/ch-maintainerscripts.html</a>) “Maintainer scripts idempotency”. In short: it shouldn’t matter if one manually re-runs the script several times in a row and it would be best if it could recover if the script was terminated in the middle (unlikely, but possible due to power failure, user error, etc.).</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/marmarek'><span itemprop='name'>marmarek</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-28T14:42:08Z' class='post-time'>
                September 28, 2014,  2:42pm
              </time>
              <meta itemprop='dateModified' content='2014-09-28T14:42:08Z'>
          <span itemprop='position'>#48</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Hi!</p>
<p>If Whonix gateway IP address is hardcoded in too much places, you can just leave it as it is and use some NAT rules to hide it from Qubes infrastructure. Something like this:</p>
<ol>
<li>Workstation uses IP assigned by Qubes.</li>
<li>Gateway uses IP assigned by Qubes, and has additional dummy interface (modprobe dummy) with IP 10.152.152.10</li>
<li>Gateway: iptables -t nat -A PR-QBS-SERVICES -d 10.152.152.10 -j REDIRECT (PR-QBS-SERVICES is called from PREROUTING, specifically for this purpose)<br>
This way whatever is sent to 10.152.152.10, it will be intercepted by the gateway.<br>
The same approach is already used in Qubes for updates proxy - VM can send traffic to 10.137.255.254 and it will be intercepted by updates proxy, wherever it is. Details here: <a href="../../../external.html?link=https://wiki.qubes-os.org/wiki/SoftwareUpdateVM#Technicaldetails" rel="nofollow noopener">https://wiki.qubes-os.org/wiki/SoftwareUpdateVM#Technicaldetails</a>
</li>
</ol>
<p>This wont be as simple for workstation IP, but I guess it is much less problematic to change its IP.</p>
<p>Also I’m thinking how to make installation process as simple as possible. Is it possible to take a clean wheezy installation, add some apt repo and just install some metapackage, which will pull all the required stuff? If yes, IMHO it is the way to go. If no, can you still separate scripts for building clean wheezy from whonix? This way review would be much easier and your work will be reusable for other templates. In fact the current situation is almost good (at least in linux-template-builder), the commit history just contains some mess around it - perhaps I should look at the final diff (origin/master…nrgaway/master), not each commit separately…</p>
<p>Regarding AppVM/StandaloneVM - I assume you need some configuration/data persistence. Using StandaloneVM is rather inconvenient - at least because of disk space, but also more VMs to update. The easiest way would be to store such files in /rw (/rw/config? /rw/whonix?) and simply place symlinks in original location pointing at those files. Then add some startup script which will initialize /rw on the first boot. Keep in mind that template’s private.img isn’t accessible for VMs, so files to initialize /rw should be stores somewhere else.</p>
<p>For example I have this in /rw/config/rc.local in my UsbVM (where bluetooth adapter is attached):</p>
<pre><code class="lang-auto">rm -rf /var/lib/bluetooth 
ln -s /rw/config/var-lib-bluetooth /var/lib/bluetooth</code></pre>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="3" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-28T19:01:23Z' class='post-time'>
                September 28, 2014,  7:01pm
              </time>
              <meta itemprop='dateModified' content='2014-09-28T19:01:23Z'>
          <span itemprop='position'>#49</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Great idea about solving the IP question by using iptables!</p>
<p>I just updated the wiki a few moments ago to answer some questions (you were not the first to ask, and I wanted to do this for some time now).</p>
<p>This page is supposed to answer the feasibility of installing Whonix from a apt repository:<br>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../external.html?link=https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="../../../external.html?link=https://www.whonix.org/wiki/Dev/Installation_from_Repository" target="_blank" title="05:06PM - 01 May 2020">Whonix – 1 May 20</a>
  </header>
  <article class="onebox-body">
    <img src="#" class="thumbnail" width="" height="">

<h3><a href="../../../external.html?link=https://www.whonix.org/wiki/Dev/Installation_from_Repository" target="_blank">Dev/Installation from Repository - Whonix</a></h3>

<p>Also known as proverbial 'sudo apt-get install whonix' or 'distro-morphing'.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>Chroot-scripts get into the way, but likely there are solutions for that:<br>
</p><aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../external.html?link=https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="../../../external.html?link=https://www.whonix.org/wiki/Dev/Source_Code_Intro#Chroot_Scripts" target="_blank" title="05:19PM - 01 March 2020">Whonix – 1 Mar 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:598/500;"><img src="../../../external.html?link=https://www.whonix.org/w/images/f/fa/Accept-47587640.png" class="thumbnail" width="598" height="500"></div>

<h3><a href="../../../external.html?link=https://www.whonix.org/wiki/Dev/Source_Code_Intro#Chroot_Scripts" target="_blank">Dev/Source Code Intro - Whonix</a></h3>

<p>Introduction into Whonix ™ source code.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-28T22:41:19Z' class='post-time'>
                September 28, 2014, 10:41pm
              </time>
              <meta itemprop='dateModified' content='2014-09-28T22:41:19Z'>
          <span itemprop='position'>#50</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“marmarek, post:48, topic:512”]Hi!</p>
<p>If Whonix gateway IP address is hardcoded in too much places, you can just leave it as it is and use some NAT rules to hide it from Qubes infrastructure. Something like this:</p>
<ol>
<li>Workstation uses IP assigned by Qubes.</li>
<li>Gateway uses IP assigned by Qubes, and has additional dummy interface (modprobe dummy) with IP 10.152.152.10</li>
<li>Gateway: iptables -t nat -A PR-QBS-SERVICES -d 10.152.152.10 -j REDIRECT (PR-QBS-SERVICES is called from PREROUTING, specifically for this purpose)<br>
This way whatever is sent to 10.152.152.10, it will be intercepted by the gateway.<br>
The same approach is already used in Qubes for updates proxy - VM can send traffic to 10.137.255.254 and it will be intercepted by updates proxy, wherever it is. Details here: <a href="../../../external.html?link=https://wiki.qubes-os.org/wiki/SoftwareUpdateVM#Technicaldetails" rel="nofollow noopener">https://wiki.qubes-os.org/wiki/SoftwareUpdateVM#Technicaldetails</a>
</li>
</ol>
<p>This wont be as simple for workstation IP, but I guess it is much less problematic to change its IP.</p>
<p>Also I’m thinking how to make installation process as simple as possible. Is it possible to take a clean wheezy installation, add some apt repo and just install some metapackage, which will pull all the required stuff? If yes, IMHO it is the way to go. If no, can you still separate scripts for building clean wheezy from whonix? This way review would be much easier and your work will be reusable for other templates. In fact the current situation is almost good (at least in linux-template-builder), the commit history just contains some mess around it - perhaps I should look at the final diff (origin/master…nrgaway/master), not each commit separately…</p>
<p>Regarding AppVM/StandaloneVM - I assume you need some configuration/data persistence. Using StandaloneVM is rather inconvenient - at least because of disk space, but also more VMs to update. The easiest way would be to store such files in /rw (/rw/config? /rw/whonix?) and simply place symlinks in original location pointing at those files. Then add some startup script which will initialize /rw on the first boot. Keep in mind that template’s private.img isn’t accessible for VMs, so files to initialize /rw should be stores somewhere else.</p>
<p>For example I have this in /rw/config/rc.local in my UsbVM (where bluetooth adapter is attached):</p>
<p><code>
rm -rf /var/lib/bluetooth 
ln -s /rw/config/var-lib-bluetooth /var/lib/bluetooth
</code>[/quote]</p>
<p>In some of my more recent builds, I have already separated out Whonix from Wheezy installation.  Whonix now get installed as a flavor, like fedora uses for minimum install templates.  So linux-template-builder can now create a Jessie only, Wheezy only, Jessie+Whonix-gateway/workstation (untested), Wheezy+Whonix-gateway/workstation, or ability to add in any other custom template flavors since I added hooks for that.</p>
<p>The commit history is a mess since I had to try many different configurations to get things to work.  I will build a clean commit history once everything is working.</p>
<p>I have not had much time this weekend to work on the IP challenges, but will take a look at your solution as well now.  It seems very interesting.</p>
<p>The requirement of needing a standalone AppVM is only for testing purposes and will not be a requirement once I have this working.    I still need to work on the ability to update the main template though and it MUST be updated via a tor / Whonix connection, not via clearnet.</p>
<p>One other thing I am working on is the ability to install Whonix using Salt-Stack’s salt-minion.  This should allow Whonix to be installed on any Linux platform (using my custom formulas).  I can complete this once I get everything else working.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-28T23:08:30Z' class='post-time'>
                September 28, 2014, 11:08pm
              </time>
              <meta itemprop='dateModified' content='2014-09-28T23:08:30Z'>
          <span itemprop='position'>#51</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“marmarek, post:48, topic:512”]Hi!</p>
<p>… In fact the current situation is almost good (at least in linux-template-builder), the commit history just contains some mess around it - perhaps I should look at the final diff (origin/master…nrgaway/master), not each commit separately…[/quote]</p>
<p>Just wanted to further clarify that the whonix branch within linux-template-builder is a WIP branch with dirty commits.  It is not meant for use other than testing out different builds.  I will clean the commit history and merge into a fresh development branch once my testing is complete which will allow a clean merge or ability to cherry pick.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-29T02:34:10Z' class='post-time'>
                September 29, 2014,  2:34am
              </time>
              <meta itemprop='dateModified' content='2014-09-29T02:34:10Z'>
          <span itemprop='position'>#52</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="48" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/m/df705f/40.png" class="avatar"> marmarek:</div>
<blockquote>
<p>Hi!</p>
</blockquote>
</aside>
<p>Hi Marek. Welcome! <img src="../../images/emoji/twitter/smileyae52.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>[quote=“marmarek, post:48, topic:512”]If Whonix gateway IP address is hardcoded in too much places, you can just leave it as it is and use some NAT rules to hide it from Qubes infrastructure. Something like this:</p>
<ol>
<li>Workstation uses IP assigned by Qubes.</li>
<li>Gateway uses IP assigned by Qubes, and has additional dummy interface (modprobe dummy) with IP 10.152.152.10</li>
<li>Gateway: iptables -t nat -A PR-QBS-SERVICES -d 10.152.152.10 -j REDIRECT (PR-QBS-SERVICES is called from PREROUTING, specifically for this purpose)<br>
This way whatever is sent to 10.152.152.10, it will be intercepted by the gateway.<br>
The same approach is already used in Qubes for updates proxy - VM can send traffic to 10.137.255.254 and it will be intercepted by updates proxy, wherever it is. Details here: <a href="../../../external.html?link=https://wiki.qubes-os.org/wiki/SoftwareUpdateVM#Technicaldetails" rel="nofollow noopener">https://wiki.qubes-os.org/wiki/SoftwareUpdateVM#Technicaldetails</a>
</li>
</ol>
<p>This wont be as simple for workstation IP, but I guess it is much less problematic to change its IP.[/quote]</p>
<p>I’m wondering how this solution would end up affecting the user-level functionality of a ProxyVM Gateway + Dynamic AppVMs.</p>
<p>For example, based on my current understanding with Qubes Fedora-based ProxyVMs and AppVMs…</p>
<p>Let’s say the ProxyVM receives an IP address of 10.137.2.5.</p>
<p>Let’s say 3 AppVMs are networked (NetVM/backend) to the ProxyVM and receive the following IP addresses:</p>
<ul>
<li>AppVM-1 IP: 10.137.3.6</li>
<li>AppVM-2 IP: 10.137.3.7</li>
<li>AppVM-3 IP: 10.137.3.8</li>
</ul>
<p>Inside the ProxyVM, the following vif interfaces would be dynamically created for connectivity with the AppVMs (where 51,52,53 are used as example Xen VM IDs):</p>
<ul>
<li>vif51.0 IP: 10.137.3.1  (backend for AppVM-1)</li>
<li>vif52.0 IP: 10.137.3.1  (backend for AppVM-2)</li>
<li>vif53.0 IP: 10.137.3.1  (backend for AppVM-3)</li>
</ul>
<p>So the vifs in the ProxyVM use 10.137.3.1 as the IP which is used for the networking gateway address with AppVM eth0 interfaces.</p>
<p>My concerns with the iptables static redirect approach are:</p>
<ul>
<li>
<p>a) Would the Whonix-Gateway ProxyVM act like a “native” Qubes ProxyVM where other AppVMs can dynamically make use of its network connectivity?</p>
</li>
<li>
<p>b) Would multiple Whonix-Workstation AppVMs be able to dynamically utilize a Whonix-Gateway ProxyVM via the VM Manager GUI?</p>
</li>
</ul>
<p>Just on the surface, without having to do manual network configuration work on the user’s part, it seems the iptables redirect hack might limit the implementation to using a single AppVM with the ProxyVM, and specifically only using a Whonix AppVMs with a Whonix ProxyVM.</p>
<p>Trying to think ahead for Joanna’s intention to integrate Whonix along with TorVM as a native Qubes user experience in the official Qubes installer.</p>
<p>P.S. As a reference, here is the post where I laid out more of my comprehensive understanding of Qubes networking:</p>
<p><a href="../../../external.html?link=https://www.whonix.org/forum/index.php/topic,537.msg4378.html#msg4378" class="onebox" target="_blank" rel="nofollow noopener">https://www.whonix.org/forum/index.php/topic,537.msg4378.html#msg4378</a></p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-29T03:17:04Z' class='post-time'>
                September 29, 2014,  3:17am
              </time>
              <meta itemprop='dateModified' content='2014-09-29T03:17:04Z'>
          <span itemprop='position'>#53</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Question: Are you going to implement that iptables exception suggested by Marek for all versions of Whonix? I’d urge you to reconsider as spoofing IP addresses is very easy and can fool firewalls.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-29T07:37:27Z' class='post-time'>
                September 29, 2014,  7:37am
              </time>
              <meta itemprop='dateModified' content='2014-09-29T07:37:27Z'>
          <span itemprop='position'>#54</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="53" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Question: Are you going to implement that iptables exception suggested by Marek for all versions of Whonix? I’d urge you to reconsider as spoofing IP addresses is very easy and can fool firewalls.</p>
</blockquote>
</aside>
<p>I don’t think so, only in worst case scenario as Marek suggested.  There are many places that have a hard coded IP address today, but I imagine it will not be too difficult to lower that number considerably.</p>
<p>So far I have been successful using a search and replace on required files.  Once I can prove everything is working with the qubes install scripts we will know exactly what steps are required to get things going and at that point can figure out the best way to proceed.</p>
<p>I am very close to getting the ProxyVM working.  I had it going a few hours ago, just rebuilding another version with the changes I applied manually to it to get it working.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-29T10:56:07Z' class='post-time'>
                September 29, 2014, 10:56am
              </time>
              <meta itemprop='dateModified' content='2014-09-29T10:56:07Z'>
          <span itemprop='position'>#55</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Had good progress tonight.</p>
<p>Was able to get ProxyVM working, although I had a few manual tweaks (<a href="../../../external.html?link=https://github.com/nrgaway/qubes-builder/blob/master/whonix-install.NOTES" data-bbcode="true" rel="nofollow noopener">https://github.com/nrgaway/qubes-builder/blob/master/whonix-install.NOTES</a>) to apply in order for it to work.</p>
<p>Whonixcheck mostly completed complaining about hostname.  Guess I should rename it host.  Time sync failed though.  I was able to apt-get update repo in gateway, and have an AppVM connect via proxy port 9050.</p>
<p>I was also able to get the AppVM to connect without a proxy if I used torvm firewall settings(<a href="../../../external.html?link=https://github.com/nrgaway/linux-template-builder/blob/master/scripts_debian/custom_wheezy_whonix-gateway/extra-whonix-files/usr/lib/whonix/start-whonix-proxy.sh" data-bbcode="true" rel="nofollow noopener">https://github.com/nrgaway/linux-template-builder/blob/master/scripts_debian/custom_wheezy_whonix-gateway/extra-whonix-files/usr/lib/whonix/start-whonix-proxy.sh</a>, which seem to forward the vif ports via NAT to the forward facing eth0 interface.  Note that I am not using this configuration file anywhere, I just ran it to see if it would work and it did allow the AppVM to not use a proxy (confirmed with <a href="../../../external.html?link=http://check.torproject.org/" rel="nofollow noopener">check.torproject.org</a>).</p>
<p>Where is Whonix firewall rules and how / when does it get started?  I will look into the firewall more tomorrow.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-29T12:13:28Z' class='post-time'>
                September 29, 2014, 12:13pm
              </time>
              <meta itemprop='dateModified' content='2014-09-29T12:13:28Z'>
          <span itemprop='position'>#56</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="54" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/n/f17d59/40.png" class="avatar"> nrgaway:</div>
<blockquote>
<p>There are many places that have a hard coded IP address today, but I imagine it will not be too difficult to lower that number considerably.</p>
</blockquote>
</aside>
<p>Yes. Unfortunately, some upstream packages don’t allow variables. And please keep in mind, that search and replace in /etc/* would cause an interactive dpkg conflict resolution dialog on upgrade.</p>
<blockquote>Once I can prove everything is working with the qubes install scripts we will know exactly what steps are required to get things going and at that point can figure out the best way to proceed.</blockquote>
Sounds good. Feel free to postpone the IP discussion to a comfortable time.
<blockquote>Whonixcheck mostly completed complaining about hostname.  Guess I should rename it host.</blockquote>
Yes.
<blockquote>Where is Whonix firewall rules and</blockquote>
whonix-gw-firewall: /usr/bin/whonix_firewall - https://github.com/Whonix/whonix-gw-firewall/blob/master/usr/bin/whonix_firewall
<blockquote>how / when does it get started?</blockquote>
<p>By an eth0 pre-up hook in /etc/network/interfaces (<a href="../../../external.html?link=https://github.com/Whonix/whonix-gw-network-conf/blob/master/etc/network/interfaces.whonix#L24">https://github.com/Whonix/whonix-gw-network-conf/blob/master/etc/network/interfaces.whonix#L24</a>) before eth0 gets up.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-29T13:38:46Z' class='post-time'>
                September 29, 2014,  1:38pm
              </time>
              <meta itemprop='dateModified' content='2014-09-29T13:38:46Z'>
          <span itemprop='position'>#57</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>I don't think so, only in worst case scenario as Marek suggested.  There are many places that have a hard coded IP address today, but I imagine it will not be too difficult to lower that number considerably.</blockquote>
<p>I see. But lest say it comes to the worse, will that feature just affect qubes or is it a change in Whonix itself for all versions?</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-29T13:40:02Z' class='post-time'>
                September 29, 2014,  1:40pm
              </time>
              <meta itemprop='dateModified' content='2014-09-29T13:40:02Z'>
          <span itemprop='position'>#58</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“nrgaway, post:55, topic:512”]Had good progress tonight.</p>
<p>Was able to get ProxyVM working…</p>
<p>I was also able to get the AppVM to connect…[/quote]</p>
<p>Awesome. Really exciting to see you make steady progress! <img src="../../images/emoji/twitter/smileyae52.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-29T13:54:52Z' class='post-time'>
                September 29, 2014,  1:54pm
              </time>
              <meta itemprop='dateModified' content='2014-09-29T13:54:52Z'>
          <span itemprop='position'>#59</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="57" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>I see. But lest say it comes to the worse, will that feature just affect qubes or is it a change in Whonix itself for all versions?</p>
</blockquote>
</aside>
<p>My guess (although others my know better) is that, if utilized, it would be specific to the Whonix Qubes implementation only. I say that without knowing for sure, and just with a surface-level overview of what was mentioned being involved.</p>
<p>We will at some point have to figure out how and where we want to package and deliver a Whonix Qubes ProxyVM + AppVM solution.</p>
<p>The way we choose to accomplish this packaging and delivering might also have an affect on which components make sense to bake into Whonix proper and which to keep outside of it.</p>
<p>Right now, a lot of things with ProxyVM + AppVM development are still up in the air, TBD, not final, and subject to change/optimization.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/marmarek'><span itemprop='name'>marmarek</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-29T14:46:44Z' class='post-time'>
                September 29, 2014,  2:46pm
              </time>
              <meta itemprop='dateModified' content='2014-09-29T14:46:44Z'>
          <span itemprop='position'>#60</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“WhonixQubes, post:52, topic:512”]My concerns with the iptables static redirect approach are:</p>
<ul>
<li>
<p>a) Would the Whonix-Gateway ProxyVM act like a “native” Qubes ProxyVM where other AppVMs can dynamically make use of its network connectivity?</p>
</li>
<li>
<p>b) Would multiple Whonix-Workstation AppVMs be able to dynamically utilize a Whonix-Gateway ProxyVM via the VM Manager GUI?[/quote]</p>
</li>
</ul>
<p>Yes and yes.</p>
<aside class="quote" data-post="52" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/w/c5a1d2/40.png" class="avatar"> WhonixQubes:</div>
<blockquote>
<p>Just on the surface, without having to do manual network configuration work on the user’s part, it seems the iptables redirect hack might limit the implementation to using a single AppVM with the ProxyVM, and specifically only using a Whonix AppVMs with a Whonix ProxyVM.</p>
</blockquote>
</aside>
<p>ProxyVM will still be available at its original (Qubes-assigned) IP, so all the routing will be still working. The only thing that changes is that the traffic directed for some special IP (10.152.152.10) will be intercepted there. And perhaps - if you want to support normal AppVMs (which know nothing about tor) - it should intercept all the traffic, same as TorVM. That trick with iptables is to not change IP in many config files. A second though - when the IP will be set on some interface (dummy0), perhaps even iptables rule will not be needed there - thanks to routing, traffic should be simply routed to that dummy0 local interface. But still - if you want to allow usage of normal AppVM (which is not configured to proxy traffic through specific IP), you should add some iptables rule to intercept all the traffic.</p>
<p>Workstation IP should still be assigned dynamically by Qubes tools, so will be unique (no conflicts). And should use ProxyVM IP (10.137.x.y) as its default route. But can assume that Whonix Gateway is available at 10.152.152.10.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="5124658.html?page=2">← previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="512fdb0.html?page=4">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

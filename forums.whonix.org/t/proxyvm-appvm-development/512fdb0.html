<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>ProxyVM + AppVM Development - Qubes-Whonix - Whonix Forum</title>
    <meta name="description" content="I don&amp;#39;t know how far you have gotten in getting Whonix working as an appvm but I thought I would share my code to build it as a appvm / proxyvm if you were interested. 

I couldn&amp;#39;t figure out how to get the HVM to go ful&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="512fdb0.html?page=4" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;ProxyVM + AppVM Development&#39;" href="512.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/proxyvm-appvm-development/512?page=4" />
<meta name="twitter:url" content="https://forums.whonix.org/t/proxyvm-appvm-development/512?page=4" />
<meta property="og:title" content="ProxyVM + AppVM Development" />
<meta name="twitter:title" content="ProxyVM + AppVM Development" />
<meta property="og:description" content="[quote=“marmarek, post:60, topic:512”][quote author=WhonixQubes link=topic=537.msg4504#msg4504 date=1411958050]  My concerns with the iptables static redirect approach are:    a) Would the Whonix-Gateway ProxyVM act like a “native” Qubes ProxyVM where other AppVMs can dynamically make use of its network connectivity?    b) Would multiple Whonix-Workstation AppVMs be able to dynamically utilize a Whonix-Gateway ProxyVM via the VM Manager GUI?  [/quote]    Yes and yes.  [/quote]  Awesome clarifica..." />
<meta name="twitter:description" content="[quote=“marmarek, post:60, topic:512”][quote author=WhonixQubes link=topic=537.msg4504#msg4504 date=1411958050]  My concerns with the iptables static redirect approach are:    a) Would the Whonix-Gateway ProxyVM act like a “native” Qubes ProxyVM where other AppVMs can dynamically make use of its network connectivity?    b) Would multiple Whonix-Workstation AppVMs be able to dynamically utilize a Whonix-Gateway ProxyVM via the VM Manager GUI?  [/quote]    Yes and yes.  [/quote]  Awesome clarifica..." />
<meta property="article:published_time" content="2014-09-29T23:22:11+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="5129ba9.html?page=3">
        <link rel="next" href="512af4d.html?page=5">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="512.html">ProxyVM + AppVM Development</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/qubes-whonix/12.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #63a0ff'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Qubes-Whonix</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-09-29T23:22:11Z' class='post-time'>
                September 29, 2014, 11:22pm
              </time>
              <meta itemprop='dateModified' content='2014-09-29T23:22:11Z'>
          <span itemprop='position'>#61</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“marmarek, post:60, topic:512”][quote author=WhonixQubes link=topic=537.msg4504#msg4504 date=1411958050]<br>
My concerns with the iptables static redirect approach are:</p>
<ul>
<li>
<p>a) Would the Whonix-Gateway ProxyVM act like a “native” Qubes ProxyVM where other AppVMs can dynamically make use of its network connectivity?</p>
</li>
<li>
<p>b) Would multiple Whonix-Workstation AppVMs be able to dynamically utilize a Whonix-Gateway ProxyVM via the VM Manager GUI?<br>
[/quote]</p>
</li>
</ul>
<p>Yes and yes.</p>
<p>[/quote]</p>
<p>Awesome clarification. Thanks Marek!</p>
<p>Yes, if we can, then I think it makes sense to offer Tor routing through Whonix-Gateway to other types of AppVMs connecting to it as well…which doesn’t limit the user’s flexibility and sets a consistent expectation/experience for using Whonix along side of TorVM in Qubes.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-10T10:58:37Z' class='post-time'>
                October 10, 2014, 10:58am
              </time>
              <meta itemprop='dateModified' content='2014-10-10T10:58:37Z'>
          <span itemprop='position'>#62</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Seems like I have got the networking working now <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Whonix firewall now starts on boot and will bind tor to the second interface IP.</p>
<p>Tor TransPort transparent proxy is working from an AppVM as well and software can also connect via a socks port.</p>
<p>I ran whonixcheck and it returned all PASS for each tested item.  I guess now I just need to know what other kinds of tests can I run to make sure the firewall is good; both on the gateway and AppVM (I will build the workstation once gateway is complete)</p>
<p>PS.<br>
There were some upstream Qubes changes that broke the build, so I am fixing that now.  Whoever has been making changes has been writing for Jessie so I had to allow some backports, so my repo is also broken at the moment.  Jessie is so unstable, so that is why I am not considering building Whonix on top of it right now.  For example, I just updated the standard Debian 8 supplied with Qubes today and it now had broken packages from the update.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="4" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-10T13:06:16Z' class='post-time'>
                October 10, 2014,  1:06pm
              </time>
              <meta itemprop='dateModified' content='2014-10-10T13:06:16Z'>
          <span itemprop='position'>#63</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Congratulations!</p>
<aside class="quote" data-post="62" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/n/f17d59/40.png" class="avatar"> nrgaway:</div>
<blockquote>
<p>I guess now I just need to know what other kinds of tests can I run to make sure the firewall is good; both on the gateway and AppVM (I will build the workstation once gateway is complete)</p>
</blockquote>
</aside>
<p>See: <a href="../../../external.html?link=https://www.whonix.org/wiki/Dev/Leak_Tests">https://www.whonix.org/wiki/Dev/Leak_Tests</a></p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/marmarek'><span itemprop='name'>marmarek</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-10T14:15:44Z' class='post-time'>
                October 10, 2014,  2:15pm
              </time>
              <meta itemprop='dateModified' content='2014-10-10T14:15:44Z'>
          <span itemprop='position'>#64</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="62" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/n/f17d59/40.png" class="avatar"> nrgaway:</div>
<blockquote>
<p>There were some upstream Qubes changes that broke the build, so I am fixing that now.  Whoever has been making changes has been writing for Jessie so I had to allow some backports, so my repo is also broken at the moment.  Jessie is so unstable, so that is why I am not considering building Whonix on top of it right now.  For example, I just updated the standard Debian 8 supplied with Qubes today and it now had broken packages from the update.</p>
</blockquote>
</aside>
<p>If you can provide patches already made for building wheezy template, I can merge them right now (i.e. before final whonix template version). This way I’ll be able to test my changes also on wheezy, which should minimize risk of regressions.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-10T14:34:16Z' class='post-time'>
                October 10, 2014,  2:34pm
              </time>
              <meta itemprop='dateModified' content='2014-10-10T14:34:16Z'>
          <span itemprop='position'>#65</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="62" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/n/f17d59/40.png" class="avatar"> nrgaway:</div>
<blockquote>
<p>Seems like I have got the networking working now <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</blockquote>
</aside>
<p>This is awesome news! <img src="../../images/emoji/twitter/smileyae52.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>I literally was just in the process of building your old code again a few hours ago before seeing this news. So great timing!</p>
<p>Looking forward to learning exactly how you achieved the networking and overall solution.</p>
<p>And after you get things smoothed out, and we test, then we will likely want to talk about packaging and distribution (involving Qubes devs too).</p>
<p>Great job, nrgaway! <img src="../../images/emoji/twitter/smileyae52.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Whoqubix1'><span itemprop='name'>Whoqubix1</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-10T20:10:24Z' class='post-time'>
                October 10, 2014,  8:10pm
              </time>
              <meta itemprop='dateModified' content='2014-10-10T20:10:24Z'>
          <span itemprop='position'>#66</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="62" data-topic="512">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/n/f17d59/40.png" class="avatar"> nrgaway:</div>
<blockquote>
<p>Seems like I have got the networking working now <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</blockquote>
</aside>
<p>Good to hear. Looking forward to the potential of being able to run Whonix through the VM manager rather than the current method.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-10T22:21:23Z' class='post-time'>
                October 10, 2014, 10:21pm
              </time>
              <meta itemprop='dateModified' content='2014-10-10T22:21:23Z'>
          <span itemprop='position'>#67</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“marmarek, post:64, topic:512”][quote author=nrgaway link=topic=537.msg4710#msg4710 date=1412938717]<br>
There were some upstream Qubes changes that broke the build, so I am fixing that now.  Whoever has been making changes has been writing for Jessie so I had to allow some backports, so my repo is also broken at the moment.  Jessie is so unstable, so that is why I am not considering building Whonix on top of it right now.  For example, I just updated the standard Debian 8 supplied with Qubes today and it now had broken packages from the update.<br>
[/quote]</p>
<p>If you can provide patches already made for building wheezy template, I can merge them right now (i.e. before final whonix template version). This way I’ll be able to test my changes also on wheezy, which should minimize risk of regressions.[/quote]</p>
<p>I can get Wheezy to build with the upstream changes to core-agent-linux and the VM will boot but I can not connect a terminal client anymore.  I see you are using systemd now and have made sure it is re-installed again before Qubes packages are installed.</p>
<p>There use to be an ‘/etc/init.d/qubes-core startup’ file that would execute the ‘/usr/lib/qubes/setup-ip’ file.  I am in the process of determining why the VM will load with success but unable to connect to it with a terminal.</p>
<p>Once I can figure out how to access the VM again, I will be able to cleanup the code and prepare it for you to merge the Wheezy portion.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-10T22:41:10Z' class='post-time'>
                October 10, 2014, 10:41pm
              </time>
              <meta itemprop='dateModified' content='2014-10-10T22:41:10Z'>
          <span itemprop='position'>#68</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“WhonixQubes, post:65, topic:512”][quote author=nrgaway link=topic=537.msg4710#msg4710 date=1412938717]<br>
Seems like I have got the networking working now <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"><br>
[/quote]</p>
<p>This is awesome news! <img src="../../images/emoji/twitter/smileyae52.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>I literally was just in the process of building your old code again a few hours ago before seeing this news. So great timing!</p>
<p>Looking forward to learning exactly how you achieved the networking and overall solution.</p>
<p>And after you get things smoothed out, and we test, then we will likely want to talk about packaging and distribution (involving Qubes devs too).</p>
<p>Great job, nrgaway! :D[/quote]</p>
<p>It ended up being a simple fix for the vif+ interface.  The issue I was having was that I need to be able to run Whonix firewall before when eth0 came up initially, but if there were no guest VM connected to the Whonix Gateway at the time of boot, the tor scripts would fail to be able to bind to any interface.</p>
<p>So based on something <span class="mention">@mammamek</span> said about using a dummy interface, I got the idea to just use a dummy interface ‘eth1’ that uses the ‘/usr/lib/qubes/setup-ip’ ip address (same ip address the vif+ interfaces use, for example 10.137.3.1) and then tor configurations load properly.  The dummy interface is used for no other purpose and is not routing any packets.</p>
<pre><code class="lang-auto"># Create a dummy eth1 interface so tor can bind to it if there
# are no DOMU virtual machines connected at the moment
INTERFACE="eth1"
/sbin/ip link add $INTERFACE type dummy

# Now, assign it the netvm-gateway IP address
ip=$($XENSTORE_READ qubes-netvm-gateway 2&gt; /dev/null)
if [ x$ip != x ]; then
    netmask=$($XENSTORE_READ qubes-netvm-netmask)
    gateway=$($XENSTORE_READ qubes-netvm-gateway)
    /sbin/ifconfig $INTERFACE $ip netmask 255.255.255.255
    /sbin/ifconfig $INTERFACE up
    /sbin/ethtool -K $INTERFACE sg off
    /sbin/ethtool -K $INTERFACE tx off
fi</code></pre>
<p>I am still trying to find the proper spot to hook this code into.  I was just replacing the ‘setup-ip’ script qubes uses since ‘/etc/init.d/qubes-core’ called it very early in the ‘init’ sequence and was looking for a better spot to implement it from when the upstream changes broke my build; which I am currently working on fixing.</p>
<p>I was hoping to actually just create a udev rule to execute the script but I was having an issue where the udev code was not executing for some reason unless I restarted udev after booting.  I am not that familiar with udev, so I may have missed a configuration step.</p>
<p>But once I can get the VM to boot again, and find the proper spot to execute the dummy interface creation it won’t take long to finish things off.  I am trying to emulate the behaviour of the original whonix implementation and start the firewall right when eth0 becomes active so the VM is protect with the firewall rules when the eth0 goes online.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-13T03:23:08Z' class='post-time'>
                October 13, 2014,  3:23am
              </time>
              <meta itemprop='dateModified' content='2014-10-13T03:23:08Z'>
          <span itemprop='position'>#69</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I have managed to get going again using the qubes-rc2 repos instead of the marmarek repos.  The marmarek repos contain updates that changed some of the debian modules to use systemd for init scripts instead of sysvinit.  I did update Whonix to use systemd but there must be some script that is not starting since I can not access the VM with a terminal.  The other issue using systemd is that sysvinit will re-install itself during a dist-upgrade even if its pinned not to do so or marked as held.  I have not found a solution to this issue yet.</p>
<p>Again, I want to state that whonixcheck reports success for all tests, although I am still having issues with other stuff.</p>
<p>These are issues I am currently having:</p>
<ol>
<li>
<p>sdwdate fails on boot.  I see that it tries to access network before tor is started.  Is it supposed to use clearnet?  It also starts before tor on regular version of Whonix</p>
</li>
<li>
<p>sdwdate also fails after boot when tor becomes active.  Is it supposed to connect to 4 sites that seem random when using a browser to check connection status (<a href="../../../external.html?link=https://www.1984.is/" rel="nofollow noopener">https://www.1984.is</a>, <a href="../../../external.html?link=https://www.privacyinternational.org/" rel="nofollow noopener">https://www.privacyinternational.org</a>, <a href="../../../external.html?link=https://chavez.indymedia.org/" rel="nofollow noopener">https://chavez.indymedia.org</a>, <a href="../../../external.html?link=https://chavez.indymedia.org/" rel="nofollow noopener">https://chavez.indymedia.org</a>).</p>
</li>
</ol>
<p>Would this not expose whonix users as whonix users if they connect to those sites via clearnet?  Or is the firewall supposed to prevent this (which it may, but since tor is not enabled at the time I am not sure how it can complete with success)</p>
<ol start="3">
<li>
<p>initial whonix check fails on boot stating it can not find the pid ‘/var/run/tor/tor.pid’.  I am assuming maybe that tor may be still boot strapping at this point?  A manual whonixcheck works when logging into a terminal though.</p>
</li>
<li>
<p>It seems like I can not run connection manager within terminal.  It keeps wait for its own window id or something.  You can run ‘sudo whonixsetup’ manually from a terminal window.</p>
</li>
<li>
<p>Not sure if I can run the whonix apps; I had problems when I tried before, but still need to test.  If they can open a window of sorts they should work.</p>
</li>
</ol>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-13T05:15:12Z' class='post-time'>
                October 13, 2014,  5:15am
              </time>
              <meta itemprop='dateModified' content='2014-10-13T05:15:12Z'>
          <span itemprop='position'>#70</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>1. sdwdate fails on boot.  I see that it tries to access network before tor is started.</blockquote>
<blockquote>It also starts before tor on regular version of Whonix</blockquote>
<p>It might start before Tor yes, but it Whonix-Default/Download-Version, it waits until Tor is fully bootstrapped. This is implemented in <a href="../../../external.html?link=https://github.com/Whonix/sdwdate-plugin-anon-shared-con-check">https://github.com/Whonix/sdwdate-plugin-anon-shared-con-check</a>.</p>
<blockquote>Is it supposed to use clearnet?</blockquote>
Inside it Whonix it can't use clearnet by design. It explicitly uses proxy settings for stream isolation. This is implemented in https://github.com/Whonix/sdwdate-plugin-anon-shared-streamiso. [Off-topic: However, sdwdate is created with being able to use it over clearnet. So one day there will be a Whonix Host Additions package, that will likely recommend sdwdate.]
<blockquote>Is it supposed to connect to 4 sites that seem random when using a browser to check connection status</blockquote>
3 random picks from 3 different pools. Only more when some servers fail. With fail-max and so forth.
<blockquote>Would this not expose whonix users as whonix users if they connect to those sites via clearnet?</blockquote>
Yes, but it's not using cleranet.
<blockquote>Or is the firewall supposed to prevent this (which it may, but since tor is not enabled at the time I am not sure how it can complete with success)</blockquote>
The firewall is supposed to prevent this. But also without firewall, due to using explicit proxy settings in sdwdate, it cannot connect without using the Tor proxy.
<blockquote>3. initial whonix check fails on boot stating it can not find the pid '/var/run/tor/tor.pid'.  I am assuming maybe that tor may be still boot strapping at this point?</blockquote>
No, when Tor is bootstrapping, the pid is designed to exist. (By upstream Debian package.) Otherwise it would be a grave bug.
<blockquote>A manual whonixcheck works when logging into a terminal though.</blockquote>
Seems more like a race condition with the particular Whonix-Qubes boot process. With the default/download version, /etc/init.d/whonixcheck includes a "Required-Start: $all". But if Tor does not get started during the usual boot process, perhaps because of the $XENSTORE_READ magic script, then this might happen. In other words... If Tor fails to bind, because the IP in its default config does not exist, then sysvinit will consider Tor as "done" and go on with starting whonixcheck. Ideally the $XENSTORE_READ magic script also was an init script, that runs before Tor. Perhaps using something like "Should-Start: tor" in the init script.
<blockquote>4. It seems like I can not run connection manager within terminal.  It keeps wait for its own window id or something.</blockquote>
<blockquote>5. Not sure if I can run the whonix apps; I had problems when I tried before, but still need to test.  If they can open a window of sorts they should work.</blockquote>
Using default KDE or some other desktop environment?
The package involved is:
https://github.com/Whonix/msgcollector
<p>The hook is:<br>
<aside class="onebox githubblob">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/msgcollector/blob/master/etc/xdg/autostart/msgdispatcher.desktop" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://github.com/Whonix/msgcollector/blob/master/etc/xdg/autostart/msgdispatcher.desktop" target="_blank" rel="nofollow noopener">Whonix/msgcollector/blob/master/etc/xdg/autostart/msgdispatcher.desktop</a></h4>
<pre><code class="lang-desktop">## Copyright (C) 2012 - 2018 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions.

[Desktop Entry]
Type=Application
Exec=/usr/lib/msgcollector/msgdispatcher_xdg_autostart
</code></pre>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<pre><code class="lang-auto"></code></pre>
<p>Should include.</p>
<pre><code class="lang-auto"></code></pre>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-13T09:54:02Z' class='post-time'>
                October 13, 2014,  9:54am
              </time>
              <meta itemprop='dateModified' content='2014-10-13T09:54:02Z'>
          <span itemprop='position'>#71</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Thanks Patrick.  Your last post should give me enough info to investigate for the next few days to iron stuff out!</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-14T14:39:37Z' class='post-time'>
                October 14, 2014,  2:39pm
              </time>
              <meta itemprop='dateModified' content='2014-10-14T14:39:37Z'>
          <span itemprop='position'>#72</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>In regards to timesync not working it just appears that it is unable to connect.  I can run the regular curl without a problem from the command line but I get errors if trying to run</p>
<pre><code class="lang-auto">user@host:~$ curl.anondist-orig http://pay.reddit.com/r/usenet#
curl: (6) Couldn't resolve host 'pay.reddit.com'

user@host:~$ curl.anondist-orig http://198.41.209.142/r/usenet#
curl: (7) couldn't connect to host</code></pre>
<p>So I guess I must have some issues with the firewall still.  Any suggestions on trouble shooting it?</p>
<p>Also, I am not sure if it matters but I did receive an error in one of the modules since TEMP_DIR environment variable was not set</p>
<pre><code class="lang-auto">/usr/lib/anon-shared-helper-scripts/tor_bootstrap_check.bsh: line 86: error: command not found
    if [ "$TEMP_DIR" = "" ]; then
       error "Variable TEMP_DIR is empty."
    fi</code></pre>
<p>The command ‘error’ is not on my system.  Is it a function?  I came across the error when manually running /usr/lib/anon-shared-helper-scripts/te_pe_tb_check when trying to track down this timesync issue.</p>
<p>EDIT:</p>
<p>I commented out the if [ “$TEMP_DIR” = “” ] section in ‘/usr/lib/anon-shared-helper-scripts/tor_bootstrap_check.bsh’ and now when I boot Whonixcheck no longer gives me the pid not found error and reports back correctly so either I need to set TEMP_DIR somewhere or ensure the command or function ‘error’ can be found.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-14T15:04:27Z' class='post-time'>
                October 14, 2014,  3:04pm
              </time>
              <meta itemprop='dateModified' content='2014-10-14T15:04:27Z'>
          <span itemprop='position'>#73</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>On Whonix-Gateway? On Whonix-Gateway curl.anondist-orig won’t work out of the box, because Whonix-Gateway does not enable transparent proxying for its own traffic by default. (It is possible, though: <a href="../../../external.html?link=https://www.whonix.org/wiki/Whonix-Gateways_Own_Traffic_Transparent_Proxy">https://www.whonix.org/wiki/Whonix-Gateways_Own_Traffic_Transparent_Proxy</a>)<br>
Using existing open Tor SocksPorts should work however out of the box, ex:</p>
<pre><code class="lang-auto"></code></pre>
<p>TEMP_DIR is not a system environment variable, but an variable, that the script that <code>source</code>es the anon-shared-helper-script is supposed to set…</p>
<p>“error” is not implemented on purpose. It is only a way to make the script stop and complain loudly. (That works great when a fully featured trap ERR is implemented as for example whonixcheck does.)</p>
<p>The TEMP_DIR variable gets set by <a href="../../../external.html?link=https://github.com/Whonix/whonixcheck/blob/Whonix9/usr/lib/whonixcheck/preparation#L141">https://github.com/Whonix/whonixcheck/blob/Whonix9/usr/lib/whonixcheck/preparation#L141</a>.</p>
<p>The whonixcheck startup process is sysvinit -&gt; <a href="../../../external.html?link=https://github.com/Whonix/whonixcheck/blob/Whonix9/etc/init.d/whonixcheck">https://github.com/Whonix/whonixcheck/blob/Whonix9/etc/init.d/whonixcheck</a> -&gt; <a href="../../../external.html?link=https://github.com/Whonix/whonixcheck/blob/Whonix9/usr/lib/whonixcheckdaemon">https://github.com/Whonix/whonixcheck/blob/Whonix9/usr/lib/whonixcheckdaemon</a> -&gt; <a href="../../../external.html?link=https://github.com/Whonix/whonixcheck/blob/Whonix9/usr/bin/whonixcheck">https://github.com/Whonix/whonixcheck/blob/Whonix9/usr/bin/whonixcheck</a>.</p>
<p>I try to come up with a hypothesis why the TEMP_DIR variable might not be set.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-14T15:16:25Z' class='post-time'>
                October 14, 2014,  3:16pm
              </time>
              <meta itemprop='dateModified' content='2014-10-14T15:16:25Z'>
          <span itemprop='position'>#74</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>My original hypothesis was, that somehow the Qubes specific boot process, does not let whonixcheck use mktemp or mktemp fails and returns “” what the anon-shared-helper-script would complain about. But later in the boot process, mktemp can work as expected.</p>
<p>But I usually try to always have ports and other unusual occurrences in mind. I deliberately messed up the mktemp command with mktemp___  for debugging to check if whonixcheck would notice that, loudly complain and exit. It’s not the case.</p>
<pre><code class="lang-auto">ERROR: ############################################################################### 
## whonixcheck script bug. 
## No panic. Nothing is broken. Just some rare condition has been hit. 
## Try again later. There is likely a solution for this problem. 
## Please see Whonix News, Whonix Blog and Whonix User Help Forum. 
## Please report this bug! 
## 
## BASH_COMMAND: TEMP_DIR="$(mktemp___ --directory)" 
## exit_code: 127 
## 
## Experts only: 
## bash -x whonixcheck --verbose 
## for verbose output. Clean the output and report to Whonix developers. 
#########################################################################</code></pre>
<pre><code class="lang-auto">## BASH_COMMAND: TEMP_DIR="$(mktemp --just-fail-for-debugging --directory)" 
## exit_code: 1 </code></pre>
<p>What would be possible in theory though, that mktemp has a hypothetical bug, exiting 0 and still not write a temp dir to stdout, i.e. end up with an empty variable. To check that hypothesis, even though unlikely… Right below <a href="../../../external.html?link=https://github.com/Whonix/whonixcheck/blob/Whonix9/usr/lib/whonixcheck/preparation#L141">https://github.com/Whonix/whonixcheck/blob/Whonix9/usr/lib/whonixcheck/preparation#L141</a> add this.</p>
<pre><code class="lang-auto">   if [ "$TEMP_DIR" = "" ]; then
      error "Variable TEMP_DIR is empty!"
   fi</code></pre>
<p>(No need to do a new build or this. Can be done on live system. Reboot should be sufficient.)</p>
<p>[hr]</p>
<p>For further debugging purposes, whonixcheckd (init script) can also be configured to run in verbose mode. File:<br>
<aside class="onebox githubblob">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/whonixcheck/blob/Whonix9/etc/default/whonixcheckd" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://github.com/Whonix/whonixcheck/blob/Whonix9/etc/default/whonixcheckd" target="_blank" rel="nofollow noopener">Whonix/whonixcheck/blob/Whonix9/etc/default/whonixcheckd</a></h4>
<pre><code class="lang-">## This file is part of Whonix.
## Copyright (C) 2012 - 2014 Patrick Schleizer &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions.

## Whonix /etc/default/whonixcheckd

## This file gets sourced by /usr/lib/whonixcheckdaemon

debugging="false"

## End of Whonix /etc/default/whonixcheckd
</code></pre>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>Add:</p>
<pre><code class="lang-auto"></code></pre>
<p>A log will then be created.</p>
<pre><code class="lang-auto"></code></pre>
<p>Search that log for TEMP_DIR. See if it got set after initial start of whonixcheck after boot.</p>
<p>For me it includes.</p>
<p>[code]++ mktemp --directory</p>
<ul>
<li>TEMP_DIR=/tmp/tmp.a60Zf6Ui30<br>
[/code]</li>
</ul>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/WhonixQubes'><span itemprop='name'>WhonixQubes</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-21T16:08:29Z' class='post-time'>
                October 21, 2014,  4:08pm
              </time>
              <meta itemprop='dateModified' content='2014-10-21T16:08:29Z'>
          <span itemprop='position'>#75</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>FYI:</p>
<p>For those interested and following this thread, nrgaway and marmarek are currently making additional progress over on the qubes-devel mailing list…</p>
<p>Current thread: <span class="bbcode-b">New Wheezy Template / Whonix Template</span></p>
<p><span class="bbcode-b"><a href="../../../external.html?link=https://groups.google.com/d/topic/qubes-devel/lsSGUS12T9g" rel="nofollow noopener">https://groups.google.com/d/topic/qubes-devel/lsSGUS12T9g</a></span></p>
<p>Things seem to be going quite well! <img src="../../images/emoji/twitter/smileyae52.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-25T23:19:04Z' class='post-time'>
                October 25, 2014, 11:19pm
              </time>
              <meta itemprop='dateModified' content='2014-10-25T23:19:04Z'>
          <span itemprop='position'>#76</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Good news…  I finally have a build that runs without errors and both the gateway and workstation are working in Qubes as a ProxyVM and AppVM!</p>
<p>The Transport Internet access is also working from an AppVM.  Any AppVM can be used to connect to Whonix Gateway or use the Workstation for better security.</p>
<p>Everything needs to be leak tested and there are still some issues with running apps. Some apps run and some don’t from the Qubes ‘Start Menu’.  They all run if you start them manually from the terminal.</p>
<p>Three apps I will list as an example that do not work from ‘Start Menu’ are:</p>
<ol>
<li>Whonix Repository: Tries to start and exits</li>
<li>Configuration Manager (whonixsetup):  It won’t show and will actually shutdown (power off) the VM</li>
<li>Tor Browser: Same as <span class="hashtag">#1</span>.  Maybe a restart of VM will help.</li>
</ol>
<p>I get a lot of invalid image error messages when syncing apps to Qubes ‘Start Menu’.  Will be looking into that.</p>
<p>Whonix check and time sync do work and show properly.</p>
<p>So I guess others should get there hands on this soon and help testing and not use it for everyday use yet.  It can be built from my repo and within a few days most likely Qubes repo.</p>
<p>I still recommend running both the Gateway and Workstation as a standalone VM mostly since I have not tested them as templates yet.  Main reason though is updating the template; it may end up updating via clearnet or not at all.  Have not tested yet.</p>
<p>The local time issue must be looked at as well to see if there is a way to disable it.</p>
<p>There also still an issue with Wheezy that when you open the terminal the first time, you have to go into setting to change the colors otherwise it show black on black.  Looking into that too now since I now have time to look into more configuration related issues.</p>
<p>If you decide to build this, grab my ‘qubes-builder’ repo and git fetch; git checkout wheezy to use wheezy branch, not whonix.  Then you just have to run the ./README.whonix file to build.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-26T17:13:25Z' class='post-time'>
                October 26, 2014,  5:13pm
              </time>
              <meta itemprop='dateModified' content='2014-10-26T17:13:25Z'>
          <span itemprop='position'>#77</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <blockquote>1. Whonix Repository: Tries to start and exits
2. Configuration Manager (whonixsetup):  It won't show and will actually shutdown (power off) the VM</blockquote>
<p>About 2.) The usual way in Whonix-Debian/Default-[…] is showing a menu using <code>dialog</code> and check if the answer to the disclaimer is “yes”, and if it’s not, shutdown. This is implemented here:<br>
<aside class="onebox githubblob">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/whonixsetup/blob/master/usr/lib/whonixsetup_/ft_disclaimer" target="_blank">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://github.com/Whonix/whonixsetup/blob/master/usr/lib/whonixsetup_/ft_disclaimer" target="_blank">Whonix/whonixsetup/blob/master/usr/lib/whonixsetup_/ft_disclaimer</a></h4>
<pre><code class="lang-">#!/bin/bash

## Copyright (C) 2012 - 2020 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions.

TITLE="Important Information About Whonix Part 1/2 | Wichtige Informationen zu Whonix Teil 1/2 (whonixsetup)"

MSG='
Please do NOT continue unless you understand everything!

This is not the usual blah blah blah but fact. Whonix is a research project. Whonix is free of charge. Whonix is a derivative of Debian GNU/Linux. Whonix is produced independently of, with no guarantee from, The Tor Project. Whonix is created by volunteers in their spare time. Whonix was created by self-taught hobbyists in their spare time, without the backing of any particular formal certification or training. Although Whonix attempts to be as usable as possible, there are many ways in which it fails. Whonix is in English. Do not use Whonix without excellent knowledge of the English language. Misunderstandings have consequences. Whonix is based on other software, including GNU/Linux, Debian, and virtualization. Do not rely on Whonix without working knowledge of these technologies.

The documentation available on Whonix.org is a crash course in anonymity, privacy, and security on the Internet. Whonix is a technological means to anonymity, but staying anonymous is not just a technological problem: No tool is enough to keep you safe. Anonymity is a complex problem without an easy solution, and security is only as strong as its weakest link, often the user. The more you know, the safer you can be.

Whonix is a compilation of software packages, each under its own copyright and license. The exact license terms for each program are described in the individual files in /usr/share/doc/*/copyright.

The compilation is made available the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version with additional terms applicable per GNU GPL version 3 section 7. The license can be refereed to as GPL-3+-with-additional-terms-1 and can be found in /usr/share/whonix/WHONIX_BINARY_LICENSE_AGREEMENT or online here: https://www.whonix.org/wiki/Whonix:Copyrights
'

dialog --title "$TITLE" --defaultno --yes-label "Understood / Verstanden" --no-label "Not understood / Nicht verstanden" --yesno "$MSG" 640 480
</code></pre>

  This file has been truncated. <a href="../../../external.html?link=https://github.com/Whonix/whonixsetup/blob/master/usr/lib/whonixsetup_/ft_disclaimer" target="_blank">show original</a>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>My hypothesis is, that somehow through the Qubes menu there is no terminal attached?</p>
<p>Might be a bug in Qubes. To falsify/confirm, could you create a test script to the menu please that check whether running in a terminal or not? Perhaps a loop that waits until terminal gets available? This would help (check for stdin):<br>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="../../../external.html?link=https://stackoverflow.com/questions/9863508/how-do-i-detect-whether-stderr-is-connected-to-a-terminal-from-within-a-script" target="_blank">stackoverflow.com</a>
  </header>
  <article class="onebox-body">
      <a href="../../../external.html?link=https://stackoverflow.com/users/882600/tomas-pruzina" target="_blank">
    <img alt="Tomas Pruzina" src="../../../external.html?link=https://www.gravatar.com/avatar/78d00bd38dd232eb53227bba15f0b4a5?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="128" height="128">
  </a>
<h4>
  <a href="../../../external.html?link=https://stackoverflow.com/questions/9863508/how-do-i-detect-whether-stderr-is-connected-to-a-terminal-from-within-a-script" target="_blank">How do I detect whether stderr is connected to a terminal from within a script?</a>
</h4>

<div class="tags">
  <strong>bash, shell</strong>
</div>

<div class="date">
  asked by
  
  <a href="../../../external.html?link=https://stackoverflow.com/users/882600/tomas-pruzina" target="_blank">
    Tomas Pruzina
  </a>
  on <a href="../../../external.html?link=https://stackoverflow.com/questions/9863508/how-do-i-detect-whether-stderr-is-connected-to-a-terminal-from-within-a-script" target="_blank">08:00PM - 25 Mar 12 UTC</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<br>
I could help with that test script if necessary.</p>
<p>But perhaps Whonix scripts that use terminal input should check if they’re really running in a terminal and otherwise wait for the terminal forever?</p>
<p>About 1.) Probably similar to 2.) [Using <code>dialog</code> while no terminal is attached.]</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/nrgaway'><span itemprop='name'>nrgaway</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-27T02:36:22Z' class='post-time'>
                October 27, 2014,  2:36am
              </time>
              <meta itemprop='dateModified' content='2014-10-27T02:36:22Z'>
          <span itemprop='position'>#78</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“Patrick, post:77, topic:512”][quote]1. Whonix Repository: Tries to start and exits<br>
2. Configuration Manager (whonixsetup):  It won’t show and will actually shutdown (power off) the VM[/quote]</p>
<p>About 2.) The usual way in Whonix-Debian/Default-[…] is showing a menu using <code>dialog</code> and check if the answer to the disclaimer is “yes”, and if it’s not, shutdown. This is implemented here:<br>
<aside class="onebox githubblob">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/whonixsetup/blob/master/usr/lib/whonixsetup_/ft_disclaimer" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://github.com/Whonix/whonixsetup/blob/master/usr/lib/whonixsetup_/ft_disclaimer" target="_blank" rel="nofollow noopener">Whonix/whonixsetup/blob/master/usr/lib/whonixsetup_/ft_disclaimer</a></h4>
<pre><code class="lang-">#!/bin/bash

## Copyright (C) 2012 - 2018 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions.

TITLE="Important Information About Whonix Part 1/2 | Wichtige Informationen zu Whonix Teil 1/2 (whonixsetup)"

MSG='
ENG: Please do NOT continue unless you understand everything!
GER: Bitte NICHT weitermachen, falls Sie nicht alles verstehen!

ENG: Welcome to Whonix!
GER: Willkommen zu Whonix!

ENG: This is not the usual blah blah blah but fact.
GER: Dies ist kein blabla, sondern Fakt.

ENG: Whonix is experimental software. Do not rely on it for strong anonymity.
GER: Whonix is experimentelle Software. Nicht darauf verlassen, wenn starke Anonymitaet benoetigt wird!

</code></pre>

  This file has been truncated. <a href="../../../external.html?link=https://github.com/Whonix/whonixsetup/blob/master/usr/lib/whonixsetup_/ft_disclaimer" target="_blank" rel="nofollow noopener">show original</a>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>My hypothesis is, that somehow through the Qubes menu there is no terminal attached?[/quote]</p>
<p>I think you are right.  Qubes make a call to the VM to start x-window programs.  If you want an actual terminal you call the gnome-terminal application.</p>
<blockquote>Might be a bug in Qubes. To falsify/confirm, could you create a test script to the menu please that check whether running in a terminal or not? Perhaps a loop that waits until terminal gets available? This would help (check for stdin):
http://stackoverflow.com/questions/9863508/how-do-i-detect-whether-stderr-is-connected-to-a-terminal-from-within-a-script
I could help with that test script if necessary.
<p>But perhaps Whonix scripts that use terminal input should check if they’re really running in a terminal and otherwise wait for the terminal forever?</p>
<p>About 1.) Probably similar to 2.) [Using <code>dialog</code> while no terminal is attached.]</p>
</blockquote>
<p>I will look into the script.  Maybe a wrapper can be designed to start those types of apps within gnome-terminal.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-27T02:48:29Z' class='post-time'>
                October 27, 2014,  2:48am
              </time>
              <meta itemprop='dateModified' content='2014-10-27T02:48:29Z'>
          <span itemprop='position'>#79</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Repo:<br>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../external.html?link=https://github.githubassets.com/favicons/favicon.svg" class="site-icon" width="32" height="32">
      <a href="../../../external.html?link=https://github.com/Whonix/whonix-repository" target="_blank">GitHub</a>
  </header>
  <article class="onebox-body">
    <img src="../../../external.html?link=https://avatars3.githubusercontent.com/u/4500165?s=400&amp;v=4" class="thumbnail onebox-avatar" width="400" height="400">

<h3><a href="../../../external.html?link=https://github.com/Whonix/whonix-repository" target="_blank">Whonix/whonix-repository</a></h3>

<p>Whonix APT Repository Tool -  Can be used to enable either Whonix's stable, testers or  developers repository or to disable Whonix's repository. - For better usability and security. - Whoni...</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>Startup sequence:<br>
/usr/share/applications/whonix_repository.desktop -&gt; /usr/lib/whonix-repository -&gt; /usr/bin/whonix_repository</p>
<p>[hr]</p>
<p>Repo:<br>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../external.html?link=https://github.githubassets.com/favicons/favicon.svg" class="site-icon" width="32" height="32">
      <a href="../../../external.html?link=https://github.com/Whonix/whonixsetup/tree/master/usr/lib" target="_blank">GitHub</a>
  </header>
  <article class="onebox-body">
    <img src="../../../external.html?link=https://avatars3.githubusercontent.com/u/4500165?s=400&amp;v=4" class="thumbnail onebox-avatar" width="400" height="400">

<h3><a href="../../../external.html?link=https://github.com/Whonix/whonixsetup/tree/master/usr/lib" target="_blank">Whonix/whonixsetup</a></h3>

<p>First Time Connection Setup - for better usability, anonymity and privacy. When Whonix starts for the first time, it won't automatically connect to the public Tor network. This is useful for us...</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>Startup sequence:<br>
/usr/share/applications/gateway-firsttimesetup.desktop -&gt; /usr/lib/<em>whonixsetup</em> -&gt; /usr/bin/whonixsetup</p>
<p>[hr]</p>
<p>We can work around it in Whonix, but I think it should be reported against Qubes as well.</p>
<p>For the report against Qubes, a small test script<br>
/usr/share/applications/teststdin.desktop -&gt; /usr/bin/teststdin<br>
that reads from stdin (which will fail as I expect) or uses <code>dialog</code> (which I am more surely expect to fail).</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/marmarek'><span itemprop='name'>marmarek</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="512.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2014-10-27T11:10:48Z' class='post-time'>
                October 27, 2014, 11:10am
              </time>
              <meta itemprop='dateModified' content='2014-10-27T11:10:48Z'>
          <span itemprop='position'>#80</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>[quote=“nrgaway, post:78, topic:512”][quote author=Patrick link=topic=537.msg4983#msg4983 date=1414343605]</p>
<p>[quote]1. Whonix Repository: Tries to start and exits<br>
2. Configuration Manager (whonixsetup):  It won’t show and will actually shutdown (power off) the VM[/quote]</p>
<p>About 2.) The usual way in Whonix-Debian/Default-[…] is showing a menu using <code>dialog</code> and check if the answer to the disclaimer is “yes”, and if it’s not, shutdown. This is implemented here:<br>
<aside class="onebox githubblob">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Whonix/whonixsetup/blob/master/usr/lib/whonixsetup_/ft_disclaimer" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://github.com/Whonix/whonixsetup/blob/master/usr/lib/whonixsetup_/ft_disclaimer" target="_blank" rel="nofollow noopener">Whonix/whonixsetup/blob/master/usr/lib/whonixsetup_/ft_disclaimer</a></h4>
<pre><code class="lang-">#!/bin/bash

## Copyright (C) 2012 - 2018 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;
## See the file COPYING for copying conditions.

TITLE="Important Information About Whonix Part 1/2 | Wichtige Informationen zu Whonix Teil 1/2 (whonixsetup)"

MSG='
ENG: Please do NOT continue unless you understand everything!
GER: Bitte NICHT weitermachen, falls Sie nicht alles verstehen!

ENG: Welcome to Whonix!
GER: Willkommen zu Whonix!

ENG: This is not the usual blah blah blah but fact.
GER: Dies ist kein blabla, sondern Fakt.

ENG: Whonix is experimental software. Do not rely on it for strong anonymity.
GER: Whonix is experimentelle Software. Nicht darauf verlassen, wenn starke Anonymitaet benoetigt wird!

</code></pre>

  This file has been truncated. <a href="../../../external.html?link=https://github.com/Whonix/whonixsetup/blob/master/usr/lib/whonixsetup_/ft_disclaimer" target="_blank" rel="nofollow noopener">show original</a>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>My hypothesis is, that somehow through the Qubes menu there is no terminal attached?[/quote]</p>
<p>I think you are right.  Qubes make a call to the VM to start x-window programs.  If you want an actual terminal you call the gnome-terminal application.[/quote]</p>
<p>Indeed Qubes currently ignores Terminal=true option in desktop file, only Exec= line is handled. I’ll fix it shortly.</p>
        </div>

        <meta itemprop='headline' content='ProxyVM + AppVM Development'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="5129ba9.html?page=3">← previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="512af4d.html?page=5">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Application Customization and Privacy Issues</title>
    <link>http://forums.whonix.org/t/application-customization-and-privacy-issues/3245</link>
    <description>Continuing the discussion from [Qubes DispVM technical discussion](https://forums.whonix.org/t/qubes-dispvm-technical-discussion/3232/19):

This post has a Qubes feel to it because it was originally to be posted in Qubes-Whonix sub-forum. Halfway through though, I realized it was applicable to all Whonix flavors. The concept of Template VMs are universal, just called different things, ie base images. In short, separate VMs are not enough to guarantee identity isolation if customization parameters are shared by those VMs and are discoverable.

[quote=&quot;entr0py, post:18, topic:3232&quot;]
[quote=&quot;Patrick&quot;]
Any thoughts on the (previously existing) quote https://www.whonix.org/wiki/Tor_Browser#Running_Tor_Browser_in_Qubes_TemplateVM

Don&#39;t start Tor Browser in the whonix-ws TemplateVM or whonix-ws-dvm DisposableVM-TemplateVM. It is not expected to be done that way and wrong. [...]
[/quote]

The conservative view would be to recommend that as a best practice. However, we are already relying on Tor Browser not to generate any unique identifiers every time we use it. So logically, it should be safe to run in a template for customization purposes. But it really needs to be stressed that customization is a dangerous exercise.
[/quote]

[quote=&quot;Patrick, post:19, topic:3232&quot;]
Agreed! Please add!
[/quote]

Here&#39;s my draft:

&gt; It is strongly recommended to never run user applications (especially network-facing ones) in any type of template VM. This is because applications often generate files, that when propagated to child VMs, can result in VM-linkability. For example, starting Firefox and connecting to a website might result in the download of unique cookies. Some applications may generate a random number seed that could be used to identify the VM uniquely. 

&gt; In the case of Tor Browser, an exception may be made to allow for customization. However, it should be clearly understood that the best practice, as recommended by The Tor Project, is to use Tor Browser in its stock configuration. This is because Tor Browser has a very deliberate fingerprint, one that is designed to be shared by all Tor Browser users. Even seemingly innocuous changes, like enabling the NoScript option to &#39;Show message about blocked scripts&#39; can alter the fingerprint by changing the reported screen size. Further, while Tor Browser is designed to prevent any type of linkability through fingerprinting, issues past and present suggest that it is not perfect. These issues are only magnified by using a custom configuration that is shared by multiple VMs.

**But** after re-reading the original text, I changed my mind. Here&#39;s a very relevant ticket to our situation: https://trac.torproject.org/projects/tor/ticket/14390. This bug is still embargoed after 2 years?!?!? Given something like that, how can we recommend anything other than best practice / stock configuration? In fact, I think we need to do the opposite and whitelist things that are safe to customize in templates for Tor Browser.

* Can you customize the toolbar? Add/remove buttons?
* Can you change Preferences?
-tab behavior?
-download directory?
-search engines?
-update preferences? (I find it very useful for disposableVMs to set update to notify-only instead of auto)
* NoScript? disable JS?
* TorButton? change security slider?

What about other applications? I&#39;m sure most users have a favorite terminal and a set of preferences for it. Even if you don&#39;t customize a terminal in your template VM, if you then perform the identical customization in each of your user VMs, the result will be the same. An adversary that gains user-access to your VMs will be able to link them together based solely on your config files.

With Qubes, we rely on the fact that attackers with user/root privileges don&#39;t necessarily constitute an existential threat. From a privacy perspective, it could be game over. So do we need to construct a list of customizable apps? or just tell everyone to live in misery with all default settings?</description>
    <language>en</language>
    <lastBuildDate>Tue, 06 Dec 2016 23:39:13 +0000</lastBuildDate>
    <category>Support</category>
    <atom:link href="http://forums.whonix.org/t/application-customization-and-privacy-issues/3245.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Application Customization and Privacy Issues</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Related issues why it’s sometimes bad to share files in templates:</p>
<ul>
<li><a href="https://github.com/QubesOS/qubes-issues/issues/1311">https://github.com/QubesOS/qubes-issues/issues/1311</a></li>
<li><a href="https://groups.google.com/forum/#!msg/qubes-devel/Q65boPAbqbE/9ZOZUInQCgAJ">https://groups.google.com/forum/#!msg/qubes-devel/Q65boPAbqbE/9ZOZUInQCgAJ</a></li>
<li><a href="https://github.com/grml/grml-debootstrap/issues/91">https://github.com/grml/grml-debootstrap/issues/91</a></li>
<li><a href="https://labs.riseup.net/code/issues/7642">https://labs.riseup.net/code/issues/7642</a></li>
<li><a href="https://labs.riseup.net/code/issues/7100">https://labs.riseup.net/code/issues/7100</a></li>
</ul>
          <p><a href="http://forums.whonix.org/t/application-customization-and-privacy-issues/3245/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/application-customization-and-privacy-issues/3245/5</link>
        <pubDate>Tue, 06 Dec 2016 23:39:13 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3245-5</guid>
        <source url="http://forums.whonix.org/t/application-customization-and-privacy-issues/3245.rss">Application Customization and Privacy Issues</source>
      </item>
      <item>
        <title>Application Customization and Privacy Issues</title>
        <dc:creator><![CDATA[entr0py]]></dc:creator>
        <description><![CDATA[
            <p>After reading, the thought that comes to mind is that snapshots and Disposable VMs contribute to an air of invincibility. Users might feel free to engage in more risky behavior because they think, “Who cares if I get compromised? As long as my hypervisor is safe, I can rollback or toss the VM.” In reality, every compromise could fingerprint the VM so severely that linkage might be trivial in the future.</p>
<p>Unlike some of the settings you mentioned, uniquely configured apps tend to be similarly configured in every template and regardless of distribution - for example, a dedicated vim user will frequently have a unique configuration that will survive even a jessie -&gt; stretch upgrade. The only way to prevent such fingerprinting is not to be compromised in any VM. Using a Disposable VM isn’t a license to be reckless.</p>
<aside class="quote" data-post="2" data-topic="3245">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>That’s also a good question for the Tor support channels.</p>
</blockquote>
</aside>
<p>Will work on that.</p>
          <p><a href="http://forums.whonix.org/t/application-customization-and-privacy-issues/3245/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/application-customization-and-privacy-issues/3245/4</link>
        <pubDate>Tue, 06 Dec 2016 22:21:06 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3245-4</guid>
        <source url="http://forums.whonix.org/t/application-customization-and-privacy-issues/3245.rss">Application Customization and Privacy Issues</source>
      </item>
      <item>
        <title>Application Customization and Privacy Issues</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <ul>
<li>Non-Qubes-Whonix: applies when using one VM as template and then making a clone</li>
<li>Qubes-Whonix: applies since most users are using TemplateVMs and TemplateBased AppVMs</li>
</ul>
<p>You may not even need to customize applications settings. There is a ton of other such unique things. Small incomplete list of examples:</p>
<ul>
<li>The template contains filesystem timestamp information. These differ.</li>
<li>/var/lib/systemd/random-seed</li>
<li>/var/cache/ldconfig/aux-cache</li>
<li>/var/lib/dpkg/info/man-db</li>
<li>/var/lib/dpkg/info/docbook-xsl</li>
<li>/var/lib/dpkg/info/sgml-data</li>
<li>/var/lib/dpkg/info/xml-core</li>
<li>/usr/share/info/dir</li>
<li>/usr/lib/pymodules/python2.7/**/<strong>init</strong>.pyc</li>
<li>logs - what wins to write first, cron or apt-get - hard to make deterministic since it depends on so many factors such as cpu and network speed</li>
<li>list goes on and on and on</li>
<li>I these list from my previous work on <a href="https://www.whonix.org/wiki/Verifiable_Builds">verifiable builds</a>. Something much simpler, since that VM image was build in chroot. Never booted and thereby prevented a lot of differences.</li>
<li>Yes, Debian works on reproducible package repositories (packages build and ready to be downloaded) and one can only applaud them. It’s still a very long way to go. They also like to create deterministic Debian installer medium, which will be harder, since then packages need to leave deterministic results when installed inside chroot. Having the image staying deterministic when you actually boot it and shut down, I am not sure we ever get there.</li>
</ul>
<p>Two computers a) and b).</p>
<ul>
<li>Both download a VM (let’s say the same Whonix flavor/version) and install it.</li>
<li>Start the VM that is supposed to act as template on both computers.</li>
<li>Update it.</li>
<li>Shut it down.</li>
<li>They will differ.</li>
<li>In other words they will not have the same checksum. Boot and shutdown will not be a deterministic process.</li>
</ul>
<p>Even if not user customized any settings in applications, these disk images are still distinguishable for someone who has local disk access. And local disk access is included in the capabilities of an adversary that reached local VM compromise of a template based VM.</p>
<ul>
<li>template VM A</li>
<li>template based VM B</li>
<li>template based VM C</li>
</ul>
<p>An adversary that reached local disk access in VM B as well as VM C may likely be able to correlate those to the same pseudonym.</p>
<p>I am not sure if that is enough to advice against using templates for this very reason. There may be other reasons. An adversary who merely runs a website, that could link VM B and VM C through let’s say - very theoretical and unlikely - modified konsole settings would be a much more serious reason.</p>
<p>Once VM B and VM C are compromised, there is also a ton of other attack vectors to link them. One is keystroke / mice fingerprinting. Another one desktop resolution. Or any VM side channel attack. Who knows what else.</p>
          <p><a href="http://forums.whonix.org/t/application-customization-and-privacy-issues/3245/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/application-customization-and-privacy-issues/3245/3</link>
        <pubDate>Tue, 06 Dec 2016 16:49:52 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3245-3</guid>
        <source url="http://forums.whonix.org/t/application-customization-and-privacy-issues/3245.rss">Application Customization and Privacy Issues</source>
      </item>
      <item>
        <title>Application Customization and Privacy Issues</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>I’ll answer your non-TBB related questions in my next post.</p>
<aside class="quote" data-post="1" data-topic="3245">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/e/8dc957/40.png" class="avatar"> entr0py:</div>
<blockquote>
<p>NoScript? disable JS?</p>
</blockquote>
</aside>
<p>Use security slider for that.</p>
<aside class="quote" data-post="1" data-topic="3245">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/e/8dc957/40.png" class="avatar"> entr0py:</div>
<blockquote>
<p>change security slider?</p>
</blockquote>
</aside>
<p>That should be okay with TBB upstream since they are the ones providing that feature.</p>
<aside class="quote" data-post="1" data-topic="3245">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/e/8dc957/40.png" class="avatar"> entr0py:</div>
<blockquote>
<p>Can you customize the toolbar? Add/remove buttons?</p>
</blockquote>
</aside>
<p>Gotta be careful about enabling the menu bar. Could change the screen size (resolution) that websites can detect. Needs testing. Source:<br>
<a href="https://trac.torproject.org/projects/tor/ticket/13858" class="onebox" target="_blank">https://trac.torproject.org/projects/tor/ticket/13858</a><br>
That ticket is now called a duplicate, but I wonder if the issue is 100% solved. There is also a lack of testing tools.<br>
<a href="https://trac.torproject.org/projects/tor/ticket/6119" class="onebox" target="_blank">https://trac.torproject.org/projects/tor/ticket/6119</a></p>
<p>That’s also a good question for the Tor support channels. I am not aware of any guide that mentions these topics.</p>
<p>Also your not mentioned other questions about Tor Browser customizations demand canonical answers by the official TBB support.</p>
          <p><a href="http://forums.whonix.org/t/application-customization-and-privacy-issues/3245/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/application-customization-and-privacy-issues/3245/2</link>
        <pubDate>Tue, 06 Dec 2016 16:18:42 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3245-2</guid>
        <source url="http://forums.whonix.org/t/application-customization-and-privacy-issues/3245.rss">Application Customization and Privacy Issues</source>
      </item>
      <item>
        <title>Application Customization and Privacy Issues</title>
        <dc:creator><![CDATA[entr0py]]></dc:creator>
        <description><![CDATA[
            <p>Continuing the discussion from <a href="https://forums.whonix.org/t/qubes-dispvm-technical-discussion/3232/19">Qubes DispVM technical discussion</a>:</p>
<p>This post has a Qubes feel to it because it was originally to be posted in Qubes-Whonix sub-forum. Halfway through though, I realized it was applicable to all Whonix flavors. The concept of Template VMs are universal, just called different things, ie base images. In short, separate VMs are not enough to guarantee identity isolation if customization parameters are shared by those VMs and are discoverable.</p>
<aside class="quote" data-post="18" data-topic="3232">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/e/8dc957/40.png" class="avatar"><a href="//forums.whonix.org/t/qubes-dispvm-technical-discussion/3232/18">Qubes DispVM technical discussion</a>
</div>
<blockquote>
<aside class="quote">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Any thoughts on the (previously existing) quote <a href="https://www.whonix.org/wiki/Tor_Browser#Running_Tor_Browser_in_Qubes_TemplateVM">https://www.whonix.org/wiki/Tor_Browser#Running_Tor_Browser_in_Qubes_TemplateVM</a></p>
<p>Don’t start Tor Browser in the whonix-ws TemplateVM or whonix-ws-dvm DisposableVM-TemplateVM. It is not expected to be done that way and wrong. […]</p>
</blockquote>
</aside>
<p>The conservative view would be to recommend that as a best practice. However, we are already relying on Tor Browser not to generate any unique identifiers every time we use it. So logically, it should be safe to run in a template for customization purposes. But it really needs to be stressed that customization is a dangerous exercise.</p>
</blockquote>
</aside>
<aside class="quote" data-post="19" data-topic="3232">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"><a href="//forums.whonix.org/t/qubes-dispvm-technical-discussion/3232/19">Qubes DispVM technical discussion</a>
</div>
<blockquote>
<p>Agreed! Please add!</p>
</blockquote>
</aside>
<p>Here’s my draft:</p>
<blockquote>
<p>It is strongly recommended to never run user applications (especially network-facing ones) in any type of template VM. This is because applications often generate files, that when propagated to child VMs, can result in VM-linkability. For example, starting Firefox and connecting to a website might result in the download of unique cookies. Some applications may generate a random number seed that could be used to identify the VM uniquely.</p>
</blockquote>
<blockquote>
<p>In the case of Tor Browser, an exception may be made to allow for customization. However, it should be clearly understood that the best practice, as recommended by The Tor Project, is to use Tor Browser in its stock configuration. This is because Tor Browser has a very deliberate fingerprint, one that is designed to be shared by all Tor Browser users. Even seemingly innocuous changes, like enabling the NoScript option to ‘Show message about blocked scripts’ can alter the fingerprint by changing the reported screen size. Further, while Tor Browser is designed to prevent any type of linkability through fingerprinting, issues past and present suggest that it is not perfect. These issues are only magnified by using a custom configuration that is shared by multiple VMs.</p>
</blockquote>
<p><strong>But</strong> after re-reading the original text, I changed my mind. Here’s a very relevant ticket to our situation: <a href="https://trac.torproject.org/projects/tor/ticket/14390">https://trac.torproject.org/projects/tor/ticket/14390</a>. This bug is still embargoed after 2 years?!?!? Given something like that, how can we recommend anything other than best practice / stock configuration? In fact, I think we need to do the opposite and whitelist things that are safe to customize in templates for Tor Browser.</p>
<ul>
<li>Can you customize the toolbar? Add/remove buttons?</li>
<li>Can you change Preferences?<br>
-tab behavior?<br>
-download directory?<br>
-search engines?<br>
-update preferences? (I find it very useful for disposableVMs to set update to notify-only instead of auto)</li>
<li>NoScript? disable JS?</li>
<li>TorButton? change security slider?</li>
</ul>
<p>What about other applications? I’m sure most users have a favorite terminal and a set of preferences for it. Even if you don’t customize a terminal in your template VM, if you then perform the identical customization in each of your user VMs, the result will be the same. An adversary that gains user-access to your VMs will be able to link them together based solely on your config files.</p>
<p>With Qubes, we rely on the fact that attackers with user/root privileges don’t necessarily constitute an existential threat. From a privacy perspective, it could be game over. So do we need to construct a list of customizable apps? or just tell everyone to live in misery with all default settings?</p>
          <p><a href="http://forums.whonix.org/t/application-customization-and-privacy-issues/3245/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/application-customization-and-privacy-issues/3245/1</link>
        <pubDate>Tue, 06 Dec 2016 04:55:10 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3245-1</guid>
        <source url="http://forums.whonix.org/t/application-customization-and-privacy-issues/3245.rss">Application Customization and Privacy Issues</source>
      </item>
  </channel>
</rss>

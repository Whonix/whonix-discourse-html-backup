<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Unable to access V3 hidden site behind Whonix-Gateway 14</title>
    <link>http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360</link>
    <description>Not sure if this is related to Whonix 14, but I replaced a KVM Whonix-Gateway 13 by the newest version (14.0.0.7.4) and now I cannot access a v3 hidden service anymore (works with Whonix 13). Am I missing something? Has something changed? Here is what I have done on the Whonix Gateway 14:

1. copied the v3 hidden server folder containing hostname and keys in` /var/lib/tor/` directory of the Whonix-Gateway 14;
2. added the following lines in `/usr/local/etc/torrc.d/50_user.conf` (as it was in `/etc/tor/torrc` in the Whonix 13 Gateway):
    HiddenServiceDir /var/lib/tor/server-name/
    HiddenServiceVersion 3
    HiddenServicePort 80 10.152.152.12 80
3. Made sure owner of /var/lib/tor/ is debian-tor (`sudo chown -R debian-tor:debian-tor /var/lib/tor/`)

Then I restarted tor/rebooted the Gateway multiple times. The v3 hidden server is still unreachable (time out).

I checked that the VM where the server is actually located does have the correct internal address 10.152.152.12. It is connected to the Gateway and can reach the external internet through the Gateway (i.e. I can curl urls and I can see that I am connected to Tor).

What is wrong? How to correctly configure the Gateway for v3 hidden services (and maybe v2 too, didn&#39;t try it) in Whonix 14?</description>
    <language>en</language>
    <lastBuildDate>Fri, 20 Jul 2018 09:21:25 +0000</lastBuildDate>
    <category>KVM</category>
    <atom:link href="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Unable to access V3 hidden site behind Whonix-Gateway 14</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p>For interest, some related v3 issues were fixed as of yesterday e.g.</p>
<p><a href="https://trac.torproject.org/projects/tor/ticket/25552" class="onebox" target="_blank">https://trac.torproject.org/projects/tor/ticket/25552</a></p>
<p><a href="https://trac.torproject.org/projects/tor/ticket/26549" class="onebox" target="_blank">https://trac.torproject.org/projects/tor/ticket/26549</a></p>
          <p><a href="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/9</link>
        <pubDate>Fri, 20 Jul 2018 09:21:25 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-5360-9</guid>
        <source url="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360.rss">Unable to access V3 hidden site behind Whonix-Gateway 14</source>
      </item>
      <item>
        <title>Unable to access V3 hidden site behind Whonix-Gateway 14</title>
        <dc:creator><![CDATA[mig5]]></dc:creator>
        <description><![CDATA[
            <p>I’ve seen a few posts here about the mysterious ‘my v3 onion is suddenly unreachable’ (including the <a href="http://Whonix.org" rel="nofollow noopener">Whonix.org</a> v3 onion, which predated my time here), and thought I’d let you know of a known issue about v3 descriptors being re-published to the HSdirs.</p>
<p>I first saw this in OnionShare whilst working on persistent v3 onions there, and this led to it being reported upstream. But even have seen it after migrating a simple website to another server (and migrating its v3 keys) and being surprised it wouldn’t be reachable (but then did, by itself, hours later)</p>
<p>In all such cases, as seem to be the cases I’ve seen in this forum, the v3 onion magically starts working again all by itself later, without any other action taken by the admin. This is because some sort of TTL/counter expires and eventually leads to the v3 onion successfully republishing its descriptor to the HSdir.</p>
<p>A fix has been implemented (we know it fixes the OnionShare use case of re-publishing a v3 descriptor) and is expected to arrive in Tor 0.3.5 in December.</p>
<p>Links of interest:</p>
<p><a href="https://trac.torproject.org/projects/tor/ticket/25552" class="onebox" target="_blank" rel="nofollow noopener">https://trac.torproject.org/projects/tor/ticket/25552</a><br>
</p><aside class="onebox githubissue">
  <header class="source">
      <a href="https://github.com/micahflee/onionshare/issues/461" target="_blank" rel="nofollow noopener">github.com/micahflee/onionshare</a>
  </header>
  <article class="onebox-body">
    <a href="https://github.com/Baccount" rel="nofollow noopener">
<img src="//forums.whonix.org/uploads/default/original/2X/d/d503b097a7fe37af9560cca2633cc8584e207ecf.png" class="thumbnail onebox-avatar" width="420" height="420">
</a>

<h4><a href="https://github.com/micahflee/onionshare/issues/461" target="_blank" rel="nofollow noopener">Issue: Add support for prop 224</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="https://github.com/Baccount" target="_blank" rel="nofollow noopener">Baccount</a>
	on <a href="https://github.com/micahflee/onionshare/issues/461" target="_blank" rel="nofollow noopener">2017-08-02</a>
	</div>
	<div class="user">
	closed by <a href="https://github.com/mig5" target="_blank" rel="nofollow noopener">mig5</a>
	on <a href="https://github.com/micahflee/onionshare/issues/461" target="_blank" rel="nofollow noopener">2018-09-18</a>
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">The slugs can be removed because the The first layer of HS descriptor encryption
2.5.1. First layer of encryption [HS-DESC-FIRST-LAYER]
The first layer...</pre>

<div class="labels">
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">blocked</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">enhancement</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">v3 onions</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<br>
<aside class="onebox githubissue">
  <header class="source">
      <a href="https://github.com/micahflee/onionshare/issues/677" target="_blank" rel="nofollow noopener">github.com/micahflee/onionshare</a>
  </header>
  <article class="onebox-body">
    <a href="https://github.com/Baccount" rel="nofollow noopener">
<img src="//forums.whonix.org/uploads/default/original/2X/d/d503b097a7fe37af9560cca2633cc8584e207ecf.png" class="thumbnail onebox-avatar" width="420" height="420">
</a>

<h4><a href="https://github.com/micahflee/onionshare/issues/677" target="_blank" rel="nofollow noopener">Issue: Add V3 onion support without "Persistent onion" for the time being</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="https://github.com/Baccount" target="_blank" rel="nofollow noopener">Baccount</a>
	on <a href="https://github.com/micahflee/onionshare/issues/677" target="_blank" rel="nofollow noopener">2018-03-23</a>
	</div>
	<div class="user">
	closed by <a href="https://github.com/mig5" target="_blank" rel="nofollow noopener">mig5</a>
	on <a href="https://github.com/micahflee/onionshare/issues/677" target="_blank" rel="nofollow noopener">2018-09-18</a>
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">The UI for now just needs to disable the possibility to set persistent address and stealth onion service when using v3...</pre>

<div class="labels">
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">enhancement</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">v3 onions</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<p></p>
<p>(Note the Tor ticket: the devs there are preoccupied with the fact that it affects ‘scalability’ of clustered v3 onions, and generally have overlooked the fact that the bug actually occurs for basic single-server v3 onions (and only when ‘restarting’ or republishing the key). However, at least one Tor dev in that ticket is aware that it fixes republication of a pre-generated v3 onion key too (the OnionShare use case, and the scenario in which I think many ‘my v3 onion has disappeared!’ cases can be attributed… just my theory though.))</p>
          <p><a href="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/8</link>
        <pubDate>Thu, 19 Jul 2018 05:19:22 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-5360-8</guid>
        <source url="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360.rss">Unable to access V3 hidden site behind Whonix-Gateway 14</source>
      </item>
      <item>
        <title>Unable to access V3 hidden site behind Whonix-Gateway 14</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Good to know. Thanks for posting back.</p>
          <p><a href="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/7</link>
        <pubDate>Wed, 18 Jul 2018 22:04:50 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-5360-7</guid>
        <source url="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360.rss">Unable to access V3 hidden site behind Whonix-Gateway 14</source>
      </item>
      <item>
        <title>Unable to access V3 hidden site behind Whonix-Gateway 14</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <p>Good News: it’s working now.</p>
<p>What did I do? Nothing! I didn’t touch it for the last two days, and now I can access the hidden server normally.</p>
<p>Maybe it needed some time for the new path to the hidden server to propagate among the Tor network?</p>
<p>Conclusion: whonix-gateway 14 can correctly “host” hidden services.</p>
          <p><a href="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/6</link>
        <pubDate>Tue, 17 Jul 2018 23:08:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-5360-6</guid>
        <source url="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360.rss">Unable to access V3 hidden site behind Whonix-Gateway 14</source>
      </item>
      <item>
        <title>Unable to access V3 hidden site behind Whonix-Gateway 14</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <p>Hello there!</p>
<p>Still no luck. Unable to connect.</p>
<p>For testing purposes, I have set up a new debian9 virtual machine with another apache2 server and generated a new v3 onion address on the Whonix Gateway. I also assigned a new internal 10.152.152.** address to this dummy devian vm. <strong>It works!</strong></p>
<p>But the oriignal server still does not work… I have tried rebooting several times both the Gateway and the vm where the server is located. I have tried changing its IP internal address…  Still no luck… I really don’t know what’s wrong. I have also tried generating a new v3 onion for my server, but it automatically resolves to the first, real v3 address (why?) and then fails to connect…</p>
<p>Any idea…?</p>
          <p><a href="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/5</link>
        <pubDate>Sun, 15 Jul 2018 19:31:18 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-5360-5</guid>
        <source url="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360.rss">Unable to access V3 hidden site behind Whonix-Gateway 14</source>
      </item>
      <item>
        <title>Unable to access V3 hidden site behind Whonix-Gateway 14</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <p>Hi. Yes probably not KVM related, must be some kind of misconfiguration somewhere. I downloaded and used this version, I believe it is the last one (14.0.0.7.4):<br>
</p><aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/favicon.ico" class="site-icon" width="" height="">
      <a href="https://www.whonix.org/wiki/KVM_Testers_Only_Version" target="_blank" rel="nofollow noopener">Whonix</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/218;"><img src="//forums.whonix.org/uploads/default/original/2X/8/83f68ccb81ade3a0f794eaf945f02bd10f182e9a.jpg" class="thumbnail"></div>

<h3><a href="https://www.whonix.org/wiki/KVM_Testers_Only_Version" target="_blank" rel="nofollow noopener">KVM Testers Only Version</a></h3>

<p>Whonix in KVM - Testers Only Version</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<p></p>
<p>I will try again later today, maybe I’ll have more luck.</p>
          <p><a href="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/4</link>
        <pubDate>Sat, 23 Jun 2018 06:19:04 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-5360-4</guid>
        <source url="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360.rss">Unable to access V3 hidden site behind Whonix-Gateway 14</source>
      </item>
      <item>
        <title>Unable to access V3 hidden site behind Whonix-Gateway 14</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>HulaHoop:</p>
<blockquote>
<p><a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a> what is the status of Tor v3 support in the latest RC?</p>
</blockquote>
<p>Working.</p>
          <p><a href="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/3</link>
        <pubDate>Sat, 23 Jun 2018 04:47:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-5360-3</guid>
        <source url="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360.rss">Unable to access V3 hidden site behind Whonix-Gateway 14</source>
      </item>
      <item>
        <title>Unable to access V3 hidden site behind Whonix-Gateway 14</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Hi. Did you install the latest version of 14? technically not a KVM problem but hopefully we can get to the bottom of it. Have you tried updating from our testers repo?</p>
<p><a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a> what is the status of Tor v3 support in the latest RC?</p>
          <p><a href="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/2</link>
        <pubDate>Fri, 22 Jun 2018 20:41:20 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-5360-2</guid>
        <source url="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360.rss">Unable to access V3 hidden site behind Whonix-Gateway 14</source>
      </item>
      <item>
        <title>Unable to access V3 hidden site behind Whonix-Gateway 14</title>
        <dc:creator><![CDATA[onion_knight]]></dc:creator>
        <description><![CDATA[
            <p>Not sure if this is related to Whonix 14, but I replaced a KVM Whonix-Gateway 13 by the newest version (14.0.0.7.4) and now I cannot access a v3 hidden service anymore (works with Whonix 13). Am I missing something? Has something changed? Here is what I have done on the Whonix Gateway 14:</p>
<ol>
<li>copied the v3 hidden server folder containing hostname and keys in<code>/var/lib/tor/</code> directory of the Whonix-Gateway 14;</li>
<li>added the following lines in <code>/usr/local/etc/torrc.d/50_user.conf</code> (as it was in <code>/etc/tor/torrc</code> in the Whonix 13 Gateway):<br>
HiddenServiceDir /var/lib/tor/server-name/<br>
HiddenServiceVersion 3<br>
HiddenServicePort 80 10.152.152.12 80</li>
<li>Made sure owner of /var/lib/tor/ is debian-tor (<code>sudo chown -R debian-tor:debian-tor /var/lib/tor/</code>)</li>
</ol>
<p>Then I restarted tor/rebooted the Gateway multiple times. The v3 hidden server is still unreachable (time out).</p>
<p>I checked that the VM where the server is actually located does have the correct internal address 10.152.152.12. It is connected to the Gateway and can reach the external internet through the Gateway (i.e. I can curl urls and I can see that I am connected to Tor).</p>
<p>What is wrong? How to correctly configure the Gateway for v3 hidden services (and maybe v2 too, didn’t try it) in Whonix 14?</p>
          <p><a href="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360/1</link>
        <pubDate>Fri, 22 Jun 2018 14:18:21 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-5360-1</guid>
        <source url="http://forums.whonix.org/t/unable-to-access-v3-hidden-site-behind-whonix-gateway-14/5360.rss">Unable to access V3 hidden site behind Whonix-Gateway 14</source>
      </item>
  </channel>
</rss>

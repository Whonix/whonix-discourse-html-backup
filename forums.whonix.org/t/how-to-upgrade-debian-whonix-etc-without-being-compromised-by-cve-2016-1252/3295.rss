<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>How to upgrade Debian, Whonix, etc. without being compromised by CVE-2016-1252</title>
    <link>http://forums.whonix.org/t/how-to-upgrade-debian-whonix-etc-without-being-compromised-by-cve-2016-1252/3295</link>
    <description>&lt;small&gt;Originally published at:			https://www.whonix.org/blog/cve-2016-1252
		&lt;/small&gt;&lt;br&gt;See:&lt;a href=&quot;https://www.whonix.org/wiki/CVE-2016-1252&quot;&gt;
https://www.whonix.org/wiki/CVE-2016-1252&lt;/a&gt;</description>
    <language>en</language>
    <lastBuildDate>Wed, 21 Dec 2016 13:24:56 +0000</lastBuildDate>
    <category>News</category>
    <atom:link href="http://forums.whonix.org/t/how-to-upgrade-debian-whonix-etc-without-being-compromised-by-cve-2016-1252/3295.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>How to upgrade Debian, Whonix, etc. without being compromised by CVE-2016-1252</title>
        <dc:creator><![CDATA[torjunkie]]></dc:creator>
        <description><![CDATA[
            <p>Based on Qubes Security Bulletin <span class="hashtag">#28</span>, isn’t the safest advice to reinstall the Debian and Whonix templates from scratch using the steps below?</p>
<p>Assume the worst and hope for the best? Always go full Ripley:</p>
<blockquote>
<p>“Nuke the entire site [Debian/Whonix Templates] from orbit–it’s the only way to be sure”</p>
</blockquote>
<aside class="onebox githubblob">
  <header class="source">
      <a href="https://github.com/QubesOS/qubes-secpack/blob/master/QSBs/qsb-028-2016.txt" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="https://github.com/QubesOS/qubes-secpack/blob/master/QSBs/qsb-028-2016.txt" target="_blank" rel="nofollow noopener">QubesOS/qubes-secpack/blob/master/QSBs/qsb-028-2016.txt</a></h4>
<pre><code class="lang-txt">

             ---===[ Qubes Security Bulletin #28 ]===---

                          December 19, 2016


                Debian update mechanism vulnerability


Quick Summary
==============

The Debian Security Team has announced a security bug (DSA-3733-1) in
the signature verification of repository metadata, which could lead to
privilege escalation [1] within a Debian-based VM. This bug does _not_
allow escape from any VM or enable any attacks on other parts of the
Qubes system. In particular, this bug does _not_ affect dom0, the Xen
hypervisor, and non-Debian-based VMs. Nevertheless, we have decided to
release this bulletin, because if a TemplateVM is affected, then every
</code></pre>

  This file has been truncated. <a href="https://github.com/QubesOS/qubes-secpack/blob/master/QSBs/qsb-028-2016.txt" target="_blank" rel="nofollow noopener">show original</a>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Important bits:</p>
<blockquote>
<p><strong>Impact</strong></p>
</blockquote>
<blockquote>
<p>In theory, this bug allows an attacker to take over any Debian 8 or  Debian 9 template (which includes Whonix templates [3]) and,  consequently, any VMs based on those templates. However, for the  reasons explained above, the configuration used in Qubes OS happens to make this bug hard to exploit. Nevertheless, one should never underestimate the creativity of exploit authors, and thus one should assume that the bug is exploitable and patch immediately, just to stay on the safe side.</p>
</blockquote>
<blockquote>
<p>&amp;</p>
</blockquote>
<blockquote>
<p><strong>Patching</strong></p>
</blockquote>
<blockquote>
<p>As the bug affects Debian-based templates themselves, just applying updates may not be enough, if those VMs are already compromised.  Users, especially those using Debian-based VMs for sensitive tasks, should remove all affected templates and install fresh ones. This also applies to any customized Debian-based templates. Users with customized Debian-based templates should first note their  customizations, remove the potentially compromised templates, install fresh templates, clone them, and reapply their customizations to the cloned templates.</p>
</blockquote>
<blockquote>
<p>The procedure for removing affected templates and installing fresh ones is documented as the “Manual Reinstallation Method” in the Qubes documentation on reinstalling TemplateVMs [5]. (Please note that the simplified template reinstallation method described in the documentation, which uses <code>--action=reinstall</code>, is not sufficient, since it will download the old, vulnerable template.)</p>
</blockquote>
<blockquote>
<p>Fixed APT packages are included in templates listed below:</p>
</blockquote>
<blockquote>
<p>For Qubes 3.2:</p>
<ul>
<li>qubes-template-debian-8-3.0.6-201612171620</li>
<li>qubes-template-whonix-gw-3.0.6-201612182342</li>
<li>qubes-template-whonix-ws-3.0.6-201612190628</li>
</ul>
</blockquote>
<blockquote>
<p>For Qubes 3.1:</p>
<ul>
<li>qubes-template-debian-8-3.0.6-201612171837</li>
<li>qubes-template-whonix-gw-3.0.6-201612190009</li>
<li>qubes-template-whonix-ws-3.0.6-201612190633</li>
</ul>
</blockquote>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.qubes-os.org/attachment/icons/512x512/apps/qubes-logo-icon.png" class="site-icon" width="500" height="500">
      <a href="https://www.qubes-os.org/doc/reinstall-template/#manual-reinstallation-method" target="_blank" rel="nofollow noopener">Qubes OS</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/362;"><img src="https://www.qubes-os.org/attachment/icons/qubes-logo-icon-name-slogan-fb.png" class="thumbnail"></div>

<h3><a href="https://www.qubes-os.org/doc/reinstall-template/#manual-reinstallation-method" target="_blank" rel="nofollow noopener">How to Reinstall a TemplateVM</a></h3>

<p>How to Reinstall a TemplateVM  If you suspect your TemplateVM is broken, misconfigured, or compromised, you can reinstall any TemplateVM that was installed from the Qubes repository.  The procedure...</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<blockquote>
<p><strong>(1)</strong> (Optional) Clone the existing target TemplateVM.</p>
</blockquote>
<blockquote>
<p>This can be a good idea if you’ve customized the existing template and want to keep your customizations. On the other hand, if you suspect that this template is broken, misconfigured, or compromised, you may want to remove it without cloning it.</p>
</blockquote>
<blockquote>
<p><strong>(2)</strong> Create a temporary dummy template:</p>
</blockquote>
<blockquote>
<p>mkdir /var/lib/qubes/vm-templates/dummy<br>
touch /var/lib/qubes/vm-templates/dummy/{root.img,private.img}<br>
qvm-add-template dummy</p>
</blockquote>
<blockquote>
<p><strong>(3)</strong> Temporarily change all VMs based on the target TemplateVM to the new dummy template, or remove them.</p>
</blockquote>
<blockquote>
<p>This can be a good idea if you have user data in these VMs that you want to keep. On the other hand, if you suspect that these VMs (or the templates on which they are based) are broken, misconfigured, or compromised, you may want to remove them instead. You can do this in Qubes Manager by right-clicking on the VM and clicking Remove VM, or you can use the command qvm-remove  in dom0.</p>
</blockquote>
<blockquote>
<p>Using a dummy template as a temporary template is preferable to using another real TemplateVM because you can’t accidentally boot any VMs from the dummy template. (There is no OS in the dummy template, so the boot will fail.)</p>
</blockquote>
<blockquote>
<p><strong>(4)</strong> Uninstall the target TemplateVM from dom0:</p>
</blockquote>
<blockquote>
<p>$ sudo yum remove </p>
</blockquote>
<blockquote>
<p>For example, to uninstall the whonix-gw template:</p>
</blockquote>
<blockquote>
<p>$ sudo yum remove qubes-template-whonix-gw</p>
</blockquote>
<blockquote>
<p><strong>(5)</strong> Reinstall the target TemplateVM in dom0:</p>
</blockquote>
<blockquote>
<p>$ sudo qubes-dom0-update --enablerepo= \ </p>
</blockquote>
<blockquote>
<p>For example, to install the whonix-gw template:</p>
</blockquote>
<blockquote>
<p>$ sudo qubes-dom0-update --enablerepo=qubes-templates-community \ qubes-template-whonix-gw</p>
</blockquote>
<blockquote>
<p><strong>(6)</strong> If you temporarily changed all VMs based on the target TemplateVM to the dummy template in step 3, change them back to the new target TemplateVM now. If you instead removed all VMs based on the old target TemplateVM, you can recreate your desired VMs from the newly reinstalled target TemplateVM now.</p>
</blockquote>
          <p><a href="http://forums.whonix.org/t/how-to-upgrade-debian-whonix-etc-without-being-compromised-by-cve-2016-1252/3295/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/how-to-upgrade-debian-whonix-etc-without-being-compromised-by-cve-2016-1252/3295/2</link>
        <pubDate>Wed, 21 Dec 2016 13:24:56 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3295-2</guid>
        <source url="http://forums.whonix.org/t/how-to-upgrade-debian-whonix-etc-without-being-compromised-by-cve-2016-1252/3295.rss">How to upgrade Debian, Whonix, etc. without being compromised by CVE-2016-1252</source>
      </item>
      <item>
        <title>How to upgrade Debian, Whonix, etc. without being compromised by CVE-2016-1252</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p><small>Originally published at:			<a href="https://www.whonix.org/blog/cve-2016-1252">https://www.whonix.org/blog/cve-2016-1252</a><br>
</small><br>See:<a href="https://www.whonix.org/wiki/CVE-2016-1252"><br>
https://www.whonix.org/wiki/CVE-2016-1252</a></p>
          <p><a href="http://forums.whonix.org/t/how-to-upgrade-debian-whonix-etc-without-being-compromised-by-cve-2016-1252/3295/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/how-to-upgrade-debian-whonix-etc-without-being-compromised-by-cve-2016-1252/3295/1</link>
        <pubDate>Thu, 15 Dec 2016 23:02:16 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-3295-1</guid>
        <source url="http://forums.whonix.org/t/how-to-upgrade-debian-whonix-etc-without-being-compromised-by-cve-2016-1252/3295.rss">How to upgrade Debian, Whonix, etc. without being compromised by CVE-2016-1252</source>
      </item>
  </channel>
</rss>

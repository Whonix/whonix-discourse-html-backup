<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Configure “host -&gt; ssh(encrypted socks5 proxy) -&gt; Tor -&gt; destination”</title>
    <link>http://forums.whonix.org/t/configure-host-ssh-encrypted-socks5-proxy-tor-destination/9889</link>
    <description>The goal is to create an encrypted connection all the way between host and tor exit node, while hiding the use of tor from the host isp and masking host network activity as ssh encrypted traffic when using whonix.

Inside whonix-gateway stop tor, then connect to a vps using ssh:

` ssh -f -N -D 1080 vps-ip-address` 

This establishes an encrypted tunnel between whonix-gateway and the vps, creating a socks5 proxy on 127.0.0.1:1080 inside whonix-gateway that tunnels all traffic to the vps encrypted (unlike using directly the vps as socks5 proxy).

The host real ip address is exposed to the vps (ssh bypasses tor inside whonix-gateway).

Inside whonix-gateway open the tor configuration (gui or text file) and add 127.0.0.1:1080 as socks5 proxy to use &quot;before connecting to tor&quot;. If using the text file configuration use:

`Socks5Proxy 127.0.0.1:1080`

This followed the instructions on the whonix wiki page: whonix. org/wiki/Tunnels/Connecting_to_SSH_before_Tor but there is no mention if it works with bridges, as Im currently using obfs4 bridges.

Also, using Socks5Proxy 127.0.0.1:1080 prevents tor from working if the socks5 proxy (vps) goes offline or ssh connection drops?

Is this persistent after a reboot?

Is correct to assume that now the isp only sees encrypted ssh traffic to/from the vps ip, and the tunnel is encrypted all the way to tor exit node?

`(host -&gt; ssh -&gt; vps -&gt; obfs4 bridge -&gt; tor -&gt; destination)`


Thanks. 
(asked also on tor stackexchange )</description>
    <language>en</language>
    <lastBuildDate>Sun, 05 Jul 2020 19:00:50 +0000</lastBuildDate>
    <category>Support</category>
    <atom:link href="http://forums.whonix.org/t/configure-host-ssh-encrypted-socks5-proxy-tor-destination/9889.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Configure “host -&gt; ssh(encrypted socks5 proxy) -&gt; Tor -&gt; destination”</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="corabella" data-post="1" data-topic="9889">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/c/ecd19e/40.png" class="avatar"> corabella:</div>
<blockquote>
<p>but there is no mention if it works with bridges, as Im currently using obfs4 bridges.</p>
</blockquote>
</aside>
<p>That is because bridge settings are unrelated. Tor config bridges + Tor proxy config changes are Tor questions as per <a href="https://www.whonix.org/wiki/Free_Support_Principle">https://www.whonix.org/wiki/Free_Support_Principle</a></p>
<aside class="quote no-group" data-username="corabella" data-post="1" data-topic="9889">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/c/ecd19e/40.png" class="avatar"> corabella:</div>
<blockquote>
<p>Also, using Socks5Proxy 127.0.0.1:1080 prevents tor from working if the socks5 proxy (vps) goes offline or ssh connection drops?</p>
</blockquote>
</aside>
<p>Should. That is entirely up to Tor. <a href="https://www.whonix.org/wiki/Free_Support_Principle">https://www.whonix.org/wiki/Free_Support_Principle</a> applies.</p>
<aside class="quote no-group" data-username="corabella" data-post="1" data-topic="9889">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/c/ecd19e/40.png" class="avatar"> corabella:</div>
<blockquote>
<p>Is this persistent after a reboot?</p>
</blockquote>
</aside>
<p>Instructions for <a href="https://www.whonix.org/wiki/Tor#Edit_Tor_Configuration">Edit Tor Configuration</a> are persistent by default - unless you select to boot into live mode at grub boot menu.</p>
<aside class="quote no-group" data-username="corabella" data-post="1" data-topic="9889">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/c/ecd19e/40.png" class="avatar"> corabella:</div>
<blockquote>
<p>vps</p>
</blockquote>
</aside>
<p>related:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Remote_Administration" target="_blank" title="12:04PM - 19 June 2020">Whonix – 19 Jun 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:120/60;"><img src="https://www.whonix.org/w/images/a/ad/Remoteadmin.png" class="thumbnail" width="120" height="60"></div>

<h3><a href="https://www.whonix.org/wiki/Remote_Administration" target="_blank">Remote Administration - Whonix</a></h3>

<p>Remote Administration</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-username="corabella" data-post="1" data-topic="9889">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/c/ecd19e/40.png" class="avatar"> corabella:</div>
<blockquote>
<p>hiding the use of tor from the host isp</p>
</blockquote>
</aside>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/Hide_Tor_from_your_Internet_Service_Provider" target="_blank" title="11:59PM - 19 June 2020">Whonix – 19 Jun 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:120/80;"><img src="https://www.whonix.org/w/images/c/c4/Cat-1040815640.jpg" class="thumbnail" width="120" height="80"></div>

<h3><a href="https://www.whonix.org/wiki/Hide_Tor_from_your_Internet_Service_Provider" target="_blank">Hide Tor use from the Internet Service Provider</a></h3>

<p>Prevent the Internet Service Provider from discovering you are a Tor user.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-username="corabella" data-post="1" data-topic="9889">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v4/letter/c/ecd19e/40.png" class="avatar"> corabella:</div>
<blockquote>
<p>The host real ip address is exposed to the vps</p>
</blockquote>
</aside>
<p>No good idea.</p>
          <p><a href="http://forums.whonix.org/t/configure-host-ssh-encrypted-socks5-proxy-tor-destination/9889/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/configure-host-ssh-encrypted-socks5-proxy-tor-destination/9889/2</link>
        <pubDate>Sun, 05 Jul 2020 19:00:50 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9889-2</guid>
        <source url="http://forums.whonix.org/t/configure-host-ssh-encrypted-socks5-proxy-tor-destination/9889.rss">Configure “host -&gt; ssh(encrypted socks5 proxy) -&gt; Tor -&gt; destination”</source>
      </item>
      <item>
        <title>Configure “host -&gt; ssh(encrypted socks5 proxy) -&gt; Tor -&gt; destination”</title>
        <dc:creator><![CDATA[corabella]]></dc:creator>
        <description><![CDATA[
            <p>The goal is to create an encrypted connection all the way between host and tor exit node, while hiding the use of tor from the host isp and masking host network activity as ssh encrypted traffic when using whonix.</p>
<p>Inside whonix-gateway stop tor, then connect to a vps using ssh:</p>
<p><code> ssh -f -N -D 1080 vps-ip-address</code></p>
<p>This establishes an encrypted tunnel between whonix-gateway and the vps, creating a socks5 proxy on 127.0.0.1:1080 inside whonix-gateway that tunnels all traffic to the vps encrypted (unlike using directly the vps as socks5 proxy).</p>
<p>The host real ip address is exposed to the vps (ssh bypasses tor inside whonix-gateway).</p>
<p>Inside whonix-gateway open the tor configuration (gui or text file) and add 127.0.0.1:1080 as socks5 proxy to use “before connecting to tor”. If using the text file configuration use:</p>
<p><code>Socks5Proxy 127.0.0.1:1080</code></p>
<p>This followed the instructions on the whonix wiki page: whonix. org/wiki/Tunnels/Connecting_to_SSH_before_Tor but there is no mention if it works with bridges, as Im currently using obfs4 bridges.</p>
<p>Also, using Socks5Proxy 127.0.0.1:1080 prevents tor from working if the socks5 proxy (vps) goes offline or ssh connection drops?</p>
<p>Is this persistent after a reboot?</p>
<p>Is correct to assume that now the isp only sees encrypted ssh traffic to/from the vps ip, and the tunnel is encrypted all the way to tor exit node?</p>
<p><code>(host -&gt; ssh -&gt; vps -&gt; obfs4 bridge -&gt; tor -&gt; destination)</code></p>
<p>Thanks.<br>
(asked also on tor stackexchange )</p>
          <p><a href="http://forums.whonix.org/t/configure-host-ssh-encrypted-socks5-proxy-tor-destination/9889/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/configure-host-ssh-encrypted-socks5-proxy-tor-destination/9889/1</link>
        <pubDate>Thu, 02 Jul 2020 09:57:40 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9889-1</guid>
        <source url="http://forums.whonix.org/t/configure-host-ssh-encrypted-socks5-proxy-tor-destination/9889.rss">Configure “host -&gt; ssh(encrypted socks5 proxy) -&gt; Tor -&gt; destination”</source>
      </item>
  </channel>
</rss>

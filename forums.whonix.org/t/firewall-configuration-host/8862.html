<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Firewall configuration host - Support - Whonix Forum</title>
    <meta name="description" content="Following Whonix instructions I set up a firewall on my Ubuntu host by just enabling gufw in its default configuration: deny incoming, allow outgoing. Simple enough. Today I issued the command: sudo iptables -L, to have &amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="8862.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Firewall configuration host&#39;" href="8862.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/firewall-configuration-host/8862" />
<meta name="twitter:url" content="https://forums.whonix.org/t/firewall-configuration-host/8862" />
<meta property="og:title" content="Firewall configuration host" />
<meta name="twitter:title" content="Firewall configuration host" />
<meta property="og:description" content="Following Whonix instructions I set up a firewall on my Ubuntu host by just enabling gufw in its default configuration: deny incoming, allow outgoing. Simple enough. Today I issued the command: sudo iptables -L, to have a manual look at my firewall rules, this is the output for the chain INPUT:  Chain INPUT (policy DROP)  target     prot opt source               destination  ACCEPT     all  ‚Äì  anywhere             anywhere  ACCEPT     all  ‚Äì  255.255.255.255      anywhere  ACCEPT     all  ‚Äì  192..." />
<meta name="twitter:description" content="Following Whonix instructions I set up a firewall on my Ubuntu host by just enabling gufw in its default configuration: deny incoming, allow outgoing. Simple enough. Today I issued the command: sudo iptables -L, to have a manual look at my firewall rules, this is the output for the chain INPUT:  Chain INPUT (policy DROP)  target     prot opt source               destination  ACCEPT     all  ‚Äì  anywhere             anywhere  ACCEPT     all  ‚Äì  255.255.255.255      anywhere  ACCEPT     all  ‚Äì  192..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="4 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="2 ‚ù§" />
<meta property="article:published_time" content="2020-01-29T13:22:57+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="8862.html">Firewall configuration host</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/support/5.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #8C6238'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Support</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/rk1'><span itemprop='name'>rk1</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8862.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-29T13:22:57Z' class='post-time'>
                January 29, 2020,  1:22pm
              </time>
              <meta itemprop='dateModified' content='2020-01-29T13:22:57Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Following Whonix instructions I set up a firewall on my Ubuntu host by just enabling gufw in its default configuration: deny incoming, allow outgoing. Simple enough. Today I issued the command: sudo iptables -L, to have a manual look at my firewall rules, this is the output for the chain INPUT:</p>
<p>Chain INPUT (policy DROP)</p>
<p>target     prot opt source               destination<br>
ACCEPT     all  ‚Äì  anywhere             anywhere<br>
ACCEPT     all  ‚Äì  255.255.255.255      anywhere<br>
ACCEPT     all  ‚Äì  192.168.0.0/16       192.168.0.0/16<br>
ACCEPT     all  ‚Äì  10.0.0.0/8           10.0.0.0/8<br>
ACCEPT     all  ‚Äì  172.16.0.0/12        172.16.0.0/12<br>
ACCEPT     icmp ‚Äì  anywhere             anywhere             icmp echo-request<br>
ACCEPT     all  ‚Äì  anywhere             anywhere             state RELATED,ESTABLISHED<br>
ACCEPT     all  ‚Äì  anywhere             anywhere<br>
DROP       all  ‚Äì  anywhere             anywhere<br>
ufw-before-logging-input  all  ‚Äì  anywhere             anywhere<br>
ufw-before-input  all  ‚Äì  anywhere             anywhere<br>
ufw-after-input  all  ‚Äì  anywhere             anywhere<br>
ufw-after-logging-input  all  ‚Äì  anywhere             anywhere<br>
ufw-reject-input  all  ‚Äì  anywhere             anywhere<br>
ufw-track-input  all  ‚Äì  anywhere             anywhere</p>
<p>As you can see the default policy is DROP, which is good and as expected by setting ufw‚Äôs default (deny incoming). But then look at the rules for INPUT. As I understand the rules goes from specific to general. So if the default is to drop input, you put some specific rules in place to allow the incoming traffic you do want. Now what is the first ‚Äúspecific‚Äù rule on input:</p>
<p>ACCEPT     all  ‚Äì  anywhere             anywhere<br>
meaning: yes, accept all traffic coming from anywhere going to anywhere and do so for all protocols. So while my ufw policy is dead simple: drop all incoming traffic, that policy is defeated by the very first rule that comes before that: allow everything incoming.</p>
<p>I asked the same question on <a href="../../../external.html?link=https://askubuntu.com/questions/1206557/dont-understand-my-firewall-settings" rel="nofollow noopener">https://askubuntu.com/questions/1206557/dont-understand-my-firewall-settings</a>. Thus far I got this comment: ‚ÄúA default install of Ubuntu Desktop has no exploitable open ports‚Äù. I thought ‚Äúdefault install‚Äù, and I was thinking of my VPN connection and my Whonix guest system. I issued the command sudo netstat -lntup, which gave me this output:</p>
<p>Active Internet connections (only servers)<br>
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name<br>
tcp        0      0 127.0.0.1:9050          0.0.0.0:*               LISTEN      1219/tor<br>
tcp        0      0 127.0.0.1:3100          0.0.0.0:*               LISTEN      5283/openvpn<br>
tcp        0      0 127.0.0.1:42685         0.0.0.0:*               LISTEN      3194/mono<br>
tcp        0      0 10.0.2.2:53             0.0.0.0:*               LISTEN      1721/dnsmasq<br>
tcp        0      0 192.168.122.1:53        0.0.0.0:*               LISTEN      1484/dnsmasq<br>
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      1138/systemd-resolv<br>
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      6357/cupsd<br>
tcp6       0      0 ::1:631                 :::*                    LISTEN      6357/cupsd<br>
udp        0      0 10.0.2.2:53             0.0.0.0:*                           1721/dnsmasq<br>
udp        0      0 192.168.122.1:53        0.0.0.0:*                           1484/dnsmasq<br>
udp        0      0 127.0.0.53:53           0.0.0.0:*                           1138/systemd-resolv<br>
udp        0      0 0.0.0.0:67              0.0.0.0:*                           1484/dnsmasq<br>
udp        0      0 0.0.0.0:68              0.0.0.0:*                           1142/dhclient<br>
udp        0      0 0.0.0.0:631             0.0.0.0:*                           6358/cups-browsed<br>
udp        0      0 0.0.0.0:41794           0.0.0.0:*                           820/avahi-daemon: r<br>
udp        0      0 0.0.0.0:58320           0.0.0.0:*                           5283/openvpn<br>
udp        0      0 224.0.0.251:5353        0.0.0.0:*                           6741/chrome --type=<br>
udp        0      0 224.0.0.251:5353        0.0.0.0:*                           6741/chrome --type=<br>
udp        0      0 224.0.0.251:5353        0.0.0.0:*                           6703/chrome<br>
udp        0      0 224.0.0.251:5353        0.0.0.0:*                           6703/chrome<br>
udp        0      0 224.0.0.251:5353        0.0.0.0:*                           6741/chrome --type=<br>
udp        0      0 0.0.0.0:5353            0.0.0.0:*                           820/avahi-daemon: r<br>
udp6       0      0 :::50178                :::*                                820/avahi-daemon: r<br>
udp6       0      0 :::5353                 :::*                                820/avahi-daemon: r</p>
<p>Now the first listening process is tor, the second openvpn. And we have dnsmaq en cups. Now first off I don‚Äôt understand the Whonix instruction to deny all incoming, if we have a tor process listening (if that tor process comes from Whonix). Second: is there a relation between these listeners and my firewall rules. But still first rule: ‚Äòaccept all anywhere‚Äô‚Ä¶ would be too broadly defined.</p>
<p>I did a fresh install of Ubuntu just a couple of weeks back, and I never played with my firewall settings (except by enabling gufw in its default config) as I never understand much of networking.</p>
<p>Can you shed some light here?</p>
        </div>

        <meta itemprop='headline' content='Firewall configuration host'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8862.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-29T13:56:02Z' class='post-time'>
                January 29, 2020,  1:56pm
              </time>
              <meta itemprop='dateModified' content='2020-01-29T13:56:02Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Reduce as much as possible applications opening listeners on anything except localhost (127.0.0.1). Avahi / cups and a few more are maybe not needed by you and can be uninstalled. In theory, if there are no applications opening listeners to the outside world you don‚Äôt need a firewall blocking unsolicited incoming connections‚Ä¶ But since such a dependency might be pulled  by another package without your knowledge it is advisable to have a host firewall.</p>
<p>There is also <a href="../../../external.html?link=https://github.com/Whonix/whonix-host-firewall">https://github.com/Whonix/whonix-host-firewall</a> which blocks also invalid packages but it‚Äôs development / testing was never finished (usual lack of resources, time, money).</p>
<p>Once development of Kicksecure and/or Whonix-Host progressed further, there will be a firewall installed on the host by default.</p>
<aside class="quote no-group" data-username="rk1" data-post="1" data-topic="8862">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/r/9f8e36/40.png" class="avatar"> rk1:</div>
<blockquote>
<p>tcp 0 0 127.0.0.1:9050 0.0.0.0:* LISTEN 1219/tor</p>
</blockquote>
</aside>
<p>Listens on localhost only as 127.0.0.1 indicates. If this output is from the host, then this is not from Whonix.<br>
It‚Äôs possible to configure a VM to provide an open port on the host but Whonix does not need to do that and never did that by default. This is likely from the distribution <code>tor</code> which is possibly installed on the host.</p>
<aside class="quote no-group" data-username="rk1" data-post="1" data-topic="8862">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/r/9f8e36/40.png" class="avatar"> rk1:</div>
<blockquote>
<p>deny all incoming</p>
</blockquote>
</aside>
<p>This means actually ‚Äúdeny all incoming unsolicited connections‚Äù. Really ‚Äúall incoming‚Äù would mean no more internet connectivity.</p>
<aside class="quote no-group" data-username="rk1" data-post="1" data-topic="8862">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/r/9f8e36/40.png" class="avatar"> rk1:</div>
<blockquote>
<p>if we have a tor process listening (if that tor process comes from Whonix)</p>
</blockquote>
</aside>
<p>Not by Whonix as explained above.</p>
        </div>

        <meta itemprop='headline' content='Firewall configuration host'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/anontor'><span itemprop='name'>anontor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8862.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-29T17:50:59Z' class='post-time'>
                January 29, 2020,  5:50pm
              </time>
              <meta itemprop='dateModified' content='2020-01-29T18:28:58Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>rk1,</p>
<p>I can help you with iptables. There are a couple different directions you can go.<br>
First, as you correctly observed, ufw allows more things than it should, at least I think so. Protocols such as icmp, multicast DNS, and it makes many, many custom chains that confuse things even further. You can disable it and use iptables only. If you use apt and get netfilter-persistent and iptables-persistent packages, your settings will be saved and applied on each boot.<br>
Here is a simple policy using only iptables that would accomplish everything ufw does, but without the clutter. You would type these commands in your terminal, individually. If you do that, and then download the 2 packages, an option will be presented on install to make your rules permanent. Say yes to the query. Then, your rules are set and applied on each boot. Ubuntu will store them at: /etc/iptables/rules.v4 and /etc/iptables/rules.v6<br>
All commands preceded by sudo.<br>
Start by disabling ufw:<br>
sudo ufw reset (this flushes the chains so your iptables rules are the only rules parsed)<br>
sudo ufw disable<br>
Now start with your chain defaults:<br>
iptables -P INPUT DROP<br>
iptables -P FORWARD DROP<br>
iptables -P OUTPUT ACCEPT (or DROP, but you will need to configure a rule for every outgoing connection)<br>
These commands clear any residual rules left over  for the various tables. Think of it as a failsafe:<br>
iptables -F<br>
iptables -X<br>
iptables -t nat -F<br>
iptables -t nat -X<br>
iptables -t mangle -F<br>
iptables -t mangle -X<br>
iptables -t raw -F<br>
iptables -t raw -X<br>
The default ‚Äútable‚Äù where the majority of the rules are set is the ‚Äúfilter‚Äù table. The first two commands from the 8 above deal with that table. It is the default and that‚Äôs why you do not need to type: ‚Äúiptables -t filter -F‚Äù although you could and it would work. The mangle, nat and raw tables manipulate packets at different points as they make their way in or out of the system. They are specialized and can be left alone in most cases. The filter table and nat table, to a lesser extent are where most rules are. When operating a vpn server, for example, you need the ‚Äúnat‚Äù table. For your purposes, you don‚Äôt.<br>
These start the rules for incoming:<br>
iptables -A INPUT -p icmp --j DROP (optional. Sometimes useful for ping etc.)<br>
iptables -A INPUT -m state --state ESTABLISHED --j ACCEPT<br>
iptables -A INPUT -i lo --j ACCEPT (this is localhost)<br>
Usually on ‚Äúinput‚Äù chains, when you have specific ‚Äúdrop‚Äù rules, you put them first, then put your ‚Äúestablished‚Äù rule, then the rest.<br>
If you do not use forwarding, disable it:<br>
iptables -A FORWARD --j DROP<br>
Now for outgoing; if you have a default ACCEPT for outgoing, these rules are not necessary. If you set a default DROP then you need them. They are only examples; your rules will be different, but take note of the syntax.<br>
iptables -A OUTPUT -o lo --j ACCEPT (localhost)<br>
iptables -A OUTPUT -o tun0 -s 10.x.x.x --j ACCEPT (optional for vpn)<br>
iptables -A OUTPUT -p tcp -s [ip address] --sport 22 --j ACCEPT (This makes so your ssh can communicate out, but only from the ip you specify. Since we have an ESTABLISHED on incoming, this is the only rule you need. Port can be whatever, but 22 is common for ssh. By specifying port, other apps that share the ip address cannot misbehave because only the ssh port is allowed. ‚Äú‚Äìsport‚Äù means ‚Äúsource port‚Äù which is the port that the outgoing packet for this rule originates from)<br>
iptables -A OUTPUT --j DROP (Put this rule last just as a guarantee that anything not specified is dropped. You really only need this if you have a default ‚Äúaccept‚Äù policy for outgoing. If you have a default deny, then every packet that does not have a rule allowing it will automatically, and silently be dropped.)<br>
IPV6. This is important. Not many people use IPV6 yet, so make sure to have rules to block it. The command changes from iptables to ip6tables to denote Ipv6. Here is a set to block everything:<br>
Just like Ipv4, start by flushing any derelict packets:<br>
ip6tables -F<br>
ip6tables -X<br>
ip6tables -t nat -F<br>
ip6tables -t nat -X<br>
ip6tables -t mangle -F<br>
ip6tables -t mangle -X<br>
ip6tables -t raw -F<br>
ip6tables -t raw -X<br>
Now for the actual blocking rules:<br>
ip6tables -A INPUT --j DROP<br>
ip6tables -A FORWARD --j DROP<br>
ip6tables -A OUTPUT --j DROP<br>
That‚Äôs it! Enter these rules at the end of your previous rules.</p>
<p>Some stuff to remember:<br>
Iptables parses in order. If you have an ‚Äúaccept‚Äù and then a ‚Äúdeny‚Äù below it for the same address or port or whatever, only the first matching rule is used.<br>
There is a conntrack module that counts and tracks connections where it is specified in order to parse rules more quickly, not have as big a memory footprint, etc. I do not use conntrack personally. You do not really need it.<br>
Sometimes people like to use ‚Äúestablished‚Äù along with ‚Äúrelated‚Äù which will assume that certain packets are part of the communication and allow them to pass. ‚ÄúRelated‚Äù is not specifically necessary, and while it may not be harmful, for the maximum security, use the ‚Äúestablished‚Äù on its own like we did in this example.<br>
Make your rules as precise as possible, especially on default deny chains. As an example, iptables -A OUTPUT -o enp3s0 --j ACCEPT lets everything out on that interface whereas something like: iptables -A OUTPUT -o enp3s0 -p tcp -s [ip address] --sport 3572 --j ACCEPT means that only packets that are tcp, coming from the specified address, and specified port are allowed out on the interface enp3s0. All conditions must be met or the packet is dropped.<br>
There are several other rules that can be used for both incoming and outgoing. They do things like block fragments, and certain types of attacks. You can add them if you like. Put them first in your chains, then put your rules underneath them. Also, when using ‚Äúestablished,‚Äù it‚Äôs good practice to put it first, and then put your specific rules under it. If you have any ‚Äúdrop‚Äù rules, put them first, then ‚Äúestablished‚Äù below them. Not a big deal, but it looks nice. Also, using ‚Äúestablished‚Äù on a default-accept outgoing policy makes no sense. On a default-deny outgoing policy, each instance has to be specified anyway, so ‚Äúestablished‚Äù would not apply there either. I only use ‚Äúestablished‚Äù on the INPUT chain just like the example shows.<br>
You can take the skeleton ruleset above and adapt it to your Ubuntu system. If you want it permanent, install the 2 packages (netfilter-persistent and iptables-persistent). Iptables can do much more than this and is very easy once you understand the syntax.</p>
        </div>

        <meta itemprop='headline' content='Firewall configuration host'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/rk1'><span itemprop='name'>rk1</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8862.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-29T19:37:18Z' class='post-time'>
                January 29, 2020,  7:37pm
              </time>
              <meta itemprop='dateModified' content='2020-01-29T19:37:18Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Well, I was just about to redo my iptables, so your answer comes right in time‚Ä¶ You gave what looks like a pretty understandable and comprehensive answer, thanks for that.</p>
        </div>

        <meta itemprop='headline' content='Firewall configuration host'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/anontor'><span itemprop='name'>anontor</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="8862.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-01-30T00:00:09Z' class='post-time'>
                January 30, 2020, 12:00am
              </time>
              <meta itemprop='dateModified' content='2020-01-30T00:00:09Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>No problem, hope it helps; iptables is probably the best firewall solution as far as adaptability and simplicity as far as no unneeded baggage. You can be as broad or fine-grained as you want with the rules.<br>
Let me know if you have any more questions</p>
        </div>

        <meta itemprop='headline' content='Firewall configuration host'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

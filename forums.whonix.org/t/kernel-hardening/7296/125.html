<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Kernel Hardening - #125 by Patrick - Development - Whonix Forum</title>
    <meta name="description" content="Whonix should implement more kernel hardening. All of these settings add no or a very minimal performance decrease. 
Setting “kernel.kptr_restrict=1” makes kernel symbols in /proc/kallsyms only accessible to root which c&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../7296c575.html?page=6" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Kernel Hardening&#39;" href="../7296.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/kernel-hardening/7296/125" />
<meta name="twitter:url" content="https://forums.whonix.org/t/kernel-hardening/7296/125" />
<meta property="og:title" content="Kernel Hardening" />
<meta name="twitter:title" content="Kernel Hardening" />
<meta property="og:description" content="3 posts were split to a new topic: allow loading signed kernel modules by default / disallow kernel module loading by default" />
<meta name="twitter:description" content="3 posts were split to a new topic: allow loading signed kernel modules by default / disallow kernel module loading by default" />
<meta property="article:published_time" content="2019-08-05T09:08:57+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="../7296af4d.html?page=5">
        <link rel="next" href="../7296235c.html?page=7">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../7296.html">Kernel Hardening</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
              split this topic 
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-08T20:53:09Z' class='post-time'>
                July 8, 2019,  8:53pm
              </time>
              <meta itemprop='dateModified' content='2019-07-08T20:53:09Z'>
          <span itemprop='position'>#120</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>2 posts were merged into an existing topic: <a href="../../redirect-host-traffic-to-whonix-gateway-allow-multiple-incoming-flashproxy-ports/7448/14.html">Allow multiple flashproxy ports</a></p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-31T19:38:10Z' class='post-time'>
                July 31, 2019,  7:38pm
              </time>
              <meta itemprop='dateModified' content='2019-07-31T19:38:10Z'>
          <span itemprop='position'>#121</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="84" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>The System.map files should be removed. By default, /boot/System.map-* contains kernel symbols which could be useful to an attacker.</p>
</blockquote>
</aside>
<p>What creates system-map files and can we suppress creation rather than deleting those?</p>
<p>We delete those but that doesn’t help much if these get created later on. Better prevent creation than “only” deleting.</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-07-31T22:06:52Z' class='post-time'>
                July 31, 2019, 10:06pm
              </time>
              <meta itemprop='dateModified' content='2019-07-31T22:06:52Z'>
          <span itemprop='position'>#122</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="121" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>What creates system-map files and can we suppress creation rather than deleting those?</p>
</blockquote>
</aside>
<p>When compiling the kernel, it generates system.map files. The kernel package likely puts them into /boot so we’d have to modify the package if we want to suppress the creation of them.</p>
<aside class="quote no-group" data-post="121" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>We delete those but that doesn’t help much if these get created later on.</p>
</blockquote>
</aside>
<p>They get deleted at boot by a systemd service. If they get created later on, they’d get deleted next boot.</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-01T06:19:00Z' class='post-time'>
                August 1, 2019,  6:19am
              </time>
              <meta itemprop='dateModified' content='2019-08-01T06:19:00Z'>
          <span itemprop='position'>#123</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Which means there’s a time gap between re-creation and re-deletion which<br>
could be abused even by chance by malware.</p>
<p>Could you look please if you can find the code which generates these<br>
files? Maybe there is a config option already to disable it. And if not,<br>
we could request it from upstream.</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-01T13:09:20Z' class='post-time'>
                August 1, 2019,  1:09pm
              </time>
              <meta itemprop='dateModified' content='2019-08-01T13:09:20Z'>
          <span itemprop='position'>#124</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="123" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Could you look please if you can find the code which generates these<br>
files?</p>
</blockquote>
</aside>
<p>The actual compilation generates them. I can’t find what places them in /boot though.</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
              split this topic 
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-05T09:08:57Z' class='post-time'>
                August 5, 2019,  9:08am
              </time>
              <meta itemprop='dateModified' content='2019-08-05T09:08:57Z'>
          <span itemprop='position'>#125</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>3 posts were split to a new topic: <a href="../../enforce-kernel-module-software-signature-verification-module-signing-disallow-kernel-module-loading-by-default/7880.html">allow loading signed kernel modules by default / disallow kernel module loading by default</a></p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-05T14:11:39Z' class='post-time'>
                August 5, 2019,  2:11pm
              </time>
              <meta itemprop='dateModified' content='2019-08-05T14:11:39Z'>
          <span itemprop='position'>#126</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="123" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Which means there’s a time gap between re-creation and re-deletion which could be abused even by chance by malware.</p>
</blockquote>
</aside>
<p>Instead of trying to get rid of this time gap altogether which as far as I know, isn’t doable, we could attempt to reduce it as much as possible.</p>
<p>We could configure remove-system-map.service to execute our script every few minutes. This can be done by adding</p>
<pre><code> Restart=always
 RestartSec=5m
</code></pre>
<p>which would make it run every 5 minutes.</p>
<p>This would flood the systemd logs with “Starting remove-system-map.service” type messages though.</p>
<p>Alternatively, we could configure a cron job to execute our script every few minutes.</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-06T06:27:00Z' class='post-time'>
                August 6, 2019,  6:27am
              </time>
              <meta itemprop='dateModified' content='2019-08-06T06:27:00Z'>
          <span itemprop='position'>#127</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Prerequisite: ask upstream how this file is created.</p>
<p>Next step, if above step doesn’t find a solution: an inotify based<br>
rather than time based implementation.</p>
<p>whonix-firewall /usr/lib/whonix-firewall/firewall-restarter uses<br>
inotify. (So does msgcollector.)</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-07T16:02:05Z' class='post-time'>
                August 7, 2019,  4:02pm
              </time>
              <meta itemprop='dateModified' content='2019-08-07T16:02:05Z'>
          <span itemprop='position'>#128</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubissue">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2045" target="_blank" rel="nofollow noopener">github.com/QubesOS/qubes-issues</a>
  </header>
  <article class="onebox-body">
    <a href="../../../../external.html?link=https://github.com/marmarek" rel="nofollow noopener">
<img src="../../../../external.html?link=https://avatars1.githubusercontent.com/u/726704?v=2&amp;s=96" class="thumbnail onebox-avatar" width="60" height="60">
</a>

<h4><a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2045" target="_blank" rel="nofollow noopener">Issue: Kernel hardening - change default options</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="../../../../external.html?link=https://github.com/marmarek" target="_blank" rel="nofollow noopener">marmarek</a>
	on <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2045" target="_blank" rel="nofollow noopener">2016-06-04</a>
	</div>
	<div class="user">
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">https://groups.google.com/d/msgid/qubes-devel/5751F9E4.2070300%40riseup.net
vsyscall=none
mce=0
Maybe also others from that discussion - will update above list then.</pre>

<div class="labels">
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">C: kernel</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">P: minor</span>
 	<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">T: enhancement</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-07T16:02:16Z' class='post-time'>
                August 7, 2019,  4:02pm
              </time>
              <meta itemprop='dateModified' content='2019-08-07T16:02:16Z'>
          <span itemprop='position'>#129</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><a href="../../../../external.html?link=https://groups.google.com/forum/#!msg/qubes-devel/LK2EPYOlczo/iA9i6-fNAgAJ" class="onebox" target="_blank" rel="nofollow noopener">https://groups.google.com/forum/#!msg/qubes-devel/LK2EPYOlczo/iA9i6-fNAgAJ</a></p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-07T16:05:56Z' class='post-time'>
                August 7, 2019,  4:05pm
              </time>
              <meta itemprop='dateModified' content='2019-08-07T16:05:56Z'>
          <span itemprop='position'>#130</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <pre><code>apt-file list linux-image-4.19.0-5-amd64 | grep System
linux-image-4.19.0-5-amd64: /boot/System.map-4.19.0-5-amd64

dpkg -S /boot/System.map-4.19.0-5-amd64
linux-image-4.19.0-5-amd64: /boot/System.map-4.19.0-5-amd64</code></pre>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='../../../../external.html?link=http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='../../../../external.html?link=http://schema.org/ListItem'>
                    <a href="../../whonix-virtualbox-15-0-0-3-6-testers-wanted-stronger-linux-user-account-isolation-and-more-hardening/7891.html" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='../../whonix-virtualbox-15-0-0-3-6-testers-wanted-stronger-linux-user-account-isolation-and-more-hardening/7891.html'>
                      <span itemprop='name'>Whonix VirtualBox 15.0.0.3.6 - Testers Wanted! - Stronger Linux User Account Isolation and more Hardening</span>
                    </a>
                    <meta itemprop='position' content='1'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-07T16:20:56Z' class='post-time'>
                August 7, 2019,  4:20pm
              </time>
              <meta itemprop='dateModified' content='2019-08-07T16:20:56Z'>
          <span itemprop='position'>#131</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>In other words, system map file is shipped as a usual file by the Debian kernel package.</p>
<p>To remove it more effectly we could have a hook in <code>/etc/kernel/postinst.d</code> folder which calls <code>/usr/lib/security-misc/remove-system.map</code> (failing open).</p>
<p>A duplicate of system map file could still be on the disk in <code>/var/cache/apt/archives/</code> folder. (apt cached package) Other duplicates could be there when using an apt-cache. It could be recoverable unless we use <code>shred</code>. And even then it could be recoverable from swap or so?</p>
<p>Also, contents of this system map are public knowledge - since easily re-downloadable from <a href="../../../../external.html?link=http://packages.debian.org/" rel="nofollow noopener">packages.debian.org</a>.</p>
<p>What kernel version we are using is easily knowable anyway with <code>uname -a</code> (and likely also through standard API and other ways?).</p>
<p>So I am wondering if any efforts to delete system map are worth anyhow? Maybe that is more useful for people who compile their own kernels (therefore using own randomization)? If I remember right, grsecurity back then said that self-compiled kernels will always be more secure than downloaded kernels due to randomizations, therefore encouraged self-compiled kernels.</p>
<p>Other crazy ideas: mount system map to /dev/null or other trickery (this idea is ignoring what I said above).</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="3" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-07T18:31:30Z' class='post-time'>
                August 7, 2019,  6:31pm
              </time>
              <meta itemprop='dateModified' content='2019-08-07T18:31:30Z'>
          <span itemprop='position'>#132</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group quote-modified" data-post="128" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p><a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/2045" rel="nofollow noopener">https://github.com/QubesOS/qubes-issues/issues/2045</a></p>
</blockquote>
</aside>
<p><code>vsyscall=none</code> isn’t useful as vsyscalls were removed from the kernel. <code>kaslr</code> isn’t useful either as Debian and most other kernels enable kaslr by default.</p>
<aside class="quote no-group" data-post="131" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>A duplicate of system map file could still be on the disk in <code>/var/cache/apt/archives/</code> folder.</p>
</blockquote>
</aside>
<p>We can remove those too.</p>
<aside class="quote no-group" data-post="131" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>It could be recoverable unless we use <code>shred</code> .</p>
</blockquote>
</aside>
<p>Shred would only help if the attacker has local access and at that point, them seeing the system map is the least of your worries.</p>
<aside class="quote no-group" data-post="131" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>And even then it could be recoverable from swap or so?</p>
</blockquote>
</aside>
<p>Wouldn’t that require local access also?</p>
<aside class="quote no-group" data-post="131" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Also, contents of this system map are public knowledge - since easily re-downloadable from <a href="../../../../external.html?link=http://packages.debian.org/" rel="nofollow noopener">packages.debian.org</a>.</p>
</blockquote>
</aside>
<p>It’s harder for an attacker to download the system map files from another source than to just look in /boot.</p>
<aside class="quote no-group" data-post="131" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>So I am wondering if any efforts to delete system map are worth anyhow? Maybe that is more useful for people who compile their own kernels (therefore using own randomization)?</p>
</blockquote>
</aside>
<p>It’s much more useful for custom kernels. Even when using standard kernels, it raises the bar for more common malware. If Whonix starts using it’s own kernel, then this will become much more useful.</p>
<aside class="quote no-group" data-post="131" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Other crazy ideas: mount system map to /dev/null or other trickery</p>
</blockquote>
</aside>
<p>I don’t see any advantage to this over just deleting them. It might just cause confusion to some people as the files are there but don’t open properly.</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-07T19:06:00Z' class='post-time'>
                August 7, 2019,  7:06pm
              </time>
              <meta itemprop='dateModified' content='2019-08-07T19:06:00Z'>
          <span itemprop='position'>#133</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>madaidan via Whonix Forum:</p>
<blockquote>
<aside class="quote no-group" data-post="131" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>A duplicate of system map file could still be on the disk in <code>/var/cache/apt/archives/</code> folder.</p>
</blockquote>
</aside>
<p>We can remove those too.</p>
</blockquote>
<p>We’d have to delete the kernel package from that folder which is kinda<br>
strange?</p>
<blockquote>
<aside class="quote no-group" data-post="131" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>It could be recoverable unless we use <code>shred</code> .</p>
</blockquote>
</aside>
<p>Shred would only help if the attacker has local access and at that point, them seeing the system map is the least of your worries.</p>
</blockquote>
<p>I see. The threat model for system map files wasn’t clear to me whether<br>
to presuppose root access or not.</p>
<blockquote>
<aside class="quote no-group" data-post="131" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>So I am wondering if any efforts to delete system map are worth anyhow? Maybe that is more useful for people who compile their own kernels (therefore using own randomization)?</p>
</blockquote>
</aside>
<p>It’s much more useful for custom kernels. Even when using standard kernels, it raises the bar for more common malware. If Whonix starts using it’s own kernel, then this will become much more useful.</p>
</blockquote>
<p>If it’s about raising the bar for common malware (off-the-shelf<br>
malware), then kernel package deletion from <code>/var/cache/apt/archives/</code><br>
is avoidable?</p>
<blockquote>
<aside class="quote no-group" data-post="131" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Other crazy ideas: mount system map to /dev/null or other trickery</p>
</blockquote>
</aside>
<p>I don’t see any advantage to this over just deleting them. It might just cause confusion to some people as the files are there but don’t open properly.</p>
</blockquote>
<p>Advantage would be that never something readable would be written there.<br>
Never written, never recoverable, never readable.</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-07T19:14:36Z' class='post-time'>
                August 7, 2019,  7:14pm
              </time>
              <meta itemprop='dateModified' content='2019-08-07T19:14:36Z'>
          <span itemprop='position'>#134</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="133" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>We’d have to delete the kernel package from that folder which is kinda strange?</p>
</blockquote>
</aside>
<p>Ah. I didn’t realise it was the package itself.</p>
<aside class="quote no-group" data-post="133" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>If it’s about raising the bar for common malware (off-the-shelf<br>
malware), then kernel package deletion from <code>/var/cache/apt/archives/</code> is avoidable?</p>
</blockquote>
</aside>
<p>Possibly. It may be unlikely for an attacker to look inside the package but still not that hard to do.</p>
<aside class="quote no-group" data-post="133" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Advantage would be that never something readable would be written there. Never written, never recoverable, never readable.</p>
</blockquote>
</aside>
<p>That would make sense. Sounds like a much better option. Another way would be to replace the file with our own null device instead of linking it to /dev/null.</p>
<p>It can be done with</p>
<pre><code>mknod /boot/System.map c 1 3</code></pre>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-07T23:08:58Z' class='post-time'>
                August 7, 2019, 11:08pm
              </time>
              <meta itemprop='dateModified' content='2019-08-07T23:08:58Z'>
          <span itemprop='position'>#135</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Not so easy. Will result in an error when reinstalling the package.</p>
<pre><code>sudo rm /boot/System.map-4.19.0-5-amd64
sudo touch /boot/System.map-4.19.0-5-amd64
sudo chattr +i /boot/System.map-4.19.0-5-amd64
sudo apt install --reinstall linux-image-4.19.0-5-amd64
</code></pre>
<aside class="quote no-group" data-post="134" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>mknod /boot/System.map c 1 3</p>
</blockquote>
</aside>
<p>Will just be overwritten on upgrade.</p>
<blockquote>
<p>dpkg: error processing archive /var/cache/apt/archives/linux-image-4.19.0-5-amd64_4.19.37-5+deb10u1_amd64.deb (–unpack):<br>
unable to make backup link of ‘./boot/System.map-4.19.0-5-amd64’ before installing new version: Operation not permitted<br>
dpkg-deb: error: paste subprocess was killed by signal (Broken pipe)<br>
I: /vmlinuz is now a symlink to boot/vmlinuz-4.19.0-4-amd64<br>
I: /initrd.img is now a symlink to boot/initrd.img-4.19.0-4-amd64<br>
Errors were encountered while processing:<br>
/var/cache/apt/archives/linux-image-4.19.0-5-amd64_4.19.37-5+deb10u1_amd64.deb<br>
E: Sub-process /usr/bin/dpkg returned an error code (1)</p>
</blockquote>
<aside class="quote no-group" data-post="134" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Possibly. It may be unlikely for an attacker to look inside the package but still not that hard to do.</p>
</blockquote>
</aside>
<p>Then it’s also not that hard to hardcode whatever information required from system map into the malware itself (for a few common kernel versions). Looking up required information by parsing system map sounds like a rather advanced attack?</p>
<p>Also path to <code>/boot/System.map-4.19.0-5-amd64</code> cannot be easily determined. Perhaps by looking parsing apt-file list kernel-package or by using information from uname and dynamically creating the name of the file.</p>
<p>If we create our own kernel package we can wipe that file before creating the package or when users compile their own kernel they can wipe it.</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-07T23:45:31Z' class='post-time'>
                August 7, 2019, 11:45pm
              </time>
              <meta itemprop='dateModified' content='2019-08-07T23:45:31Z'>
          <span itemprop='position'>#136</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="135" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Then it’s also not that hard to hardcode whatever information required from system map into the malware itself (for a few common kernel versions).</p>
</blockquote>
</aside>
<p>I think most malware would attempt to look around certain files on the system instead of hardcoding information or getting them from another source.</p>
<p>An attacker could just run</p>
<pre><code>cd /var/cache/apt/archive; ar x linux-image-$(uname -r).deb; tar -xf data.tar.xz; cat boot/System.map-$(uname-r)
</code></pre>
<p>Instead of spending time on manually getting the information for multiple different kernels.</p>
<aside class="quote no-group" data-post="135" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Also path to <code>/boot/System.map-4.19.0-5-amd64</code> cannot be easily determined. Perhaps by looking parsing apt-file list kernel-package or by using information from uname and dynamically creating the name of the file.</p>
</blockquote>
</aside>
<p>It always ends in the kernel version so you can just use <code>/boot/System.map-$(uname -r)</code>.</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-08T01:00:59Z' class='post-time'>
                August 8, 2019,  1:00am
              </time>
              <meta itemprop='dateModified' content='2019-08-08T01:00:59Z'>
          <span itemprop='position'>#137</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group">
<blockquote>
<blockquote>
<p>Shred would only help if the attacker has local access and at that point, them seeing the system map is the least of your worries.</p>
</blockquote>
<p>I see. The threat model for system map files wasn’t clear to me whether<br>
to presuppose root access or not.</p>
</blockquote>
</aside>
<p>If this threat model presupposes non-root access, wouldn’t it be enough to just harden linux file access rights? Making system map no longer readable by non-root users? That may even be something upstream might be more easily convinced of doing by default since it would be a great balance between security and debugging?</p>
<p>On topic:<br>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://lwn.net/images/favicon.png" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://lwn.net/Articles/415603/" target="_blank" rel="nofollow noopener">lwn.net</a>
  </header>
  <article class="onebox-body">
    

<h3><a href="../../../../external.html?link=https://lwn.net/Articles/415603/" target="_blank" rel="nofollow noopener">Making attacks a little harder [LWN.net]</a></h3>

<p>Regardless of whether one believes that the security of the Linux kernel is
as good as it should be, it is hard to disagree with the idea that it could
be made more secure.  For some years, it has seemed like much of the
security-related work on the...</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>madaidan via Whonix Forum:&gt;</p>
<blockquote>
<aside class="quote no-group" data-post="135" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Then it’s also not that hard to hardcode whatever information required from system map into the malware itself (for a few common kernel versions).</p>
</blockquote>
</aside>
<p>I think most malware would attempt to look around certain files on the system instead of hardcoding information or getting them from another source.</p>
<p>An attacker could just run</p>
<pre><code>cd /var/cache/apt/archive; ar x linux-image-$(uname -r).deb; tar -xf data.tar.xz; cat boot/System.map-$(uname-r)
</code></pre>
</blockquote>
<p>That’s not a great since the kernel package may or may note be still inside folder /var/cache/apt/archive.</p>
<p>There’s not that many kernel versions. Collecting various boot/System.map-$(uname-r) files (probably just need a few lines of these) and hardcoding into malware does not seem hard to me.</p>
<blockquote>
<p>Instead of spending time on manually getting the information for multiple different kernels.</p>
<aside class="quote no-group" data-post="135" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Also path to <code>/boot/System.map-4.19.0-5-amd64</code> cannot be easily determined. Perhaps by looking parsing apt-file list kernel-package or by using information from uname and dynamically creating the name of the file.</p>
</blockquote>
</aside>
<p>It always ends in the kernel version so you can just use <code>/boot/System.map-$(uname -r)</code>.</p>
</blockquote>
<p>But that is only known after the kernel was installed and booted. So mount to /dev/null and similar tricks cannot be applied beforehand so it gets never really written.</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-08T09:31:16Z' class='post-time'>
                August 8, 2019,  9:31am
              </time>
              <meta itemprop='dateModified' content='2019-08-08T09:31:16Z'>
          <span itemprop='position'>#138</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-post="137" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>If this threat model presupposes non-root access, wouldn’t it be enough to just harden linux file access rights? Making system map no longer readable by non-root users?</p>
</blockquote>
</aside>
<p>I don’t see why it should presuppose non-root access. What I meant above about shred was local access, not root. Shred would only really help if someone is doing forensics analysis on your hard drive.</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7296.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-08-08T12:44:00Z' class='post-time'>
                August 8, 2019, 12:44pm
              </time>
              <meta itemprop='dateModified' content='2019-08-08T12:44:00Z'>
          <span itemprop='position'>#139</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>madaidan via Whonix Forum:</p>
<blockquote>
<aside class="quote no-group" data-post="137" data-topic="7296">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>If this threat model presupposes non-root access, wouldn’t it be enough to just harden linux file access rights? Making system map no longer readable by non-root users?</p>
</blockquote>
</aside>
<p>I don’t see why it should presuppose non-root access. What I meant above about shred was local access, not root. Shred would only really help if someone is doing forensics analysis on your hard drive.</p>
</blockquote>
<p>A lot mixed in here to easily talk past each other.</p>
<p>system map access generally:</p>
<p>root compromise: If there is root access (root user compromise from<br>
remote), why would anyone still care about system map?</p>
<p>non-root user compromise: I.e. a malware process is running under a<br>
linux user account such as user apache2 or so. In that case, the malware<br>
being unable to read system map, might help to prevent the attacker from<br>
escalating to compromise.</p>
<p>If these assumptions are right, then setting access rights to system map<br>
to root only would complicate non-root to root escalation for malware.</p>
<p>system map file recovery by malware:</p>
<p>File recovery tools can be run root or non-root users?</p>
<p>If only by root users: great.</p>
<p>If also by non-root users: bad, because then malware could use undelete<br>
tools to re-creating system map file.</p>
<p>File recovery tools don’t necessarily require local (as in hands on) access.</p>
        </div>

        <meta itemprop='headline' content='Kernel Hardening'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="../7296af4d.html?page=5">← previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="../7296235c.html?page=7">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
    <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715</link>
    <description>https://lists.debian.org/debian-security-announce/2019/msg00010.html

@Patrick can you please tell me how to force builds to use onion only?</description>
    <language>en</language>
    <lastBuildDate>Mon, 04 Feb 2019 09:10:40 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p><a href="https://github.com/Whonix/Whonix/compare/14.0.1.3.5-developers-only...14.0.1.3.8-developers-only" rel="nofollow noopener">https://github.com/Whonix/Whonix/compare/14.0.1.3.5-developers-only...14.0.1.3.8-developers-only</a></p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/19">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/19</link>
        <pubDate>Mon, 04 Feb 2019 09:10:40 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-19</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>git tag:</p>
<pre><code>14.0.1.3.8-testers-only
</code></pre>
<aside class="quote" data-post="1" data-topic="6780">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="https://forums.whonix.org/t/whonix-virtualbox-14-0-1-3-8-point-release-testers-wanted/6780">Whonix VirtualBox 14.0.1.3.8 - Point Release - Testers Wanted!</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/news"><span class="badge-category-bg" style="background-color: #AB9364;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="News posted by Whonix staff. The Whonix Blog.">News</span></a>
  </div>
  <blockquote>
    Testers Wanted! 
This is a release candidate for a <a href="https://www.whonix.org/wiki/Point_Release" rel="nofollow noopener">point release</a>. 
Debian APT remote code execution vulnerability <a href="https://lists.debian.org/debian-security-announce/2019/msg00010.html" rel="nofollow noopener">DSA 4371-1</a> is fixed in this version. Therefore, <a href="https://forums.whonix.org/t/special-instructions-required-to-securely-update-because-of-apt-security-update-dsa-4371-1/6721">special instructions for upgrading</a> are not required. The usual <a href="https://www.whonix.org/wiki/Operating_System_Software_and_Updates" rel="nofollow noopener">standard (“everyday”) upgrading instructions</a> should be applied. 

Download the Testers-Only version of Whonix for VirtualBox:
  </blockquote>
</aside>

          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/18">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/18</link>
        <pubDate>Mon, 04 Feb 2019 09:08:41 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-18</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="16" data-topic="6715">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>That should be partially fixed. Was an apparmor issue.</p>
</blockquote>
</aside>
<p>Yay! you found it.</p>
<hr>
<aside class="quote no-group" data-post="16" data-topic="6715">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Can anyone make head or tail from the mmdebstrap source code why this is happening?</p>
</blockquote>
</aside>
<p>Maybe:</p>
<pre><code class="lang-auto"> ## setup merged usr
    #my @amd64_dirs = ('lib32', 'lib64', 'libx32'); # only amd64 for now
    #foreach my $dir ("bin", "sbin", "lib", @amd64_dirs) {
    #    symlink "usr/$dir", "$options-&gt;{root}/$dir" or die "cannot create symlink: $!";
    #    make_path("$options-&gt;{root}/usr/$dir") or die "cannot create /usr/$dir: $!";
    #}
</code></pre>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/17">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/17</link>
        <pubDate>Sat, 02 Feb 2019 16:22:35 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-17</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Certainly still unfit for release.</p>
<hr>
<p>Build config <code>/etc/apt/apt.conf.d/99mmdebstrap</code> breaks apt-get connectivity. Need to be deleted in final build. Easy to fix, will fix soon.</p>
<p><code>/etc/network/interfaces</code> is empty. Therefore no network interfaces configured. Will fix soon.</p>
<p>Made a minor whonixcheck bug apparent, and fixed:</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/whonixcheck/commit/5edd48edc4ba6df4f24d527fd51acde8f4b622d8" target="_blank" rel="nofollow noopener">github.com/Whonix/whonixcheck</a>
  </header>
  <article class="onebox-body">
      <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="https://github.com/Whonix/whonixcheck/commit/5edd48edc4ba6df4f24d527fd51acde8f4b622d8" target="_blank" rel="nofollow noopener">fix, run check_network_interfaces before check_whonixsetup_done</a>
</h4>


<div class="date">
  by <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="https://github.com/Whonix/whonixcheck/commit/5edd48edc4ba6df4f24d527fd51acde8f4b622d8" target="_blank" rel="nofollow noopener">01:25PM - 02 Feb 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>1 files</strong>
  with <strong>3 additions</strong>
  and <strong>3 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<blockquote>
<p>sudo: pam_open_session: Module is unknown<br>
sudo: policy plugin failed session initialization</p>
</blockquote>
<p>That should be partially fixed. Was an apparmor issue.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/whonixcheck/commit/add429962dac37d2e776ab26adb8349c170655f1" target="_blank" rel="nofollow noopener">github.com/Whonix/whonixcheck</a>
  </header>
  <article class="onebox-body">
      <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="https://github.com/Whonix/whonixcheck/commit/add429962dac37d2e776ab26adb8349c170655f1" target="_blank" rel="nofollow noopener">/usr/lib/*-linux-gnu/security/** mr,</a>
</h4>


<div class="date">
  by <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="https://github.com/Whonix/whonixcheck/commit/add429962dac37d2e776ab26adb8349c170655f1" target="_blank" rel="nofollow noopener">01:29PM - 02 Feb 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>1 files</strong>
  with <strong>1 additions</strong>
  and <strong>0 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>The full fix may depend on below.</p>
<hr>
<p>Most critical bug that I hope upstream will react to soon.</p>
<p><code>coreutils such as /bin/mkdir are duplicated in /usr/bin/mkdir</code><br>
<a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=921163" class="onebox" target="_blank" rel="nofollow noopener">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=921163</a></p>
<p>Can anyone make head or tail from the mmdebstrap source code why this is happening?</p>
<p><a href="https://gitlab.mister-muffin.de/josch/mmdebstrap/blob/master/mmdebstrap" rel="nofollow noopener">https://gitlab.mister-muffin.de/josch/mmdebstrap/blob/master/mmdebstrap</a></p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/16">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/16</link>
        <pubDate>Sat, 02 Feb 2019 14:21:44 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-16</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p><a href="https://github.com/Whonix/Whonix/compare/14.0.1.0.9-developers-only...14.0.1.3.5-developers-only" rel="nofollow noopener">https://github.com/Whonix/Whonix/compare/14.0.1.0.9-developers-only...14.0.1.3.5-developers-only</a></p>
<aside class="quote quote-modified" data-post="1" data-topic="6763">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="https://forums.whonix.org/t/building-whonix-from-source-code-is-safe-again-apt-vulnerability-dsa-4371-1/6763">Building Whonix from source code is safe again (APT vulnerability DSA 4371-1)</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/news"><span class="badge-category-bg" style="background-color: #AB9364;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="News posted by Whonix staff. The Whonix Blog.">News</span></a>
  </div>
  <blockquote>
    This news is primarily to inform developers and everyone who builds Whonix from source code. If that doesn’t mean anything to you, this news can be safely ignored. 


Building Non-Qubes-Whonix from source code is safe again as per git tag 14.0.1.3.2-developers-only.
Qubes-Whonix fixed this independently.

This is only about builds of Whonix. Resulting images are untested at the time of writing. Users should wait for testers-only or  stable release. 
Context: 
<a href="https://forums.whonix.org/t/fixed-building-whonix-from-source-code-is-not-safe-at-the-moment-due-to-apt-vulnerability-dsa-4371-1/6723" class="inline-onebox">[FIXED] Building Whonix from source …</a>
  </blockquote>
</aside>

          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/15">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/15</link>
        <pubDate>Thu, 31 Jan 2019 11:58:23 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-15</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Install <code>mmdebstrap</code> from Debian buster now required on build machine. <a href="https://www.whonix.org/wiki/Dev/Build_Documentation/14_full" rel="nofollow noopener">https://www.whonix.org/wiki/Dev/Build_Documentation/14_full</a> updated.</p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/14">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/14</link>
        <pubDate>Fri, 25 Jan 2019 13:12:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-14</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="12" data-topic="6715">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>But since security fixed apt is now also available in “<a href="http://packages.debian.org" rel="nofollow noopener">packages.debian.org</a>” (not just only Debian security repository), it’s hard to really test.</p>
</blockquote>
</aside>
<p>Try and mimic the situation using two versions of Whonix repos?</p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/13">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/13</link>
        <pubDate>Thu, 24 Jan 2019 17:45:55 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-13</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="11" data-topic="6715">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>mmdebstrap might be able to bootstrap from multiple repositories but may not figuring out using newer packages from <a href="http://security.debian.org" rel="nofollow noopener">security.debian.org</a>.</p>
</blockquote>
</aside>
<p>I might fortunately be wrong about this. The cowbuilder / pbuilder / mmdebstrap interaction is hard to grasp and enforce always using Debian security repository. Fixed.</p>
<aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/Whonix/commit/c1d4692d32bd09fc603efdecbc2bab16da4b593a" target="_blank" rel="nofollow noopener">github.com/Whonix/Whonix</a>
  </header>
  <article class="onebox-body">
      <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="https://github.com/Whonix/Whonix/commit/c1d4692d32bd09fc603efdecbc2bab16da4b593a" target="_blank" rel="nofollow noopener">prevent pbuilder from rewriting sources list in cowbuilder chroot</a>
</h4>

  <pre class="message" style="white-space: normal;">https://forums.whonix.org/t/apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715</pre>

<div class="date">
  by <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="https://github.com/Whonix/Whonix/commit/c1d4692d32bd09fc603efdecbc2bab16da4b593a" target="_blank" rel="nofollow noopener">05:37PM - 24 Jan 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>3 files</strong>
  with <strong>29 additions</strong>
  and <strong>1 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>But since security fixed apt is now also available in “<a href="http://packages.debian.org" rel="nofollow noopener">packages.debian.org</a>” (not just only Debian security repository), it’s hard to really test.</p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/12">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/12</link>
        <pubDate>Thu, 24 Jan 2019 17:44:27 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-12</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Might have been in vain. mmdebstrap might be able to bootstrap from multiple repositories but may not figuring out using newer packages from <a href="http://security.debian.org" rel="nofollow noopener">security.debian.org</a>. Still investigating.</p>
<p>Either way. mmdebstrap has some advantages.</p>
<ul>
<li>faster</li>
<li>Quote man page
<ul>
<li>
<blockquote>
<p>Reproducible output by default if $SOURCE_DATE_EPOCH is set</p>
</blockquote>
</li>
</ul>
</li>
<li>written in perl rather than bash (debootstrap)</li>
</ul>
<p><a href="https://manpages.debian.org/testing/mmdebstrap/mmdebstrap.1.en.html" class="onebox" target="_blank" rel="nofollow noopener">https://manpages.debian.org/testing/mmdebstrap/mmdebstrap.1.en.html</a><br>
<a href="https://bugs.debian.org/cgi-bin/pkgreport.cgi?pkg=multistrap;dist=unstable" class="onebox" target="_blank" rel="nofollow noopener">https://bugs.debian.org/cgi-bin/pkgreport.cgi?pkg=multistrap;dist=unstable</a></p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/11">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/11</link>
        <pubDate>Thu, 24 Jan 2019 14:21:58 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-11</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox githubcommit">
  <header class="source">
      <a href="https://github.com/Whonix/Whonix/commit/f0b826dec991256a108dcc5afb756b0d25330df1" target="_blank" rel="nofollow noopener">github.com/Whonix/Whonix</a>
  </header>
  <article class="onebox-body">
      <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">
    <img alt="adrelanos" src="https://avatars3.githubusercontent.com/u/1985040?v=4" class="thumbnail onebox-avatar" width="90" height="90">
  </a>

<h4>
  <a href="https://github.com/Whonix/Whonix/commit/f0b826dec991256a108dcc5afb756b0d25330df1" target="_blank" rel="nofollow noopener">port to mmdebstrap for better build security</a>
</h4>

  <pre class="message" style="white-space: normal;">https://forums.whonix.org/t/apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715</pre>

<div class="date">
  by <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
  on <a href="https://github.com/Whonix/Whonix/commit/f0b826dec991256a108dcc5afb756b0d25330df1" target="_blank" rel="nofollow noopener">02:09PM - 24 Jan 19 UTC</a>
</div>

<div class="github-commit-stats">
  changed <strong>5 files</strong>
  with <strong>69 additions</strong>
  and <strong>5 deletions</strong>.
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/10">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/10</link>
        <pubDate>Thu, 24 Jan 2019 14:11:07 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-10</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="onebox githubissue">
  <header class="source">
      <a href="https://github.com/QubesOS/qubes-issues/issues/4760" target="_blank" rel="nofollow noopener">github.com/QubesOS/qubes-issues</a>
  </header>
  <article class="onebox-body">
    <a href="https://github.com/adrelanos" rel="nofollow noopener">
<img src="https://avatars1.githubusercontent.com/u/1985040?v=2&amp;s=96" class="thumbnail onebox-avatar" width="60" height="60">
</a>

<h4><a href="https://github.com/QubesOS/qubes-issues/issues/4760" target="_blank" rel="nofollow noopener">Issue: port Qubes Debian Template Build Process to Multistrap or Similar for better Build Security</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
	on <a href="https://github.com/QubesOS/qubes-issues/issues/4760" target="_blank" rel="nofollow noopener">2019-01-24</a>
	</div>
	<div class="user">
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">Current situation and problem:
Qubes builder -&gt; build Debian base image using debootstrap with mirror "packages.debian.org" but not "security.debian.org" because debootstrap can...</pre>

<div class="labels">
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="onebox githubissue">
  <header class="source">
      <a href="https://github.com/grml/grml-debootstrap/issues/120" target="_blank" rel="nofollow noopener">github.com/grml/grml-debootstrap</a>
  </header>
  <article class="onebox-body">
    <a href="https://github.com/adrelanos" rel="nofollow noopener">
<img src="https://avatars1.githubusercontent.com/u/1985040?v=2&amp;s=96" class="thumbnail onebox-avatar" width="60" height="60">
</a>

<h4><a href="https://github.com/grml/grml-debootstrap/issues/120" target="_blank" rel="nofollow noopener">Issue: port to Multistrap or Similar for better Build Security</a></h4>

<div class="date" style="margin-top:10px;">
	<div class="user" style="margin-top:10px;">
	opened by <a href="https://github.com/adrelanos" target="_blank" rel="nofollow noopener">adrelanos</a>
	on <a href="https://github.com/grml/grml-debootstrap/issues/120" target="_blank" rel="nofollow noopener">2019-01-24</a>
	</div>
	<div class="user">
	</div>
</div>

<pre class="content" style="white-space: pre-wrap;">Current situation and problem:
build Debian base image using grml-debootstrap which uses debootstrap with mirror "packages.debian.org" but not "security.debian.org" because debootstrap can...</pre>

<div class="labels">
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/9">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/9</link>
        <pubDate>Thu, 24 Jan 2019 05:53:02 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-9</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="5" data-topic="6715" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>FWIW I updated the build machine with apt redirects disabled as per their workaround and checked the final image to contain the pacthed 1.4.9</p>
<p>Is this enough?</p>
</blockquote>
</aside>
<p>No. Otherwise I wouldn’t create above post and make a big deal of it.</p>
<p>This is how it works:</p>
<p>Whonix build script runs commands to run cowbuilder to create cowbuilder image (used for clean package builds) -&gt; cowbuilder runs debootstrap -&gt; deboostrap installs from <a href="http://packages.debian.org" rel="nofollow noopener">packages.debian.org</a> only due to limitations explained above -&gt; <a href="http://packages.debian.org" rel="nofollow noopener">packages.debian.org</a> contains vulnerable APT -&gt; Whonix build script runs the vulnerable apt-get from inside cowbuilder image -&gt; at this point the image and build machine could get compromises.</p>
<p>Whonix build script runs commands to run grml-debootstrap to create Debian base image (to be updated and Whonix packages installed afterwards) -&gt; grml-debootstrap runs debootstrap -&gt; deboostrap installs from <a href="http://packages.debian.org" rel="nofollow noopener">packages.debian.org</a> only due to limitations explained above -&gt; <a href="http://packages.debian.org" rel="nofollow noopener">packages.debian.org</a> contains vulnerable APT -&gt; Whonix build script runs the vulnerable apt-get from inside Debian base image -&gt; at this point the image and build machine could get compromises.</p>
<aside class="quote no-group" data-post="6" data-topic="6715">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/mig5/40/1647_2.png" class="avatar"> mig5:</div>
<blockquote>
<p>Debian made a new point release of Stretch which contains the Apt package fix already included. Might help your problem here (e.g build off of the new 9.7 images when they are released).</p>
<p><a href="https://www.debian.org/News/2019/20190123" rel="nofollow noopener">https://www.debian.org/News/2019/20190123 </a></p>
</blockquote>
</aside>
<p>Can’t create cowbuilder / debian base image from Debian iso.</p>
<ul>
<li>installation method: not sane, not clean […]</li>
<li>conversion: difficult</li>
</ul>
<p>But above might help make the package migrate from Debian security repository to non-security <a href="http://packages.debian.org" rel="nofollow noopener">packages.debian.org</a>.</p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/8">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/8</link>
        <pubDate>Thu, 24 Jan 2019 05:15:20 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-8</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>I wish I read this more carefully before wasting hours building. So pbuilder apt does not depend on the version installed on the base environment, but pulls and uses the vulnerable one from the outdated distro snapshot…</p>
<p>This is one nasty bug.</p>
<p>Let me know when it’s safe to build as mig5’s advice seems good.</p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/7</link>
        <pubDate>Thu, 24 Jan 2019 05:06:18 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-7</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[mig5]]></dc:creator>
        <description><![CDATA[
            <p>Debian made a new point release of Stretch which contains the Apt package fix already included. Might help your problem here (e.g build off of the new 9.7 images when they are released).</p>
<p><a href="https://www.debian.org/News/2019/20190123" class="onebox" target="_blank" rel="nofollow noopener">https://www.debian.org/News/2019/20190123</a></p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/6</link>
        <pubDate>Wed, 23 Jan 2019 23:23:26 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-6</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>FWIW I updated the build machine with apt redirects disabled as per their workaround and checked the final image to contain the pacthed 1.4.9</p>
<p>Is this enough?</p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/5</link>
        <pubDate>Wed, 23 Jan 2019 18:24:44 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-5</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p><strong>Whonix build NOT safe at the moment.</strong><br>
Build happens in <code>chroot</code> but these aren’t safe against breakout. So building now could compromise a build machine.</p>
<p>Applies to Non-Qubes-Whonix only.<br>
Qubes(-Whonix) build <a href="https://forums.whonix.org/t/apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/4?u=patrick">attempts</a> to fix this.</p>
<p>Technical background:</p>
<p>Misery of Debian package repositories:</p>
<ul>
<li>Debian package repository: contains vulnerable apt version.</li>
<li>
<a href="http://security.debian.org" rel="nofollow noopener">security.debian.org</a> Debian security fixes package repository: contains fixed apt version.</li>
</ul>
<p><code>debootstrap</code> is a popular Debian tool.</p>
<ul>
<li>Also used by Whonix since Whonix uses grml-debootstrap which internally uses debootstrap to create base Debian images.</li>
<li>Also used by Whonix since Whonix uses cowbuilder to create packages which internally uses debootstrap.</li>
</ul>
<p>debootstrap limitations:</p>
<ul>
<li>It can only use the Debian package repository.</li>
<li>It can not use <a href="http://security.debian.org" rel="nofollow noopener">security.debian.org</a> Debian security fixes package repository because that only contains packages that have security fixes but not all packages. So that repository cannot be used</li>
<li>debootstrap cannot use multiple repositories at once like apt-get can. It can only use one <code>--mirror</code>.</li>
</ul>
<p>Build process usually:<br>
Build Debian base image from Debian package repository and then upgrade from Debian package repository and Debian security repository.</p>
<p>Problem:<br>
Exactly this upgrade is insecure.</p>
<p>Solution:</p>
<ul>
<li>a) securely update apt after debootstrap inside base image and inside cowbuilder image, OR</li>
<li>b) multistrap
<ul>
<li>make grml-debootstrap use multistrap with multiple repositories and,</li>
<li>create cowbuilder image with multistrap with multiple repositories</li>
</ul>
</li>
</ul>
<p>Not exactly easy. So don’t hold your breath.</p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/4</link>
        <pubDate>Wed, 23 Jan 2019 06:54:57 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-4</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p><a href="https://www.whonix.org/wiki/Operating_System_Software_and_Updates#apt_security_update_-_DSA_4371-1" rel="nofollow noopener">https://www.whonix.org/wiki/Operating_System_Software_and_Updates#apt_security_update_-_DSA_4371-1</a></p>
<blockquote>
<p>Using <a href="https://www.whonix.org/wiki/Onionizing_Repositories" rel="nofollow noopener">onion sources</a> may or may <strong>not</strong> protect from this vulnerability.</p>
</blockquote>
<blockquote>
<p><a href="https://lists.debian.org/debian-security-announce/2019/msg00010.html" rel="nofollow noopener">Debian’s security announcement</a> does not mention <a href="https://onion.torproject.org" rel="nofollow noopener">Debian onion sources</a>. Redirects might also be used by onion mirrors. Debian has to the knowledge of Whonix not released information where Debian onion sources are hosted. Onion sources are also just a mirror. And mirrors may also be in a position to attempt a <a href="https://www.whonix.org/wiki/Warning#Man-in-the-middle_Attacks" rel="nofollow noopener">man-in-the-middle attack</a>.</p>
</blockquote>
<p>Building Whonix is currently <strong>not</strong> safe. Will elaborate soon.</p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/3</link>
        <pubDate>Wed, 23 Jan 2019 06:31:08 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-3</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <pre><code>--connection onion
</code></pre>
<p><a href="https://phabricator.whonix.org/T721#17922" class="onebox" target="_blank" rel="nofollow noopener">https://phabricator.whonix.org/T721#17922</a></p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/2</link>
        <pubDate>Wed, 23 Jan 2019 04:42:00 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-2</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
      <item>
        <title>[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p><a href="https://lists.debian.org/debian-security-announce/2019/msg00010.html" class="onebox" target="_blank" rel="nofollow noopener">https://lists.debian.org/debian-security-announce/2019/msg00010.html</a></p>
<p><a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a> can you please tell me how to force builds to use onion only?</p>
          <p><a href="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715/1</link>
        <pubDate>Tue, 22 Jan 2019 16:59:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-6715-1</guid>
        <source url="http://forums.whonix.org/t/fixed-apt-rce-announced-new-whonix-images-needed-whonix-build-not-safe-at-the-moment/6715.rss">[FIXED] Apt RCE announced. New Whonix images needed. Whonix build NOT safe at the moment.</source>
      </item>
  </channel>
</rss>

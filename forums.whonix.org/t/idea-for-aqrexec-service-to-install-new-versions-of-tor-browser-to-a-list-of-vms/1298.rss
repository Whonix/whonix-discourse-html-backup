<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Idea for aqrexec service to install new versions of Tor browser to a list of VMs</title>
    <link>http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298</link>
    <description>Installing and updating Tor browser on VM by VM basis is very cumbersome (time and bandwidth-wise) when you have 10 or so separate VMs you&#39;d like it in. It would be nice if you could update it in the template, and that could execute a qrexec service (really a script that is triggered and runs the qrexec service multiple times depending on the input parameters you give it) that would do the following:

1. Prompt you with a gui asking which whonix-ws based VMs you&#39;d like to update Tor browser in. Each one could have a checkbox and it could remember your last choice(s).

2. If the first VM in the list of those chosen is already on, intiate a qrexec request. If it is rejected by the qrexec daemon, do not go any further and shutdown the process with an error report. The user probably made a mistake or otherwise your dom0 is really someone else&#39;s.

3. Supposing the user accepts it, whonix-ws template will send the verified Tor browser tar archive to the VM. The VM will then move the old one aside and extract the new one in it&#39;s place. If everything goes right, it sends back an exit code 0. If something went wrong (this seems really unlikely considering how basic the operation is), we send back an error code and continue.

4. Repeat steps 2-3 for the rest of the VMs selected in step 1.

The obvious threat here is for a malicious VM to somehow infect the template. It should not be too hard to express in Python that if the input coming back is not 0 or one of the recognized error codes, that an exception should be thrown and error printed that says &quot;Hey, maybe VM X it totally pwn3d. You might want to check that out.&quot;

Thoughts?

I could try writing this.</description>
    <language>en</language>
    <lastBuildDate>Tue, 15 Dec 2015 04:36:55 +0000</lastBuildDate>
    <category>Qubes-Whonix</category>
    <atom:link href="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Idea for aqrexec service to install new versions of Tor browser to a list of VMs</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Unless this proposal is refined, we will be going with <a href="https://phabricator.whonix.org/T417">https://phabricator.whonix.org/T417</a> only.</p>
          <p><a href="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/7">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/7</link>
        <pubDate>Tue, 15 Dec 2015 04:36:55 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1298-7</guid>
        <source url="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298.rss">Idea for aqrexec service to install new versions of Tor browser to a list of VMs</source>
      </item>
      <item>
        <title>Idea for aqrexec service to install new versions of Tor browser to a list of VMs</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>No one has demonstrated yet, that it’s possible to install &amp; run [ &amp; update ] TBB to either /usr/<em>, /opt/</em> or anything of that sort. By upstream default, you are supposed to have it in your home folder.</p>
<p>Brainstorming: We could download and extract TBB to /opt/* [running tb-updater as root or something, but nevermind] and then have somehow have AppVM copy it from there to user’s home folder.</p>
          <p><a href="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/6</link>
        <pubDate>Mon, 17 Aug 2015 14:48:51 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1298-6</guid>
        <source url="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298.rss">Idea for aqrexec service to install new versions of Tor browser to a list of VMs</source>
      </item>
      <item>
        <title>Idea for aqrexec service to install new versions of Tor browser to a list of VMs</title>
        <dc:creator><![CDATA[fowlslegs]]></dc:creator>
        <description><![CDATA[
            <p>Just a note that /usr/local/ actually belongs to the private.img of your AppVM. It’s symlinked to /rw/usrlocal/ . Therefore, it would not be wise to install TB there.</p>
<p>/usr/bin/ on the other hand, you should not install to because /usr/bin/X11/ hangs out there and that’s a weird folder. Try going to /usr/bin/X11/ and then /usr/bin/X11/X11, seconds later you’ll be 10 X11 dirs deep wondering where the fuck you are. It’s almost as if it’s symlinked to itself… no… that’s not possible!1!1! Sorry, it’s late, I say go with /opt/.</p>
          <p><a href="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/5</link>
        <pubDate>Mon, 17 Aug 2015 12:02:16 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1298-5</guid>
        <source url="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298.rss">Idea for aqrexec service to install new versions of Tor browser to a list of VMs</source>
      </item>
      <item>
        <title>Idea for aqrexec service to install new versions of Tor browser to a list of VMs</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <blockquote>Installing and updating Tor browser on VM by VM basis is very cumbersome (time and bandwidth-wise) when you have 10 or so separate VMs you'd like it in.</blockquote>
I agree.
<blockquote>It would be nice if you could update it in the template, and that could execute a qrexec service (really a script that is triggered and runs the qrexec service multiple times depending on the input parameters you give it) that would do the following:</blockquote>
<blockquote>1. Prompt you with a gui asking which whonix-ws based VMs you'd like to update Tor browser in. Each one could have a checkbox and it could remember your last choice(s).</blockquote>
Good.
<p>But did you know already, that tb-updater is unable to keep your user settings? It renames your old folder so nothing is lost. Then installs a fresh one. Something important to know. I don’t think this limitation can be lifted in tb-updater. Upgrading Tor Browser is hard. (Upstream often changed the folder layout in past.) That’s what Tor Browser’s internal updater is for.</p>
<p>References:</p>
<ul>
<li>tb-updater, Tor Browser Updater (Whonix): <a href="https://www.whonix.org/wiki/Tor_Browser#Tor_Browser_Updater_.28Whonix.29">https://www.whonix.org/wiki/Tor_Browser#Tor_Browser_Updater_.28Whonix.29</a>
</li>
<li>Tor Browser internal updater: <a href="https://www.whonix.org/wiki/Tor_Browser#Tor_Browser_Internal_Updater">https://www.whonix.org/wiki/Tor_Browser#Tor_Browser_Internal_Updater</a>
</li>
</ul>
<p>So most likely your solution should rely on Tor Browser’s internal updater rather than tb-updater?</p>
<blockquote>2. If the first VM in the list of those chosen is already on, intiate a qrexec request. If it is rejected by the qrexec daemon, do not go any further and shutdown the process with an error report. The user probably made a mistake or otherwise your dom0 is really someone else's.</blockquote>
Ok.
<blockquote>3. Supposing the user accepts it, whonix-ws template will send the verified Tor browser tar archive to the VM. The VM will then move the old one aside and extract the new one in it's place. If everything goes right, it sends back an exit code 0. If something went wrong (this seems really unlikely considering how basic the operation is), we send back an error code and continue.</blockquote>
Ok. (But my above considerations apply.)
<blockquote>4. Repeat steps 2-3 for the rest of the VMs selected in step 1.</blockquote>
Ok.
<blockquote>The obvious threat here is for a malicious VM to somehow infect the template. It should not be too hard to express in Python that if the input coming back is not 0 or one of the recognized error codes, that an exception should be thrown and error printed that says "Hey, maybe VM X it totally pwn3d. You might want to check that out."</blockquote>
Ok.
<blockquote>Thoughts?</blockquote>
Sounds good overall.
<blockquote>I could try writing this.</blockquote>
Yes.
<p>I am not sure into which package this belongs. Perhaps <a href="https://github.com/Whonix/tb-updater">https://github.com/Whonix/tb-updater</a>. Or <a href="https://github.com/Whonix/qubes-whonix">https://github.com/Whonix/qubes-whonix</a>.</p>
<blockquote>Actually... it seems like it might just be easier to install Tor browser to root.</blockquote>
<blockquote>I don't see any danger or difficulty to doing so, do you? You could simply modify your GUI tool to download and verify in /home, and then prompt root and install to / in whonix-ws template only.</blockquote>
Tor Browser refuses to run as root. (Could be patched, but probably not a good solution, would cause other confusing permission issues.)
<p>Due to Tor Browser binaries being entangled with user data in the same folder (Tor Browser is packaged and only available as portable app) (“upstream issue”?), you cannot install Tor Browser to /usr/bin or /opt or so as root and then run it as a user having your profile in user’s home folder.</p>
<blockquote>I understand why there is no point in doing so on a non-template-based Whonix setup, but as far as Qubes goes, this would provide a reliable way to upgrade and update Tor browser for all whonix-ws based VMs.</blockquote>
We can consider any Qubes specific command line switches [run as root, install to root etc.] switches for tb-updater, but as said above, I don't think it would work that way.
          <p><a href="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/4</link>
        <pubDate>Fri, 14 Aug 2015 18:36:45 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1298-4</guid>
        <source url="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298.rss">Idea for aqrexec service to install new versions of Tor browser to a list of VMs</source>
      </item>
      <item>
        <title>Idea for aqrexec service to install new versions of Tor browser to a list of VMs</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Thanks for the suggestion. I’ll read this more carefully later.</p>
<p>In meanwhile, please check out the related discussion:<br>
What should Tor Browser Updater (Whonix) do in a TemplateVM?<br>
<a href="https://www.whonix.org/forum/index.php/topic,1381.0.html" class="onebox" target="_blank">https://www.whonix.org/forum/index.php/topic,1381.0.html</a></p>
<p>After having read, please consider to restart/upgrade your argument if applicable.</p>
<p>Unrelated, but since you’re interested in Qubes-Whonix, perhaps also check out:<br>
What should whonixcheck do when it detects being run inside a TemplateVM?<br>
<a href="https://www.whonix.org/forum/index.php/topic,1380.0.html" class="onebox" target="_blank">https://www.whonix.org/forum/index.php/topic,1380.0.html</a></p>
          <p><a href="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/3</link>
        <pubDate>Fri, 14 Aug 2015 17:43:01 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1298-3</guid>
        <source url="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298.rss">Idea for aqrexec service to install new versions of Tor browser to a list of VMs</source>
      </item>
      <item>
        <title>Idea for aqrexec service to install new versions of Tor browser to a list of VMs</title>
        <dc:creator><![CDATA[fowlslegs]]></dc:creator>
        <description><![CDATA[
            <p>Actually… it seems like it might just be easier to install Tor browser to root. I understand why there is no point in doing so on a non-template-based Whonix setup, but as far as Qubes goes, this would provide a reliable way to upgrade and update Tor browser for all whonix-ws based VMs.</p>
<p>I don’t see any danger or difficulty to doing so, do you? You could simply modify your GUI tool to download and verify in /home, and then prompt root and install to / in whonix-ws template only.</p>
          <p><a href="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/2</link>
        <pubDate>Thu, 13 Aug 2015 21:43:01 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1298-2</guid>
        <source url="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298.rss">Idea for aqrexec service to install new versions of Tor browser to a list of VMs</source>
      </item>
      <item>
        <title>Idea for aqrexec service to install new versions of Tor browser to a list of VMs</title>
        <dc:creator><![CDATA[fowlslegs]]></dc:creator>
        <description><![CDATA[
            <p>Installing and updating Tor browser on VM by VM basis is very cumbersome (time and bandwidth-wise) when you have 10 or so separate VMs you’d like it in. It would be nice if you could update it in the template, and that could execute a qrexec service (really a script that is triggered and runs the qrexec service multiple times depending on the input parameters you give it) that would do the following:</p>
<ol>
<li>
<p>Prompt you with a gui asking which whonix-ws based VMs you’d like to update Tor browser in. Each one could have a checkbox and it could remember your last choice(s).</p>
</li>
<li>
<p>If the first VM in the list of those chosen is already on, intiate a qrexec request. If it is rejected by the qrexec daemon, do not go any further and shutdown the process with an error report. The user probably made a mistake or otherwise your dom0 is really someone else’s.</p>
</li>
<li>
<p>Supposing the user accepts it, whonix-ws template will send the verified Tor browser tar archive to the VM. The VM will then move the old one aside and extract the new one in it’s place. If everything goes right, it sends back an exit code 0. If something went wrong (this seems really unlikely considering how basic the operation is), we send back an error code and continue.</p>
</li>
<li>
<p>Repeat steps 2-3 for the rest of the VMs selected in step 1.</p>
</li>
</ol>
<p>The obvious threat here is for a malicious VM to somehow infect the template. It should not be too hard to express in Python that if the input coming back is not 0 or one of the recognized error codes, that an exception should be thrown and error printed that says “Hey, maybe VM X it totally pwn3d. You might want to check that out.”</p>
<p>Thoughts?</p>
<p>I could try writing this.</p>
          <p><a href="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298/1</link>
        <pubDate>Thu, 13 Aug 2015 21:31:25 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-1298-1</guid>
        <source url="http://forums.whonix.org/t/idea-for-aqrexec-service-to-install-new-versions-of-tor-browser-to-a-list-of-vms/1298.rss">Idea for aqrexec service to install new versions of Tor browser to a list of VMs</source>
      </item>
  </channel>
</rss>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Using corridor, a Tor traffic whitelisting gateway with Qubes-Whonix - #6 by Patrick - News - Whonix Forum</title>
    <meta name="description" content="Originally published at: https://www.whonix.org/blog/using-corridor-tor-traffic-whitelisting-gateway-qubes-whonix corridor is a Tor traffic whitelisting gateway. It is a filtering gateway. Not a proxying gateway. 
It can&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../2761.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Using corridor, a Tor traffic whitelisting gateway with Qubes-Whonix&#39;" href="../2761.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/using-corridor-a-tor-traffic-whitelisting-gateway-with-qubes-whonix/2761/6" />
<meta name="twitter:url" content="https://forums.whonix.org/t/using-corridor-a-tor-traffic-whitelisting-gateway-with-qubes-whonix/2761/6" />
<meta property="og:title" content="Using corridor, a Tor traffic whitelisting gateway with Qubes-Whonix" />
<meta name="twitter:title" content="Using corridor, a Tor traffic whitelisting gateway with Qubes-Whonix" />
<meta property="og:description" content="A more generic introduction into corridor:" />
<meta name="twitter:description" content="A more generic introduction into corridor:" />
<meta property="article:published_time" content="2016-07-20T17:57:28+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../2761.html">Using corridor, a Tor traffic whitelisting gateway with Qubes-Whonix</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/news/21.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #AB9364'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>News</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../2761.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-07-20T01:05:54Z' class='post-time'>
                July 20, 2016,  1:05am
              </time>
              <meta itemprop='dateModified' content='2019-08-30T09:36:20Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><small>Originally published at: <a href="../../../../external.html?link=https://www.whonix.org/blog/using-corridor-tor-traffic-whitelisting-gateway-qubes-whonix" rel="nofollow noopener">https://www.whonix.org/blog/using-corridor-tor-traffic-whitelisting-gateway-qubes-whonix</a></small><br><a href="../../../../external.html?link=https://github.com/rustybird/corridor" rel="nofollow noopener">corridor</a> is a Tor traffic whitelisting gateway. It is a filtering gateway. Not a proxying gateway.</p>
<p>It can also be used as a <a href="../../../../external.html?link=https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO/BridgeFirewall" target="_blank" rel="nofollow noopener">BridgeFirewall</a>.</p>
<p>This is not necessarily more anonymous. It is an additional fail-save Tor traffic whitelisting firewall that would protect from accidental clearnet leaks (hypothetical clearnet leak bugs in Whonix). As <a href="../../../../external.html?link=https://github.com/rustybird/corridor" target="_blank" rel="nofollow noopener">corridor’s project description</a> states, quote “it cannot prevent malware on a client computer from finding out your clearnet IP address”. corridor is mostly useful for developers and auditors of Whonix, perhaps also for advanced users who would like to have an additional safety net. It cannot protect from hypothetical Qubes ProxyVM leak bugs either, a <a href="../../../../external.html?link=https://github.com/rustybird/corridor" target="_blank" rel="nofollow noopener">physically isolated, standalone corridor-Gateway</a> would be better and could cover that.</p>
<p>It does not increase the tunnel length, i.e. it does not add more relays between you and the destination, if you are interested in that, see <a title="Tunnels/Introduction" href="../../../../external.html?link=https://www.whonix.org/wiki/Tunnels/Introduction" rel="nofollow noopener">Tunnels/Introduction</a>.</p>
<p>Credits: The author of corridor is <a href="../../../../external.html?link=https://github.com/rustybird" target="_blank" rel="nofollow noopener">rustybird</a>. The author of <a href="../../../../external.html?link=https://en.wikipedia.org/wiki/Fork_(software_development)" target="_blank" rel="nofollow noopener">fork</a> of <a href="../../../../external.html?link=https://github.com/adrelanos/corridor" target="_blank" rel="nofollow noopener">corridor for Debian</a> which will be used in this instructions is <a href="../../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="nofollow noopener">Patrick Schleizer</a>.</p>
<p>The full documentation for doing this can be found here:</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://www.whonix.org/favicon.ico" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://www.whonix.org/wiki/Corridor" target="_blank" rel="nofollow noopener">Whonix</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:640/411;"><img src="../../../../external.html?link=https://www.whonix.org/w/images/9/9b/Corridor.jpg" class="thumbnail"></div>

<h3><a href="../../../../external.html?link=https://www.whonix.org/wiki/Corridor" target="_blank" rel="nofollow noopener">Corridor</a></h3>

<p>Using corridor, a Tor traffic whitelisting gateway with Whonix</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>If you like Whonix, please support it.</p>
<ul>
 	<li>test / try</li>
 	<li>comment and/or share this article</li>
 	<li><a href="../../../../external.html?link=https://whonix.org/wiki/Donate" rel="nofollow noopener">donate</a></li>
 	<li><a href="../../../../external.html?link=https://whonix.org/wiki/Contribute" rel="nofollow noopener">contribute</a></li>
</ul>
        </div>

        <meta itemprop='headline' content='Using corridor, a Tor traffic whitelisting gateway with Qubes-Whonix'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="3" />
           <span class='post-likes'>3 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../2761.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-07-20T01:59:39Z' class='post-time'>
                July 20, 2016,  1:59am
              </time>
              <meta itemprop='dateModified' content='2016-07-20T02:20:27Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Great to see this idea progressing. I have an idea about how Corridor can implement a “hardened” mode beside its current safety net model.</p>
<p>It can add an optional setting that locks outgoing connections to the guard(s) chosen by the Tor client instead of merely whitelisting all Tor traffic which can be abused by malware speaking to colluding guards.</p>
<p>At first it will seem like a Whonix-light firewall but when considering that only whitelisted commands make it to Tor on the GW it becomes a second line of defense in Whonix and not just a safety net like on a single system setup.</p>
<p>EDIT:</p>
<p>Supporting multi torrc/guard files for locking can be useful outside the Whonix context when There is a system-tor and tbb Tor running at the same time and you want to whitelist their guards.</p>
        </div>

        <meta itemprop='headline' content='Using corridor, a Tor traffic whitelisting gateway with Qubes-Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../2761.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-07-20T04:25:46Z' class='post-time'>
                July 20, 2016,  4:25am
              </time>
              <meta itemprop='dateModified' content='2016-07-20T04:25:46Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="2" data-topic="2761">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>It can add an optional setting that locks outgoing connections to the guard(s) chosen by the Tor client</p>
</blockquote>
</aside>
<p>corridor-gateway’s Tor does not have access to sys-whonix’s Tor. So this is difficult to know for corridor-gateway.</p>
<p>Perhaps corridor could limit it to manually configured IPs. I wonder if that would still require corridor or a simpler firewall. It would break when sys-whonix’s Tor automatically (by Tor default) moves to the next Tor entry guard.</p>
<p>You can already do this by using bridges. Then corridor-gateway would act as a bridge firewall:<br>
<a href="../../../../external.html?link=https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO/BridgeFirewall" class="onebox" target="_blank">https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO/BridgeFirewall</a></p>
<aside class="quote" data-post="2" data-topic="2761">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>It can add an optional setting that locks outgoing connections to the guard(s)</p>
</blockquote>
</aside>
<p>Even if it had. I am not sure what that would gain.</p>
<p>sys-whonix does not have access to corridor-gateway’s Tor. And would sophisticated attacks it would not need to. sys-whonix, once compromised, could just run <code>getinfo address</code> and game over. Other attacks mentioned on <a href="../../../../external.html?link=https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO/BridgeFirewall">https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO/BridgeFirewall</a> also apply.</p>
<p>Btw I am not the one to convince here. The one that would receive the feature request / pull request would be upstream:</p>
<p><a href="../../../../external.html?link=https://github.com/rustybird/corridor">https://github.com/rustybird/corridor</a></p>
<p>Feel free to convince me here anyhow, since that might help writing a good feature request.</p>
<aside class="quote" data-post="2" data-topic="2761">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Supporting multi torrc/guard files for locking can be useful outside the Whonix context when There is a system-tor and tbb Tor running at the same time and you want to whitelist their guards.</p>
</blockquote>
</aside>
<p>Since corridor uses <code>sh</code> for its config files that should already be possible for bridges:</p>
<pre><code>BRIDGES1=`grep -Ei '^[[:space:]]*Bridge[[:space:]]' /etc/tor/torrc`
BRIDGES2=`grep -Ei '^[[:space:]]*Bridge[[:space:]]' /path/to/other/torrc`
BRIDGES="$BRIDGES1
$BRIDGES2"</code></pre>
        </div>

        <meta itemprop='headline' content='Using corridor, a Tor traffic whitelisting gateway with Qubes-Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../2761.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-07-20T15:38:33Z' class='post-time'>
                July 20, 2016,  3:38pm
              </time>
              <meta itemprop='dateModified' content='2016-07-20T15:38:33Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="3" data-topic="2761">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>corridor-gateway’s Tor does not have access to sys-whonix’s Tor. So this is difficult to know for corridor-gateway.</p>
</blockquote>
</aside>
<p>I see. That wasn’t entirely clear from the documentation. (I am also unfamiliar with Qubes architecture). I thought the corridor firewall is installed on the GW VM.</p>
<p>My idea of how it worked:</p>
<p>Internal Network -&gt; |GW eth1 firewall| -&gt; Corridor firewall -&gt; |GW eth0 firewall | -&gt; Clearnet</p>
<p>Is this a Qubes thing or is there an intermediary VM sitting between WS and GW for all Whonix editions? IMO that would be a bit resource intensive. If its on the gateway then the bridge/guard lock thing can be done?</p>
<aside class="quote" data-post="3" data-topic="2761">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Even if it had. I am not sure what that would gain.</p>
</blockquote>
</aside>
<p>The gain is a simpler firewall that is very conservative with rule changes that can guard (and log) leaks that are mistakes or intentional that eth1 firewall didn’t catch.</p>
<aside class="quote" data-post="3" data-topic="2761">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_1.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Btw I am not the one to convince here. The one that would receive the feature request / pull request would be upstream:</p>
</blockquote>
</aside>
<p>Right. I want to see if we are onto something here that can serve many purposes before talking to upstream. I don’t want to make a dumb request.</p>
        </div>

        <meta itemprop='headline' content='Using corridor, a Tor traffic whitelisting gateway with Qubes-Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../2761.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-07-20T16:30:05Z' class='post-time'>
                July 20, 2016,  4:30pm
              </time>
              <meta itemprop='dateModified' content='2016-07-20T16:30:05Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="4" data-topic="2761">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>My idea of how it worked:</p>
<p>Internal Network -&gt; |GW eth1 firewall| -&gt; Corridor firewall -&gt; |GW eth0 firewall | -&gt; Clearnet</p>
</blockquote>
</aside>
<p>No. Absolutly not. Start thinking with the upstream defaults from <a href="../../../../external.html?link=https://github.com/rustybird/corridor">https://github.com/rustybird/corridor</a>. This has been adjusted as an additional VM. Whonix-Gateway not connected directly to the internet. But connected to a corridor-Gateway instead.</p>
<blockquote>
<p>sitting between WS and GW</p>
</blockquote>
<p>This is not possible. This is not for what corridor is designed.</p>
<p>What would be possible is:</p>
<ul>
<li>corridor-workstation -&gt; corridor-gateway</li>
</ul>
<p>In Such an setup it would be up to the corridor-workstation to establish its own Tor circuits. But this would come with all the disadvantages that corridor lists for itself:<br>
<a href="../../../../external.html?link=https://github.com/rustybird/corridor">https://github.com/rustybird/corridor</a></p>
<p>Quote corridor readme:</p>
<blockquote>
<p>“corridor is not a replacement for using a well-designed operating system on your client computers, like Qubes with TorVM/Whonix.”</p>
</blockquote>
<p>It is a supplement.</p>
<p>So when Whonix comes into play to, Whonix-Gateway should establish its own Tor circuits and then have a corridor-Gateway as a safety net checking that Whonix-Gateway does not try to establish non-Tor connections.</p>
<aside class="quote" data-post="4" data-topic="2761">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>Is this a Qubes thing or is there an intermediary VM sitting between WS and GW for all Whonix editions?</p>
</blockquote>
</aside>
<p>Qubes does not have networking on the host for security reasons. (In Qubes, the host is called dom0.)</p>
<p>[Which is great, because then the many and diverse wifi / lan drivers do not run on the same system, in kernel mode (!), together with everything else such as private gpg keys, but in an isolated NetVM.]</p>
<p>[And yes, Qubes host can be updated, networking and package download is done in a VM, just package verification and installation of Qubes host updates happens on Qubes host.]</p>
<p>So for Qubes only two things are possible:</p>
<ul>
<li>sys-corridor intermediary VM sitting between GW and sys-firewall</li>
<li>sys-whonix -&gt; sys-corridor -&gt; sys-firewall -&gt; sys-net -&gt; internet</li>
<li>anon-whonix -&gt; sys-whonix -&gt; sys-corridor -&gt; sys-firewall -&gt; sys-net -&gt; internet</li>
<li>standalone, physically isolated corridor-Gateway</li>
</ul>
<p><a href="../../../../external.html?link=https://phabricator.whonix.org/T524#9510" class="onebox" target="_blank">https://phabricator.whonix.org/T524#9510</a></p>
<blockquote>
<p><a href="../../../../external.html?link=https://www.whonix.org/wiki/Non-Qubes-Whonix" target="_blank">For Non-Qubes-Whonix</a>, installing corridor in a VM is not that useful. More useful:</p>
<ul>
<li>corridor as a host firewall<ul>
<li><a href="../../../../external.html?link=https://github.com/rustybird/corridor/issues/3" target="_blank">already possible with some configuration</a></li>
<li>for Debian hosts [perhaps also any Linux] probably simpler to document and do than creating a new VM and reconfiguring Whonix-Gateway VM to use corridor-gateway VM</li>
</ul>
</li>
<li>
<a href="../../../../external.html?link=https://github.com/rustybird/corridor" target="_blank">standalone corridor-gateway</a>
</li>
</ul>
</blockquote>
<aside class="quote" data-post="4" data-topic="2761">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v2/letter/h/edb3f5/40.png" class="avatar"> HulaHoop:</div>
<blockquote>
<p>The gain is a simpler firewall that is very conservative with rule changes that can guard (and log) leaks that are mistakes or intentional that eth1 firewall didn’t catch.</p>
</blockquote>
</aside>
<p>That is not how it works.</p>
<p>A separate firewall - corridor - running on a different system is a safety net and leak tester for Whonix-Gateway. It cannot be combined with Whonix-Gateway.</p>
<p>What could be done would be making Whonix’s firewall more complex. Rather than “user debian-tor on Whonix-Gateway can establish any [IPv4] connection” it could be limited to “debian-tor may connect to Tor’s current entry guard[s] or bridge[s]”. Perhaps reusing some code that corridor is using. That would not be a “additional safety net and leak tester for Whonix-Gateway”, since that would run on Whonix-Gateway.</p>
        </div>

        <meta itemprop='headline' content='Using corridor, a Tor traffic whitelisting gateway with Qubes-Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../2761.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-07-20T17:57:28Z' class='post-time'>
                July 20, 2016,  5:57pm
              </time>
              <meta itemprop='dateModified' content='2019-08-30T09:36:50Z'>
          <span itemprop='position'>#6</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>A more generic introduction into corridor:</p>
<aside class="quote quote-modified" data-post="1" data-topic="2765">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="../../corridor-a-tor-traffic-whitelisting-gateway-a-clearnet-leak-tester/2765.html">corridor, a Tor traffic whitelisting gateway, a clearnet leak tester</a> <a class="badge-wrapper  bullet" href="../../../c/news/21.html"><span class="badge-category-bg" style="background-color: #AB9364;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="News posted by Whonix staff. The Whonix Blog. Stay Tuned. (rss)">News</span></a>
  </div>
  <blockquote>
    Originally published at: <a href="../../../../external.html?link=https://www.whonix.org/blog/corridor-a-clearnet-leak-tester" rel="nofollow noopener">https://www.whonix.org/blog/corridor-a-clearnet-leak-tester</a> After making the second step, posting how to <a href="../../../../external.html?link=https://www.whonix.org/blog/using-corridor-tor-traffic-whitelisting-gateway-qubes-whonix" rel="nofollow noopener">use corridor, a Tor traffic whitelisting gateway with Qubes-Whonix</a>, I will hereby do the first step, posting a general announcement of an interesting third party project, corridor. Please forget about Whonix for a moment, and I will explain what the corridor project by default is doing. 
<a href="../../../../external.html?link=https://github.com/rustybird/corridor" rel="nofollow noopener">corridor</a> is a Tor traffic whitelisting gateway. It is a filtering gateway. Not a …
  </blockquote>
</aside>

        </div>

        <meta itemprop='headline' content='Using corridor, a Tor traffic whitelisting gateway with Qubes-Whonix'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

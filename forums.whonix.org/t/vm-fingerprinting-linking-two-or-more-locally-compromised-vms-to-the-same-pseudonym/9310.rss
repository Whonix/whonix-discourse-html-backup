<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>VM Fingerprinting - linking two or more locally compromised VMs to the same pseudonym</title>
    <link>http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310</link>
    <description>Please see and leave feedback:


https://www.whonix.org/wiki/VM_Fingerprinting</description>
    <language>en</language>
    <lastBuildDate>Thu, 25 Feb 2021 17:22:46 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>VM Fingerprinting - linking two or more locally compromised VMs to the same pseudonym</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Patrick" data-post="5" data-topic="9310">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forums.whonix.org/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Another option to defeat benchmarking. (And also maybe a nice way to prevent crashes, i.e. buggy applications using all CPU / RAM / IO thereby freezing the system.)</p>
</blockquote>
</aside>
<p>Using separate forum thread for that:</p>
<aside class="quote quote-modified" data-post="1" data-topic="10914">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="/user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="https://forums.whonix.org/t/constrained-system-resources-program-starter-wrapper/10914">constrained system resources program starter wrapper</a> <a class="badge-wrapper  bullet" href="http://forums.whonix.org/c/development/8"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    systemd provides a powerful tool, systemd-run which can constrain how many system resources an application started by it can use. It can limit (non-exhaustive list) use of CPU, memory and disk. However, this powerful too is too complicated to use on the command line. A wrapper is required to make it easily accessible. Use case: running resource intensive tasks (such as backups, compression) without making the system (almost) unusable by the load generated by that task. 
limit-low design goals: 

…
  </blockquote>
</aside>

          <p><a href="http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310/6">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310/6</link>
        <pubDate>Thu, 25 Feb 2021 17:22:46 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9310-6</guid>
        <source url="http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310.rss">VM Fingerprinting - linking two or more locally compromised VMs to the same pseudonym</source>
      </item>
      <item>
        <title>VM Fingerprinting - linking two or more locally compromised VMs to the same pseudonym</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Another option to defeat benchmarking. (And also maybe a nice way to prevent crashes, i.e. buggy applications using all CPU / RAM / IO thereby freezing the system.)</p>
<p><code>systemd-run</code> supports system resource limits. An easy to use wrapper to use cgroups.</p>
<p>Install <code>stress</code>.</p>
<pre><code>sudo apt update
sudo apt install stress
</code></pre>
<p>Example as root:</p>
<pre><code>sudo systemd-run \
   --same-dir \
   --collect \
   --nice=19 \
   --property=MemoryMax=2G \
   --property=CPUAccounting=yes \
   --property=CPUQuota=20% \
   --property=CPUWeight=1 \
   --property=CPUShares=2 \
   --property=TasksAccounting=yes \
   --property=TasksMax=200 \
   --property=IOAccounting=yes \
   --property=IOWeight=1 \
   --scope \
   -- \
   stress --cpu 8 --io 4 --vm 2 --vm-bytes 128M --timeout 10s
</code></pre>
<p>Does not work as non-root, user as of Debian <code>buster</code>. But does work in Debian <code>bullseye</code>. (Newer systemd version.)</p>
<p>Example as non-root:</p>
<pre><code class="lang-auto">systemd-run \
   --user \
   --same-dir \
   --collect \
   --nice=19 \
   --property=MemoryMax=2G \
   --property=CPUAccounting=yes \
   --property=CPUQuota=20% \
   --property=CPUWeight=1 \
   --property=CPUShares=2 \
   --property=TasksAccounting=yes \
   --property=TasksMax=200 \
   --property=IOAccounting=yes \
   --property=IOWeight=1 \
   --scope \
   --unit=testtest \
   -- \
   stress --cpu 8 --io 4 --vm 2 --vm-bytes 128M --timeout 10s
</code></pre>
          <p><a href="http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310/5">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310/5</link>
        <pubDate>Thu, 14 May 2020 11:56:33 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9310-5</guid>
        <source url="http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310.rss">VM Fingerprinting - linking two or more locally compromised VMs to the same pseudonym</source>
      </item>
      <item>
        <title>VM Fingerprinting - linking two or more locally compromised VMs to the same pseudonym</title>
        <dc:creator><![CDATA[madaidan]]></dc:creator>
        <description><![CDATA[
            <blockquote>
<ul>
<li>
<code>/proc/cpuinfo</code> (Related: <a href="https://www.whonix.org/wiki/Security-misc#Restrict_Hardware_Information_to_Root">Restrict Hardware Information to Root</a>)</li>
</ul>
</blockquote>
<p>To hide hardware identifiers, we could add a hardware info permission to sandbox-app-launcher. Then, only apps users have chosen can access hardware identifiers like CPU information.</p>
<blockquote>
<p>Perhaps such a feature could be implemented in <a href="https://github.com/Whonix/sandbox-app-launcher">sandbox-app-launcher</a> <a href="https://web.archive.org/web/https://github.com/Whonix/sandbox-app-launcher">[archive]</a> (<a href="https://forums.whonix.org/t/system-wide-sandboxing-framework/9008">development discussion</a> <a href="https://web.archive.org/web/https://forums.whonix.org/t/system-wide-sandboxing-framework/9008">[archive]</a>) which would be useful in case of buggy / misbehaving applications not accidentally DDOS’ing the host as well as compromised applications trying to benchmark the VM.</p>
</blockquote>
<p>Apparmor supports rlimit rules we can set.</p>
<p><a href="https://manpages.debian.org/buster/apparmor/apparmor.d.5.en.html#rlimit_rules" class="onebox" target="_blank">https://manpages.debian.org/buster/apparmor/apparmor.d.5.en.html#rlimit_rules</a></p>
<p>In sandbox-app-launcher, currently it only sets a 200 process limit to prevent fork bombs but we can restrict it further.</p>
<p>rlimit supports many types of restrictions.</p>
<p><a href="https://manpages.debian.org/buster/manpages-dev/setrlimit.2.en.html" class="onebox" target="_blank">https://manpages.debian.org/buster/manpages-dev/setrlimit.2.en.html</a></p>
          <p><a href="http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310/4">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310/4</link>
        <pubDate>Sun, 12 Apr 2020 16:36:25 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9310-4</guid>
        <source url="http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310.rss">VM Fingerprinting - linking two or more locally compromised VMs to the same pseudonym</source>
      </item>
      <item>
        <title>VM Fingerprinting - linking two or more locally compromised VMs to the same pseudonym</title>
        <dc:creator><![CDATA[HulaHoop]]></dc:creator>
        <description><![CDATA[
            <p>Excellent writeup. I am not sure hiding Whonix is a feasible goal, same with hiding Tor. A really determined remote service can implement ways to fingerprint an environment especially if code is run locally.</p>
<p>Some low hanging fruit can be fixed with sandbox restrictions to files that have uniquely generated data, but besides that it’s impossible.</p>
          <p><a href="http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310/3">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310/3</link>
        <pubDate>Sat, 11 Apr 2020 15:08:14 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9310-3</guid>
        <source url="http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310.rss">VM Fingerprinting - linking two or more locally compromised VMs to the same pseudonym</source>
      </item>
      <item>
        <title>VM Fingerprinting - linking two or more locally compromised VMs to the same pseudonym</title>
        <dc:creator><![CDATA[marmarek]]></dc:creator>
        <description><![CDATA[
            <p>Specifically in context of <a href="https://github.com/QubesOS/qubes-issues/issues/5764" rel="nofollow noopener">https://github.com/QubesOS/qubes-issues/issues/5764</a>, that (supposedly) was about MAC address. In Qubes every VM (inter-VM interfaces) use the same MAC address (<code>00:16:3e:5e:6c:00</code>). This means having ability to read local MAC address, one can easily say it is Qubes. Also, attacker can think they correlated two VMs to the same pseudonym when finding the same MAC elsewhere, but in practice this means the other VM is also a Qubes VM (possibly on a totally different machine).<br>
The MAC address we use if of “Xensource, Inc” vendor - default value that Xen uses. Standard Xen behavior is to choose random device part (or hash of VM name, depending on version) - we use constant device part.</p>
<p>Now we can consider two scenarios:</p>
<ol>
<li>Attacker knowing about Qubes, trying to de-anonymize user: here I think constant MAC doesn’t change much - there are already quite a lot of methods to detect it is Qubes, but otherwise it doesn’t give much more info. This may affect a case where attacker has very limited access and can for example extract only MAC address - in this case, our current approach gives some info - that it is Qubes.</li>
<li>Attacker not knowing about Qubes, using generic techniques like checking MAC address (Zoom case). Here, using constant MAC across all Qubes installations, gives false sense of de-anonymization, while in fact it is only about identifying Qubes. Here any kind of randomization (like - just device part, keeping Xensource vendor) would help.</li>
</ol>
<p>There is also another argument: any kind of MAC randomization (in opposition to use the same across large user base) allows to identify (with some probability) a specific <em>instance</em> of a DisposableVM. If an attacker can only probe MAC address from time to time, with randomization they can say “I have seen this particular DisposableVM recently (with some probability)” - until that DisposableVM is stopped. I think it isn’t a big concern given the threat model of a DisposableVM (a method to unlink identifies is to restart it, other methods aren’t guaranteed to work), but still something to consider. Also, likely if one can extract MAC address, then can access also various other information with similar impact (like system uptime, VM IP address etc).</p>
<p>In any case, it may be desirable to hide the fact of using Qubes even if only from some attackers (by using different vendor parts in MAC), because this is also a bit of information. But as <a class="mention" href="http://forums.whonix.org/u/patrick">@Patrick</a> said elsewhere, it is complex problem.</p>
          <p><a href="http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310/2">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310/2</link>
        <pubDate>Sat, 11 Apr 2020 13:51:17 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9310-2</guid>
        <source url="http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310.rss">VM Fingerprinting - linking two or more locally compromised VMs to the same pseudonym</source>
      </item>
      <item>
        <title>VM Fingerprinting - linking two or more locally compromised VMs to the same pseudonym</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <p>Please see and leave feedback:</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.whonix.org/w/images/favicon.ico" class="site-icon" width="16" height="16">
      <a href="https://www.whonix.org/wiki/VM_Fingerprinting" target="_blank" rel="noopener" title="10:16AM - 19 June 2020">Whonix – 19 Jun 20</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/460;"><img src="https://www.whonix.org/w/images/b/b5/Vmfingerprint123123.jpg" class="thumbnail" width="690" height="460"></div>

<h3><a href="https://www.whonix.org/wiki/VM_Fingerprinting" target="_blank" rel="noopener">VM Fingerprinting</a></h3>

<p>Linking two or more locally compromised VMs to the same pseudonym</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310/1</link>
        <pubDate>Sat, 11 Apr 2020 12:38:29 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-9310-1</guid>
        <source url="http://forums.whonix.org/t/vm-fingerprinting-linking-two-or-more-locally-compromised-vms-to-the-same-pseudonym/9310.rss">VM Fingerprinting - linking two or more locally compromised VMs to the same pseudonym</source>
      </item>
  </channel>
</rss>

<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security? - #33 by Patrick - Development - Whonix Forum</title>
    <meta name="description" content="Could we gain security by mounting home with noexec (and nosuid [among other useful mount options])? 
How does noexec help if one can use 

bash ./script
sh ./script
python ./script

etc.? 
EDIT: bash ./script etc. does &amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../77074658.html?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../../c/news/21.html">NEWS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?&#39;" href="../7707.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707/33" />
<meta name="twitter:url" content="https://forums.whonix.org/t/re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/7707/33" />
<meta property="og:title" content="(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?" />
<meta name="twitter:title" content="(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?" />
<meta property="og:description" content="What remount-secure does is easy to log indeed. That always worked. What was hard to debug was some random unrelated service breaking.   That would be a good solution.  Before piling up more and more initramfs stuff, could you port all of Whonix to dracut and implement this using a dracut hook?" />
<meta name="twitter:description" content="What remount-secure does is easy to log indeed. That always worked. What was hard to debug was some random unrelated service breaking.   That would be a good solution.  Before piling up more and more initramfs stuff, could you port all of Whonix to dracut and implement this using a dracut hook?" />
<meta property="article:published_time" content="2020-03-07T17:30:10+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="../7707.html">
        <link rel="next" href="../77079ba9.html?page=3">

    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../../index.html">
          <img src="../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="../7707.html">(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../../external.html?link=http://schema.org/ListItem">
            <a href="../../../c/development/8.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../../tag/component_security.html' class='discourse-tag' rel="tag">component_security</a>, 
            <a href='../../../tag/status_open_issue_todo.html' class='discourse-tag' rel="tag">status_open_issue_todo</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-07T16:56:13Z' class='post-time'>
                March 7, 2020,  4:56pm
              </time>
              <meta itemprop='dateModified' content='2020-03-07T16:56:13Z'>
          <span itemprop='position'>#28</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/pull/68" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/pull/68" target="_blank">remount-secure improvements</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> ‚Üê <code>madaidan:remount-secure</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-03-07" data-time="16:46:02" data-timezone="UTC">04:46PM - 07 Mar 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/madaidan" target="_blank">
          <img alt="madaidan" src="../../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>

      <div class="lines" title="1 commits changed 1 files with 38 additions and 1 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/pull/68/files" target="_blank">
          <span class="added">+38</span>
          <span class="removed">-1</span>
        </a>
      </div>
    </div>

  </div>
</div>
  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>/run/user/1000 bypasses /run‚Äôs <code>noexec</code> as it is its own mount point. We might want to look into restricting that too.</p>
<p>It could be useful to mount /dev with <code>noexec</code>.</p>
<p>We should experiment with the <code>ro</code> mount option to mount directories as read-only. /sys would be a good one for this as most things don‚Äôt need to write to it.</p>
<p>More mount points we can restrict are:</p>
<pre><code class="lang-auto">mqueue on /dev/mqueue type mqueue (rw,relatime)
debugfs on /sys/kernel/debug type debugfs (rw,relatime)
hugetlbfs on /dev/hugepages type hugetlbfs (rw,relatime,pagesize=2M)
</code></pre>
<p>CLIP OS‚Äôs fstab is here <a href="../../../../external.html?link=https://github.com/clipos/products_clipos/blob/master/core/configure.d/40_fstab.sh">https://github.com/clipos/products_clipos/blob/master/core/configure.d/40_fstab.sh</a></p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>
          <meta itemprop='keywords' content='component_security, status_open_issue_todo'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-07T16:59:13Z' class='post-time'>
                March 7, 2020,  4:59pm
              </time>
              <meta itemprop='dateModified' content='2020-03-07T16:59:13Z'>
          <span itemprop='position'>#29</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="28" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/pull/68">remount-secure improvements</a></p>
</blockquote>
</aside>
<p>I can merge that but it won‚Äôt help much. The current implementation is a dead-end. It‚Äôs needs to be replaced entirely. See my previous post. There I link to my question, the bug description and reply by systemd.</p>
<aside class="quote" data-post="27" data-topic="7707">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="27.html">(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?</a> <a class="badge-wrapper  bullet" href="../../../c/development/8.html"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    This needs a revision. 
systemd unit file to remount /home /tmp /dev/shm /run with nosuid,nodev 

<a href="../../../../external.html?link=https://lists.freedesktop.org/archives/systemd-devel/2019-December/043844.html">https://lists.freedesktop.org/archives/systemd-devel/2019-December/043844.html</a>
<a href="../../../../external.html?link=https://lists.freedesktop.org/archives/systemd-devel/2019-December/043845.html">https://lists.freedesktop.org/archives/systemd-devel/2019-December/043845.html</a>
  </blockquote>
</aside>

        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-07T17:01:50Z' class='post-time'>
                March 7, 2020,  5:01pm
              </time>
              <meta itemprop='dateModified' content='2020-03-07T17:01:50Z'>
          <span itemprop='position'>#30</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>The 2 alternative methods talked about in that link are using /etc/fstab or systemd .mount files. We‚Äôve already looked into both of these when creating proc-hidepid and neither worked for us.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-07T17:04:19Z' class='post-time'>
                March 7, 2020,  5:04pm
              </time>
              <meta itemprop='dateModified' content='2020-03-07T17:04:19Z'>
          <span itemprop='position'>#31</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Then we need to produce good questions and ask the systemd developers more. The current implementation is a dead-end indeed. My question on the mailing list perhaps doesn‚Äôt reflect it how bad it is. It causes horrible race conditions. Hard to debug. Random things break at random time. It‚Äôs really not ready for production.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-07T17:11:25Z' class='post-time'>
                March 7, 2020,  5:11pm
              </time>
              <meta itemprop='dateModified' content='2020-03-07T17:11:25Z'>
          <span itemprop='position'>#32</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>The race conditions can be fixed by scrapping the systemd service and running it in the initramfs. This also goes in line with what the guy on the mailing list said:</p>
<blockquote>
<p>Have it run <em>before</em> systemd (i.e. do it from the initramfs)</p>
</blockquote>
<p>How would debugging be a problem? Make a list of everything it does and write it to /var/log/remount-secure.log.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-07T17:30:10Z' class='post-time'>
                March 7, 2020,  5:30pm
              </time>
              <meta itemprop='dateModified' content='2020-03-07T17:30:10Z'>
          <span itemprop='position'>#33</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="32" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>How would debugging be a problem? Make a list of everything it does and write it to /var/log/remount-secure.log.</p>
</blockquote>
</aside>
<p>What remount-secure does is easy to log indeed. That always worked. What was hard to debug was some random unrelated service breaking.</p>
<aside class="quote no-group quote-modified" data-username="madaidan" data-post="32" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>The race conditions can be fixed by scrapping the systemd service and running it in the initramfs. This also goes in line with what the guy on the mailing list said:</p>
<blockquote>
<p>Have it run <em>before</em> systemd (i.e. do it from the initramfs)</p>
</blockquote>
</blockquote>
</aside>
<p>That would be a good solution.</p>
<p>Before piling up more and more initramfs stuff, could you port all of Whonix to dracut and implement this using a dracut hook?</p>
<aside class="quote" data-post="7" data-topic="4487">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar">
    <a href="../../replacing-initramfs-tools-with-dracut/4487/7.html">replacing initramfs-tools with dracut</a> <a class="badge-wrapper  bullet" href="../../../c/development/8.html"><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Hacking on the Whonix software and code. (devs) (list of unmaintained components)">Development</span></a>
  </div>
  <blockquote>
    Quote: 

Oh, and one last question before closing: instead of implementing these features in your own distro‚Äôs initrd, may I suggest just using Dracut instead? It‚Äôs all already implemented there! 

Source: 
<a href="../../../../external.html?link=https://www.freedesktop.org/wiki/Software/systemd/InitrdInterface/" class="onebox" target="_blank">https://www.freedesktop.org/wiki/Software/systemd/InitrdInterface/</a>
  </blockquote>
</aside>

        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-07T17:35:05Z' class='post-time'>
                March 7, 2020,  5:35pm
              </time>
              <meta itemprop='dateModified' content='2020-03-07T17:35:05Z'>
          <span itemprop='position'>#34</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="33" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Before piling up more and more initramfs stuff, could you port all of Whonix to dracut and implement this using a dracut hook?</p>
</blockquote>
</aside>
<p>I‚Äôve no experience with dracut and an initramfs-tools hook would still be needed even if we do switch to dracut, for ordinary Debian compatibility as security-misc isn‚Äôt Whonix-specific.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-07T17:42:13Z' class='post-time'>
                March 7, 2020,  5:42pm
              </time>
              <meta itemprop='dateModified' content='2020-03-07T17:42:13Z'>
          <span itemprop='position'>#35</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>dracut is a replacement for initramfs-tools if I am not mistaken.<br>
initramfs-tools hooks would need to be replaced by a dracut hook.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-07T17:44:37Z' class='post-time'>
                March 7, 2020,  5:44pm
              </time>
              <meta itemprop='dateModified' content='2020-03-07T17:44:37Z'>
          <span itemprop='position'>#36</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Yes, but normal Debian users won‚Äôt be using dracut so we‚Äôd need to have hooks for both so they can still use security-misc.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">

            <link itemprop="image" href="../../../uploads/default/original/2X/a/ac08261c9ca84b31a3e33765ec6fd1dbc2395d85.png">

          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-07T17:51:52Z' class='post-time'>
                March 7, 2020,  5:51pm
              </time>
              <meta itemprop='dateModified' content='2020-03-07T17:51:52Z'>
          <span itemprop='position'>#37</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Also normal Debian users can use dracut. It‚Äôs a well supported Debian package. Dunno which initramfs generator is default for Deiban now or in future initramfs-tools vs dracut.</p>
<p>I am not sure how much it‚Äôs worth spending effort on supporting security-misc for plain Debian, non-Kicksecure users.</p>
<p><a href="../../../../external.html?link=https://www.whonix.org/wiki/Dev/Permissions">Linux user account hardening</a> (pam, su, sudo) is causing trouble.</p>
<ul>
<li>at least 1 user needs to be in group <code>sudo</code> - otherwise security-misc aborts installation</li>
<li>previous manual pam modifications can break:</li>
</ul>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="../../../../external.html?link=https://community.parrot.sh/uploads/default/optimized/1X/ac08261c9ca84b31a3e33765ec6fd1dbc2395d85_2_32x32.png" class="site-icon" width="16" height="16">
      <a href="../../../../external.html?link=https://community.parrotlinux.org/t/parrotos-hardening/11649/10" target="_blank" title="05:28PM - 01 March 2020">Parrot Community ‚Äì 1 Mar 20</a>
  </header>
  <article class="onebox-body">
    <img src="../../../../external.html?link=https://community.parrot.sh/user_avatar/community.parrot.sh/contra/200/4287_2.png" class="thumbnail" width="" height="">

<h3><a href="../../../../external.html?link=https://community.parrotlinux.org/t/parrotos-hardening/11649/10" target="_blank">ParrotOS hardening</a></h3>

<p>Will the access restrictions to root via changes to the /etc/pam.d/common-auth file mess up my settings (yubikey)  my common-auth file:  # Use this to use both your password + Yubikey. You can comment this line if you want to JUST use your Yubikey...</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>That could be a lot effort for a small number of users.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-07T18:35:01Z' class='post-time'>
                March 7, 2020,  6:35pm
              </time>
              <meta itemprop='dateModified' content='2020-03-07T18:35:01Z'>
          <span itemprop='position'>#38</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="37" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I am not sure how much it‚Äôs worth spending effort on supporting security-misc for plain Debian, non-Kicksecure users.</p>
</blockquote>
</aside>
<p>initramfs-tools hooks are trivial. It‚Äôs a minor thing that would make security-misc far more compatible.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-07T20:47:12Z' class='post-time'>
                March 7, 2020,  8:47pm
              </time>
              <meta itemprop='dateModified' content='2020-03-07T20:47:12Z'>
          <span itemprop='position'>#39</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I figured it out.</p>
<aside class="onebox githubpullrequest">
  <header class="source">
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/pull/69" target="_blank">github.com/Whonix/security-misc</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Pull Request">
    <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/pull/69" target="_blank">Use systemd .mount files for stricter mount options and remove remount-secure</a>
    </h4>

    <div class="branches">
      <code>Whonix:master</code> ‚Üê <code>madaidan:systemd-mount</code>
    </div>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2020-03-07" data-time="20:45:03" data-timezone="UTC">08:45PM - 07 Mar 20 UTC</span>
      </div>

      <div class="user">
        <a href="../../../../external.html?link=https://github.com/madaidan" target="_blank">
          <img alt="madaidan" src="../../../../external.html?link=https://avatars0.githubusercontent.com/u/50278627?v=4" class="onebox-avatar-inline" width="20" height="20">
          madaidan
        </a>
      </div>

      <div class="lines" title="13 commits changed 10 files with 111 additions and 138 deletions">
        <a href="../../../../external.html?link=https://github.com/Whonix/security-misc/pull/69/files" target="_blank">
          <span class="added">+111</span>
          <span class="removed">-138</span>
        </a>
      </div>
    </div>

  </div>
</div>
  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Now we just need to figure out how to get the /tmp, /dev/shm and /run restrictions to work.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="3" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-07T21:00:42Z' class='post-time'>
                March 7, 2020,  9:00pm
              </time>
              <meta itemprop='dateModified' content='2020-03-07T21:00:42Z'>
          <span itemprop='position'>#40</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="39" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Now we just need to figure out how to get the /tmp, /dev/shm and /run restrictions to work.</p>
</blockquote>
</aside>
<p>/run is mounted in the initramfs and is moved to the rootfs just after the init-bottom scripts are executed so we can create an init-bottom initramfs hook to remount /run with the mount options.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick_mobile'><span itemprop='name'>Patrick_mobile</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-08T02:27:30Z' class='post-time'>
                March 8, 2020,  2:27am
              </time>
              <meta itemprop='dateModified' content='2020-03-08T02:27:30Z'>
          <span itemprop='position'>#41</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Options=bind needed? See systemd mailing list. They were asking why use mount bind.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-08T07:26:31Z' class='post-time'>
                March 8, 2020,  7:26am
              </time>
              <meta itemprop='dateModified' content='2020-03-08T07:26:31Z'>
          <span itemprop='position'>#42</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="38" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>initramfs-tools hooks are trivial. It‚Äôs a minor thing that would make security-misc far more compatible.</p>
</blockquote>
</aside>
<p>Ok.</p>
<p>Seems like we‚Äôll be stuck with initramfs-tools forever or at least until/if all major distributions (or at least Debian) switch to dracut by default.</p>
<aside class="onebox xkcd">
  <header class="source">
      <a href="../../../../external.html?link=https://xkcd.com/927/" target="_blank">xkcd.com</a>
  </header>
  <article class="onebox-body">
    <h3><a href="../../../../external.html?link=https://xkcd.com/927/" target="_blank">Standards</a></h3>

  <div class="xkcd-image"><img src="../../../../external.html?link=https://imgs.xkcd.com/comics/standards.png" width="" height=""></div>

<p>Fortunately, the charging one has been solved now that we've all standardized on mini-USB. Or is it micro-USB? Shit.</p>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-username="madaidan" data-post="39" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Now we just need to figure out how to get the /tmp, /dev/shm and /run restrictions to work.</p>
</blockquote>
</aside>
<p>About /run‚Ä¶</p>
<p>Older quote <a href="../../../../external.html?link=https://www.freedesktop.org/wiki/Software/systemd/InitrdInterface/:">https://www.freedesktop.org/wiki/Software/systemd/InitrdInterface/:</a></p>
<blockquote>
<ul>
<li>The initrd should mount /run as a tmpfs and pass it pre-mounted when jumping into the main system when executing systemd. The mount options should be mode=755,nodev</li>
</ul>
</blockquote>
<p>Newer quote <a href="../../../../external.html?link=https://systemd.io/INITRD_INTERFACE/">https://systemd.io/INITRD_INTERFACE/</a></p>
<blockquote>
<ul>
<li>The initrd should mount <code>/run/</code> as a tmpfs and pass it pre-mounted when jumping into the main system when executing systemd. The mount options should be <code>mode=755,nodev,nosuid,strictatime</code> .</li>
</ul>
</blockquote>
<p>This speaks for a initrd based implementation.</p>
<aside class="quote no-group" data-username="madaidan" data-post="39" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p>Now we just need to figure out how to get the /tmp, /dev/shm and /run restrictions to work.</p>
</blockquote>
</aside>
<p>If stuck, could you please ask on systemd mailing list?</p>
<p>Also I guess it would be better to have only 1 place to implement mount options. Either do everything inside initramfs or do everything using systemd units. Not two places to implement. I.e. not initramfs + systemd units. Reason: lower complexity.</p>
<aside class="quote no-group" data-username="madaidan" data-post="39" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/pull/69">Use systemd .mount files for stricter mount options and remove remount-secure</a></p>
</blockquote>
</aside>
<p>If going the systemd way, could you please make this configurable?<br>
Due to high potential for regressions [1], we‚Äôll ship this disabled by default and then call for testers enabling this.<br>
Using systemd unit files it may be possible to implement this by requiring kernel boot parameter <code>remount-secure</code> being set by extending the <code>[Unit]</code> section of the systemd unit file. Example:</p>
<pre><code class="lang-auto">[Unit]
ConditionKernelCommandLine=|remount-secure
</code></pre>
<hr>
<blockquote>
<p>Type=ext4</p>
</blockquote>
<p>Is this required? Or could be auto detected? Since you like to support non-Whonix, non-Kicksecure users (plain Debian) too, this might break when users are using other file systems such as btrfs.</p>
<blockquote>
<p><code>Type=</code></p>
<p>Takes a string for the file system type. See <a href="../../../../external.html?link=http://man7.org/linux/man-pages/man8/mount.8.html">mount(8)</a> for details. This setting is optional.</p>
</blockquote>
<p>Therefore I guess it can be dropped and would be auto detected by systemd if needed.</p>
<pre><code class="lang-auto">[Mount]
## Uncomment this to deny execution of programs in /home.
#Options=noexec
</code></pre>
<p>The problem with that is that this file will be replaced once a comment or something is ever changed there in the package. Would be better to add instructions there how to do that in /etc or glaceing that file in /etc perhaps. Or maybe better, instead we could probably use:</p>
<pre><code class="lang-auto">[Unit]
ConditionPathExists=|/etc/noexec
ConditionPathExists=|/usr/local/etc/noexec
</code></pre>
<p>(And/or <code>/etc/exec</code> / <code>/usr/local/etc/exec</code>.)</p>
<p>I.e. two systemd units. <code>home-exec.mount</code> and <code>home-noexec.mount</code> and which one is used/ignored depending on <code>ConditionPathExists</code>.</p>
<hr>
<blockquote>
<p>filename <code>/lib/systemd/system/bin.mount</code></p>
</blockquote>
<p>Must be <code>/lib/systemd/system/bin.mount</code><br>
Cannot be <code>/lib/systemd/system/bin.mount.d</code>?<br>
Filename could also be <code>/lib/systemd/system/remount-secure-bin.mount</code>?</p>
<p>What about the mount options for the root file system <code>/</code> itself?</p>
<p>How to test if <code>/</code> is mounted with <code>nodev</code>?</p>
<hr>
<p>[1] I previously had Qubes VMs which would boot sometimes, not boot at other times or sometimes would have broken AppArmor</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="3" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-08T15:17:54Z' class='post-time'>
                March 8, 2020,  3:17pm
              </time>
              <meta itemprop='dateModified' content='2020-03-08T15:17:54Z'>
          <span itemprop='position'>#43</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick_mobile" data-post="41" data-topic="7707" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/p/898d66/40.png" class="avatar"> Patrick_mobile:</div>
<blockquote>
<p>Options=bind needed? See systemd mailing list. They were asking why use mount bind.</p>
</blockquote>
</aside>
<p>Bind mounts are needed because we aren‚Äôt using different partitions.</p>
<aside class="quote no-group" data-username="Patrick" data-post="42" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Cannot be <code>/lib/systemd/system/bin.mount.d</code> ?</p>
</blockquote>
</aside>
<p>No, there isn‚Äôt a bin.mount in the first place so bin.mount.d won‚Äôt work.</p>
<aside class="quote no-group" data-username="Patrick" data-post="42" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Filename could also be <code>/lib/systemd/system/remount-secure-bin.mount</code> ?</p>
</blockquote>
</aside>
<p>No, systemd gives an error.</p>
<aside class="quote no-group" data-username="Patrick" data-post="42" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>What about the mount options for the root file system <code>/</code> itself?</p>
<p>How to test if <code>/</code> is mounted with <code>nodev</code> ?</p>
</blockquote>
</aside>
<p>Mounting / with <code>nodev</code> would break all devices in <code>/dev</code>.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/madaidan'><span itemprop='name'>madaidan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-08T15:38:38Z' class='post-time'>
                March 8, 2020,  3:38pm
              </time>
              <meta itemprop='dateModified' content='2020-03-08T15:38:38Z'>
          <span itemprop='position'>#44</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="Patrick" data-post="42" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Using systemd unit files it may be possible to implement this by requiring kernel boot parameter <code>remount-secure</code> being set by extending the <code>[Unit]</code> section of the systemd unit file.</p>
</blockquote>
</aside>
<p>Checking for /etc/remount-secure would be a better implementation:</p>
<pre><code>ConditionPathExists=/etc/remount-secure
</code></pre>
<aside class="quote no-group" data-username="Patrick" data-post="42" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>I.e. two systemd units. <code>home-exec.mount</code> and <code>home-noexec.mount</code> and which one is used/ignored depending on <code>ConditionPathExists</code> .</p>
</blockquote>
</aside>
<p>Won‚Äôt work:</p>
<pre><code>home-noexec.mount: Where= setting doesn't match unit name. Refusing.</code></pre>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-11T13:05:16Z' class='post-time'>
                March 11, 2020,  1:05pm
              </time>
              <meta itemprop='dateModified' content='2020-03-11T13:05:16Z'>
          <span itemprop='position'>#45</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="madaidan" data-post="39" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../letter_avatar_proxy/v4/letter/m/ea5d25/40.png" class="avatar"> madaidan:</div>
<blockquote>
<p><a href="../../../../external.html?link=https://github.com/Whonix/security-misc/pull/69">Use systemd .mount files for stricter mount options and remove remount-secure</a></p>
</blockquote>
</aside>
<p>In case you‚Äôre wondering why this is not merged yet‚Ä¶</p>
<aside class="quote no-group quote-modified" data-username="Patrick" data-post="42" data-topic="7707">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/forums.whonix.org/patrick/40/17_2.png" class="avatar"> Patrick:</div>
<blockquote>
<p>About /run‚Ä¶</p>
<p>Older quote <a href="../../../../external.html?link=https://www.freedesktop.org/wiki/Software/systemd/InitrdInterface/:">https://www.freedesktop.org/wiki/Software/systemd/InitrdInterface/:</a></p>
<blockquote>
<ul>
<li>The initrd should mount /run as a tmpfs and pass it pre-mounted when jumping into the main system when executing systemd. The mount options should be mode=755,nodev</li>
</ul>
</blockquote>
<p>Newer quote <a href="../../../../external.html?link=https://systemd.io/INITRD_INTERFACE/">https://systemd.io/INITRD_INTERFACE/</a></p>
<blockquote>
<ul>
<li>The initrd should mount <code>/run/</code> as a tmpfs and pass it pre-mounted when jumping into the main system when executing systemd. The mount options should be <code>mode=755,nodev,nosuid,strictatime</code> .</li>
</ul>
</blockquote>
<p>This speaks for a initrd based implementation.</p>
<blockquote>
<p>Now we just need to figure out how to get the /tmp, /dev/shm and /run restrictions to work.</p>
</blockquote>
<p>If stuck, could you please ask on systemd mailing list?</p>
<p>Also I guess it would be better to have only 1 place to implement mount options. Either do everything inside initramfs or do everything using systemd units. Not two places to implement. I.e. not initramfs + systemd units. Reason: lower complexity.</p>
</blockquote>
</aside>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-11T16:58:36Z' class='post-time'>
                March 11, 2020,  4:58pm
              </time>
              <meta itemprop='dateModified' content='2020-03-11T16:58:36Z'>
          <span itemprop='position'>#46</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Quote <a href="../../../../external.html?link=https://github.com/QubesOS/qubes-issues/issues/5263#issuecomment-597744172">https://github.com/QubesOS/qubes-issues/issues/5263#issuecomment-597744172</a></p>
<blockquote>
<p><code>nodev</code> on /home breaks qubes-builder (specifically: <code>/dev/null</code> and probably other devices inside chroot). I wonder what else‚Ä¶</p>
</blockquote>
<p>Probably also breaks Whonix build script which uses chroot in home and cowbuilder which uses chroot in /var.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../../external.html?link=https://forums.whonix.org/u/Patrick'><span itemprop='name'>Patrick</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="../7707.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-03-11T17:28:25Z' class='post-time'>
                March 11, 2020,  5:28pm
              </time>
              <meta itemprop='dateModified' content='2020-03-11T17:28:25Z'>
          <span itemprop='position'>#47</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Quote <a href="../../../../external.html?link=https://docs.clip-os.org/toolkit/setup.html">https://docs.clip-os.org/toolkit/setup.html</a></p>
<blockquote>
<p>Make sure to work in a filesystem without any restricted features such as noexec or nodev as it will cause undefined issues throughout the building process of some parts of the CLIP OS images.</p>
</blockquote>
<hr>
<p>The rationale of <code>nosuid</code> in <code>/home</code>, <code>/run</code>, <code>/dev/shm</code> and <code>/tmp</code> (all partially user writable) is somewhat clear. Perhaps <code>nosuid</code> by extension too (lower attack surface).</p>
<p>But what‚Äôs the rationale of mounting <code>/etc</code> and some other folders with <code>nodev</code>? CLIP OS doesn‚Äôt do that. Out commented by their default. I haven‚Äôt seen <code>/etc</code> suggested to be mounted with <code>nosuid</code>, <code>nodev</code> anywhere.</p>
<p>Maybe the argument of principle of least privilege? Well, non-root users cannot write to these folders such as <code>/etc</code> by default anyhow. Only root can. And compromised root could also change mount options. Therefore I don‚Äôt see any advantage of mounting <code>/etc</code> with <code>nosuid</code>, <code>nodev</code>. Root can always create a lets say suid file in some folder (even <code>/</code>). The only way to prevent that would be untrusted root / appamor-profile-everything.</p>
<p>Maybe a useful question to ask‚Ä¶? Was there ever any vulnerability that would have been prevented by such mount options on such folders?</p>
<p>If not recommended anywhere / not helpful in any threat model, then better keep things minimal.</p>
        </div>

        <meta itemprop='headline' content='(re-)mount home [and other?] with noexec (and nosuid [among other useful mount options]) for better security?'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="2" />
          </div>

      </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="../7707.html">‚Üê previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="../77079ba9.html?page=3">next page ‚Üí</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

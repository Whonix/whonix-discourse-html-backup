<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[Solved]Can&#39;t seem to get VPN functioning on Whonix Gateway - Support - Whonix Forum</title>
    <meta name="description" content="I have been wrestling with this for the past few days.  So, my host OS uses a VPN.  On that host I have a fully configured and functional KVM VM Whonix Gateway that I would like to install a VPN on. (It is better to inst&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="2574.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[Solved]Can&#39;t seem to get VPN functioning on Whonix Gateway&#39;" href="2574.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/solved-cant-seem-to-get-vpn-functioning-on-whonix-gateway/2574" />
<meta name="twitter:url" content="https://forums.whonix.org/t/solved-cant-seem-to-get-vpn-functioning-on-whonix-gateway/2574" />
<meta property="og:title" content="[Solved]Can&#39;t seem to get VPN functioning on Whonix Gateway" />
<meta name="twitter:title" content="[Solved]Can&#39;t seem to get VPN functioning on Whonix Gateway" />
<meta property="og:description" content="I have been wrestling with this for the past few days.  So, my host OS uses a VPN.  On that host I have a fully configured and functional KVM VM Whonix Gateway that I would like to install a VPN on. (It is better to install the VPN on the gateway rather than the Workstation correct? )  I have followed the documentation strictly, mainly using this as a guide/troubleshooter. I was able to set up this VPN on a different system(non Whonix) without issue. My .crt is updated, login info correct, firew..." />
<meta name="twitter:description" content="I have been wrestling with this for the past few days.  So, my host OS uses a VPN.  On that host I have a fully configured and functional KVM VM Whonix Gateway that I would like to install a VPN on. (It is better to install the VPN on the gateway rather than the Workstation correct? )  I have followed the documentation strictly, mainly using this as a guide/troubleshooter. I was able to set up this VPN on a different system(non Whonix) without issue. My .crt is updated, login info correct, firew..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="5 ‚ù§" />
<meta property="article:published_time" content="2016-06-09T00:27:46+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="2574.html">[Solved]Can&#39;t seem to get VPN functioning on Whonix Gateway</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/support/5.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #8C6238'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Support</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Grey'><span itemprop='name'>Grey</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="2574.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-06-09T00:27:46Z' class='post-time'>
                June 9, 2016, 12:27am
              </time>
              <meta itemprop='dateModified' content='2016-06-10T03:19:39Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I have been wrestling with this for the past few days.<br>
So, my host OS uses a VPN.<br>
On that host I have a fully configured and functional KVM VM Whonix Gateway that I would like to install a VPN on. (It is better to install the VPN on the gateway rather than the Workstation correct? )<br>
I have followed the documentation strictly, mainly using <a href="../../../external.html?link=https://www.whonix.org/wiki/Tunnels/Connecting_to_a_VPN_before_Tor#Firewall_Settings" rel="nofollow noopener">this</a> as a guide/troubleshooter. I was able to set up this VPN on a different system(non Whonix) without issue. My .crt is updated, login info correct, firewall configured, and my config files seem spot on with what my VPN provider recommends, but alas there is something I am missing because whenever I try to start my VPN with:<br>
‚Äúsudo service openvpn@vpnname start‚Äù</p>
<p>I get<br>
"write UDPv4: Operation not permitted (code=1)"<br>
‚ÄúTLS Error: TLS key negotiation failed to occur within‚Ä¶ty‚Äù<br>
‚ÄúTLS Error: TLS handshake failed‚Äù</p>
<p>Any help at all would be appreciated.<br>
Thanks in advance.</p>
        </div>

        <meta itemprop='headline' content='[Solved]Can&#39;t seem to get VPN functioning on Whonix Gateway'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/entr0py'><span itemprop='name'>entr0py</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="2574.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-06-09T03:15:59Z' class='post-time'>
                June 9, 2016,  3:15am
              </time>
              <meta itemprop='dateModified' content='2016-06-09T03:15:59Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="1" data-topic="2574">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/g/b782af/40.png" class="avatar"> Grey:</div>
<blockquote>
<p>It is better to install the VPN on the gateway rather than the Workstation correct?</p>
</blockquote>
</aside>
<p>Completely different traffic flow. For:</p>
<p>user -&gt; vpn -&gt; tor -&gt; internet: install on host or gateway<br>
user -&gt; vpn1 -&gt; vpn2 -&gt; tor -&gt; internet: install on host <em>and</em> gateway<br>
user -&gt; tor -&gt; vpn -&gt; internet: install on workstation</p>
<aside class="quote" data-post="1" data-topic="2574">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/g/b782af/40.png" class="avatar"> Grey:</div>
<blockquote>
<p>sudo service openvpn@vpnname start</p>
</blockquote>
</aside>
<p>should be <code>sudo service openvpn@openvpn start</code></p>
        </div>

        <meta itemprop='headline' content='[Solved]Can&#39;t seem to get VPN functioning on Whonix Gateway'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Grey'><span itemprop='name'>Grey</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="2574.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-06-09T13:08:39Z' class='post-time'>
                June 9, 2016,  1:08pm
              </time>
              <meta itemprop='dateModified' content='2016-06-09T14:57:54Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Ok that fix was able to get rid of the UDP code 1 error, but not the:<br>
‚ÄúTLS Error: TLS key negotiation failed to occur within‚Ä¶ty‚Äù<br>
‚ÄúTLS Error: TLS handshake failed‚Äù</p>
<p>openvpn.conf:</p>
<p>client<br>
dev tun<br>
proto udp<br>
resolv-retry infinite<br>
nobind<br>
persist-key<br>
persist-tun<br>
ns-cert-type server</p>
<p>user tunnel<br>
iproute /usr/bin/ip-unpriv</p>
<p>comp-lzo<br>
verb 3<br>
tun-mtu 1500<br>
fragment 0<br>
mssfix 1400<br>
cipher AES-256-CBC<br>
remote-random<br>
remote xxx.xxx.xxx.xxx port<br>
route-delay<br>
reneg-sec 0<br>
auth-user-pass /etc/openvpn/vpnname.login<br>
ca /etc/openvpn/ca.crt</p>
<p>Do I have to use tun instead of tap?</p>
        </div>

        <meta itemprop='headline' content='[Solved]Can&#39;t seem to get VPN functioning on Whonix Gateway'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/entr0py'><span itemprop='name'>entr0py</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="2574.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-06-09T17:43:24Z' class='post-time'>
                June 9, 2016,  5:43pm
              </time>
              <meta itemprop='dateModified' content='2016-06-09T17:43:24Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote" data-post="3" data-topic="2574">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v2/letter/g/b782af/40.png" class="avatar"> Grey:</div>
<blockquote>
<p>Do I have to use tun instead of tap?</p>
</blockquote>
</aside>
<p>If you are using VPN_FIREWALL,<br>
then its <code>dev tun0</code><br>
not <code>dev tun</code></p>
        </div>

        <meta itemprop='headline' content='[Solved]Can&#39;t seem to get VPN functioning on Whonix Gateway'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="2" />
           <span class='post-likes'>2 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.html'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/Grey'><span itemprop='name'>Grey</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="2574.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2016-06-10T03:07:15Z' class='post-time'>
                June 10, 2016,  3:07am
              </time>
              <meta itemprop='dateModified' content='2016-06-10T03:19:05Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Changed it to dev tun0 in the .conf because I have the VPN_FIREWALL enabled in 50_user.conf as well as VPN_INTERFACE set to tun0. Also ip-unpriv is now ip_unpriv because I am not using the Standalone VPN_FIREWALL. I am using the firewall preinstalled with Whonix. I am still getting the same error.</p>
<p>EDIT* HOLD THE PHONE - It works, OMG it works! I just needed to do these above things and edit the remote IP in the conf. Thank you so much for your help entr0py.</p>
        </div>

        <meta itemprop='headline' content='[Solved]Can&#39;t seem to get VPN functioning on Whonix Gateway'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>

<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>security-misc pam-info broken pip bug</title>
    <link>http://forums.whonix.org/t/security-misc-pam-info-broken-pip-bug/15951</link>
    <description>Clean Kicksecure morphed to Debian, on the login screen I see:

`/usr/libexec/security-misc/pam-info: line 91: echo: write error: Broken pipe`.

Happens when closing the lid without locking the screen first.

https://github.com/Kicksecure/security-misc/blob/master/usr/libexec/security-misc/pam-info#L78
https://github.com/Kicksecure/security-misc/blob/master/usr/libexec/security-misc/pam-info#L91</description>
    <language>en</language>
    <lastBuildDate>Mon, 14 Nov 2022 12:03:12 +0000</lastBuildDate>
    <category>Development</category>
    <atom:link href="http://forums.whonix.org/t/security-misc-pam-info-broken-pip-bug/15951.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>security-misc pam-info broken pip bug</title>
        <dc:creator><![CDATA[grass]]></dc:creator>
        <description><![CDATA[
            <p>Clean Kicksecure morphed to Debian, on the login screen I see:</p>
<p><code>/usr/libexec/security-misc/pam-info: line 91: echo: write error: Broken pipe</code>.</p>
<p>Happens when closing the lid without locking the screen first.</p>
<aside class="onebox githubblob" data-onebox-src="https://github.com/Kicksecure/security-misc/blob/master/usr/libexec/security-misc/pam-info#L78">
  <header class="source">

      <a href="https://github.com/Kicksecure/security-misc/blob/master/usr/libexec/security-misc/pam-info#L78" target="_blank" rel="noopener nofollow ugc">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/Kicksecure/security-misc/blob/master/usr/libexec/security-misc/pam-info#L78" target="_blank" rel="noopener nofollow ugc">Kicksecure/security-misc/blob/master/usr/libexec/security-misc/pam-info#L78</a></h4>



    <pre class="onebox">      <code class="lang-">
        <ol class="start lines" start="68" style="counter-reset: li-counter 67 ;">
            <li>#          echo "$0: ERROR: This is because /etc/securetty is empty." &gt;&amp;2</li>
            <li>#          echo "$0: See also:" &gt;&amp;2</li>
            <li>#          echo "https://www.kicksecure.com/wiki/root#login" &gt;&amp;2</li>
            <li>#          echo "" &gt;&amp;2</li>
            <li>#          exit 0</li>
            <li>#       fi</li>
            <li>#    fi</li>
            <li># fi</li>
            <li>
            </li>
<li>## Using || true to not break read-only disk boot without ro-mode-init or grub-live.</li>
            <li class="selected">pam_faillock_output="$(faillock --user "$PAM_USER")" || true</li>
            <li>
            </li>
<li>if [ "$pam_faillock_output" = "" ]; then</li>
            <li>   true "$0: no failed login"</li>
            <li>   exit 0</li>
            <li>fi</li>
            <li>
            </li>
<li>## Example:</li>
            <li>## user:</li>
            <li>## When                Type  Source                                           Valid</li>
            <li>## 2021-08-10 16:26:33 RHOST                                                      V</li>
        </ol>
      </code>
    </pre>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
<aside class="onebox githubblob" data-onebox-src="https://github.com/Kicksecure/security-misc/blob/master/usr/libexec/security-misc/pam-info#L91">
  <header class="source">

      <a href="https://github.com/Kicksecure/security-misc/blob/master/usr/libexec/security-misc/pam-info#L91" target="_blank" rel="noopener nofollow ugc">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/Kicksecure/security-misc/blob/master/usr/libexec/security-misc/pam-info#L91" target="_blank" rel="noopener nofollow ugc">Kicksecure/security-misc/blob/master/usr/libexec/security-misc/pam-info#L91</a></h4>



    <pre class="onebox">      <code class="lang-">
        <ol class="start lines" start="81" style="counter-reset: li-counter 80 ;">
            <li>   true "$0: no failed login"</li>
            <li>   exit 0</li>
            <li>fi</li>
            <li>
            </li>
<li>## Example:</li>
            <li>## user:</li>
            <li>## When                Type  Source                                           Valid</li>
            <li>## 2021-08-10 16:26:33 RHOST                                                      V</li>
            <li>## 2021-08-10 16:26:54 RHOST                                                      V</li>
            <li>
            </li>
<li class="selected">pam_faillock_output_first_line="$(echo "$pam_faillock_output" | head -1)"</li>
            <li>user_name="$(echo "$pam_faillock_output_first_line" | LANG=C str_replace ":" "")"</li>
            <li>
            </li>
<li>pam_faillock_output_count="$(echo "$pam_faillock_output" | wc -l)"</li>
            <li>
            </li>
<li>failed_login_counter=$(( pam_faillock_output_count - 2 ))</li>
            <li>
            </li>
<li>if [ ! "$PAM_USER" = "$user_name" ]; then</li>
            <li>   echo "$0: ERROR: PAM_USER: '$PAM_USER' does not equal user_name: '$user_name'." &gt;&amp;2</li>
            <li>   echo "$0: ERROR: Please report this bug." &gt;&amp;2</li>
            <li>   echo "" &gt;&amp;2</li>
        </ol>
      </code>
    </pre>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="http://forums.whonix.org/t/security-misc-pam-info-broken-pip-bug/15951/1">Read full topic</a></p>
        ]]></description>
        <link>http://forums.whonix.org/t/security-misc-pam-info-broken-pip-bug/15951/1</link>
        <pubDate>Mon, 14 Nov 2022 12:03:12 +0000</pubDate>
        <guid isPermaLink="false">forums.whonix.org-post-15951-1</guid>
        <source url="http://forums.whonix.org/t/security-misc-pam-info-broken-pip-bug/15951.rss">security-misc pam-info broken pip bug</source>
      </item>
  </channel>
</rss>

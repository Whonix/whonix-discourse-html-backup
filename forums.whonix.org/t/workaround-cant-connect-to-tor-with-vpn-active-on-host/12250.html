<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[Workaround] Can&#39;t connect to Tor with VPN active on host - KVM - Whonix Forum</title>
    <meta name="description" content="A couple of months ago (I think), I started having a problem with Whonix Gateway; more specifically, after updating the packages one day, the gateway stopped being able to connect to the Tor network 
A few notes regardin&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.9 - https://github.com/discourse/discourse version 1503ec07c57898a507395552b765b6808b4e1db9">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/2/222b7257d0600f2bc69cf77e6bc273aa0074ed4e_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="12250.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.whonix.org","potentialAction":{"@type":"SearchAction","target":"https://forums.whonix.org/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Whonix Forum Search">

      <link href="../../stylesheets/desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5.css_%3b%20filename_%3dUTF-8%27%27desktop_eaead85939ea2f99650f56b40c8681f4e1cb68d5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="../../stylesheets/desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6c.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_f7af26cfd21c1d79bdb82342526b638dccef9d6cd2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="header"/>
<link href="../../stylesheets/desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_4_56ca71d15f2048e2e474553f0c3928756f57aec5d2c8.css?__ws=forums.whonix.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="4" data-theme-name="default"/>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/">HOME</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Download">DOWNLOAD</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Documentation">DOCS</a>]
[<a href="../../c/news/21.html">NEWS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Support">SUPPORT</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Forum_Best_Practices">TIPS</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Reporting_Bugs#Issue_Tracker">ISSUES</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contribute">CONTRIBUTE</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Donate">DONATE</a>]
</center>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[Workaround] Can&#39;t connect to Tor with VPN active on host&#39;" href="12250.rss" />
    <meta property="og:site_name" content="Whonix Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.whonix.org/uploads/default/original/2X/a/ac61071d4245560068a380cd1c08c97d1da2201d.jpeg" />
<meta property="og:image" content="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" />
<meta property="og:url" content="https://forums.whonix.org/t/workaround-cant-connect-to-tor-with-vpn-active-on-host/12250" />
<meta name="twitter:url" content="https://forums.whonix.org/t/workaround-cant-connect-to-tor-with-vpn-active-on-host/12250" />
<meta property="og:title" content="[Workaround] Can&#39;t connect to Tor with VPN active on host" />
<meta name="twitter:title" content="[Workaround] Can&#39;t connect to Tor with VPN active on host" />
<meta property="og:description" content="A couple of months ago (I think), I started having a problem with Whonix Gateway; more specifically, after updating the packages one day, the gateway stopped being able to connect to the Tor network  A few notes regarding this problem :   Problem affects a fresh Whonix setup Problem affects people with a setup similar to mine Problem is similar to issue No. 3133 from 2016 Contrary to issue 3133, OpenVPN doesn’t seem affected, only Wireguard (tested by someone else) Host (Arch) is using Wireguard..." />
<meta name="twitter:description" content="A couple of months ago (I think), I started having a problem with Whonix Gateway; more specifically, after updating the packages one day, the gateway stopped being able to connect to the Tor network  A few notes regarding this problem :   Problem affects a fresh Whonix setup Problem affects people with a setup similar to mine Problem is similar to issue No. 3133 from 2016 Contrary to issue 3133, OpenVPN doesn’t seem affected, only Wireguard (tested by someone else) Host (Arch) is using Wireguard..." />
<meta property="article:published_time" content="2021-09-05T14:36:20+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png" alt="Whonix Forum" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="12250.html">[Workaround] Can&#39;t connect to Tor with VPN active on host</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/kvm/11.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #9EB83B'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>KVM</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/shd56733'><span itemprop='name'>shd56733</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="12250.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-09-05T14:36:20Z' class='post-time'>
                September 5, 2021,  2:36pm
              </time>
              <meta itemprop='dateModified' content='2021-09-05T14:42:21Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>A couple of months ago (I think), I started having a problem with Whonix Gateway; more specifically, after updating the packages one day, the gateway stopped being able to connect to the Tor network</p>
<p>A few notes regarding this problem :</p>
<ul>
<li>Problem affects a fresh Whonix setup</li>
<li>Problem affects people with a setup similar to mine</li>
<li>Problem is similar to issue No. 3133 from 2016</li>
<li>Contrary to issue 3133, OpenVPN doesn’t seem affected, only Wireguard (tested by someone else)</li>
<li>Host (Arch) is using Wireguard through the open source Mullvad VPN daemon (important)</li>
<li>Gateway is NATed to the VPN interface</li>
<li>Only Whonix is affected, all other VMs and applications on host work fine</li>
<li>Connectivity works fine if using an older VM backup (though I can’t figure out what package is to blame as about 40 of them get updated when running the upgrade command)</li>
</ul>
<p>As written in the title though, there is a workaround that can be applied within Whonix Gateway:<br>
Connectivity can be reestablished by using bridges (tested with obfs4); and oddly enough, until rebooting, connectivity will work fine even if you disable the bridges and restart Tor</p>
<p>I’m not sure I expect a solution to be found given how specific the problem seems to be, but at the very least I figured someone could use the information</p>
        </div>

        <meta itemprop='headline' content='[Workaround] Can&#39;t connect to Tor with VPN active on host'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="12250.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-09-12T16:41:58Z' class='post-time'>
                September 12, 2021,  4:41pm
              </time>
              <meta itemprop='dateModified' content='2021-09-12T16:41:58Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <aside class="quote no-group" data-username="shd56733" data-post="1" data-topic="12250">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="../../letter_avatar_proxy/v4/letter/s/77aa72/40.png" class="avatar"> shd56733:</div>
<blockquote>
<p>A couple of months ago (I think), I started having a problem with Whonix Gateway; more specifically, after updating the packages one day, the gateway stopped being able to connect to the Tor network</p>
</blockquote>
</aside>
<p>My guess is that there’s a conflict between the IP range assigned on the Wireguard interface and the internal range assigned for the external Whonix network. You’d have to manually edit the network settings and GW XML of the latter to accommodate the former perhaps using something in the 172.x.x.x ranges instead.</p>
        </div>

        <meta itemprop='headline' content='[Workaround] Can&#39;t connect to Tor with VPN active on host'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/ChiefGyk3D'><span itemprop='name'>ChiefGyk3D</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="12250.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-10-03T13:12:31Z' class='post-time'>
                October 3, 2021,  1:12pm
              </time>
              <meta itemprop='dateModified' content='2021-10-03T13:12:31Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>I was able to replicate the same issue myself here. I was using Wireguard with my VPN and it was not working and was not happy. Switching to OpenVPN seems to have, for the past few minutes, fixed the problem.<br>
<a class="mention" href="../../../external.html?link=https://forums.whonix.org/u/hulahoop">@HulaHoop</a> for reference I have ensured all IP blocks are different and not conflicting, there is a legitimate issue with the Whonix KVM in regards to Wireguard traffic on a VPN as far it seems, or possibly something bigger. I even tried splitting routes to no success. However, my Windows 10 VM on this same machine has never had any network connectivity problems. I haven’t tested other Linux OS to see if issue is among multiple ones as I just migrated from Virtualbox to KVM a couple weeks ago for all my daily work.</p>
<p>I’m using Pop!_OS 20.04 for reference as the Host, and the VM’s were built as of three days ago. I have been reverting to snapshots of the base install I made to ensure any tweaks were tested and working. I even destroyed and recreated the VM’s from scratch and following documentation very closely.</p>
        </div>

        <meta itemprop='headline' content='[Workaround] Can&#39;t connect to Tor with VPN active on host'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
            <meta itemprop='name' content='Whonix - Anonymous Operating System'>
              <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
                <meta itemprop='url' content='../../uploads/default/original/2X/d/d66e6a1341d872ca984eb1f23d30009afef57a4c.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <a itemprop="url" href='../../../external.html?link=https://forums.whonix.org/u/HulaHoop'><span itemprop='name'>HulaHoop</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="12250.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-10-26T21:48:19Z' class='post-time'>
                October 26, 2021,  9:48pm
              </time>
              <meta itemprop='dateModified' content='2021-10-26T21:48:19Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Check out network manager settings on the host and enable automatic connection to your VPN. Check that all users can use your connection.</p>
        </div>

        <meta itemprop='headline' content='[Workaround] Can&#39;t connect to Tor with VPN active on host'>

        <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../index.html' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../categories.html' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://forums.whonix.org/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <center>
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Imprint">Imprint</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Privacy_Policy">Privacy Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Cookie_Policy">Cookie Policy</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Terms_of_Use">Terms of Use</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/E-Sign_Consent">E-Sign Consent</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/DMCA">DMCA</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Contributors">Contributors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Investors">Investors</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Priority_Support">Priority Support</a>]
[<a href="../../../external.html?link=https://www.whonix.org/wiki/Professional_Support">Professional Support</a>]
</center>
    
  </body>
  
</html>
